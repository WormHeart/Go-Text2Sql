从目录中的info.jsonl加载结果: results/qwen_test3/info.jsonl
文件大小: 14372958 字节
处理第 1 行, 长度: 11426
行内容(截断): {"id":3457299966,"db_name":"hr","question":"在2024年10月13日，哪些员工在客户服务部工...
处理第 2 行, 长度: 14766
行内容(截断): {"id":1044893251,"db_name":"hr","question":"2024年10月11日，哪些员工在清华大学毕业并...
处理第 3 行, 长度: 7302
行内容(截断): {"id":3626797096,"db_name":"hr","question":"在2024年，员工H03961的考勤记录中，有多少...
处理第 4 行, 长度: 16108
行内容(截断): {"id":207527642,"db_name":"hr","question":"2024年9月24日，哪些员工在8:30之前打卡上班...
处理第 5 行, 长度: 37721
行内容(截断): {"id":4093748071,"db_name":"hr","question":"请列出在2024年10月5日所有员工的姓名、部...
处理第 6 行, 长度: 39268
行内容(截断): {"id":4123999737,"db_name":"hr","question":"查询2024年9月21日所有员工的姓名、部门名...
处理第 7 行, 长度: 402
行内容(截断): {"id":560968712,"db_name":"hr","question":"试用期未满三个月就离职的员工比例是多少...
处理第 8 行, 长度: 12877
行内容(截断): {"id":2123418406,"db_name":"hr","question":"2024年10月8日，哪些员工在客户服务部工作...
处理第 9 行, 长度: 22720
行内容(截断): {"id":2685336973,"db_name":"hr","question":"列出所有试用期员工的姓名和他们的入职...
处理第 10 行, 长度: 23800
行内容(截断): {"id":1786804299,"db_name":"hr","question":"2024年9月22日，哪些部门的员工在上班时间...
处理第 11 行, 长度: 17490
行内容(截断): {"id":187164736,"db_name":"hr","question":"2023年入职的员工中，哪些人在2024年10月5日...
处理第 12 行, 长度: 25008
行内容(截断): {"id":16656251,"db_name":"hr","question":"2023年入职的员工中，哪些人在2024年9月26日...
处理第 13 行, 长度: 15226
行内容(截断): {"id":3745687130,"db_name":"hr","question":"在2024年，员工H05598的考勤记录中，下班时...
处理第 14 行, 长度: 15287
行内容(截断): {"id":2706374430,"db_name":"hr","question":"2024年9月28日，哪些员工的考勤记录显示他...
处理第 15 行, 长度: 29593
行内容(截断): {"id":1934436050,"db_name":"hr","question":"2024年10月12日，哪些员工在运营部工作并且...
处理第 16 行, 长度: 14094
行内容(截断): {"id":3074190923,"db_name":"hr","question":"2024年10月11日，哪些员工在上班时间（check_...
处理第 17 行, 长度: 31373
行内容(截断): {"id":511554832,"db_name":"hr","question":"2024年9月21日，哪些员工在销售部工作并且...
处理第 18 行, 长度: 6170
行内容(截断): {"id":2699770862,"db_name":"hr","question":"2023年12月11日，哪些员工在绩效评估中获得...
处理第 19 行, 长度: 13696
行内容(截断): {"id":2054121283,"db_name":"hr","question":"2024年9月22日，哪些员工的考勤记录显示他...
处理第 20 行, 长度: 8313
行内容(截断): {"id":1458867293,"db_name":"hr","question":"2023年有哪些员工获得了创新奖，并且他们...
处理第 21 行, 长度: 25478
行内容(截断): {"id":3998131614,"db_name":"hr","question":"2024年10月9日，哪些员工在客户服务部工作...
处理第 22 行, 长度: 12595
行内容(截断): {"id":3232263409,"db_name":"hr","question":"2023年有多少员工在试用期内获得了优秀员...
处理第 23 行, 长度: 11641
行内容(截断): {"id":3292642794,"db_name":"hr","question":"2021年入职的员工中，有哪些人在2022年获得...
处理第 24 行, 长度: 19550
行内容(截断): {"id":1309577663,"db_name":"hr","question":"哪些员工的考勤记录显示他们可能同时在...
处理第 25 行, 长度: 15248
行内容(截断): {"id":3488243740,"db_name":"hr","question":"2024年9月24日，哪些部门的员工在上班时间...
处理第 26 行, 长度: 19839
行内容(截断): {"id":651157477,"db_name":"hr","question":"2024年9月19日，哪些员工在销售部工作并且...
处理第 27 行, 长度: 17026
行内容(截断): {"id":53102733,"db_name":"hr","question":"2024年9月26日，哪些部门的员工在上班时间（...
处理第 28 行, 长度: 12665
行内容(截断): {"id":3108523290,"db_name":"hr","question":"2021年入职的员工中，哪些人在2021年获得了...
处理第 29 行, 长度: 10302
行内容(截断): {"id":840538968,"db_name":"hr","question":"2024年10月3日，哪些员工在销售部工作并且...
处理第 30 行, 长度: 13857
行内容(截断): {"id":3192644686,"db_name":"hr","question":"2020年获得'优秀员工'奖项的员工中，哪些...
处理第 31 行, 长度: 12309
行内容(截断): {"id":1597119407,"db_name":"hr","question":"2023年入职的员工中，哪些员工在2023年获得...
处理第 32 行, 长度: 41631
行内容(截断): {"id":3355699316,"db_name":"hr","question":"请列出在2024年9月19日所有员工的姓名、部...
处理第 33 行, 长度: 43396
行内容(截断): {"id":1396580707,"db_name":"hr","question":"对于每个员工，如何计算其入职后的年假...
处理第 34 行, 长度: 47727
行内容(截断): {"id":2385394779,"db_name":"hr","question":"2022年获得'技术突破奖'的员工中，哪些人...
处理第 35 行, 长度: 9470
行内容(截断): {"id":3598287205,"db_name":"hr","question":"2024年9月20日，哪些员工在质量控制部工作...
处理第 36 行, 长度: 8541
行内容(截断): {"id":1157360763,"db_name":"hr","question":"2024年9月25日，哪些员工在清华大学毕业并...
处理第 37 行, 长度: 13813
行内容(截断): {"id":1456890377,"db_name":"hr","question":"绩效评级为A+的员工中，平均每天工作时长...
处理第 38 行, 长度: 18513
行内容(截断): {"id":455172185,"db_name":"hr","question":"2024年10月4日，哪些员工在销售部工作并且...
处理第 39 行, 长度: 20250
行内容(截断): {"id":4212530835,"db_name":"hr","question":"在2024年9月18日，哪些员工的考勤记录显示...
处理第 40 行, 长度: 25376
行内容(截断): {"id":1240612673,"db_name":"hr","question":"2024年9月25日，哪些员工在上班时间（check_i...
处理第 41 行, 长度: 18738
行内容(截断): {"id":2857901445,"db_name":"hr","question":"查询2024年所有员工的面试记录，并按面试...
处理第 42 行, 长度: 18240
行内容(截断): {"id":71265646,"db_name":"hr","question":"2024年10月10日，哪些员工在上班时间（check_in...
处理第 43 行, 长度: 22418
行内容(截断): {"id":2168264130,"db_name":"hr","question":"2024年9月27日，哪些部门的员工在上班时间...
处理第 44 行, 长度: 13293
行内容(截断): {"id":1505285087,"db_name":"hr","question":"查询所有员工的姓名和他们的绩效评估日...
处理第 45 行, 长度: 21911
行内容(截断): {"id":1736090929,"db_name":"hr","question":"2024年10月7日，哪些员工在上班时间（check_i...
处理第 46 行, 长度: 21754
行内容(截断): {"id":816170327,"db_name":"hr","question":"请查询2024年10月5日所有员工的考勤记录，...
处理第 47 行, 长度: 9776
行内容(截断): {"id":3913837113,"db_name":"hr","question":"哪个部门的员工平均面试次数最多？","gt_sq...
处理第 48 行, 长度: 64587
行内容(截断): {"id":578427607,"db_name":"hr","question":"哪些员工在2024年9月27日有考勤记录，并且...
处理第 49 行, 长度: 12044
行内容(截断): {"id":2435455132,"db_name":"hr","question":"2024年获得最佳团队奖的员工中，哪些人在2...
处理第 50 行, 长度: 8609
行内容(截断): {"id":801113743,"db_name":"hr","question":"2024年10月14日，哪些员工在质量控制部工作...
处理第 51 行, 长度: 19404
行内容(截断): {"id":879816496,"db_name":"hr","question":"2024年9月24日，哪些员工在下午1点之后才下...
处理第 52 行, 长度: 14365
行内容(截断): {"id":2367322111,"db_name":"hr","question":"在2024年10月8日，哪些员工的考勤记录显示...
处理第 53 行, 长度: 17527
行内容(截断): {"id":247458622,"db_name":"hr","question":"请列出2022年获得过奖项的所有员工的名字...
处理第 54 行, 长度: 16330
行内容(截断): {"id":570267133,"db_name":"hr","question":"在2024年10月12日，哪些员工的考勤记录显示...
处理第 55 行, 长度: 15714
行内容(截断): {"id":137546085,"db_name":"hr","question":"2024年10月13日，哪些员工在清华大学毕业并...
处理第 56 行, 长度: 9801
行内容(截断): {"id":4072264422,"db_name":"hr","question":"2024年9月22日，哪些员工在客户服务部工作...
处理第 57 行, 长度: 10222
行内容(截断): {"id":4121529769,"db_name":"hr","question":"2023年有哪些员工获得了'质量改进奖'，并...
处理第 58 行, 长度: 18172
行内容(截断): {"id":437939056,"db_name":"hr","question":"2024年10月5日，哪些员工在上班时间（check_in...
处理第 59 行, 长度: 6057
行内容(截断): {"id":2108794903,"db_name":"hr","question":"2024年10月2日，哪些员工在行政部工作并且...
处理第 60 行, 长度: 6587
行内容(截断): {"id":2803368869,"db_name":"hr","question":"2023年3月31日，哪些部门的员工在绩效评估...
处理第 61 行, 长度: 7766
行内容(截断): {"id":408783378,"db_name":"hr","question":"列出所有正式员工的姓名和他们的车牌号。...
处理第 62 行, 长度: 26481
行内容(截断): {"id":1719343281,"db_name":"hr","question":"在2024年9月19日，哪些员工在质量控制部工...
处理第 63 行, 长度: 9628
行内容(截断): {"id":2395193694,"db_name":"hr","question":"2022年获得'客户满意度奖'的员工中，哪些...
处理第 64 行, 长度: 23578
行内容(截断): {"id":2461283805,"db_name":"hr","question":"2024年10月11日，哪些员工的考勤记录显示他...
处理第 65 行, 长度: 14764
行内容(截断): {"id":1004841644,"db_name":"hr","question":"请列出2023年获得'领导力奖'的员工姓名及...
处理第 66 行, 长度: 13919
行内容(截断): {"id":958025096,"db_name":"hr","question":"2023年获得'领导力奖'的员工中，哪些人在202...
处理第 67 行, 长度: 23141
行内容(截断): {"id":4156394932,"db_name":"hr","question":"在2024年10月2日，哪些实习生在早上9点到10...
处理第 68 行, 长度: 8365
行内容(截断): {"id":5535555,"db_name":"hr","question":"哪个部门的员工平均年龄最大？","gt_sql":"SELEC...
处理第 69 行, 长度: 23674
行内容(截断): {"id":1584866592,"db_name":"hr","question":"哪些员工在2024年9月16日有考勤记录，并且...
处理第 70 行, 长度: 20209
行内容(截断): {"id":4123927043,"db_name":"hr","question":"2024年10月8日，哪些员工在研发部工作并且...
处理第 71 行, 长度: 15657
行内容(截断): {"id":2642437739,"db_name":"hr","question":"2024年9月20日，哪些员工在财务部工作并且...
处理第 72 行, 长度: 22770
行内容(截断): {"id":1412040002,"db_name":"hr","question":"2024年10月5日，哪些员工在人力资源部工作...
处理第 73 行, 长度: 25089
行内容(截断): {"id":467771706,"db_name":"hr","question":"哪些员工在2024年10月14日有考勤记录，并且...
处理第 74 行, 长度: 39734
行内容(截断): {"id":416599650,"db_name":"hr","question":"2024年9月27日，哪些员工在行政部工作并且...
处理第 75 行, 长度: 8933
行内容(截断): {"id":2074887228,"db_name":"hr","question":"列出所有部门的名称及其对应的员工数量...
处理第 76 行, 长度: 11019
行内容(截断): {"id":4204863942,"db_name":"hr","question":"入职时间最短但已获得A+绩效的员工是谁？...
处理第 77 行, 长度: 13610
行内容(截断): {"id":603993474,"db_name":"hr","question":"哪些员工的出勤时间与其所属部门的平均出...
处理第 78 行, 长度: 30086
行内容(截断): {"id":4133405205,"db_name":"hr","question":"2024年10月5日，哪些员工在研发部工作并且...
处理第 79 行, 长度: 21638
行内容(截断): {"id":1822156377,"db_name":"hr","question":"请找出在2024年10月12日有考勤记录的员工姓...
处理第 80 行, 长度: 20652
行内容(截断): {"id":3941104083,"db_name":"hr","question":"2024年10月11日，哪些员工在销售部工作并且...
处理第 81 行, 长度: 42021
行内容(截断): {"id":1448803792,"db_name":"hr","question":"在2024年9月26日，哪些员工在上班时间（chec...
处理第 82 行, 长度: 18493
行内容(截断): {"id":2348295774,"db_name":"hr","question":"2024年10月5日，哪些员工在上班时间晚于9:00...
处理第 83 行, 长度: 8563
行内容(截断): {"id":1351044911,"db_name":"hr","question":"2024年10月7日，哪些员工在人力资源部工作...
处理第 84 行, 长度: 22574
行内容(截断): {"id":1269433479,"db_name":"hr","question":"在2024年10月11日，哪些实习生的考勤记录显...
处理第 85 行, 长度: 9555
行内容(截断): {"id":2181400574,"db_name":"hr","question":"2023年有哪些员工获得了优秀员工奖，并且...
处理第 86 行, 长度: 11497
行内容(截断): {"id":2992677261,"db_name":"hr","question":"近五年内，每个部门为公司培养的高潜力...
处理第 87 行, 长度: 14112
行内容(截断): {"id":1583766775,"db_name":"hr","question":"2024年获得新人奖的员工中，哪些人在2024年...
处理第 88 行, 长度: 19205
行内容(截断): {"id":2928703740,"db_name":"hr","question":"2024年10月2日，哪些员工的考勤记录显示他...
处理第 89 行, 长度: 15588
行内容(截断): {"id":2166514841,"db_name":"hr","question":"请列出在2024年获得'新人奖'的员工姓名及...
处理第 90 行, 长度: 11251
行内容(截断): {"id":2864760744,"db_name":"hr","question":"从入职到首次获得管理职位，员工平均需...
处理第 91 行, 长度: 25331
行内容(截断): {"id":2860391364,"db_name":"hr","question":"2024年10月6日，哪些员工在研发部工作并且...
处理第 92 行, 长度: 9387
行内容(截断): {"id":1852490763,"db_name":"hr","question":"2023年有哪些员工获得了技术突破奖，并且...
处理第 93 行, 长度: 15813
行内容(截断): {"id":2494653166,"db_name":"hr","question":"2024年9月17日，哪些员工在上班时间迟到并...
处理第 94 行, 长度: 16398
行内容(截断): {"id":3084451002,"db_name":"hr","question":"2024年获得'项目管理奖'的员工中，哪些人...
处理第 95 行, 长度: 21436
行内容(截断): {"id":408688532,"db_name":"hr","question":"2023年获得领导力奖的员工中，哪些人是在20...
处理第 96 行, 长度: 31584
行内容(截断): {"id":4036648411,"db_name":"hr","question":"在2024年9月16日，哪些员工在清华大学毕业...
处理第 97 行, 长度: 4991
行内容(截断): {"id":548473863,"db_name":"hr","question":"2023年获得领导力奖的员工中，哪些人是在20...
处理第 98 行, 长度: 9413
行内容(截断): {"id":2286968533,"db_name":"hr","question":"2024年10月12日，哪些员工在客户服务部工作...
处理第 99 行, 长度: 19121
行内容(截断): {"id":3284637113,"db_name":"hr","question":"在2024年9月21日，哪些员工的考勤记录显示...
处理第 100 行, 长度: 12431
行内容(截断): {"id":773404511,"db_name":"hr","question":"2024年9月24日，哪些部门的员工在上班时间...
处理第 101 行, 长度: 35236
行内容(截断): {"id":2149393306,"db_name":"hr","question":"2024年10月5日，哪些员工在行政部工作并且...
处理第 102 行, 长度: 18041
行内容(截断): {"id":2477803619,"db_name":"hr","question":"在2024年10月6日，哪些员工在财务部工作并...
处理第 103 行, 长度: 20177
行内容(截断): {"id":821353235,"db_name":"hr","question":"哪些员工在2023年获得了'A+'的绩效评级，并...
处理第 104 行, 长度: 20579
行内容(截断): {"id":907163187,"db_name":"hr","question":"在2024年9月28日，哪些员工的考勤记录显示...
处理第 105 行, 长度: 23588
行内容(截断): {"id":811463423,"db_name":"hr","question":"2023年获得'销售冠军'奖项的员工在2024年10月...
处理第 106 行, 长度: 12477
行内容(截断): {"id":2913040945,"db_name":"hr","question":"每个部门中，从入职到首次获得A+绩效评级...
处理第 107 行, 长度: 14076
行内容(截断): {"id":1736656854,"db_name":"hr","question":"2024年9月22日，哪些员工的考勤记录显示他...
处理第 108 行, 长度: 7430
行内容(截断): {"id":2339817132,"db_name":"hr","question":"哪些员工在2024年获得了'优秀员工'奖项，...
处理第 109 行, 长度: 8750
行内容(截断): {"id":2218878981,"db_name":"hr","question":"请列出在2023年10月29日进行绩效评估的所有...
处理第 110 行, 长度: 28104
行内容(截断): {"id":1785434408,"db_name":"hr","question":"2024年9月17日，哪些员工在清华大学毕业并...
处理第 111 行, 长度: 9661
行内容(截断): {"id":2274426817,"db_name":"hr","question":"2022年6月16日，哪些员工在绩效评估中获得...
处理第 112 行, 长度: 8800
行内容(截断): {"id":1121061015,"db_name":"hr","question":"2022年获得'优秀员工'奖的员工中，哪些人...
处理第 113 行, 长度: 14424
行内容(截断): {"id":1822740611,"db_name":"hr","question":"2024年9月15日，哪些员工的考勤记录显示他...
处理第 114 行, 长度: 16956
行内容(截断): {"id":3049098373,"db_name":"hr","question":"找出所有在销售部工作的员工的姓名和职...
处理第 115 行, 长度: 21141
行内容(截断): {"id":2137629249,"db_name":"hr","question":"在2024年9月23日，哪些员工的考勤记录显示...
处理第 116 行, 长度: 7166
行内容(截断): {"id":2240615465,"db_name":"hr","question":"2024年10月14日，哪些员工在客户服务部工作...
处理第 117 行, 长度: 18540
行内容(截断): {"id":1309270874,"db_name":"hr","question":"2023年获得领导力奖的员工中，哪些人是在2...
处理第 118 行, 长度: 12958
行内容(截断): {"id":2420332715,"db_name":"hr","question":"在2024年9月20日，哪些部门的员工在上班时...
处理第 119 行, 长度: 26538
行内容(截断): {"id":60966118,"db_name":"hr","question":"哪些员工虽然绩效一般，但在同事评价或团...
处理第 120 行, 长度: 16252
行内容(截断): {"id":1965264110,"db_name":"hr","question":"2024年9月20日，哪些员工在8点到9点之间打...
处理第 121 行, 长度: 15146
行内容(截断): {"id":1436736406,"db_name":"hr","question":"哪些员工的最后一次绩效评估是在2024年之...
处理第 122 行, 长度: 20288
行内容(截断): {"id":2263195811,"db_name":"hr","question":"在2024年9月19日，哪些员工的考勤记录显示...
处理第 123 行, 长度: 6199
行内容(截断): {"id":1079007714,"db_name":"hr","question":"在2024年9月24日，哪些员工的考勤记录显示...
处理第 124 行, 长度: 25244
行内容(截断): {"id":2835428087,"db_name":"hr","question":"2024年9月29日，哪些员工在清华大学毕业并...
处理第 125 行, 长度: 16482
行内容(截断): {"id":2600324766,"db_name":"hr","question":"在2024年10月11日，哪些员工在上班时间（che...
处理第 126 行, 长度: 371
行内容(截断): {"id":1290741288,"db_name":"hr","question":"查询某个员工（例如H03961）的考勤记录，...
处理第 127 行, 长度: 19387
行内容(截断): {"id":3714812669,"db_name":"hr","question":"2024年9月23日，哪些员工在厦门大学毕业并...
处理第 128 行, 长度: 9724
行内容(截断): {"id":4217899403,"db_name":"hr","question":"2024年9月19日，哪些员工在上班时间（check_i...
处理第 129 行, 长度: 21327
行内容(截断): {"id":1946117596,"db_name":"hr","question":"2024年10月11日，哪些员工在清华大学毕业并...
处理第 130 行, 长度: 13649
行内容(截断): {"id":1268105110,"db_name":"hr","question":"2024年10月10日，哪些员工的考勤记录显示他...
处理第 131 行, 长度: 8786
行内容(截断): {"id":910719964,"db_name":"hr","question":"2024年入职的员工中，哪些人在2024年获得了'...
处理第 132 行, 长度: 17915
行内容(截断): {"id":4215983699,"db_name":"hr","question":"2024年9月26日，哪些员工在早上8点到9点之...
处理第 133 行, 长度: 11808
行内容(截断): {"id":3022631781,"db_name":"hr","question":"2023年获得创新奖的员工中，哪些人在2024年...
处理第 134 行, 长度: 13799
行内容(截断): {"id":1326215630,"db_name":"hr","question":"在2024年9月24日，哪些员工的考勤记录显示...
处理第 135 行, 长度: 21894
行内容(截断): {"id":2739991096,"db_name":"hr","question":"在2024年，哪个部门的经理是员工H03372，并...
处理第 136 行, 长度: 14444
行内容(截断): {"id":3094758858,"db_name":"hr","question":"哪些员工在2024年10月12日有考勤记录，并且...
处理第 137 行, 长度: 28624
行内容(截断): {"id":3240116959,"db_name":"hr","question":"2023年获得'质量改进奖'的员工中，哪些人...
处理第 138 行, 长度: 38657
行内容(截断): {"id":3253971302,"db_name":"hr","question":"在2024年9月15日，哪些员工在财务部工作并...
处理第 139 行, 长度: 14217
行内容(截断): {"id":3037862925,"db_name":"hr","question":"2024年9月21日，哪些员工在质量控制部工作...
处理第 140 行, 长度: 15925
行内容(截断): {"id":1991610345,"db_name":"hr","question":"2024年9月25日，哪些员工在销售部工作并且...
处理第 141 行, 长度: 17874
行内容(截断): {"id":3421802959,"db_name":"hr","question":"2022年获得'技术突破奖'的员工中，哪些人...
处理第 142 行, 长度: 16200
行内容(截断): {"id":3350855518,"db_name":"hr","question":"在2024年10月11日，哪些员工在财务部工作并...
处理第 143 行, 长度: 17555
行内容(截断): {"id":1481678835,"db_name":"hr","question":"2024年10月12日，哪些员工在研发部工作并且...
处理第 144 行, 长度: 6849
行内容(截断): {"id":1832961045,"db_name":"hr","question":"2023年8月6日，哪些部门的员工在绩效评估...
处理第 145 行, 长度: 25016
行内容(截断): {"id":3794832374,"db_name":"hr","question":"在2024年10月1日，哪些员工的考勤记录显示...
处理第 146 行, 长度: 13837
行内容(截断): {"id":4131389571,"db_name":"hr","question":"2024年10月9日，哪些员工的考勤记录显示他...
处理第 147 行, 长度: 27231
行内容(截断): {"id":2592420070,"db_name":"hr","question":"2024年9月24日，哪些员工在人力资源部工作...
处理第 148 行, 长度: 19866
行内容(截断): {"id":1526114356,"db_name":"hr","question":"在2024年10月2日，哪些员工在销售部工作并...
处理第 149 行, 长度: 19796
行内容(截断): {"id":906637391,"db_name":"hr","question":"在2024年10月11日，哪些员工的考勤记录显示...
处理第 150 行, 长度: 18452
行内容(截断): {"id":3180358031,"db_name":"hr","question":"请列出2022年绩效评估等级为B的员工姓名、...
处理第 151 行, 长度: 12856
行内容(截断): {"id":1427670664,"db_name":"hr","question":"请列出在2024年9月22日考勤记录中，所有员...
处理第 152 行, 长度: 28038
行内容(截断): {"id":2517372671,"db_name":"hr","question":"2024年9月20日，哪些部门的员工在上班时间...
处理第 153 行, 长度: 5448
行内容(截断): {"id":2374975326,"db_name":"hr","question":"2024年10月2日最早到岗的员工是谁？","gt_sql"...
处理第 154 行, 长度: 21839
行内容(截断): {"id":1399658957,"db_name":"hr","question":"2023年入职的员工中，哪些人在2024年10月10...
处理第 155 行, 长度: 44564
行内容(截断): {"id":1337508734,"db_name":"hr","question":"2024年10月4日，哪些员工在财务部工作并且...
处理第 156 行, 长度: 16306
行内容(截断): {"id":2509046712,"db_name":"hr","question":"哪些员工在2024年9月17日有考勤记录，并且...
处理第 157 行, 长度: 16221
行内容(截断): {"id":1196649212,"db_name":"hr","question":"试用期延长次数最多的三名员工分别来自...
处理第 158 行, 长度: 22280
行内容(截断): {"id":3455582973,"db_name":"hr","question":"2024年10月4日，哪些员工在财务部工作并且...
处理第 159 行, 长度: 14620
行内容(截断): {"id":2169239057,"db_name":"hr","question":"请列出2023年所有获得'优秀员工'奖项的员...
处理第 160 行, 长度: 11979
行内容(截断): {"id":329969630,"db_name":"hr","question":"2023年有多少员工在试用期内获得了客户满...
处理第 161 行, 长度: 15749
行内容(截断): {"id":1957766738,"db_name":"hr","question":"在2024年9月24日，哪些员工的考勤记录显示...
处理第 162 行, 长度: 10759
行内容(截断): {"id":701997867,"db_name":"hr","question":"列出所有获得过奖项的员工的姓名和奖项名...
处理第 163 行, 长度: 34570
行内容(截断): {"id":906781191,"db_name":"hr","question":"在2024年10月13日，哪些员工在法务部工作并...
处理第 164 行, 长度: 12186
行内容(截断): {"id":388401260,"db_name":"hr","question":"2024年9月17日，哪些员工在质量控制部工作...
处理第 165 行, 长度: 25136
行内容(截断): {"id":1988310183,"db_name":"hr","question":"请列出2024年9月26日所有员工的姓名、部门...
处理第 166 行, 长度: 38702
行内容(截断): {"id":2363197929,"db_name":"hr","question":"2024年10月9日，哪些员工在财务部工作并且...
处理第 167 行, 长度: 8924
行内容(截断): {"id":935583315,"db_name":"hr","question":"2024年10月10日，哪些员工在客户服务部工作...
处理第 168 行, 长度: 11700
行内容(截断): {"id":3679145520,"db_name":"hr","question":"哪些员工在公司内部的创新孵化项目中表...
处理第 169 行, 长度: 15507
行内容(截断): {"id":1647521458,"db_name":"hr","question":"在2024年9月25日，哪些员工的考勤记录显示...
处理第 170 行, 长度: 22522
行内容(截断): {"id":2154404311,"db_name":"hr","question":"2024年9月28日，哪些员工在客户服务部工作...
处理第 171 行, 长度: 28849
行内容(截断): {"id":1956887122,"db_name":"hr","question":"2024年10月7日，哪些员工在法务部工作并且...
处理第 172 行, 长度: 22731
行内容(截断): {"id":541499305,"db_name":"hr","question":"请列出在2024年10月14日考勤记录中，所有员...
处理第 173 行, 长度: 10628
行内容(截断): {"id":607760760,"db_name":"hr","question":"2021年获得优秀员工的员工中，哪些人在2021...
处理第 174 行, 长度: 10517
行内容(截断): {"id":3786409554,"db_name":"hr","question":"2024年获得领导力奖的员工中，哪些人是在2...
处理第 175 行, 长度: 24120
行内容(截断): {"id":1833538335,"db_name":"hr","question":"哪些员工虽然履历看似普通，但在关键决...
处理第 176 行, 长度: 7039
行内容(截断): {"id":2571560082,"db_name":"hr","question":"在2023年12月7日进行的绩效评估中，哪些员...
处理第 177 行, 长度: 16745
行内容(截断): {"id":3184081384,"db_name":"hr","question":"2023年入职的员工中，有哪些人在2023年获得...
处理第 178 行, 长度: 37320
行内容(截断): {"id":3265054996,"db_name":"hr","question":"2024年9月25日，哪些员工在销售部工作并且...
处理第 179 行, 长度: 31207
行内容(截断): {"id":1987469456,"db_name":"hr","question":"2024年9月20日，哪些员工在质量控制部工作...
处理第 180 行, 长度: 9646
行内容(截断): {"id":3475714298,"db_name":"hr","question":"在2024年9月29日，哪些员工在客户服务部工...
处理第 181 行, 长度: 18385
行内容(截断): {"id":3158837504,"db_name":"hr","question":"2024年10月4日，哪些员工在上班时间（check_i...
处理第 182 行, 长度: 15383
行内容(截断): {"id":1341335041,"db_name":"hr","question":"获取所有员工的考勤记录，并统计每个员...
处理第 183 行, 长度: 12856
行内容(截断): {"id":1248129462,"db_name":"hr","question":"哪些员工在2024年9月15日有考勤记录，并且...
处理第 184 行, 长度: 11897
行内容(截断): {"id":2929076718,"db_name":"hr","question":"2021年获得最佳团队奖的员工中，哪些人在2...
处理第 185 行, 长度: 10382
行内容(截断): {"id":860593492,"db_name":"hr","question":"在2024年9月21日，哪些员工在客户服务部工...
处理第 186 行, 长度: 33816
行内容(截断): {"id":803138423,"db_name":"hr","question":"在2024年9月23日，哪些员工在财务部工作并...
处理第 187 行, 长度: 19947
行内容(截断): {"id":1392351924,"db_name":"hr","question":"2024年10月9日，哪些实习生的考勤记录显示...
处理第 188 行, 长度: 36624
行内容(截断): {"id":2647170145,"db_name":"hr","question":"2023年获得'项目管理奖'的员工中，哪些人...
处理第 189 行, 长度: 11013
行内容(截断): {"id":2581619009,"db_name":"hr","question":"2022年入职的员工中，哪些人在2023年获得了...
处理第 190 行, 长度: 39380
行内容(截断): {"id":2697889458,"db_name":"hr","question":"请列出在2024年10月13日考勤记录中，所有员...
处理第 191 行, 长度: 23587
行内容(截断): {"id":3387668548,"db_name":"hr","question":"2024年9月18日，哪些员工在行政部工作并且...
处理第 192 行, 长度: 7995
行内容(截断): {"id":1417292000,"db_name":"hr","question":"哪些因素（如导师计划、培训课程、轮岗...
处理第 193 行, 长度: 22548
行内容(截断): {"id":1597423542,"db_name":"hr","question":"2024年9月20日，哪些员工在销售部工作并且...
处理第 194 行, 长度: 13478
行内容(截断): {"id":3397723976,"db_name":"hr","question":"每个部门中年龄最大的员工是谁？","gt_sql":...
处理第 195 行, 长度: 8187
行内容(截断): {"id":339893232,"db_name":"hr","question":"在2024年9月30日，哪些员工在人力资源部工...
处理第 196 行, 长度: 22084
行内容(截断): {"id":244305078,"db_name":"hr","question":"2024年9月18日，哪些员工在研发部工作并且...
处理第 197 行, 长度: 20354
行内容(截断): {"id":2030661443,"db_name":"hr","question":"2024年9月28日，哪些员工在上班时间（check_i...
处理第 198 行, 长度: 20823
行内容(截断): {"id":2290320497,"db_name":"hr","question":"在2024年9月17日，哪些员工的考勤记录显示...
处理第 199 行, 长度: 19035
行内容(截断): {"id":2134005508,"db_name":"hr","question":"哪些员工在2024年9月22日有考勤记录，并且...
处理第 200 行, 长度: 26699
行内容(截断): {"id":3179866905,"db_name":"hr","question":"哪些员工在2024年10月3日有考勤记录，并且...
处理第 201 行, 长度: 34270
行内容(截断): {"id":1447725797,"db_name":"hr","question":"2024年10月7日，哪些员工在客户服务部工作...
处理第 202 行, 长度: 25598
行内容(截断): {"id":3166523944,"db_name":"hr","question":"显示每位员工的考勤记录及其绩效评估评...
处理第 203 行, 长度: 21388
行内容(截断): {"id":3133264714,"db_name":"hr","question":"在2024年10月5日，哪些员工的考勤记录显示...
处理第 204 行, 长度: 9990
行内容(截断): {"id":2850698943,"db_name":"hr","question":"2024年9月25日，哪些员工在质量控制部工作...
处理第 205 行, 长度: 1489
行内容(截断): {"id":2860363666,"db_name":"hr","question":"过去三年中，每个季度产出最高的员工是...
处理第 206 行, 长度: 19238
行内容(截断): {"id":3284872060,"db_name":"hr","question":"2023年有哪些员工获得了奖项，并且他们的...
处理第 207 行, 长度: 11485
行内容(截断): {"id":1370529433,"db_name":"hr","question":"2022年获得'质量改进奖'的员工中，哪些人...
处理第 208 行, 长度: 10500
行内容(截断): {"id":4101493476,"db_name":"hr","question":"2024年10月3日，哪些员工在客户服务部工作...
处理第 209 行, 长度: 7840
行内容(截断): {"id":1724137514,"db_name":"hr","question":"2024年10月2日，哪些员工在人力资源部工作...
处理第 210 行, 长度: 10854
行内容(截断): {"id":3595600525,"db_name":"hr","question":"2023年获得'优秀员工'奖项的员工中，哪些...
处理第 211 行, 长度: 10872
行内容(截断): {"id":815548435,"db_name":"hr","question":"2023年5月31日，哪些部门的员工在绩效评估...
处理第 212 行, 长度: 24773
行内容(截断): {"id":2061849622,"db_name":"hr","question":"2024年10月2日，哪些员工在上班时间（check_i...
处理第 213 行, 长度: 27115
行内容(截断): {"id":1250267679,"db_name":"hr","question":"2021年获得'销售冠军'奖项的员工在2024年9月...
处理第 214 行, 长度: 9892
行内容(截断): {"id":1929429344,"db_name":"hr","question":"2023年5月27日，哪些员工在绩效评估中获得...
处理第 215 行, 长度: 20732
行内容(截断): {"id":3689323727,"db_name":"hr","question":"在2024年9月16日，哪些员工的考勤记录显示...
处理第 216 行, 长度: 14907
行内容(截断): {"id":2977986068,"db_name":"hr","question":"列出所有员工的姓名及其部门名称。","gt_sq...
处理第 217 行, 长度: 11023
行内容(截断): {"id":3402561235,"db_name":"hr","question":"入职时间最长但职位级别最低的员工是谁...
处理第 218 行, 长度: 10979
行内容(截断): {"id":3958686389,"db_name":"hr","question":"在2024年，部门ID为D00007的员工中，哪些人...
处理第 219 行, 长度: 10826
行内容(截断): {"id":3786147845,"db_name":"hr","question":"2022年获得创新奖的员工中，有哪些人在2024...
处理第 220 行, 长度: 29090
行内容(截断): {"id":1159542995,"db_name":"hr","question":"在2024年9月23日，哪些员工的考勤记录显示...
处理第 221 行, 长度: 7590
行内容(截断): {"id":3254827737,"db_name":"hr","question":"2023年有多少员工获得了质量改进奖，并且...
处理第 222 行, 长度: 12382
行内容(截断): {"id":3909320290,"db_name":"hr","question":"2024年9月23日，哪些部门的员工在上班时间...
处理第 223 行, 长度: 8620
行内容(截断): {"id":628072208,"db_name":"hr","question":"2023年10月9日，哪些部门的员工在面试中表...
处理第 224 行, 长度: 28871
行内容(截断): {"id":3286899081,"db_name":"hr","question":"在2024年10月12日，哪些员工在上午9点前打...
处理第 225 行, 长度: 21638
行内容(截断): {"id":2517269758,"db_name":"hr","question":"在2024年9月20日，哪些员工的考勤记录显示...
处理第 226 行, 长度: 9611
行内容(截断): {"id":3866100328,"db_name":"hr","question":"2021年获得'质量改进奖'的员工中，哪些人...
处理第 227 行, 长度: 13172
行内容(截断): {"id":3469101707,"db_name":"hr","question":"2024年9月29日，哪些员工在客户服务部工作...
处理第 228 行, 长度: 34252
行内容(截断): {"id":2797510377,"db_name":"hr","question":"2024年9月16日，哪些员工在上班时间（check_i...
处理第 229 行, 长度: 18122
行内容(截断): {"id":2587625643,"db_name":"hr","question":"在2024年10月1日，哪些员工的考勤记录显示...
处理第 230 行, 长度: 17935
行内容(截断): {"id":2556819995,"db_name":"hr","question":"2024年9月23日，哪些员工在客户服务部工作...
处理第 231 行, 长度: 10340
行内容(截断): {"id":2163155798,"db_name":"hr","question":"过去五年中，每年的技术创新奖获得者，...
处理第 232 行, 长度: 28239
行内容(截断): {"id":1599035554,"db_name":"hr","question":"2024年10月6日，哪些员工在财务部工作并且...
处理第 233 行, 长度: 13168
行内容(截断): {"id":3248411469,"db_name":"hr","question":"在2024年10月4日，哪些员工的考勤记录显示...
处理第 234 行, 长度: 13685
行内容(截断): {"id":2257279104,"db_name":"hr","question":"请列出在2024年10月4日有考勤记录的员工姓...
处理第 235 行, 长度: 21259
行内容(截断): {"id":2036213054,"db_name":"hr","question":"在2023年，哪些员工获得了奖项并且在同一...
处理第 236 行, 长度: 16049
行内容(截断): {"id":2231439732,"db_name":"hr","question":"请列出在2024年10月10日所有迟到的员工姓名...
处理第 237 行, 长度: 40178
行内容(截断): {"id":1852561007,"db_name":"hr","question":"请列出2024年9月19日所有员工的姓名、部门...
处理第 238 行, 长度: 18708
行内容(截断): {"id":3057784484,"db_name":"hr","question":"2024年10月3日，哪些员工在行政部工作并且...
处理第 239 行, 长度: 9441
行内容(截断): {"id":604055577,"db_name":"hr","question":"哪个部门的员工平均剩余年假最多？","gt_sql...
处理第 240 行, 长度: 18314
行内容(截断): {"id":1799658813,"db_name":"hr","question":"2024年9月27日，哪些员工在上午10点之前打...
处理第 241 行, 长度: 14887
行内容(截断): {"id":556306212,"db_name":"hr","question":"查询在2024年进行面试的所有员工的面试日...
处理第 242 行, 长度: 15041
行内容(截断): {"id":3669286537,"db_name":"hr","question":"在2024年9月20日，哪些员工的考勤记录显示...
处理第 243 行, 长度: 12001
行内容(截断): {"id":1975822937,"db_name":"hr","question":"2024年9月29日，哪些员工在研发部工作并且...
处理第 244 行, 长度: 34237
行内容(截断): {"id":1362951886,"db_name":"hr","question":"2022年获得'销售冠军'奖项的员工在2024年10...
处理第 245 行, 长度: 18654
行内容(截断): {"id":2799760973,"db_name":"hr","question":"2023年获得客户满意度奖的员工中，哪些人...
处理第 246 行, 长度: 18300
行内容(截断): {"id":1692765210,"db_name":"hr","question":"在2024年9月22日，哪些员工在上班时间（chec...
处理第 247 行, 长度: 7189
行内容(截断): {"id":804998806,"db_name":"hr","question":"2022年6月20日，哪些部门的员工在绩效评估...
处理第 248 行, 长度: 9499
行内容(截断): {"id":170694593,"db_name":"hr","question":"哪些员工在2024年获得了'客户满意度奖'，并...
处理第 249 行, 长度: 11098
行内容(截断): {"id":2091607073,"db_name":"hr","question":"2023年获得'项目管理奖'的员工中，哪些人...
处理第 250 行, 长度: 7982
行内容(截断): {"id":2894384990,"db_name":"hr","question":"2023年3月9日，哪些员工在绩效评估中获得...
处理第 251 行, 长度: 625
行内容(截断): {"id":1149281173,"db_name":"hr","question":"长期致力于某个专业领域的专家型员工，...
处理第 252 行, 长度: 36034
行内容(截断): {"id":1884200158,"db_name":"hr","question":"请列出在2024年10月8日考勤记录中，所有员...
处理第 253 行, 长度: 26250
行内容(截断): {"id":2557740373,"db_name":"hr","question":"2024年9月26日，哪些员工在人力资源部工作...
处理第 254 行, 长度: 19811
行内容(截断): {"id":3799739588,"db_name":"hr","question":"在2024年9月28日，哪些员工的考勤记录显示...
处理第 255 行, 长度: 13910
行内容(截断): {"id":1074403791,"db_name":"hr","question":"在2024年9月20日，哪些员工在研发部工作并...
处理第 256 行, 长度: 19494
行内容(截断): {"id":1640643914,"db_name":"hr","question":"2024年10月13日，哪些部门的员工在上班时间...
处理第 257 行, 长度: 16499
行内容(截断): {"id":3875469036,"db_name":"hr","question":"2023年获得'销售冠军'奖项的员工中，哪些...
处理第 258 行, 长度: 39990
行内容(截断): {"id":1182082319,"db_name":"hr","question":"2024年9月17日，哪些员工在财务部工作并且...
处理第 259 行, 长度: 33786
行内容(截断): {"id":219564979,"db_name":"hr","question":"在2024年9月18日，哪些员工的考勤记录显示...
处理第 260 行, 长度: 15638
行内容(截断): {"id":2296352057,"db_name":"hr","question":"2023年获得'技术突破奖'的员工中，哪些人...
处理第 261 行, 长度: 9392
行内容(截断): {"id":3848854887,"db_name":"hr","question":"2024年9月26日，哪些员工在运营部工作并且...
处理第 262 行, 长度: 9438
行内容(截断): {"id":4144781586,"db_name":"hr","question":"2020年获得“优秀员工”奖项的员工中，哪...
处理第 263 行, 长度: 25529
行内容(截断): {"id":543593806,"db_name":"hr","question":"2024年10月3日，哪些员工在上班时间迟到并...
处理第 264 行, 长度: 14195
行内容(截断): {"id":3302179394,"db_name":"hr","question":"2024年10月12日，哪些员工在法务部工作并且...
处理第 265 行, 长度: 1008
行内容(截断): {"id":1798514231,"db_name":"hr","question":"近5年来，每年面试通过率（最终入职的比...
处理第 266 行, 长度: 20638
行内容(截断): {"id":2882208186,"db_name":"hr","question":"在2024年10月12日，哪些员工在清华大学毕业...
处理第 267 行, 长度: 11046
行内容(截断): {"id":2752876678,"db_name":"hr","question":"2023年获得领导力奖的员工中，哪些人在2024...
处理第 268 行, 长度: 11390
行内容(截断): {"id":2550918549,"db_name":"hr","question":"在2023年获得'销售冠军'奖项的员工中，哪...
处理第 269 行, 长度: 12310
行内容(截断): {"id":2654497153,"db_name":"hr","question":"2024年10月10日，哪些员工在人力资源部工作...
处理第 270 行, 长度: 12588
行内容(截断): {"id":776263740,"db_name":"hr","question":"2023年4月20日，哪些员工在绩效评估中获得...
处理第 271 行, 长度: 707
行内容(截断): {"id":1728657056,"db_name":"hr","question":"近两年内既获得过奖项又有绩效提升的员...
处理第 272 行, 长度: 10864
行内容(截断): {"id":4069271992,"db_name":"hr","question":"2023年入职的员工中，哪些人在2023年获得了...
处理第 273 行, 长度: 20330
行内容(截断): {"id":2408826226,"db_name":"hr","question":"在2024年9月21日，哪些员工在客户服务部工...
处理第 274 行, 长度: 16908
行内容(截断): {"id":2252548426,"db_name":"hr","question":"获取所有员工的考勤记录，并计算他们的...
处理第 275 行, 长度: 8402
行内容(截断): {"id":141603518,"db_name":"hr","question":"2024年9月15日，哪些员工在客户服务部工作...
处理第 276 行, 长度: 12786
行内容(截断): {"id":3509550647,"db_name":"hr","question":"2021年获得创新奖的员工中，哪些人在2024年...
处理第 277 行, 长度: 19733
行内容(截断): {"id":102704152,"db_name":"hr","question":"哪些员工在2024年获得了奖项，并且他们的...
处理第 278 行, 长度: 12998
行内容(截断): {"id":4066261878,"db_name":"hr","question":"2024年有哪些员工获得了'领导力奖'，并且...
处理第 279 行, 长度: 19367
行内容(截断): {"id":7133946,"db_name":"hr","question":"2024年9月19日，哪些员工在质量控制部工作并...
处理第 280 行, 长度: 13635
行内容(截断): {"id":2339648,"db_name":"hr","question":"2024年获得'项目管理奖'的员工中，哪些人在20...
处理第 281 行, 长度: 20359
行内容(截断): {"id":1476916008,"db_name":"hr","question":"请列出在2024年9月20日有考勤记录的员工姓...
处理第 282 行, 长度: 30772
行内容(截断): {"id":2848971755,"db_name":"hr","question":"2024年9月26日，哪些员工在上班时间（check_i...
处理第 283 行, 长度: 17815
行内容(截断): {"id":1510555187,"db_name":"hr","question":"2024年10月3日，哪些员工在清华大学毕业并...
处理第 284 行, 长度: 47537
行内容(截断): {"id":1954114065,"db_name":"hr","question":"2024年10月1日，哪些员工在研发部工作并且...
处理第 285 行, 长度: 13011
行内容(截断): {"id":3968556416,"db_name":"hr","question":"2023年获得'优秀员工'奖项的员工中，哪些...
处理第 286 行, 长度: 676
行内容(截断): {"id":2192717523,"db_name":"loan_user","question":"在2024年7月19日，哪些客户的存款账户...
处理第 287 行, 长度: 435
行内容(截断): {"id":747211607,"db_name":"loan_user","question":"在2024年7月2日，哪些客户持有美元理...
处理第 288 行, 长度: 421
行内容(截断): {"id":218132520,"db_name":"loan_user","question":"请查询2024年7月22日所有属于'不良'大...
处理第 289 行, 长度: 499
行内容(截断): {"id":175056471,"db_name":"loan_user","question":"获取所有用户的姓名、职业名称和还...
处理第 290 行, 长度: 548
行内容(截断): {"id":334027216,"db_name":"loan_user","question":"查询所有职业为'护士'的客户的基本信...
处理第 291 行, 长度: 573
行内容(截断): {"id":3272129262,"db_name":"loan_user","question":"在2024年7月19日，沈阳分行的客户中，...
处理第 292 行, 长度: 493
行内容(截断): {"id":2889578956,"db_name":"loan_user","question":"查询2023年6月30日所有外币的币种代码...
处理第 293 行, 长度: 370
行内容(截断): {"id":88302712,"db_name":"loan_user","question":"查找所有存款类型的产品编号和名称，...
处理第 294 行, 长度: 477
行内容(截断): {"id":1348647978,"db_name":"loan_user","question":"查询2024年7月15日开户且卡内活期余额...
处理第 295 行, 长度: 393
行内容(截断): {"id":1016905624,"db_name":"loan_user","question":"查询2003年6月22日所有信用分高于0.75...
处理第 296 行, 长度: 459
行内容(截断): {"id":3611732895,"db_name":"loan_user","question":"查询所有用户的姓名、性别及其还款...
处理第 297 行, 长度: 420
行内容(截断): {"id":1319754722,"db_name":"loan_user","question":"获取贷款金额最高的贷款申请及其客...
处理第 298 行, 长度: 465
行内容(截断): {"id":2123954700,"db_name":"loan_user","question":"找出理财产品余额超过100万且借记卡...
处理第 299 行, 长度: 629
行内容(截断): {"id":4161720938,"db_name":"loan_user","question":"在2024年7月19日，哪些客户在沈阳余淮...
处理第 300 行, 长度: 465
行内容(截断): {"id":1485816909,"db_name":"loan_user","question":"查询所有贷款申请金额超过30000元且...
处理第 301 行, 长度: 581
行内容(截断): {"id":864749016,"db_name":"loan_user","question":"查询贷款金额最高的前20名客户中，每...
处理第 302 行, 长度: 401
行内容(截断): {"id":3380354553,"db_name":"loan_user","question":"列出所有币种分类为'外币'的币种代...
处理第 303 行, 长度: 362
行内容(截断): {"id":146146439,"db_name":"loan_user","question":"查询所有客户及其贷款金额，按贷款...
处理第 304 行, 长度: 453
行内容(截断): {"id":2245911258,"db_name":"loan_user","question":"查询2024年7月的理财月日均余额，按...
处理第 305 行, 长度: 341
行内容(截断): {"id":904046704,"db_name":"loan_user","question":"查看贷款发放日期在2024年4月1日之后...
处理第 306 行, 长度: 1281
行内容(截断): {"id":2037290745,"db_name":"loan_user","question":"找出贷款金额超过其年龄段（0-20，21-...
处理第 307 行, 长度: 287
行内容(截断): {"id":1073845704,"db_name":"loan_user","question":"获取用户的出生日期和性别信息。","g...
处理第 308 行, 长度: 512
行内容(截断): {"id":1970903262,"db_name":"loan_user","question":"在2024年7月19日，哪些客户在沈阳分行...
处理第 309 行, 长度: 576
行内容(截断): {"id":2098164166,"db_name":"loan_user","question":"查询所有贷款余额大于1000000的贷款明...
处理第 310 行, 长度: 512
行内容(截断): {"id":3382000879,"db_name":"loan_user","question":"查询所有贷款余额大于1000000的客户及...
处理第 311 行, 长度: 501
行内容(截断): {"id":2579167658,"db_name":"loan_user","question":"找出过去一年内有最多不同类型用户...
处理第 312 行, 长度: 518
行内容(截断): {"id":1454085576,"db_name":"loan_user","question":"查询信用卡数据表中，法人主体为'Cor...
处理第 313 行, 长度: 330
行内容(截断): {"id":1846154246,"db_name":"loan_user","question":"查询贷款明细信息中客户编号为 '1004'...
处理第 314 行, 长度: 403
行内容(截断): {"id":3291969349,"db_name":"loan_user","question":"查找所有客户及其对应的转账记录。"...
处理第 315 行, 长度: 416
行内容(截断): {"id":3977283654,"db_name":"loan_user","question":"获取所有客户的行为和贷款还款信息...
处理第 316 行, 长度: 560
行内容(截断): {"id":2512363543,"db_name":"loan_user","question":"查询2024年7月21日所有存款账户的客户...
处理第 317 行, 长度: 850
行内容(截断): {"id":4035425926,"db_name":"loan_user","question":"计算每个客户的贷款总额占其所在省...
处理第 318 行, 长度: 863
行内容(截断): {"id":82349614,"db_name":"loan_user","question":"每个省份的贷款申请通过率最高的职业...
处理第 319 行, 长度: 837
行内容(截断): {"id":3816528329,"db_name":"loan_user","question":"各银行分行中，存款余额最高的前10...
处理第 320 行, 长度: 360
行内容(截断): {"id":3967240206,"db_name":"loan_user","question":"获取所有借记卡的客户名称和电话，...
处理第 321 行, 长度: 410
行内容(截断): {"id":2555762315,"db_name":"loan_user","question":"查询每个客户的行为和还款记录的详...
处理第 322 行, 长度: 543
行内容(截断): {"id":1472446382,"db_name":"loan_user","question":"2021年11月10日，哪些客户的信用评分...
处理第 323 行, 长度: 324
行内容(截断): {"id":837468015,"db_name":"loan_user","question":"查询所有还款记录中还款金额超过900...
处理第 324 行, 长度: 612
行内容(截断): {"id":3614707278,"db_name":"loan_user","question":"在2024年7月9日，哪些客户的借记卡状...
处理第 325 行, 长度: 307
行内容(截断): {"id":3381297740,"db_name":"loan_user","question":"查询所有客户的贷款信息及余额。","g...
处理第 326 行, 长度: 446
行内容(截断): {"id":3209601254,"db_name":"loan_user","question":"各种贷款类型中，关联的借记卡用户...
处理第 327 行, 长度: 357
行内容(截断): {"id":1181974520,"db_name":"loan_user","question":"获取每种贷款类型的客户数量。","gt_s...
处理第 328 行, 长度: 346
行内容(截断): {"id":4290316983,"db_name":"loan_user","question":"查询2011年4月13日所有客户的信用分和...
处理第 329 行, 长度: 532
行内容(截断): {"id":4121525980,"db_name":"loan_user","question":"查询2024年7月14日沈阳余淮支行的所有...
处理第 330 行, 长度: 393
行内容(截断): {"id":1634196262,"db_name":"loan_user","question":"查询2003年6月22日所有信用分大于0.75...
处理第 331 行, 长度: 336
行内容(截断): {"id":2019378478,"db_name":"loan_user","question":"获取所有客户的转账记录，并包括源...
处理第 332 行, 长度: 330
行内容(截断): {"id":522536270,"db_name":"loan_user","question":"查找所有贷款类型中代码为'MORTGAGE'的...
处理第 333 行, 长度: 389
行内容(截断): {"id":126227619,"db_name":"loan_user","question":"查询在2024年7月5日拥有正常状态的借...
处理第 334 行, 长度: 386
行内容(截断): {"id":2456368123,"db_name":"loan_user","question":"统计每个银行的理财产品数目及其对...
处理第 335 行, 长度: 402
行内容(截断): {"id":1564372003,"db_name":"loan_user","question":"请列出所有存款类型产品名称及其对...
处理第 336 行, 长度: 326
行内容(截断): {"id":2160477527,"db_name":"loan_user","question":"获取所有客户的贷款申请状态及对应...
处理第 337 行, 长度: 313
行内容(截断): {"id":1462437870,"db_name":"loan_user","question":"查找所有信用评分为0.77的客户信息。...
处理第 338 行, 长度: 432
行内容(截断): {"id":4083934626,"db_name":"loan_user","question":"查询每个贷款类型的描述和对应的还...
处理第 339 行, 长度: 361
行内容(截断): {"id":2872120818,"db_name":"loan_user","question":"查询可疑分类的详细信息，包括分类...
处理第 340 行, 长度: 367
行内容(截断): {"id":1283326851,"db_name":"loan_user","question":"查找2024年7月5日后关闭的借记卡的卡...
处理第 341 行, 长度: 364
行内容(截断): {"id":531921010,"db_name":"loan_user","question":"列出所有借记卡的卡种类和状态，要...
处理第 342 行, 长度: 499
行内容(截断): {"id":1418289021,"db_name":"loan_user","question":"查询2024年7月19日所有贷款余额大于100...
处理第 343 行, 长度: 725
行内容(截断): {"id":137242606,"db_name":"loan_user","question":"各银行分行中，存款余额和贷款余额...
处理第 344 行, 长度: 539
行内容(截断): {"id":2672242323,"db_name":"loan_user","question":"统计每个月的转账总额和贷款发放总...
处理第 345 行, 长度: 331
行内容(截断): {"id":2845015839,"db_name":"loan_user","question":"查询所有上海市的客户的姓名和手机...
处理第 346 行, 长度: 344
行内容(截断): {"id":1582007502,"db_name":"loan_user","question":"查询客户ID为533302的信用评分及对应...
处理第 347 行, 长度: 314
行内容(截断): {"id":283689317,"db_name":"loan_user","question":"查询所有转账记录，并按转账金额降...
处理第 348 行, 长度: 362
行内容(截断): {"id":1594346019,"db_name":"loan_user","question":"统计每个用户的不同行为类型数量","g...
处理第 349 行, 长度: 693
行内容(截断): {"id":3342713409,"db_name":"loan_user","question":"在2024年7月22日，沈阳分行的客户中，...
处理第 350 行, 长度: 356
行内容(截断): {"id":842726032,"db_name":"loan_user","question":"查找在北京分行开户的所有借记卡的...
处理第 351 行, 长度: 699
行内容(截断): {"id":236915033,"db_name":"loan_user","question":"查询连续三个月或更长时间有贷款申...
处理第 352 行, 长度: 362
行内容(截断): {"id":4229311898,"db_name":"loan_user","question":"找出所有理财产品的客户号及其对应...
处理第 353 行, 长度: 339
行内容(截断): {"id":258690623,"db_name":"loan_user","question":"获取所有职业代码及其名称，按名称...
处理第 354 行, 长度: 435
行内容(截断): {"id":3376193292,"db_name":"loan_user","question":"找出理财产品余额超过借记卡余额10...
处理第 355 行, 长度: 390
行内容(截断): {"id":116553538,"db_name":"loan_user","question":"获取所有贷款金额超过70000的贷款明细...
处理第 356 行, 长度: 448
行内容(截断): {"id":646950911,"db_name":"loan_user","question":"查询所有贷款类型及其相关的用户行...
处理第 357 行, 长度: 334
行内容(截断): {"id":109259315,"db_name":"loan_user","question":"统计每个层级的银行机构数量。","gt_sq...
处理第 358 行, 长度: 488
行内容(截断): {"id":2700778328,"db_name":"loan_user","question":"在2024年7月15日，北京东单支行的客户...
处理第 359 行, 长度: 508
行内容(截断): {"id":4212764935,"db_name":"loan_user","question":"查询2017年10月31日信用分大于0.85的客...
处理第 360 行, 长度: 389
行内容(截断): {"id":4269406178,"db_name":"loan_user","question":"获取所有申请了汽车贷款的客户的贷...
处理第 361 行, 长度: 526
行内容(截断): {"id":1128360712,"db_name":"loan_user","question":"计算每种贷款类型的平均还款金额和...
处理第 362 行, 长度: 461
行内容(截断): {"id":2724005771,"db_name":"loan_user","question":"查询信用卡数据表中法人主体为'Corp3'...
处理第 363 行, 长度: 288
行内容(截断): {"id":3382134012,"db_name":"loan_user","question":"查询所有客户的姓名及其住址。","gt_s...
处理第 364 行, 长度: 867
行内容(截断): {"id":1545912595,"db_name":"loan_user","question":"2023年，各银行机构的贷款总额与其客...
处理第 365 行, 长度: 439
行内容(截断): {"id":2397640501,"db_name":"loan_user","question":"找出还款金额最接近平均值的记录","g...
处理第 366 行, 长度: 525
行内容(截断): {"id":561955406,"db_name":"loan_user","question":"在2024年7月，哪些客户的信用评分高于...
处理第 367 行, 长度: 525
行内容(截断): {"id":1986127383,"db_name":"loan_user","question":"计算每个月的贷款申请通过率（状态...
处理第 368 行, 长度: 806
行内容(截断): {"id":1657316021,"db_name":"loan_user","question":"2024年第一季度，各银行机构的新增客...
处理第 369 行, 长度: 474
行内容(截断): {"id":2162181589,"db_name":"loan_user","question":"计算每个管辖行的平均贷款期限和平...
处理第 370 行, 长度: 316
行内容(截断): {"id":2307971258,"db_name":"loan_user","question":"获取所有客户的信用评分及信用日期...
处理第 371 行, 长度: 374
行内容(截断): {"id":2557946358,"db_name":"loan_user","question":"查询所有贷款到期日期在2026年之前的...
处理第 372 行, 长度: 306
行内容(截断): {"id":3214990589,"db_name":"loan_user","question":"获取所有贷款申请及对应的申请日期...
处理第 373 行, 长度: 526
行内容(截断): {"id":140188268,"db_name":"loan_user","question":"查询所有申请了住房贷款且状态为'APPR...
处理第 374 行, 长度: 425
行内容(截断): {"id":2839950527,"db_name":"loan_user","question":"找出存款余额最高的前5个网点及其管...
处理第 375 行, 长度: 316
行内容(截断): {"id":2833646672,"db_name":"loan_user","question":"查找用户还款信息中描述为'严琳'的...
处理第 376 行, 长度: 319
行内容(截断): {"id":508839263,"db_name":"loan_user","question":"统计每种五级分类的数量。","gt_sql":"SE...
处理第 377 行, 长度: 308
行内容(截断): {"id":3720034566,"db_name":"loan_user","question":"统计每种五级分类的数量","gt_sql":"SELE...
处理第 378 行, 长度: 387
行内容(截断): {"id":1167041688,"db_name":"loan_user","question":"列出所有银行机构及其对应的客户号...
处理第 379 行, 长度: 354
行内容(截断): {"id":1532873158,"db_name":"loan_user","question":"列出所有贷款类型的名称和描述，并...
处理第 380 行, 长度: 427
行内容(截断): {"id":2367133121,"db_name":"loan_user","question":"列出所有层级为2的银行机构名称及其...
处理第 381 行, 长度: 638
行内容(截断): {"id":2982430979,"db_name":"loan_user","question":"找出每个省份贷款金额最高的前3名客...
处理第 382 行, 长度: 312
行内容(截断): {"id":4126585093,"db_name":"loan_user","question":"查询转账记录中源客户ID为376252的记...
处理第 383 行, 长度: 371
行内容(截断): {"id":1577554550,"db_name":"loan_user","question":"查询每个客户的姓名、性别及其职业...
处理第 384 行, 长度: 692
行内容(截断): {"id":1654794343,"db_name":"loan_user","question":"在2024年7月，沈阳余淮支行的客户中...
处理第 385 行, 长度: 318
行内容(截断): {"id":2092588313,"db_name":"loan_user","question":"查找所有信用评分为0.8以上的客户ID...
处理第 386 行, 长度: 567
行内容(截断): {"id":2021025668,"db_name":"loan_user","question":"列出所有转账金额大于5000的转账记录...
处理第 387 行, 长度: 493
行内容(截断): {"id":891116215,"db_name":"loan_user","question":"哪些客户在2019年申请了贷款并且其贷...
处理第 388 行, 长度: 521
行内容(截断): {"id":3533102799,"db_name":"loan_user","question":"计算每种卡类型的客户数量和平均理...
处理第 389 行, 长度: 423
行内容(截断): {"id":2160175524,"db_name":"loan_user","question":"查找所有贷款申请中，客户的姓名和...
处理第 390 行, 长度: 466
行内容(截断): {"id":305358980,"db_name":"loan_user","question":"查询2024年7月19日所有对私客户的账户...
处理第 391 行, 长度: 454
行内容(截断): {"id":3219483220,"db_name":"loan_user","question":"查询所有还款金额低于500的客户及其...
处理第 392 行, 长度: 380
行内容(截断): {"id":3553634354,"db_name":"loan_user","question":"找出2023年7月19日，所有客户的存款账...
处理第 393 行, 长度: 485
行内容(截断): {"id":1610907085,"db_name":"loan_user","question":"找出存款余额最高的客户及其最近的...
处理第 394 行, 长度: 386
行内容(截断): {"id":1410414363,"db_name":"loan_user","question":"统计每个职业的客户数量。","gt_sql":"S...
处理第 395 行, 长度: 529
行内容(截断): {"id":3954115529,"db_name":"loan_user","question":"查询2016年6月11日所有转账金额大于500...
处理第 396 行, 长度: 629
行内容(截断): {"id":1086674624,"db_name":"loan_user","question":"查询2024年7月1日之后发放的贷款中，...
处理第 397 行, 长度: 332
行内容(截断): {"id":1680159550,"db_name":"loan_user","question":"获取所有用户行为中，行为日期为2018...
处理第 398 行, 长度: 316
行内容(截断): {"id":2548352227,"db_name":"loan_user","question":"找出还款日期在周末的记录","gt_sql":"S...
处理第 399 行, 长度: 694
行内容(截断): {"id":1833243393,"db_name":"loan_user","question":"计算每种存款类型和贷款类型组合的...
处理第 400 行, 长度: 597
行内容(截断): {"id":3824204712,"db_name":"loan_user","question":"查询2021年11月10日所有还款金额大于20...
处理第 401 行, 长度: 470
行内容(截断): {"id":3260667731,"db_name":"loan_user","question":"统计每种贷款类型的平均信用分。","g...
处理第 402 行, 长度: 356
行内容(截断): {"id":732762958,"db_name":"loan_user","question":"获取所有贷款类型的名称和代码，要...
处理第 403 行, 长度: 408
行内容(截断): {"id":330418458,"db_name":"loan_user","question":"统计各贷款状态下的贷款申请数量。",...
处理第 404 行, 长度: 297
行内容(截断): {"id":245397134,"db_name":"loan_user","question":"获取所有信用评分的客户ID及描述。","...
处理第 405 行, 长度: 549
行内容(截断): {"id":2669572809,"db_name":"loan_user","question":"查询2024年7月15日在北京东单支行开户...
处理第 406 行, 长度: 401
行内容(截断): {"id":2085255506,"db_name":"loan_user","question":"统计每种客户类型的贷款总金额，并...
处理第 407 行, 长度: 379
行内容(截断): {"id":1984536651,"db_name":"loan_user","question":"查询贷款余额占贷款总额比例最高的...
处理第 408 行, 长度: 565
行内容(截断): {"id":258245311,"db_name":"loan_user","question":"查询2019年申请住房贷款且申请状态为'...
处理第 409 行, 长度: 269
行内容(截断): {"id":1895651034,"db_name":"loan_user","question":"获取银行机构的所有信息。","gt_sql":"S...
处理第 410 行, 长度: 668
行内容(截断): {"id":134489693,"db_name":"loan_user","question":"查询2024年7月22日当天，所有贷款余额...
处理第 411 行, 长度: 367
行内容(截断): {"id":2899938404,"db_name":"loan_user","question":"获取所有借记卡的卡状态和开户日期...
处理第 412 行, 长度: 532
行内容(截断): {"id":1614542471,"db_name":"loan_user","question":"列出所有在2023年6月30日进行转账的客...
处理第 413 行, 长度: 354
行内容(截断): {"id":2860028194,"db_name":"loan_user","question":"获取2023年6月30日的所有银行机构及其...
处理第 414 行, 长度: 499
行内容(截断): {"id":2112082105,"db_name":"loan_user","question":"查询2024年7月2日所有持有非保本理财...
处理第 415 行, 长度: 423
行内容(截断): {"id":1900105170,"db_name":"loan_user","question":"2019年申请的贷款中，状态为'REJECTED'...
处理第 416 行, 长度: 544
行内容(截断): {"id":3724611031,"db_name":"loan_user","question":"查询2024年7月21日杭州分行下所有对公...
处理第 417 行, 长度: 553
行内容(截断): {"id":3179484363,"db_name":"loan_user","question":"统计每个用户的还款总额、行为次数...
处理第 418 行, 长度: 316
行内容(截断): {"id":3200437107,"db_name":"loan_user","question":"查询所有银行及其机构层级和数据日...
处理第 419 行, 长度: 724
行内容(截断): {"id":2071923254,"db_name":"loan_user","question":"找出存款余额前10%的客户中，尚未申...
处理第 420 行, 长度: 500
行内容(截断): {"id":3565838054,"db_name":"loan_user","question":"计算每个网点的贷款申请成功率（已...
处理第 421 行, 长度: 369
行内容(截断): {"id":1893298039,"db_name":"loan_user","question":"获取所有客户在2023年7月的存款账户...
处理第 422 行, 长度: 536
行内容(截断): {"id":2315630941,"db_name":"loan_user","question":"在2023年6月30日，哪些银行机构的存款...
处理第 423 行, 长度: 551
行内容(截断): {"id":870110560,"db_name":"loan_user","question":"查询2024年7月19日所有存款账户信息中...
处理第 424 行, 长度: 477
行内容(截断): {"id":1308562229,"db_name":"loan_user","question":"查询所有借记卡状态为'正常'且开户...
处理第 425 行, 长度: 399
行内容(截断): {"id":1986404179,"db_name":"loan_user","question":"列出所有存款类型产品名称及其对应...
处理第 426 行, 长度: 477
行内容(截断): {"id":2032902123,"db_name":"loan_user","question":"找出转账次数最多的前10名客户及其...
处理第 427 行, 长度: 632
行内容(截断): {"id":3109098948,"db_name":"loan_user","question":"查询上海市的客户中，有多少人拥有...
处理第 428 行, 长度: 564
行内容(截断): {"id":188271146,"db_name":"loan_user","question":"查询2024年7月22日贷款余额大于15000的...
处理第 429 行, 长度: 793
行内容(截断): {"id":7209425,"db_name":"loan_user","question":"查询既有房贷又有车贷，并且房贷金额...
处理第 430 行, 长度: 616
行内容(截断): {"id":1065176696,"db_name":"loan_user","question":"查询2024年7月19日杭州上城区支行的所...
处理第 431 行, 长度: 617
行内容(截断): {"id":953680810,"db_name":"loan_user","question":"统计每种担保方式下的平均贷款金额...
处理第 432 行, 长度: 508
行内容(截断): {"id":2393859347,"db_name":"loan_user","question":"在2020年11月3日，信用评分高于0.8的客...
处理第 433 行, 长度: 473
行内容(截断): {"id":749612150,"db_name":"loan_user","question":"申请贷款金额超过50000且职业是护士的...
处理第 434 行, 长度: 375
行内容(截断): {"id":3260359700,"db_name":"loan_user","question":"查找所有在2024年7月的贷款申请及客...
处理第 435 行, 长度: 463
行内容(截断): {"id":2869045188,"db_name":"loan_user","question":"每个月度的贷款申请通过率是多少？"...
处理第 436 行, 长度: 516
行内容(截断): {"id":2139894777,"db_name":"loan_user","question":"查询2024年7月2日所有对公客户的理财...
处理第 437 行, 长度: 349
行内容(截断): {"id":2426521027,"db_name":"loan_user","question":"查询所有客户及其贷款申请状态。","g...
处理第 438 行, 长度: 461
行内容(截断): {"id":3310012060,"db_name":"loan_user","question":"统计各贷款类型的客户数量和贷款总...
处理第 439 行, 长度: 758
行内容(截断): {"id":1454101538,"db_name":"loan_user","question":"计算每个年龄段（0-20，21-40，41-60，61...
处理第 440 行, 长度: 353
行内容(截断): {"id":1355579742,"db_name":"loan_user","question":"查询贷款申请ID为323803的还款金额和...
处理第 441 行, 长度: 538
行内容(截断): {"id":2730549341,"db_name":"loan_user","question":"在2023年6月30日，杭州上城区支行的客...
处理第 442 行, 长度: 342
行内容(截断): {"id":1021718263,"db_name":"loan_user","question":"获取用户还款信息中还款日期在2020-02...
处理第 443 行, 长度: 381
行内容(截断): {"id":405520388,"db_name":"loan_user","question":"查找客户关飞的所有转账记录。","gt_sq...
处理第 444 行, 长度: 437
行内容(截断): {"id":1969682603,"db_name":"loan_user","question":"查找所有客户的姓名、身份证号及其...
处理第 445 行, 长度: 324
行内容(截断): {"id":797442197,"db_name":"loan_user","question":"获取所有用户行为中行为类型包含'ILL'...
处理第 446 行, 长度: 323
行内容(截断): {"id":3086691704,"db_name":"loan_user","question":"获取所有转账记录及其描述，按转账...
处理第 447 行, 长度: 308
行内容(截断): {"id":1652118460,"db_name":"loan_user","question":"查询用户行为中描述不为空的记录。"...
处理第 448 行, 长度: 434
行内容(截断): {"id":729818388,"db_name":"loan_user","question":"2024年7月9日，杭州上城区支行的客户Ja...
处理第 449 行, 长度: 301
行内容(截断): {"id":3319537046,"db_name":"loan_user","question":"查询描述中包含'Loan'的贷款类型","gt_s...
处理第 450 行, 长度: 512
行内容(截断): {"id":981960336,"db_name":"loan_user","question":"查询所有信用卡账户的币种代码及其...
处理第 451 行, 长度: 375
行内容(截断): {"id":446364127,"db_name":"loan_user","question":"查询所有银行机构的理财产品中，保...
处理第 452 行, 长度: 407
行内容(截断): {"id":1464013698,"db_name":"loan_user","question":"列出所有贷款状态为'APPROVED'的贷款类...
处理第 453 行, 长度: 536
行内容(截断): {"id":2417924945,"db_name":"loan_user","question":"查询2023年申请贷款的客户中，年龄最...
处理第 454 行, 长度: 584
行内容(截断): {"id":3366689482,"db_name":"loan_user","question":"在2023年6月30日，杭州上城区支行的客...
处理第 455 行, 长度: 405
行内容(截断): {"id":3973811473,"db_name":"loan_user","question":"2024年7月22日的五级分类中，各个大类...
处理第 456 行, 长度: 460
行内容(截断): {"id":1905559813,"db_name":"loan_user","question":"统计不同五级分类下的用户行为数量...
处理第 457 行, 长度: 296
行内容(截断): {"id":6017603,"db_name":"loan_user","question":"查看所有转账记录，按转账日期排序。"...
处理第 458 行, 长度: 509
行内容(截断): {"id":2286869285,"db_name":"loan_user","question":"在2024年7月，杭州上城区支行的客户Ja...
处理第 459 行, 长度: 401
行内容(截断): {"id":1590803091,"db_name":"loan_user","question":"查询2024年7月2日所有理财产品中，币...
处理第 460 行, 长度: 503
行内容(截断): {"id":3414285101,"db_name":"loan_user","question":"获取每个客户的行为次数和最新信用...
处理第 461 行, 长度: 618
行内容(截断): {"id":3246518573,"db_name":"loan_user","question":"查询2023年6月30日所有转账金额大于100...
处理第 462 行, 长度: 300
行内容(截断): {"id":104815069,"db_name":"loan_user","question":"获取客户姓名为饶丽的所有信息。","gt...
处理第 463 行, 长度: 404
行内容(截断): {"id":3801446621,"db_name":"loan_user","question":"查找在2024年7月14日所有正常状态的借...
处理第 464 行, 长度: 665
行内容(截断): {"id":368801370,"db_name":"loan_user","question":"查询2024年7月19日所有贷款余额超过5000...
处理第 465 行, 长度: 562
行内容(截断): {"id":852089580,"db_name":"loan_user","question":"在2024年7月19日，沈阳分行的所有客户...
处理第 466 行, 长度: 315
行内容(截断): {"id":1377442693,"db_name":"loan_user","question":"查询贷款类型为汽车贷款的所有信息...
处理第 467 行, 长度: 430
行内容(截断): {"id":2349708736,"db_name":"loan_user","question":"查询所有客户的姓名和他们的贷款金...
处理第 468 行, 长度: 1233
行内容(截断): {"id":3911124385,"db_name":"loan_user","question":"计算每个客户的综合评分（存款余额...
处理第 469 行, 长度: 332
行内容(截断): {"id":3773516021,"db_name":"loan_user","question":"获取所有护士的职业代码和描述。","g...
处理第 470 行, 长度: 471
行内容(截断): {"id":1642595147,"db_name":"loan_user","question":"获取所有客户在2021年8月的行为记录...
处理第 471 行, 长度: 367
行内容(截断): {"id":2547804030,"db_name":"loan_user","question":"查询所有贷款类型及其状态的描述。"...
处理第 472 行, 长度: 460
行内容(截断): {"id":1574302461,"db_name":"loan_user","question":"查询2024年7月2日所有对公客户的理财...
处理第 473 行, 长度: 609
行内容(截断): {"id":576649992,"db_name":"loan_user","question":"哪些客户在2019年申请了住房贷款，并...
处理第 474 行, 长度: 495
行内容(截断): {"id":278921693,"db_name":"loan_user","question":"查询2024年7月19日当天，持有非保本理...
处理第 475 行, 长度: 289
行内容(截断): {"id":2923698873,"db_name":"loan_user","question":"查找所有客户的名字和电子邮件。","g...
处理第 476 行, 长度: 824
行内容(截断): {"id":2256662449,"db_name":"loan_user","question":"计算每个客户的贷款成功率随时间的...
处理第 477 行, 长度: 484
行内容(截断): {"id":956063573,"db_name":"loan_user","question":"查询2024年7月19日所有持有美元存款的...
处理第 478 行, 长度: 444
行内容(截断): {"id":568233943,"db_name":"loan_user","question":"查询所有客户的姓名、身份证号、手...
处理第 479 行, 长度: 466
行内容(截断): {"id":665248378,"db_name":"loan_user","question":"贷款申请金额最高的前5名客户的职业...
处理第 480 行, 长度: 315
行内容(截断): {"id":1030650241,"db_name":"loan_user","question":"获取所有贷款记录的客户类型及其贷...
处理第 481 行, 长度: 553
行内容(截断): {"id":1979307069,"db_name":"loan_user","question":"在2023年6月30日，杭州上城区支行的所...
处理第 482 行, 长度: 417
行内容(截断): {"id":645950570,"db_name":"loan_user","question":"查询在特定日期的可疑行为和其对应...
处理第 483 行, 长度: 357
行内容(截断): {"id":3312818819,"db_name":"loan_user","question":"查询身份证号为c839d762-6392-4005-8386-ed4e...
处理第 484 行, 长度: 345
行内容(截断): {"id":527420496,"db_name":"loan_user","question":"查询2003年6月22日所有客户的信用分和...
处理第 485 行, 长度: 522
行内容(截断): {"id":2918505586,"db_name":"loan_user","question":"在2024年7月21日，哪些客户在杭州分行...
处理第 486 行, 长度: 483
行内容(截断): {"id":1280121870,"db_name":"loan_user","question":"查询所有贷款余额大于10000的客户编...
处理第 487 行, 长度: 479
行内容(截断): {"id":2006837077,"db_name":"loan_user","question":"统计每种五级分类的用户数量，并找...
处理第 488 行, 长度: 347
行内容(截断): {"id":938785076,"db_name":"loan_user","question":"查找所有存款类型中，数据日期为2024...
处理第 489 行, 长度: 308
行内容(截断): {"id":182531082,"db_name":"loan_user","question":"获取转账表中转账金额大于500的记录...
处理第 490 行, 长度: 546
行内容(截断): {"id":1098966204,"db_name":"loan_user","question":"查询所有在河北省出生且信用评分高...
处理第 491 行, 长度: 1018
行内容(截断): {"id":2906434348,"db_name":"loan_user","question":"计算每个年龄段（20-30岁，31-40岁，41-...
处理第 492 行, 长度: 461
行内容(截断): {"id":4018894094,"db_name":"loan_user","question":"列出所有职业代码为'NURSE'的用户贷款...
处理第 493 行, 长度: 610
行内容(截断): {"id":2317494329,"db_name":"loan_user","question":"统计每种职业的客户数量和平均贷款...
处理第 494 行, 长度: 550
行内容(截断): {"id":2459941756,"db_name":"loan_user","question":"在2024年7月14日，哪些客户在沈阳余淮...
处理第 495 行, 长度: 294
行内容(截断): {"id":627241378,"db_name":"loan_user","question":"查询所有用户的身份证号及手机号。",...
处理第 496 行, 长度: 377
行内容(截断): {"id":3818857737,"db_name":"loan_user","question":"获取在2024年7月5日及之后开户的借记...
处理第 497 行, 长度: 684
行内容(截断): {"id":1788527678,"db_name":"loan_user","question":"找出理财产品余额排名前10%的客户中...
处理第 498 行, 长度: 473
行内容(截断): {"id":1240825133,"db_name":"loan_user","question":"获取2023年12月10日的客户信用评分及...
处理第 499 行, 长度: 301
行内容(截断): {"id":1225880496,"db_name":"loan_user","question":"获取所有机构的编号及其对应的名称...
处理第 500 行, 长度: 433
行内容(截断): {"id":1895296880,"db_name":"loan_user","question":"查找2024年1月20日还款记录和对应的贷...
处理第 501 行, 长度: 614
行内容(截断): {"id":1454533076,"db_name":"loan_user","question":"查询2023年6月30日所有外币的币种代码...
处理第 502 行, 长度: 391
行内容(截断): {"id":3316681947,"db_name":"loan_user","question":"2021年11月10日，贷款申请ID为742969的用...
处理第 503 行, 长度: 482
行内容(截断): {"id":2982717712,"db_name":"loan_user","question":"统计每种存款类型下的平均贷款金额...
处理第 504 行, 长度: 432
行内容(截断): {"id":279794629,"db_name":"loan_user","question":"查询用户的姓名、职业名称及还款日...
处理第 505 行, 长度: 540
行内容(截断): {"id":2733048479,"db_name":"loan_user","question":"计算每种贷款类型的平均贷款金额和...
处理第 506 行, 长度: 570
行内容(截断): {"id":1486729335,"db_name":"loan_user","question":"2019年1月10日申请贷款且状态为'REJECTED...
处理第 507 行, 长度: 605
行内容(截断): {"id":760463294,"db_name":"loan_user","question":"查询2019年申请贷款且信用评分高于0.8...
处理第 508 行, 长度: 384
行内容(截断): {"id":84990606,"db_name":"loan_user","question":"查询所有贷款余额大于500000的贷款明细...
处理第 509 行, 长度: 387
行内容(截断): {"id":2524485514,"db_name":"loan_user","question":"查询2003年6月22日所有信用分大于0.75...
处理第 510 行, 长度: 372
行内容(截断): {"id":3030054295,"db_name":"loan_user","question":"请列出所有1990年之后出生的客户姓名...
处理第 511 行, 长度: 751
行内容(截断): {"id":2842932086,"db_name":"loan_user","question":"找出过去一年内信用评分提升最多的...
处理第 512 行, 长度: 386
行内容(截断): {"id":2650630480,"db_name":"loan_user","question":"统计每种行为类型的用户数量，按行...
处理第 513 行, 长度: 1115
行内容(截断): {"id":3532447015,"db_name":"loan_user","question":"计算每种存款类型的客户留存率（在...
处理第 514 行, 长度: 454
行内容(截断): {"id":2513228683,"db_name":"loan_user","question":"2024年7月19日，沈阳分行下所有客户的...
处理第 515 行, 长度: 14831
行内容(截断): {"id":3023054014,"db_name":"retail","question":"在2023年5月6日，哪个门店的销售利润最...
处理第 516 行, 长度: 13223
行内容(截断): {"id":252107871,"db_name":"retail","question":"获取所有销售统计中的利润和销售数量...
处理第 517 行, 长度: 306
行内容(截断): {"id":2902085248,"db_name":"retail","question":"查询特定日期（2023-05-08）的所有销售订...
处理第 518 行, 长度: 19875
行内容(截断): {"id":1743968577,"db_name":"retail","question":"在2023年5月5日，哪些员工在数码广场店...
处理第 519 行, 长度: 6887
行内容(截断): {"id":3620145899,"db_name":"retail","question":"获取所有销售统计中利润最高的记录。"...
处理第 520 行, 长度: 949
行内容(截断): {"id":2283742907,"db_name":"retail","question":"在2023年5月，哪些门店的员工销售了超...
处理第 521 行, 长度: 15119
行内容(截断): {"id":3238938312,"db_name":"retail","question":"找出在电子城旗舰店销售的所有商品及...
处理第 522 行, 长度: 31696
行内容(截断): {"id":2878333594,"db_name":"retail","question":"在2023年5月9日，哪个门店的员工销售了i...
处理第 523 行, 长度: 24859
行内容(截断): {"id":754309478,"db_name":"retail","question":"2023年5月5日，哪些门店的销售金额超过...
处理第 524 行, 长度: 5000
行内容(截断): {"id":711957819,"db_name":"retail","question":"在2023年5月7日，哪些员工处理了订单并...
处理第 525 行, 长度: 14520
行内容(截断): {"id":1769127756,"db_name":"retail","question":"在2023年5月期间，哪些门店的员工销售...
处理第 526 行, 长度: 24581
行内容(截断): {"id":435444064,"db_name":"retail","question":"在2023年5月期间，哪些员工在销售订单中...
处理第 527 行, 长度: 14208
行内容(截断): {"id":2637911653,"db_name":"retail","question":"查询所有销售统计中销售金额最高的商...
处理第 528 行, 长度: 20457
行内容(截断): {"id":424774041,"db_name":"retail","question":"获取所有订单的销售详情，包含商品名...
处理第 529 行, 长度: 12016
行内容(截断): {"id":1958922267,"db_name":"retail","question":"列出每位员工的姓名及其所属门店名称...
处理第 530 行, 长度: 25434
行内容(截断): {"id":1850407582,"db_name":"retail","question":"在2023年5月8日，哪些门店的店长姓名和...
处理第 531 行, 长度: 5606
行内容(截断): {"id":3887504470,"db_name":"retail","question":"获取所有销售订单中，销售金额高于7000...
处理第 532 行, 长度: 934
行内容(截断): {"id":3068871934,"db_name":"retail","question":"在2023年5月期间，哪些门店的员工销售...
处理第 533 行, 长度: 597
行内容(截断): {"id":2869270561,"db_name":"retail","question":"在2023年5月6日，哪些门店的员工销售了i...
处理第 534 行, 长度: 5719
行内容(截断): {"id":3219161296,"db_name":"retail","question":"查找订单ID为'b8b62bfe-a35d-4ff5-9bc9-654b5f67fe...
处理第 535 行, 长度: 15425
行内容(截断): {"id":4084880534,"db_name":"retail","question":"查询每位员工的总销售金额。","gt_sql":"S...
处理第 536 行, 长度: 12452
行内容(截断): {"id":758163770,"db_name":"retail","question":"列出每个商品的售价和进货价。","gt_sql":...
处理第 537 行, 长度: 21434
行内容(截断): {"id":2553064409,"db_name":"retail","question":"在2023年5月，哪些员工在销售订单中处...
处理第 538 行, 长度: 289
行内容(截断): {"id":2558715347,"db_name":"retail","question":"查找某个员工的ID和他们所管理的门店ID...
处理第 539 行, 长度: 20060
行内容(截断): {"id":2334672967,"db_name":"retail","question":"在2023年5月7日，哪些门店的员工销售了A...
处理第 540 行, 长度: 24709
行内容(截断): {"id":3673770320,"db_name":"retail","question":"在2023年5月5日，哪些门店的销售经理负...
处理第 541 行, 长度: 21333
行内容(截断): {"id":1434650665,"db_name":"retail","question":"获取每个订单的详细信息，包括商品名...
处理第 542 行, 长度: 12419
行内容(截断): {"id":4072489559,"db_name":"retail","question":"查询门店ID为 '0887d06a-27a8-46b4-98d6-514702e69...
处理第 543 行, 长度: 28131
行内容(截断): {"id":3987499786,"db_name":"retail","question":"在2023年5月，哪些员工在销售统计中记...
处理第 544 行, 长度: 18130
行内容(截断): {"id":3272650586,"db_name":"retail","question":"在2023年5月1日，哪些门店的员工销售了i...
处理第 545 行, 长度: 25966
行内容(截断): {"id":1170763492,"db_name":"retail","question":"列出每个商品的销售数量及对应的订单...
处理第 546 行, 长度: 7474
行内容(截断): {"id":3307597619,"db_name":"retail","question":"在2023年5月，哪个门店的销售总额最高...
处理第 547 行, 长度: 663
行内容(截断): {"id":2824509879,"db_name":"retail","question":"在2023年5月3日，哪些员工在数码广场店...
处理第 548 行, 长度: 13446
行内容(截断): {"id":348511856,"db_name":"retail","question":"在2023年5月7日，哪个门店的销售总额最...
处理第 549 行, 长度: 24606
行内容(截断): {"id":3403500771,"db_name":"retail","question":"在2023年5月1日，哪些门店的员工销售了...
处理第 550 行, 长度: 10925
行内容(截断): {"id":1837973022,"db_name":"retail","question":"查找某一商品的进货价和售价。","gt_sql"...
处理第 551 行, 长度: 16375
行内容(截断): {"id":1041289855,"db_name":"retail","question":"查询订单详情表中每个产品的销售单价...
处理第 552 行, 长度: 20591
行内容(截断): {"id":2902800338,"db_name":"retail","question":"在2023年5月6日，哪些员工销售了Apple Watc...
处理第 553 行, 长度: 12453
行内容(截断): {"id":2465572579,"db_name":"retail","question":"查询销售数量最多的门店及其销售总额...
处理第 554 行, 长度: 7183
行内容(截断): {"id":4232056788,"db_name":"retail","question":"在2023年5月期间，哪些员工在销售订单...
处理第 555 行, 长度: 490
行内容(截断): {"id":3813879652,"db_name":"retail","question":"获取每个员工负责的门店及其所有订单...
处理第 556 行, 长度: 19459
行内容(截断): {"id":1308038325,"db_name":"retail","question":"2023年5月期间，每个门店的总销售金额...
处理第 557 行, 长度: 26358
行内容(截断): {"id":3746071071,"db_name":"retail","question":"找出在2023年5月销售数量超过5的商品及...
处理第 558 行, 长度: 19033
行内容(截断): {"id":2561670271,"db_name":"retail","question":"列出每个商品的销售数量和售价。","gt_s...
处理第 559 行, 长度: 8483
行内容(截断): {"id":3159630797,"db_name":"retail","question":"在2023年5月1日，哪些门店的销售经理销...
处理第 560 行, 长度: 25786
行内容(截断): {"id":4216280203,"db_name":"retail","question":"获取所有门店的联系信息。","gt_sql":"SELE...
处理第 561 行, 长度: 16725
行内容(截断): {"id":731373976,"db_name":"retail","question":"查找销售金额小于5000的订单及其对应的...
处理第 562 行, 长度: 738
行内容(截断): {"id":170942591,"db_name":"retail","question":"在2023年5月，哪个门店的销售顾问销售了...
处理第 563 行, 长度: 30492
行内容(截断): {"id":3730467553,"db_name":"retail","question":"在2023年5月，哪些门店的员工销售了小...
处理第 564 行, 长度: 21206
行内容(截断): {"id":2909047140,"db_name":"retail","question":"在2023年5月6日，哪些员工在智慧街店销...
处理第 565 行, 长度: 3007
行内容(截断): {"id":2998787786,"db_name":"retail","question":"获取所有门店的名称和联系电话。","gt_s...
处理第 566 行, 长度: 28808
行内容(截断): {"id":3020408935,"db_name":"retail","question":"在2023年5月8日，哪些门店的销售利润超...
处理第 567 行, 长度: 10167
行内容(截断): {"id":3729612424,"db_name":"retail","question":"查找每个商品类别的总销售数量。","gt_s...
处理第 568 行, 长度: 13932
行内容(截断): {"id":1558062721,"db_name":"retail","question":"获取门店和员工的关联信息。","gt_sql":"S...
处理第 569 行, 长度: 11291
行内容(截断): {"id":3748358677,"db_name":"retail","question":"查询所有销售金额高于平均销售金额的...
处理第 570 行, 长度: 321
行内容(截断): {"id":281510090,"db_name":"retail","question":"查询特定日期范围内的所有销售订单。",...
处理第 571 行, 长度: 17230
行内容(截断): {"id":930082852,"db_name":"retail","question":"获取所有员工及其销售订单的订单日期...
处理第 572 行, 长度: 11449
行内容(截断): {"id":874677465,"db_name":"retail","question":"查询每个员工的销售订单总金额。","gt_sq...
处理第 573 行, 长度: 36272
行内容(截断): {"id":1675790879,"db_name":"retail","question":"查询每位销售员的总销售数量与总利润...
处理第 574 行, 长度: 11225
行内容(截断): {"id":1635802249,"db_name":"retail","question":"在2023年5月，哪些门店的员工销售了佳...
处理第 575 行, 长度: 17546
行内容(截断): {"id":2425848754,"db_name":"retail","question":"在2023年5月5日，哪个门店的销售总额最...
处理第 576 行, 长度: 13989
行内容(截断): {"id":2746220287,"db_name":"retail","question":"查找所有门店的商品销售数量和销售金...
处理第 577 行, 长度: 9930
行内容(截断): {"id":4181874210,"db_name":"retail","question":"在2023年5月期间，哪个门店的销售数量...
处理第 578 行, 长度: 378
行内容(截断): {"id":1518878415,"db_name":"retail","question":"获取特定员工的所有销售订单及其总金...
处理第 579 行, 长度: 18735
行内容(截断): {"id":729031894,"db_name":"retail","question":"查找某商品的所有订单详情及其销售单...
处理第 580 行, 长度: 18013
行内容(截断): {"id":415457057,"db_name":"retail","question":"查询每个门店的销售总金额及对应的统...
处理第 581 行, 长度: 23124
行内容(截断): {"id":2711834209,"db_name":"retail","question":"查找在未来城店中进货价高于4000的商品...
处理第 582 行, 长度: 16514
行内容(截断): {"id":1625040088,"db_name":"retail","question":"在2023年5月9日，哪些门店的销售订单总...
处理第 583 行, 长度: 8102
行内容(截断): {"id":3394370453,"db_name":"retail","question":"在2023年5月2日，哪个门店的销售总额最...
处理第 584 行, 长度: 17004
行内容(截断): {"id":1323956071,"db_name":"retail","question":"在2023年5月9日，哪些门店的销售金额超...
处理第 585 行, 长度: 22104
行内容(截断): {"id":3696477446,"db_name":"retail","question":"在2023年5月，哪些员工在销售订单中处...
处理第 586 行, 长度: 9416
行内容(截断): {"id":4263762934,"db_name":"retail","question":"统计每个门店的总利润，按门店名称分...
处理第 587 行, 长度: 897
行内容(截断): {"id":1452830768,"db_name":"retail","question":"在2023年5月期间，哪些门店的员工销售...
处理第 588 行, 长度: 24741
行内容(截断): {"id":4210000185,"db_name":"retail","question":"查询销售金额大于5000的订单及其详情。...
处理第 589 行, 长度: 415
行内容(截断): {"id":2309159488,"db_name":"retail","question":"查询在特定日期（例如2023-05-02）销售的...
处理第 590 行, 长度: 12546
行内容(截断): {"id":3856696435,"db_name":"retail","question":"查找2023年5月的数据，包括销售数量和...
处理第 591 行, 长度: 2119
行内容(截断): {"id":3385775144,"db_name":"retail","question":"获取每种商品的售价和进货价。","gt_sql"...
处理第 592 行, 长度: 26472
行内容(截断): {"id":898352649,"db_name":"retail","question":"在2023年5月期间，哪些门店的智能手表类...
处理第 593 行, 长度: 25477
行内容(截断): {"id":1057968799,"db_name":"retail","question":"在2023年5月，哪些门店的平均订单金额...
处理第 594 行, 长度: 25940
行内容(截断): {"id":1042797521,"db_name":"retail","question":"在2023年5月2日，哪些门店的员工销售了i...
处理第 595 行, 长度: 657
行内容(截断): {"id":2349214824,"db_name":"retail","question":"在2023年5月期间，哪些门店的员工销售...
处理第 596 行, 长度: 23229
行内容(截断): {"id":1437353225,"db_name":"retail","question":"在2023年5月，哪个门店的员工销售了最...
处理第 597 行, 长度: 20719
行内容(截断): {"id":2159290753,"db_name":"retail","question":"在2023年5月9日，哪些门店的员工销售了A...
处理第 598 行, 长度: 10801
行内容(截断): {"id":3028653636,"db_name":"retail","question":"查询订单详情表中所有订单的销售数量...
处理第 599 行, 长度: 26057
行内容(截断): {"id":699540097,"db_name":"retail","question":"在2023年5月期间，哪些门店的员工销售了...
处理第 600 行, 长度: 38867
行内容(截断): {"id":1931659377,"db_name":"retail","question":"获取所有销售统计数据中，销售数量大...
处理第 601 行, 长度: 9271
行内容(截断): {"id":3746361325,"db_name":"retail","question":"在2023年5月，哪些门店的员工销售了Ninte...
处理第 602 行, 长度: 19750
行内容(截断): {"id":716876897,"db_name":"retail","question":"获取所有订单的销售总额和对应的订单...
处理第 603 行, 长度: 28594
行内容(截断): {"id":2607128675,"db_name":"retail","question":"查询每个门店的订单总金额和销售数量...
处理第 604 行, 长度: 28695
行内容(截断): {"id":285217611,"db_name":"retail","question":"查询订单详情中，销售数量为2的所有订...
处理第 605 行, 长度: 22231
行内容(截断): {"id":780164755,"db_name":"retail","question":"在2023年5月1日，哪些门店的员工销售了...
处理第 606 行, 长度: 16132
行内容(截断): {"id":936656745,"db_name":"retail","question":"找出所有员工的职务和所属门店。","gt_sq...
处理第 607 行, 长度: 49705
行内容(截断): {"id":1245782625,"db_name":"retail","question":"在2023年5月3日，哪些门店的员工销售了...
处理第 608 行, 长度: 632
行内容(截断): {"id":1283619082,"db_name":"retail","question":"在2023年5月5日，哪些门店的员工销售了i...
处理第 609 行, 长度: 27064
行内容(截断): {"id":1656453304,"db_name":"retail","question":"在2023年5月6日，哪些门店的员工销售了...
处理第 610 行, 长度: 32039
行内容(截断): {"id":366199293,"db_name":"retail","question":"查询每个订单的详细信息，包括商品名...
处理第 611 行, 长度: 16188
行内容(截断): {"id":3334478107,"db_name":"retail","question":"查询所有员工及其职位，并显示他们所...
处理第 612 行, 长度: 21891
行内容(截断): {"id":4270219527,"db_name":"retail","question":"在2023年5月5日，哪些门店的员工销售了...
处理第 613 行, 长度: 39949
行内容(截断): {"id":1514093143,"db_name":"retail","question":"查询销售金额大于5000的订单及其商品信...
处理第 614 行, 长度: 18773
行内容(截断): {"id":2669644548,"db_name":"retail","question":"获取每个员工的销售订单及其金额。","g...
处理第 615 行, 长度: 10039
行内容(截断): {"id":805828737,"db_name":"retail","question":"查找所有利润大于3000的销售统计记录及...
处理第 616 行, 长度: 20502
行内容(截断): {"id":3997676800,"db_name":"retail","question":"在2023年5月1日，哪些门店的员工销售了A...
处理第 617 行, 长度: 26194
行内容(截断): {"id":4161491201,"db_name":"retail","question":"查询每种商品的剩余数量及其类别名称...
处理第 618 行, 长度: 28176
行内容(截断): {"id":1127435173,"db_name":"retail","question":"在2023年5月7日，哪些员工在销售订单中...
处理第 619 行, 长度: 548
行内容(截断): {"id":2902593996,"db_name":"retail","question":"在2023年5月3日，哪些门店的员工销售了i...
处理第 620 行, 长度: 7472
行内容(截断): {"id":3388599532,"db_name":"retail","question":"在2023年5月8日，哪个门店的总销售金额...
处理第 621 行, 长度: 14671
行内容(截断): {"id":4098005311,"db_name":"retail","question":"在2023年5月3日，哪些员工在数字大道店...
处理第 622 行, 长度: 33577
行内容(截断): {"id":923028298,"db_name":"retail","question":"在2023年5月5日，哪些门店的员工销售了...
处理第 623 行, 长度: 26025
行内容(截断): {"id":1361891626,"db_name":"retail","question":"在2023年5月9日，哪些门店的销售金额超...
处理第 624 行, 长度: 12718
行内容(截断): {"id":1630147030,"db_name":"retail","question":"在2023年5月1日，哪些门店的销售额超过...
处理第 625 行, 长度: 577
行内容(截断): {"id":3263175989,"db_name":"retail","question":"在2023年5月9日，哪些门店的员工销售了i...
处理第 626 行, 长度: 412
行内容(截断): {"id":378330460,"db_name":"retail","question":"查询某个商品的销售金额和剩余数量。",...
处理第 627 行, 长度: 22456
行内容(截断): {"id":4052285642,"db_name":"retail","question":"查找所有门店及其地址和电话。","gt_sql"...
处理第 628 行, 长度: 16107
行内容(截断): {"id":1549729846,"db_name":"retail","question":"在2023年5月2日，哪些门店的员工完成了...
处理第 629 行, 长度: 17358
行内容(截断): {"id":3935894550,"db_name":"retail","question":"获取每个门店的总销售数量和总利润。"...
处理第 630 行, 长度: 15711
行内容(截断): {"id":3331362186,"db_name":"retail","question":"在2023年5月7日，哪些门店的销售利润超...
处理第 631 行, 长度: 6664
行内容(截断): {"id":1128623969,"db_name":"retail","question":"在2023年5月8日，哪个门店的销售数量最...
处理第 632 行, 长度: 11963
行内容(截断): {"id":2501471268,"db_name":"retail","question":"哪个门店在2023年5月9日的销售中获利最...
处理第 633 行, 长度: 51866
行内容(截断): {"id":1462073315,"db_name":"retail","question":"在2023年5月，哪些门店的员工销售了佳...
处理第 634 行, 长度: 19548
行内容(截断): {"id":1581647710,"db_name":"retail","question":"在2023年5月期间，哪些门店的员工销售...
处理第 635 行, 长度: 9408
行内容(截断): {"id":801232665,"db_name":"retail","question":"查找所有商品的类别名称和售价。","gt_sq...
处理第 636 行, 长度: 13966
行内容(截断): {"id":456965504,"db_name":"retail","question":"在2023年5月，哪些门店的销售额超过了100...
处理第 637 行, 长度: 20266
行内容(截断): {"id":3382493010,"db_name":"retail","question":"找出每个商品的剩余数量及其对应的销...
处理第 638 行, 长度: 18510
行内容(截断): {"id":571189478,"db_name":"retail","question":"查询每个订单的详细信息，包括订单日...
处理第 639 行, 长度: 32611
行内容(截断): {"id":3197967117,"db_name":"retail","question":"在2023年5月6日，哪些门店的员工销售了...
处理第 640 行, 长度: 16734
行内容(截断): {"id":426781097,"db_name":"retail","question":"获取每个门店的员工及其职位。","gt_sql":...
处理第 641 行, 长度: 15500
行内容(截断): {"id":3095201302,"db_name":"retail","question":"在2023年5月1日，哪些员工在创客空间店...
处理第 642 行, 长度: 49306
行内容(截断): {"id":3814813462,"db_name":"retail","question":"在2023年5月期间，哪些门店的员工销售...
处理第 643 行, 长度: 19748
行内容(截断): {"id":609043667,"db_name":"retail","question":"获取所有订单详情和相应的产品信息。",...
处理第 644 行, 长度: 13007
行内容(截断): {"id":1259543351,"db_name":"retail","question":"在2023年5月6日，哪些员工在销售统计表...
处理第 645 行, 长度: 11894
行内容(截断): {"id":3115466033,"db_name":"retail","question":"查询所有商品的名称及其售价。","gt_sql"...
处理第 646 行, 长度: 10601
行内容(截断): {"id":1445435683,"db_name":"retail","question":"获取每个门店的店长姓名及联系电话。"...
处理第 647 行, 长度: 8136
行内容(截断): {"id":1024575513,"db_name":"retail","question":"查询在2023年5月7日由员工范莹负责的所...
处理第 648 行, 长度: 25889
行内容(截断): {"id":1356118157,"db_name":"retail","question":"在2023年5月期间，哪些门店的员工销售...
处理第 649 行, 长度: 11548
行内容(截断): {"id":2779355161,"db_name":"retail","question":"统计每个门店在2023年5月的销售总金额...
处理第 650 行, 长度: 9536
行内容(截断): {"id":3800488480,"db_name":"retail","question":"获取所有门店及其对应的经理姓名。","g...
处理第 651 行, 长度: 19888
行内容(截断): {"id":52927163,"db_name":"retail","question":"获取所有商品的销售单价和剩余数量。","...
处理第 652 行, 长度: 693
行内容(截断): {"id":4140737645,"db_name":"retail","question":"在2023年5月1日，哪些门店的员工销售了i...
处理第 653 行, 长度: 13650
行内容(截断): {"id":3812947992,"db_name":"retail","question":"在2023年5月8日，哪些门店的员工销售了...
处理第 654 行, 长度: 17495
行内容(截断): {"id":2237439168,"db_name":"retail","question":"在2023年5月9日，哪个门店的销售数量最...
处理第 655 行, 长度: 3981
行内容(截断): {"id":3083869006,"db_name":"retail","question":"获取销售统计表中所有记录的利润总和...
处理第 656 行, 长度: 406
行内容(截断): {"id":106112262,"db_name":"retail","question":"查询特定员工的所有订单及对应的门店...
处理第 657 行, 长度: 10117
行内容(截断): {"id":886303610,"db_name":"retail","question":"在2023年5月，哪个门店的销售顾问黄萍销...
处理第 658 行, 长度: 16778
行内容(截断): {"id":1529918379,"db_name":"retail","question":"在2023年5月8日，哪些门店的员工销售了N...
处理第 659 行, 长度: 17552
行内容(截断): {"id":3470071233,"db_name":"retail","question":"在2023年5月5日，哪些门店的员工销售了...
处理第 660 行, 长度: 22860
行内容(截断): {"id":616988720,"db_name":"retail","question":"在2023年5月5日，哪些员工在智能生活馆...
处理第 661 行, 长度: 8590
行内容(截断): {"id":4131869213,"db_name":"retail","question":"在2023年5月7日，哪个门店的销售利润最...
处理第 662 行, 长度: 23386
行内容(截断): {"id":2632379040,"db_name":"retail","question":"在2023年5月9日，哪些门店的员工销售了...
处理第 663 行, 长度: 456
行内容(截断): {"id":1347772939,"db_name":"retail","question":"查询某个商品在所有门店的销售数量及...
处理第 664 行, 长度: 18327
行内容(截断): {"id":2314844420,"db_name":"retail","question":"在销售订单表中，查询在2023年5月3日销...
处理第 665 行, 长度: 31893
行内容(截断): {"id":1029843679,"db_name":"retail","question":"查询订单详情表中销售数量大于1的所有...
处理第 666 行, 长度: 632
行内容(截断): {"id":973958071,"db_name":"retail","question":"在2023年5月5日，哪个门店的员工销售了iP...
处理第 667 行, 长度: 19069
行内容(截断): {"id":3235376159,"db_name":"retail","question":"找出在2023年5月5日的所有销售记录及其...
处理第 668 行, 长度: 35259
行内容(截断): {"id":590339570,"db_name":"retail","question":"查询所有订单中销售数量大于1的商品名...
处理第 669 行, 长度: 16606
行内容(截断): {"id":947155024,"db_name":"retail","question":"查找在2023年5月期间销售的所有订单。","...
处理第 670 行, 长度: 14038
行内容(截断): {"id":143868964,"db_name":"retail","question":"查询销售统计表中每个员工的销售数量...
处理第 671 行, 长度: 11214
行内容(截断): {"id":801054820,"db_name":"retail","question":"列出每个商品的类别和当前剩余数量。",...
处理第 672 行, 长度: 17080
行内容(截断): {"id":956049949,"db_name":"retail","question":"获取每个员工的销售数量及其对应的门...
处理第 673 行, 长度: 15377
行内容(截断): {"id":1812261268,"db_name":"retail","question":"查询订单详情中所有订单ID及其对应的...
处理第 674 行, 长度: 284
行内容(截断): {"id":573573963,"db_name":"retail","question":"查询在特定日期的销售统计。","gt_sql":"SE...
处理第 675 行, 长度: 637
行内容(截断): {"id":2726627092,"db_name":"retail","question":"在2023年5月1日，哪些员工在科技园店销...
处理第 676 行, 长度: 25744
行内容(截断): {"id":3682087832,"db_name":"retail","question":"在2023年5月9日，哪些员工销售了Apple Watc...
处理第 677 行, 长度: 15604
行内容(截断): {"id":994704464,"db_name":"retail","question":"获取在2023年5月6日的所有销售订单的总...
处理第 678 行, 长度: 396
行内容(截断): {"id":2258930244,"db_name":"retail","question":"列出在特定日期内所有销售订单的详情...
处理第 679 行, 长度: 37444
行内容(截断): {"id":251367692,"db_name":"retail","question":"在2023年5月7日，哪些员工在智慧街店销...
处理第 680 行, 长度: 17889
行内容(截断): {"id":4178948313,"db_name":"retail","question":"获取所有销售订单中每个门店的总销售...
处理第 681 行, 长度: 22902
行内容(截断): {"id":635779591,"db_name":"retail","question":"在2023年5月5日，哪些门店的员工销售了...
处理第 682 行, 长度: 36897
行内容(截断): {"id":2326522926,"db_name":"retail","question":"查询商品表中售价大于15000的商品信息...
处理第 683 行, 长度: 26322
行内容(截断): {"id":845825777,"db_name":"retail","question":"在2023年5月8日，哪些门店的员工销售了...
处理第 684 行, 长度: 16339
行内容(截断): {"id":1519890808,"db_name":"retail","question":"在2023年5月1日，哪些门店的销售顾问销...
处理第 685 行, 长度: 363
行内容(截断): {"id":624803127,"db_name":"retail","question":"查找特定商品的所有销售记录及其销售...
处理第 686 行, 长度: 16671
行内容(截断): {"id":4067103855,"db_name":"retail","question":"获取每个门店的总销售金额和对应的门...
处理第 687 行, 长度: 431
行内容(截断): {"id":2670659765,"db_name":"retail","question":"获取在特定日期内的销售订单及其商品...
处理第 688 行, 长度: 20332
行内容(截断): {"id":4067388605,"db_name":"retail","question":"查询每个订单的详细信息，包括订单日...
处理第 689 行, 长度: 12605
行内容(截断): {"id":383590974,"db_name":"retail","question":"列出所有商品的名称和其供应商名称。",...
处理第 690 行, 长度: 13186
行内容(截断): {"id":4056403376,"db_name":"retail","question":"列出所有商品的售价及其供应商名称。"...
处理第 691 行, 长度: 18836
行内容(截断): {"id":3670992366,"db_name":"retail","question":"查询所有订单详情，包括对应商品的名...
处理第 692 行, 长度: 14054
行内容(截断): {"id":2335581270,"db_name":"retail","question":"列出2023年5月销售金额大于3000的门店及...
处理第 693 行, 长度: 11668
行内容(截断): {"id":2535524828,"db_name":"retail","question":"找出所有门店的名称及其对应的店长姓...
处理第 694 行, 长度: 21512
行内容(截断): {"id":120259515,"db_name":"retail","question":"查询所有员工的姓名及其所属门店的联...
处理第 695 行, 长度: 43984
行内容(截断): {"id":1670319692,"db_name":"retail","question":"在2023年5月9日，哪些员工在创新路专卖...
处理第 696 行, 长度: 10643
行内容(截断): {"id":4086419825,"db_name":"retail","question":"在2023年5月7日，哪些员工在'未来城店'...
处理第 697 行, 长度: 12754
行内容(截断): {"id":3256730396,"db_name":"retail","question":"查询所有商品的售价和进货价差异。","g...
处理第 698 行, 长度: 20577
行内容(截断): {"id":2107889479,"db_name":"retail","question":"在2023年5月期间，哪些门店的销售总额...
处理第 699 行, 长度: 19031
行内容(截断): {"id":595252998,"db_name":"retail","question":"查找每个门店的利润和销售数量。","gt_sq...
处理第 700 行, 长度: 6140
行内容(截断): {"id":2271451016,"db_name":"retail","question":"查找门店ID为'64921abb-1d54-4e03-a15e-ea42f058f3...
处理第 701 行, 长度: 23279
行内容(截断): {"id":3431877623,"db_name":"retail","question":"在2023年5月6日，哪些门店的员工销售了...
处理第 702 行, 长度: 16193
行内容(截断): {"id":1818716672,"db_name":"retail","question":"在2023年5月，哪些门店的员工销售了Ninte...
处理第 703 行, 长度: 18350
行内容(截断): {"id":3062953566,"db_name":"retail","question":"在2023年5月9日，哪些门店的员工销售了...
处理第 704 行, 长度: 375
行内容(截断): {"id":3908942610,"db_name":"retail","question":"获取特定门店的所有销售订单信息。","g...
处理第 705 行, 长度: 20972
行内容(截断): {"id":208218356,"db_name":"retail","question":"在2023年5月3日，哪个门店的销售总额最...
处理第 706 行, 长度: 12241
行内容(截断): {"id":4174482566,"db_name":"retail","question":"在2023年5月3日，哪个门店的销售数量最...
处理第 707 行, 长度: 28470
行内容(截断): {"id":1762340720,"db_name":"retail","question":"在2023年5月1日，哪个门店的员工销售了i...
处理第 708 行, 长度: 11807
行内容(截断): {"id":1734342716,"db_name":"retail","question":"统计各个门店的销售总额。","gt_sql":"SELE...
处理第 709 行, 长度: 12205
行内容(截断): {"id":3698654694,"db_name":"retail","question":"获取所有员工的职位和他们处理的订单...
处理第 710 行, 长度: 324
行内容(截断): {"id":3114650274,"db_name":"retail","question":"查询特定门店的所有销售统计记录。","g...
处理第 711 行, 长度: 26942
行内容(截断): {"id":2085424302,"db_name":"retail","question":"在2023年5月期间，哪些门店的总销售金...
处理第 712 行, 长度: 14140
行内容(截断): {"id":662177839,"db_name":"retail","question":"在2023年5月2日，哪些门店的员工销售了...
处理第 713 行, 长度: 577
行内容(截断): {"id":3976972213,"db_name":"retail","question":"列出在指定日期内销售数量最多的商品...
处理第 714 行, 长度: 414
行内容(截断): {"id":783788015,"db_name":"retail","question":"查询特定员工的所有订单信息。","gt_sql":...
处理第 715 行, 长度: 11149
行内容(截断): {"id":2306528451,"db_name":"retail","question":"在2023年5月4日，哪个门店的销售订单总...
处理第 716 行, 长度: 36123
行内容(截断): {"id":1834111948,"db_name":"retail","question":"在2023年5月1日，哪些门店的员工销售了...
处理第 717 行, 长度: 15390
行内容(截断): {"id":1718600359,"db_name":"retail","question":"在2023年5月6日，哪些员工在销售统计表...
处理第 718 行, 长度: 29822
行内容(截断): {"id":2900121322,"db_name":"retail","question":"在2023年5月期间，哪些门店的员工销售...
处理第 719 行, 长度: 16723
行内容(截断): {"id":1605466649,"db_name":"retail","question":"获取每个商品的剩余数量和售价。","gt_s...
处理第 720 行, 长度: 21166
行内容(截断): {"id":330758085,"db_name":"retail","question":"统计每个门店的员工数量。","gt_sql":"SELEC...
处理第 721 行, 长度: 11432
行内容(截断): {"id":1887568974,"db_name":"retail","question":"在2023年5月5日，哪些员工在科技中心店...
处理第 722 行, 长度: 16129
行内容(截断): {"id":1544829110,"db_name":"retail","question":"查找在数码广场店销售的所有订单及其...
处理第 723 行, 长度: 25950
行内容(截断): {"id":1389319035,"db_name":"risk_control","question":"找出所有风险等级为'高'且影响程...
处理第 724 行, 长度: 8135
行内容(截断): {"id":955757206,"db_name":"risk_control","question":"查找所有与合规风险相关的风险事...
处理第 725 行, 长度: 7525
行内容(截断): {"id":1687223871,"db_name":"risk_control","question":"查询所有触发了欺诈嫌疑预警的风...
处理第 726 行, 长度: 7526
行内容(截断): {"id":948809000,"db_name":"risk_control","question":"找出所有已批准的风险报告中，涉...
处理第 727 行, 长度: 5431
行内容(截断): {"id":2131857844,"db_name":"risk_control","question":"列出所有客户的风险等级分布情况...
处理第 728 行, 长度: 47939
行内容(截断): {"id":1810509227,"db_name":"risk_control","question":"查询所有风险指标及其监控记录，...
处理第 729 行, 长度: 5871
行内容(截断): {"id":2704266530,"db_name":"risk_control","question":"获取所有已批准的风险报告及其作...
处理第 730 行, 长度: 21404
行内容(截断): {"id":3816194798,"db_name":"risk_control","question":"统计每个风险等级的客户在不同交...
处理第 731 行, 长度: 406
行内容(截断): {"id":3476903471,"db_name":"risk_control","question":"查询所有涉及特定风险事件的审核...
处理第 732 行, 长度: 24125
行内容(截断): {"id":451357687,"db_name":"risk_control","question":"查找所有由'周婷'撰写的风险报告，...
处理第 733 行, 长度: 21004
行内容(截断): {"id":880512967,"db_name":"risk_control","question":"查询所有在2023年之后创建的风险报...
处理第 734 行, 长度: 34166
行内容(截断): {"id":4205370122,"db_name":"risk_control","question":"查询所有包含'系统'关键词的风险...
处理第 735 行, 长度: 47875
行内容(截断): {"id":2721513399,"db_name":"risk_control","question":"列出所有风险指标的当前值、30天...
处理第 736 行, 长度: 9740
行内容(截断): {"id":1697295436,"db_name":"risk_control","question":"哪些风险事件的评估结果为高风险...
处理第 737 行, 长度: 14232
行内容(截断): {"id":2228217319,"db_name":"risk_control","question":"有哪些客户的交易类型为投资，且...
处理第 738 行, 长度: 3918
行内容(截断): {"id":1939667217,"db_name":"risk_control","question":"查询每个风险事件的创建时间和当...
处理第 739 行, 长度: 13309
行内容(截断): {"id":2175309220,"db_name":"risk_control","question":"找出所有信用评分低于600的客户及...
处理第 740 行, 长度: 5665
行内容(截断): {"id":1016775966,"db_name":"risk_control","question":"获取2023年12月所有成功交易的金额...
处理第 741 行, 长度: 13603
行内容(截断): {"id":629791557,"db_name":"risk_control","question":"获取所有预警的类型和内容。","gt_sq...
处理第 742 行, 长度: 3916
行内容(截断): {"id":4191869630,"db_name":"risk_control","question":"列出所有风险报告和其对应的审批...
处理第 743 行, 长度: 13682
行内容(截断): {"id":3240782233,"db_name":"risk_control","question":"统计每种交易类型的成功率和平均...
处理第 744 行, 长度: 59312
行内容(截断): {"id":1390189932,"db_name":"risk_control","question":"获取所有触发的预警及其对应的规...
处理第 745 行, 长度: 38236
行内容(截断): {"id":2842460105,"db_name":"risk_control","question":"查找所有客户及其最近一次交易的...
处理第 746 行, 长度: 24252
行内容(截断): {"id":3963285376,"db_name":"risk_control","question":"统计每种风险指标的平均实际值、...
处理第 747 行, 长度: 14176
行内容(截断): {"id":2546181421,"db_name":"risk_control","question":"查询所有在过去一年内既有高风险...
处理第 748 行, 长度: 8700
行内容(截断): {"id":2755620243,"db_name":"risk_control","question":"列出所有风险评估中，缓解计划为...
处理第 749 行, 长度: 30579
行内容(截断): {"id":3751427783,"db_name":"risk_control","question":"查询所有预警信息的内容及其状态...
处理第 750 行, 长度: 1040
行内容(截断): {"id":2897506811,"db_name":"risk_control","question":"计算每个客户的风险指数，风险指...
处理第 751 行, 长度: 7626
行内容(截断): {"id":1765860698,"db_name":"risk_control","question":"统计每种风险事件类型在2023年的发...
处理第 752 行, 长度: 51389
行内容(截断): {"id":2186954842,"db_name":"risk_control","question":"找出所有风险报告内容中包含\"合...
处理第 753 行, 长度: 25024
行内容(截断): {"id":1001861352,"db_name":"risk_control","question":"获取每个风险指标的更新频率及其...
处理第 754 行, 长度: 79579
行内容(截断): {"id":3688441488,"db_name":"risk_control","question":"查询所有未解决的风险事件，以及...
处理第 755 行, 长度: 12786
行内容(截断): {"id":2337622346,"db_name":"risk_control","question":"统计每种风险控制规则类型的平均...
处理第 756 行, 长度: 5207
行内容(截断): {"id":1820971007,"db_name":"risk_control","question":"统计每种风险类型下的事件数量，...
处理第 757 行, 长度: 16085
行内容(截断): {"id":3328333298,"db_name":"risk_control","question":"哪些客户在2023年进行了交易并且其...
处理第 758 行, 长度: 13968
行内容(截断): {"id":547790744,"db_name":"risk_control","question":"获取所有风险事件及其对应的风险...
处理第 759 行, 长度: 10677
行内容(截断): {"id":3644288071,"db_name":"risk_control","question":"在2023年度，有多少份风险报告被拒...
处理第 760 行, 长度: 17914
行内容(截断): {"id":3802320452,"db_name":"risk_control","question":"获取所有风险评估记录及其对应的...
处理第 761 行, 长度: 14721
行内容(截断): {"id":3489018825,"db_name":"risk_control","question":"查询所有风险指标的最新监控日志...
处理第 762 行, 长度: 15888
行内容(截断): {"id":2505821643,"db_name":"risk_control","question":"列出所有风险控制规则及其关联的...
处理第 763 行, 长度: 19205
行内容(截断): {"id":3072597279,"db_name":"risk_control","question":"查询信用风险事件的所有相关交易...
处理第 764 行, 长度: 4175
行内容(截断): {"id":260033616,"db_name":"risk_control","question":"统计每种风险等级的客户数量","gt_sq...
处理第 765 行, 长度: 26303
行内容(截断): {"id":2369245761,"db_name":"risk_control","question":"请找出所有客户中，注册时间在2019...
处理第 766 行, 长度: 18731
行内容(截断): {"id":1787317276,"db_name":"risk_control","question":"找出所有触发高风险预警的规则及...
处理第 767 行, 长度: 15732
行内容(截断): {"id":1447865488,"db_name":"risk_control","question":"获取所有风险事件的创建时间和状...
处理第 768 行, 长度: 21027
行内容(截断): {"id":3560291801,"db_name":"risk_control","question":"统计每个风险事件类型在不同月份...
处理第 769 行, 长度: 6701
行内容(截断): {"id":2152701139,"db_name":"risk_control","question":"统计每个月份的平均交易金额和交...
处理第 770 行, 长度: 26964
行内容(截断): {"id":558233205,"db_name":"risk_control","question":"查询所有已批准的风险报告及其相...
处理第 771 行, 长度: 47033
行内容(截断): {"id":3381293646,"db_name":"risk_control","question":"获取所有客户的风险等级及其交易...
处理第 772 行, 长度: 19201
行内容(截断): {"id":3077667667,"db_name":"risk_control","question":"查询所有高风险客户的交易信息及...
处理第 773 行, 长度: 5744
行内容(截断): {"id":2339616488,"db_name":"risk_control","question":"找出所有由'孙宇'撰写且尚未审批...
处理第 774 行, 长度: 24831
行内容(截断): {"id":1797007792,"db_name":"risk_control","question":"查询所有未处理预警的内容及其关...
处理第 775 行, 长度: 6420
行内容(截断): {"id":298505495,"db_name":"risk_control","question":"统计每种风险等级的客户数量，要...
处理第 776 行, 长度: 21663
行内容(截断): {"id":612300483,"db_name":"risk_control","question":"统计每个客户的交易数量和平均风...
处理第 777 行, 长度: 11705
行内容(截断): {"id":3872938276,"db_name":"risk_control","question":"计算每个月新增的高风险客户数量"...
处理第 778 行, 长度: 17537
行内容(截断): {"id":4293195588,"db_name":"risk_control","question":"查询所有高风险指标的最新监控记...
处理第 779 行, 长度: 6446
行内容(截断): {"id":3735769324,"db_name":"risk_control","question":"计算每种风险等级的客户数量及其...
处理第 780 行, 长度: 19257
行内容(截断): {"id":3555900229,"db_name":"risk_control","question":"在所有已解决的预警中，哪些预警...
处理第 781 行, 长度: 32770
行内容(截断): {"id":390806390,"db_name":"risk_control","question":"哪些客户在2023年11月期间进行了交...
处理第 782 行, 长度: 10293
行内容(截断): {"id":2736578842,"db_name":"risk_control","question":"哪些风险指标的名称包含“财务”...
处理第 783 行, 长度: 18751
行内容(截断): {"id":453782697,"db_name":"risk_control","question":"查找所有客户的名称和信用评分。",...
处理第 784 行, 长度: 25584
行内容(截断): {"id":605680231,"db_name":"risk_control","question":"列出每个客户的最新交易记录及其...
处理第 785 行, 长度: 11836
行内容(截断): {"id":591035595,"db_name":"risk_control","question":"获取所有风险监控日志中实际值超...
处理第 786 行, 长度: 11282
行内容(截断): {"id":154773295,"db_name":"risk_control","question":"找出所有高风险客户的交易记录，...
处理第 787 行, 长度: 9637
行内容(截断): {"id":2894945358,"db_name":"risk_control","question":"查找所有客户的交易记录及其风险...
处理第 788 行, 长度: 5209
行内容(截断): {"id":3936841885,"db_name":"risk_control","question":"找出所有风险报告的状态为“已拒...
处理第 789 行, 长度: 4472
行内容(截断): {"id":2451684746,"db_name":"risk_control","question":"哪些客户的风险等级为高，并且他...
处理第 790 行, 长度: 9498
行内容(截断): {"id":1650691143,"db_name":"risk_control","question":"统计每个风险等级的客户在过去一...
处理第 791 行, 长度: 6909
行内容(截断): {"id":3897186376,"db_name":"risk_control","question":"列出所有流动性风险事件的报告。"...
处理第 792 行, 长度: 7370
行内容(截断): {"id":1076275288,"db_name":"risk_control","question":"计算所有客户中，信用评分在600到8...
处理第 793 行, 长度: 19912
行内容(截断): {"id":1120727301,"db_name":"risk_control","question":"查找所有审批人王思远所批准的风...
处理第 794 行, 长度: 20054
行内容(截断): {"id":1080125465,"db_name":"risk_control","question":"查找所有合规风险事件及其相关报...
处理第 795 行, 长度: 30291
行内容(截断): {"id":136539419,"db_name":"risk_control","question":"查找所有客户在2023年6月的交易记录...
处理第 796 行, 长度: 30360
行内容(截断): {"id":3750047672,"db_name":"risk_control","question":"哪些风险事件的严重程度为3，并且...
处理第 797 行, 长度: 25206
行内容(截断): {"id":3909298542,"db_name":"risk_control","question":"查询所有风险指标的阈值及其对应...
处理第 798 行, 长度: 21253
行内容(截断): {"id":2762771801,"db_name":"risk_control","question":"获取所有客户的风险评分及其交易...
处理第 799 行, 长度: 27002
行内容(截断): {"id":2830564670,"db_name":"risk_control","question":"列出所有风险事件及其对应的预警...
处理第 800 行, 长度: 23739
行内容(截断): {"id":942591775,"db_name":"risk_control","question":"查找所有风险事件及其对应的预警...
处理第 801 行, 长度: 617
行内容(截断): {"id":3295587616,"db_name":"risk_control","question":"计算每个风险等级（低/中/高）的...
处理第 802 行, 长度: 13731
行内容(截断): {"id":3932804573,"db_name":"risk_control","question":"哪些客户的风险等级为高，并且其...
处理第 803 行, 长度: 13823
行内容(截断): {"id":862533692,"db_name":"risk_control","question":"列出所有客户的信用评分及其最近...
处理第 804 行, 长度: 8427
行内容(截断): {"id":2759801136,"db_name":"risk_control","question":"列出所有风险评估结果为高风险，...
处理第 805 行, 长度: 6908
行内容(截断): {"id":1448319074,"db_name":"risk_control","question":"查找所有企业客户中，信用评分前1...
处理第 806 行, 长度: 9865
行内容(截断): {"id":2148910450,"db_name":"risk_control","question":"统计每个月新增的风险控制规则数...
处理第 807 行, 长度: 5259
行内容(截断): {"id":3303778848,"db_name":"risk_control","question":"查询所有风险报告的作者及其对应...
处理第 808 行, 长度: 16826
行内容(截断): {"id":2919479377,"db_name":"risk_control","question":"列出所有客户的交易情况，包括金...
处理第 809 行, 长度: 14340
行内容(截断): {"id":3408098582,"db_name":"risk_control","question":"获取所有风险事件及其评估结果","g...
处理第 810 行, 长度: 23890
行内容(截断): {"id":3536942222,"db_name":"risk_control","question":"计算每个风险指标的平均实际值，...
处理第 811 行, 长度: 36637
行内容(截断): {"id":3025435441,"db_name":"risk_control","question":"找出所有已批准的风险报告及其相...
处理第 812 行, 长度: 568
行内容(截断): {"id":3761432717,"db_name":"risk_control","question":"找出所有在同一天既有高风险交易...
处理第 813 行, 长度: 11696
行内容(截断): {"id":3404778014,"db_name":"risk_control","question":"查询所有高风险的交易及其对应的...
处理第 814 行, 长度: 22449
行内容(截断): {"id":3200534548,"db_name":"risk_control","question":"列出所有风险评估结果为'高'的事...
处理第 815 行, 长度: 15362
行内容(截断): {"id":698660188,"db_name":"risk_control","question":"哪些高风险客户在最近一次交易中...
处理第 816 行, 长度: 13734
行内容(截断): {"id":756643276,"db_name":"risk_control","question":"查找每个风险事件的交易记录数量...
处理第 817 行, 长度: 27624
行内容(截断): {"id":1961596891,"db_name":"risk_control","question":"查询2023年1月至3月期间，高风险客...
处理第 818 行, 长度: 31489
行内容(截断): {"id":1488802626,"db_name":"risk_control","question":"查询2023年发生的所有高严重程度（...
处理第 819 行, 长度: 13391
行内容(截断): {"id":3027811751,"db_name":"risk_control","question":"获取所有风险监控日志中未超过阈...
处理第 820 行, 长度: 13061
行内容(截断): {"id":1296190191,"db_name":"risk_control","question":"查询所有待审批状态的风险报告，...
处理第 821 行, 长度: 17482
行内容(截断): {"id":2631012035,"db_name":"risk_control","question":"哪些客户在2021年注册并且风险等级...
处理第 822 行, 长度: 692
行内容(截断): {"id":2342271424,"db_name":"risk_control","question":"列出所有客户的最近一次交易信息...
处理第 823 行, 长度: 5410
行内容(截断): {"id":2292865545,"db_name":"risk_control","question":"获取每种风险类型的数量统计，显...
处理第 824 行, 长度: 15335
行内容(截断): {"id":3057920994,"db_name":"risk_control","question":"查询所有高风险客户（风险等级为'...
处理第 825 行, 长度: 17634
行内容(截断): {"id":1563461822,"db_name":"risk_control","question":"统计每个风险事件类型在不同月份...
处理第 826 行, 长度: 15953
行内容(截断): {"id":2699040253,"db_name":"risk_control","question":"请查询所有监控记录，显示实际值...
处理第 827 行, 长度: 10318
行内容(截断): {"id":2609391365,"db_name":"risk_control","question":"统计每个风险等级的客户在不同交...
处理第 828 行, 长度: 4310
行内容(截断): {"id":1646275357,"db_name":"risk_control","question":"当前有多少条激活状态的规则配置...
处理第 829 行, 长度: 14826
行内容(截断): {"id":3640375109,"db_name":"risk_control","question":"获取所有客户的风险等级和信用评...
处理第 830 行, 长度: 6123
行内容(截断): {"id":1137138067,"db_name":"risk_control","question":"请找出所有风险指标的阈值大于100...
处理第 831 行, 长度: 12385
行内容(截断): {"id":674388735,"db_name":"risk_control","question":"查询所有客户的名称和注册日期。",...
处理第 832 行, 长度: 21372
行内容(截断): {"id":2598937105,"db_name":"risk_control","question":"获取所有风险指标的监控日志，包...
处理第 833 行, 长度: 37009
行内容(截断): {"id":62865185,"db_name":"risk_control","question":"统计每个风险指标在不同数据来源下...
处理第 834 行, 长度: 14194
行内容(截断): {"id":185839438,"db_name":"risk_control","question":"获取所有审核结果为拒绝的审核记...
处理第 835 行, 长度: 16753
行内容(截断): {"id":3165460471,"db_name":"risk_control","question":"查询每个预警的类型和内容。","gt_s...
处理第 836 行, 长度: 10049
行内容(截断): {"id":3849483796,"db_name":"risk_control","question":"查询所有未处理状态的预警信息，...
处理第 837 行, 长度: 11939
行内容(截断): {"id":1990473038,"db_name":"risk_control","question":"找出所有未处理的预警，并计算其...
处理第 838 行, 长度: 912
行内容(截断): {"id":3119334868,"db_name":"risk_control","question":"计算每个客户的风险指数（风险评...
处理第 839 行, 长度: 7481
行内容(截断): {"id":2458967882,"db_name":"risk_control","question":"统计每种风险类型的风险事件数量...
处理第 840 行, 长度: 56081
行内容(截断): {"id":4081376750,"db_name":"risk_control","question":"哪些客户的风险等级为“低”且信...
处理第 841 行, 长度: 35458
行内容(截断): {"id":2952805928,"db_name":"risk_control","question":"列出所有未处理的高级别预警及其...
处理第 842 行, 长度: 16955
行内容(截断): {"id":790231894,"db_name":"risk_control","question":"请查询所有触发合规违规规则的预...
处理第 843 行, 长度: 29730
行内容(截断): {"id":76184048,"db_name":"risk_control","question":"请列出所有有高风险交易的客户及其...
处理第 844 行, 长度: 19959
行内容(截断): {"id":291950371,"db_name":"risk_control","question":"获取所有风险报告中，报告类型为...
处理第 845 行, 长度: 3865
行内容(截断): {"id":2809252635,"db_name":"risk_control","question":"统计每个风险事件类型的事件数量"...
处理第 846 行, 长度: 11821
行内容(截断): {"id":184311181,"db_name":"risk_control","question":"哪些客户在2023年5月4日进行了转账...
处理第 847 行, 长度: 7659
行内容(截断): {"id":1539184065,"db_name":"risk_control","question":"列出所有未处理的高级别预警，包...
处理第 848 行, 长度: 22952
行内容(截断): {"id":3408938184,"db_name":"risk_control","question":"在2023年4月的风险报告中，有哪些...
处理第 849 行, 长度: 15579
行内容(截断): {"id":547284006,"db_name":"risk_control","question":"对于每种交易类型，计算成功与失...
处理第 850 行, 长度: 12570
行内容(截断): {"id":2791172353,"db_name":"risk_control","question":"列出所有的风险事件及其最新的风...
处理第 851 行, 长度: 966
行内容(截断): {"id":616009086,"db_name":"risk_control","question":"找出所有在过去一年内既有高风险...
处理第 852 行, 长度: 322
行内容(截断): {"id":2755424699,"db_name":"risk_control","question":"获取特定客户 '恒基能源有限公司' ...
处理第 853 行, 长度: 10252
行内容(截断): {"id":3357225905,"db_name":"risk_control","question":"查找每个风险事件的最高严重程度...
处理第 854 行, 长度: 7502
行内容(截断): {"id":2507883319,"db_name":"risk_control","question":"统计每个风险等级的客户数量和他...
处理第 855 行, 长度: 17698
行内容(截断): {"id":2171757699,"db_name":"risk_control","question":"查找所有审核人张强审核的预警记...
处理第 856 行, 长度: 19134
行内容(截断): {"id":1791933892,"db_name":"risk_control","question":"获取所有监控记录的实际值和是否...
处理第 857 行, 长度: 13241
行内容(截断): {"id":4281611752,"db_name":"risk_control","question":"统计每个风险指标在2023年超过阈值...
处理第 858 行, 长度: 18897
行内容(截断): {"id":2403947927,"db_name":"risk_control","question":"查询2023年内所有预警信息及其处理...
处理第 859 行, 长度: 22300
行内容(截断): {"id":3007794799,"db_name":"risk_control","question":"查询每种风险指标的最新监控记录...
处理第 860 行, 长度: 26690
行内容(截断): {"id":3478580962,"db_name":"risk_control","question":"计算每个风险指标在过去一年内超...
处理第 861 行, 长度: 4797
行内容(截断): {"id":2835641813,"db_name":"risk_control","question":"统计每种风险等级的客户数量。","g...
处理第 862 行, 长度: 13019
行内容(截断): {"id":3556405805,"db_name":"risk_control","question":"查找所有客户的交易风险评分及其...
处理第 863 行, 长度: 19196
行内容(截断): {"id":1912282533,"db_name":"risk_control","question":"查询所有风险评估结果为高风险，...
处理第 864 行, 长度: 9123
行内容(截断): {"id":966675168,"db_name":"risk_control","question":"统计每种交易类型的成功交易数量...
处理第 865 行, 长度: 8340
行内容(截断): {"id":1657330121,"db_name":"risk_control","question":"查找所有交易失败的记录，并且关...
处理第 866 行, 长度: 14034
行内容(截断): {"id":2427884877,"db_name":"risk_control","question":"请找出所有被标记为处理中状态的...
处理第 867 行, 长度: 21527
行内容(截断): {"id":2050953540,"db_name":"risk_control","question":"列出所有交易及其相关的风险事件...
处理第 868 行, 长度: 15908
行内容(截断): {"id":2088100618,"db_name":"risk_control","question":"找出所有在最近一年内进行过大额...
处理第 869 行, 长度: 17868
行内容(截断): {"id":4242999593,"db_name":"risk_control","question":"查找所有有缓解计划的风险评估记...
处理第 870 行, 长度: 7336
行内容(截断): {"id":4243946175,"db_name":"risk_control","question":"查找所有高风险客户的交易记录及...
处理第 871 行, 长度: 28534
行内容(截断): {"id":1679294343,"db_name":"risk_control","question":"查询所有风险监控日志的实际值及...
处理第 872 行, 长度: 6499
行内容(截断): {"id":1824329950,"db_name":"risk_control","question":"列出所有已拒绝的风险报告，并显...
处理第 873 行, 长度: 32026
行内容(截断): {"id":888703769,"db_name":"risk_control","question":"哪些企业在2021年注册并且其信用评...
处理第 874 行, 长度: 36353
行内容(截断): {"id":411280576,"db_name":"risk_control","question":"查找所有由'陈强'处理的预警及其相...
处理第 875 行, 长度: 44019
行内容(截断): {"id":452369014,"db_name":"risk_control","question":"获取所有报告内容包含合规的风险...
处理第 876 行, 长度: 9770
行内容(截断): {"id":865900816,"db_name":"risk_control","question":"统计每个月风险事件的数量、平均...
处理第 877 行, 长度: 13688
行内容(截断): {"id":92424187,"db_name":"risk_control","question":"获取所有风险指标的名称和阈值。","...
处理第 878 行, 长度: 59006
行内容(截断): {"id":2998508313,"db_name":"risk_control","question":"列出所有风险指标的最新监控记录...
处理第 879 行, 长度: 6901
行内容(截断): {"id":1024168357,"db_name":"risk_control","question":"获取所有交易金额大于10万的交易...
处理第 880 行, 长度: 40995
行内容(截断): {"id":2422412797,"db_name":"risk_control","question":"获取所有审批状态为已批准的风险...
处理第 881 行, 长度: 6965
行内容(截断): {"id":3918852865,"db_name":"risk_control","question":"统计每种交易类型的平均风险评分"...
处理第 882 行, 长度: 17591
行内容(截断): {"id":2671276850,"db_name":"risk_control","question":"计算每种风险事件类型的平均处理...
处理第 883 行, 长度: 8877
行内容(截断): {"id":3873676880,"db_name":"risk_control","question":"列出每种预警类型的数量及其对应...
处理第 884 行, 长度: 8025
行内容(截断): {"id":3957865555,"db_name":"risk_control","question":"统计每个风险事件类型的平均处理...
处理第 885 行, 长度: 28258
行内容(截断): {"id":4127521896,"db_name":"risk_control","question":"找出所有触发规则的预警信息及其...
处理第 886 行, 长度: 22919
行内容(截断): {"id":4089186720,"db_name":"risk_control","question":"查询所有在2023年进行过高风险交易...
处理第 887 行, 长度: 15050
行内容(截断): {"id":907497664,"db_name":"risk_control","question":"列出每个风险事件的严重程度及其...
处理第 888 行, 长度: 337
行内容(截断): {"id":4046233588,"db_name":"risk_control","question":"查询所有与特定风险事件关联的交...
处理第 889 行, 长度: 4571
行内容(截断): {"id":950586637,"db_name":"risk_control","question":"统计每种客户类型的数量","gt_sql":"SE...
处理第 890 行, 长度: 17084
行内容(截断): {"id":1374953478,"db_name":"risk_control","question":"获取所有风险评估及其关联的风险...
处理第 891 行, 长度: 522
行内容(截断): {"id":3381418272,"db_name":"risk_control","question":"找出所有高风险客户中，最近30天...
处理第 892 行, 长度: 28740
行内容(截断): {"id":2179442925,"db_name":"risk_control","question":"列出所有高风险等级的客户及其最...
处理第 893 行, 长度: 9645
行内容(截断): {"id":1859945760,"db_name":"risk_control","question":"统计每种交易类型的成功率，并显...
处理第 894 行, 长度: 24294
行内容(截断): {"id":2798341435,"db_name":"risk_control","question":"列出所有风险评估结果为\"高\"风险...
处理第 895 行, 长度: 13794
行内容(截断): {"id":2480313897,"db_name":"risk_control","question":"哪些客户的风险等级为高，并且他...
处理第 896 行, 长度: 32642
行内容(截断): {"id":4249746696,"db_name":"risk_control","question":"查询所有风险等级为'高'且信用评...
处理第 897 行, 长度: 25272
行内容(截断): {"id":3634061359,"db_name":"risk_control","question":"查询所有客户的风险等级及其交易...
处理第 898 行, 长度: 29834
行内容(截断): {"id":1094205818,"db_name":"risk_control","question":"查询所有已批准的风险报告及其相...
处理第 899 行, 长度: 5068
行内容(截断): {"id":4008892599,"db_name":"risk_control","question":"哪位作者提交的风险报告最多？","g...
处理第 900 行, 长度: 5203
行内容(截断): {"id":1522060162,"db_name":"risk_control","question":"列出所有未处理的风险事件及其报...
处理第 901 行, 长度: 15773
行内容(截断): {"id":2054103027,"db_name":"risk_control","question":"列出所有客户及其最后更新日期，...
处理第 902 行, 长度: 93023
行内容(截断): {"id":3283769605,"db_name":"risk_control","question":"查询所有由'高志远'审批的风险报...
处理第 903 行, 长度: 29030
行内容(截断): {"id":747719750,"db_name":"risk_control","question":"查询所有风险指标的当前值、阈值...
处理第 904 行, 长度: 25439
行内容(截断): {"id":334580003,"db_name":"risk_control","question":"查询所有风险监控日志与其相关的...
处理第 905 行, 长度: 5015
行内容(截断): {"id":388467912,"db_name":"risk_control","question":"获取风险评估中影响程度评分和发...
处理第 906 行, 长度: 19512
行内容(截断): {"id":3589660339,"db_name":"risk_control","question":"列出所有风险事件及其相关的风险...
处理第 907 行, 长度: 9373
行内容(截断): {"id":1785182803,"db_name":"risk_control","question":"请找出所有客户中，交易类型为“...
处理第 908 行, 长度: 45131
行内容(截断): {"id":3949045999,"db_name":"risk_control","question":"列出所有风险指标及其最新的监控...
处理第 909 行, 长度: 9115
行内容(截断): {"id":1365503712,"db_name":"risk_control","question":"计算每个风险类型的平均缓解计划...
处理第 910 行, 长度: 6142
行内容(截断): {"id":454781039,"db_name":"risk_control","question":"统计每种风险类型下的风险事件数...
处理第 911 行, 长度: 17045
行内容(截断): {"id":312146930,"db_name":"risk_control","question":"获取所有风险评估及其对应的风险...
处理第 912 行, 长度: 26835
行内容(截断): {"id":3050678212,"db_name":"risk_control","question":"请列出风险监控日志中，实际值超...
处理第 913 行, 长度: 18996
行内容(截断): {"id":2500244814,"db_name":"risk_control","question":"查找每个风险事件的评估结果及缓...
处理第 914 行, 长度: 7673
行内容(截断): {"id":2753692877,"db_name":"risk_control","question":"查找所有已批准的风险报告及其作...
处理第 915 行, 长度: 31331
行内容(截断): {"id":2701292510,"db_name":"risk_control","question":"列出所有风险等级为高但信用评分...
处理第 916 行, 长度: 17830
行内容(截断): {"id":3788454929,"db_name":"risk_control","question":"获取所有预警信息的内容以及分配...
处理第 917 行, 长度: 22591
行内容(截断): {"id":1494274200,"db_name":"risk_control","question":"查找所有已解决的风险事件中，解...
处理第 918 行, 长度: 94698
行内容(截断): {"id":2741655674,"db_name":"risk_control","question":"查找所有激活状态的规则配置及其...
处理第 919 行, 长度: 4898
行内容(截断): {"id":4006191467,"db_name":"risk_control","question":"计算每种风险等级的客户数量，并...
处理第 920 行, 长度: 9924
行内容(截断): {"id":1366443289,"db_name":"risk_control","question":"获取所有未处理的风险事件及其报...
处理第 921 行, 长度: 11681
行内容(截断): {"id":2713864982,"db_name":"risk_control","question":"找出所有风险事件中，严重程度为3...
处理第 922 行, 长度: 17409
行内容(截断): {"id":4176420377,"db_name":"risk_control","question":"获取所有风险评估的缓解计划及其...
处理第 923 行, 长度: 37893
行内容(截断): {"id":2609744326,"db_name":"risk_control","question":"列出所有未解决的高级别预警，包...
处理第 924 行, 长度: 83555
行内容(截断): {"id":1472140605,"db_name":"risk_control","question":"查询所有风险评估结果为\"高\"的事...
处理第 925 行, 长度: 13164
行内容(截断): {"id":4016844576,"db_name":"risk_control","question":"哪些高风险等级的客户在过去一年...
处理第 926 行, 长度: 17775
行内容(截断): {"id":1206095116,"db_name":"risk_control","question":"查询风险评估中，影响程度评分大...
处理第 927 行, 长度: 25990
行内容(截断): {"id":747204718,"db_name":"risk_control","question":"获取所有风险事件及其报告类型和...
处理第 928 行, 长度: 11805
行内容(截断): {"id":380031248,"db_name":"supervise","question":"2023年第三季度，哪些金融机构的监管...
处理第 929 行, 长度: 31404
行内容(截断): {"id":796615861,"db_name":"supervise","question":"获取所有在2023年11月1日提交的监管报...
处理第 930 行, 长度: 13263
行内容(截断): {"id":226307394,"db_name":"supervise","question":"2023年6月，哪些金融机构的资本充足率...
处理第 931 行, 长度: 8210
行内容(截断): {"id":2186232166,"db_name":"supervise","question":"市场风险暴露占总风险暴露比例最高...
处理第 932 行, 长度: 25940
行内容(截断): {"id":3832687129,"db_name":"supervise","question":"2023年第三季度，哪些金融机构的监管...
处理第 933 行, 长度: 12488
行内容(截断): {"id":3593789396,"db_name":"supervise","question":"哪家机构的风险加权资产密度（风险...
处理第 934 行, 长度: 22458
行内容(截断): {"id":3734281326,"db_name":"supervise","question":"查询流动性比率表中流动性覆盖率和...
处理第 935 行, 长度: 9451
行内容(截断): {"id":2976622725,"db_name":"supervise","question":"哪些机构在2023年12月提交的合规记录...
处理第 936 行, 长度: 14754
行内容(截断): {"id":3196242817,"db_name":"supervise","question":"查询2024年所有机构的贷款总额及其对...
处理第 937 行, 长度: 9379
行内容(截断): {"id":1889616376,"db_name":"supervise","question":"查找报告日期为2039年6月8日的资产负...
处理第 938 行, 长度: 7097
行内容(截断): {"id":453935379,"db_name":"supervise","question":"不良贷款率超过3%的机构有多少家？","...
处理第 939 行, 长度: 13207
行内容(截断): {"id":44191459,"db_name":"supervise","question":"查询2023年3月1日的净利息收入和非利息...
处理第 940 行, 长度: 4303
行内容(截断): {"id":584013962,"db_name":"supervise","question":"查询不良贷款表中不良贷款金额与贷...
处理第 941 行, 长度: 10433
行内容(截断): {"id":2733428482,"db_name":"supervise","question":"在2023年提交的监管报告中，哪些金融...
处理第 942 行, 长度: 13390
行内容(截断): {"id":951459633,"db_name":"supervise","question":"2023年10月1日，哪些金融机构提交了半...
处理第 943 行, 长度: 10801
行内容(截断): {"id":1829456676,"db_name":"supervise","question":"注册资本最高的五家非银行金融机构...
处理第 944 行, 长度: 10640
行内容(截断): {"id":1953695337,"db_name":"supervise","question":"总资产排名前500的机构中，有多少家...
处理第 945 行, 长度: 12565
行内容(截断): {"id":1414930652,"db_name":"supervise","question":"2023年12月1日，哪些金融机构的资本充...
处理第 946 行, 长度: 16910
行内容(截断): {"id":364214965,"db_name":"supervise","question":"过去两年中，营业收入增长率最高但...
处理第 947 行, 长度: 10991
行内容(截断): {"id":419882166,"db_name":"supervise","question":"获取2023年7月1日的监管报告及其审批...
处理第 948 行, 长度: 18980
行内容(截断): {"id":3742684421,"db_name":"supervise","question":"哪些机构的核心一级资本充足率、一...
处理第 949 行, 长度: 35290
行内容(截断): {"id":2448874069,"db_name":"supervise","question":"查找2023年提交的合规记录中状态为'...
处理第 950 行, 长度: 5779
行内容(截断): {"id":3679648301,"db_name":"supervise","question":"2023年第三季度提交的监管报告中，哪...
处理第 951 行, 长度: 16964
行内容(截断): {"id":293590145,"db_name":"supervise","question":"获取所有机构的资本充足率表中一级...
处理第 952 行, 长度: 21101
行内容(截断): {"id":685587392,"db_name":"supervise","question":"获取流动性覆盖率高于100%的机构名称...
处理第 953 行, 长度: 11529
行内容(截断): {"id":727742801,"db_name":"supervise","question":"找出在过去两年中，资产负债率波动...
处理第 954 行, 长度: 58309
行内容(截断): {"id":3429671168,"db_name":"supervise","question":"查看2023年03月的所有合规记录及其严...
处理第 955 行, 长度: 8792
行内容(截断): {"id":3200376501,"db_name":"supervise","question":"查询2024年提交的所有机构的合规记录...
处理第 956 行, 长度: 15212
行内容(截断): {"id":1891907399,"db_name":"supervise","question":"获取2023年10月1日所有机构的监管报告...
处理第 957 行, 长度: 56032
行内容(截断): {"id":11596427,"db_name":"supervise","question":"查找2023年所有合规记录中严重程度为'...
处理第 958 行, 长度: 13523
行内容(截断): {"id":3129849565,"db_name":"supervise","question":"查询2023年10月1日的所有合规记录及其...
处理第 959 行, 长度: 5470
行内容(截断): {"id":3154891263,"db_name":"supervise","question":"哪些机构的流动性覆盖率、净稳定资...
处理第 960 行, 长度: 20216
行内容(截断): {"id":1874414819,"db_name":"supervise","question":"列出2023年第三季度提交的所有监管报...
处理第 961 行, 长度: 763
行内容(截断): {"id":495816064,"db_name":"supervise","question":"资本充足率处于行业后25%的机构中，...
处理第 962 行, 长度: 13475
行内容(截断): {"id":4161304037,"db_name":"supervise","question":"获取所有金融机构的注册资本与机构...
处理第 963 行, 长度: 13999
行内容(截断): {"id":1631317162,"db_name":"supervise","question":"获取所有金融机构的成立日期和法定...
处理第 964 行, 长度: 60794
行内容(截断): {"id":2784626903,"db_name":"supervise","question":"查询所有机构的合规记录中状态为已...
处理第 965 行, 长度: 17650
行内容(截断): {"id":1450759690,"db_name":"supervise","question":"2023年7月，哪些金融机构的监管报告...
处理第 966 行, 长度: 17552
行内容(截断): {"id":862814083,"db_name":"supervise","question":"哪家机构的贷款和垫款与存款的比值...
处理第 967 行, 长度: 14003
行内容(截断): {"id":2681992996,"db_name":"supervise","question":"查询不良贷款表中贷款总额超过1000亿...
处理第 968 行, 长度: 6194
行内容(截断): {"id":3797835240,"db_name":"supervise","question":"获取2026年4月27日的资产负债表中现金...
处理第 969 行, 长度: 18170
行内容(截断): {"id":788537141,"db_name":"supervise","question":"哪些机构的核心一级资本充足率低于9%...
处理第 970 行, 长度: 24538
行内容(截断): {"id":2511418954,"db_name":"supervise","question":"在2023年提交的监管报告中，哪些金融...
处理第 971 行, 长度: 7132
行内容(截断): {"id":133973236,"db_name":"supervise","question":"风险加权资产占总资产比例最高的十...
处理第 972 行, 长度: 17743
行内容(截断): {"id":580723534,"db_name":"supervise","question":"平均每家金融机构的分支机构数量是...
处理第 973 行, 长度: 19286
行内容(截断): {"id":627590872,"db_name":"supervise","question":"哪些机构的市场风险暴露占比超过20%...
处理第 974 行, 长度: 17835
行内容(截断): {"id":3208012990,"db_name":"supervise","question":"2023年12月1日，哪些金融机构的核心一...
处理第 975 行, 长度: 6746
行内容(截断): {"id":377707744,"db_name":"supervise","question":"2023年发生的严重程度为\"高\"的合规问...
处理第 976 行, 长度: 7538
行内容(截断): {"id":2467976254,"db_name":"supervise","question":"现金及现金等价物占总资产比例最高...
处理第 977 行, 长度: 13474
行内容(截断): {"id":416448494,"db_name":"supervise","question":"市场风险暴露占总风险暴露比例超过40...
处理第 978 行, 长度: 60528
行内容(截断): {"id":1582694445,"db_name":"supervise","question":"2023年监管报告中，哪些机构的信息披...
处理第 979 行, 长度: 23311
行内容(截断): {"id":3631241992,"db_name":"supervise","question":"在2023年，哪些金融机构的资本充足率...
处理第 980 行, 长度: 30458
行内容(截断): {"id":3632342709,"db_name":"supervise","question":"查询2024年1月所有机构的操作风险暴...
处理第 981 行, 长度: 15989
行内容(截断): {"id":2274602916,"db_name":"supervise","question":"获取2023年4月2日的合规记录及其严重...
处理第 982 行, 长度: 50606
行内容(截断): {"id":3547022021,"db_name":"supervise","question":"不良贷款率的变化趋势是否领先于或...
处理第 983 行, 长度: 14824
行内容(截断): {"id":4106988075,"db_name":"supervise","question":"查找各机构的拨备覆盖率，要求大于1...
处理第 984 行, 长度: 16374
行内容(截断): {"id":1714782457,"db_name":"supervise","question":"获取2023年12月22日的所有关联交易记...
处理第 985 行, 长度: 12731
行内容(截断): {"id":663454855,"db_name":"supervise","question":"哪些金融机构的流动性覆盖率高于110%...
处理第 986 行, 长度: 30817
行内容(截断): {"id":1930062711,"db_name":"supervise","question":"在2023年提交的监管报告中，哪些机构...
处理第 987 行, 长度: 11246
行内容(截断): {"id":166707732,"db_name":"supervise","question":"过去两年中，平均净利润率（净利润/...
处理第 988 行, 长度: 6327
行内容(截断): {"id":833967887,"db_name":"supervise","question":"2023年，各类型金融机构的平均不良贷...
处理第 989 行, 长度: 15197
行内容(截断): {"id":4204116228,"db_name":"supervise","question":"有多少家金融机构的市场风险暴露增...
处理第 990 行, 长度: 19423
行内容(截断): {"id":771560804,"db_name":"supervise","question":"获取资产负债表中所有机构的总资产...
处理第 991 行, 长度: 4690
行内容(截断): {"id":1414769749,"db_name":"supervise","question":"2023年7月，哪些金融机构的监管报告...
处理第 992 行, 长度: 9595
行内容(截断): {"id":2946947084,"db_name":"supervise","question":"总资产超过1万亿元的机构中，平均资...
处理第 993 行, 长度: 36292
行内容(截断): {"id":68375114,"db_name":"supervise","question":"查询2023年10月1日的所有风险暴露表记...
处理第 994 行, 长度: 15217
行内容(截断): {"id":1086344523,"db_name":"supervise","question":"2023年6月1日，哪些金融机构的关联交...
处理第 995 行, 长度: 8720
行内容(截断): {"id":1266365033,"db_name":"supervise","question":"总资产规模与资本充足率之间是否存...
处理第 996 行, 长度: 16398
行内容(截断): {"id":152560977,"db_name":"supervise","question":"2023年，哪些金融机构的关联交易审批...
处理第 997 行, 长度: 8600
行内容(截断): {"id":3829846580,"db_name":"supervise","question":"2023年7月1日，哪些金融机构的监管报...
处理第 998 行, 长度: 24261
行内容(截断): {"id":3809349460,"db_name":"supervise","question":"查找2023年中各机构的审批状态和合规...
处理第 999 行, 长度: 19640
行内容(截断): {"id":3887529815,"db_name":"supervise","question":"在2023年10月1日，哪些金融机构的监管...
处理第 1000 行, 长度: 12550
行内容(截断): {"id":1095324516,"db_name":"supervise","question":"查询所有机构在2023年5月的流动性覆...
处理第 1001 行, 长度: 13117
行内容(截断): {"id":2608079409,"db_name":"supervise","question":"统计各机构2023年3月1日的非利息收入...
处理第 1002 行, 长度: 33041
行内容(截断): {"id":1384996686,"db_name":"supervise","question":"获取所有机构在2023年2月1日的风险暴...
处理第 1003 行, 长度: 7884
行内容(截断): {"id":2903384914,"db_name":"supervise","question":"2023年，关联交易金额超过5亿元且为\"...
处理第 1004 行, 长度: 9538
行内容(截断): {"id":1640671061,"db_name":"supervise","question":"2023年8月1日，哪些金融机构的监管报...
处理第 1005 行, 长度: 23036
行内容(截断): {"id":3904574419,"db_name":"supervise","question":"在2023年提交的所有监管报告中，哪些...
处理第 1006 行, 长度: 8266
行内容(截断): {"id":493525183,"db_name":"supervise","question":"2023年7月1日，哪些金融机构提交了季...
处理第 1007 行, 长度: 33159
行内容(截断): {"id":3146074594,"db_name":"supervise","question":"查询所有机构的合规记录中合规类型...
处理第 1008 行, 长度: 11317
行内容(截断): {"id":2337714646,"db_name":"supervise","question":"2023年10月，哪些金融机构的监管报告...
处理第 1009 行, 长度: 8940
行内容(截断): {"id":2791588181,"db_name":"supervise","question":"各机构类型中，不良贷款率的中位数...
处理第 1010 行, 长度: 10154
行内容(截断): {"id":833263523,"db_name":"supervise","question":"查询资本充足率表中核心一级资本充...
处理第 1011 行, 长度: 45513
行内容(截断): {"id":3179741002,"db_name":"supervise","question":"在2023年提交的监管报告中，哪些金融...
处理第 1012 行, 长度: 6336
行内容(截断): {"id":2065261887,"db_name":"supervise","question":"2023年6月1日，哪些金融机构的关联交...
处理第 1013 行, 长度: 10701
行内容(截断): {"id":2360476437,"db_name":"supervise","question":"哪些机构的存贷比高于行业平均水平...
处理第 1014 行, 长度: 12989
行内容(截断): {"id":1635102268,"db_name":"supervise","question":"在2023年4月1日，哪些机构的利息净收...
处理第 1015 行, 长度: 22841
行内容(截断): {"id":890576370,"db_name":"supervise","question":"在2023年提交的所有监管报告中，哪些...
处理第 1016 行, 长度: 17748
行内容(截断): {"id":1878253672,"db_name":"supervise","question":"2023年10月1日，哪些金融机构的总风险...
处理第 1017 行, 长度: 11428
行内容(截断): {"id":860852233,"db_name":"supervise","question":"有多少家金融机构的市场风险暴露和...
处理第 1018 行, 长度: 12089
行内容(截断): {"id":3387337626,"db_name":"supervise","question":"哪些机构的贷款总额超过其存款总额...
处理第 1019 行, 长度: 35337
行内容(截断): {"id":1310122613,"db_name":"supervise","question":"在2023年提交的所有监管报告中，哪些...
处理第 1020 行, 长度: 10577
行内容(截断): {"id":663309404,"db_name":"supervise","question":"哪些机构在2023年4月1日的非利息收入...
处理第 1021 行, 长度: 9869
行内容(截断): {"id":3052564664,"db_name":"supervise","question":"过去一年中，哪家机构的关联交易笔...
处理第 1022 行, 长度: 7895
行内容(截断): {"id":3564915606,"db_name":"supervise","question":"哪家机构的信用风险暴露占总风险暴...
处理第 1023 行, 长度: 8965
行内容(截断): {"id":197691923,"db_name":"supervise","question":"找出在2023年有风险暴露记录的所有机...
处理第 1024 行, 长度: 8758
行内容(截断): {"id":4129983532,"db_name":"supervise","question":"哪些机构的风险加权资产在2023年11月...
处理第 1025 行, 长度: 21855
行内容(截断): {"id":2233736633,"db_name":"supervise","question":"合规问题的解决时间与问题的严重程...
处理第 1026 行, 长度: 8792
行内容(截断): {"id":2305237654,"db_name":"supervise","question":"流动性覆盖率和净稳定资金比例都高...
处理第 1027 行, 长度: 13625
行内容(截断): {"id":2186326450,"db_name":"supervise","question":"总资产排名前1000的机构中，平均不良...
处理第 1028 行, 长度: 20667
行内容(截断): {"id":2638456489,"db_name":"supervise","question":"2023年7月1日，哪些金融机构的监管报...
处理第 1029 行, 长度: 21242
行内容(截断): {"id":3113756288,"db_name":"supervise","question":"2024年1月1日，哪些金融机构的监管报...
处理第 1030 行, 长度: 28049
行内容(截断): {"id":1220868379,"db_name":"supervise","question":"流动性指标与资产负债结构（如贷存...
处理第 1031 行, 长度: 12798
行内容(截断): {"id":576576905,"db_name":"supervise","question":"在2023年12月，不良贷款率超过1.5%的机...
处理第 1032 行, 长度: 13302
行内容(截断): {"id":4037291156,"db_name":"supervise","question":"贷存比超过75%且流动性覆盖率低于120%...
处理第 1033 行, 长度: 10995
行内容(截断): {"id":163054391,"db_name":"supervise","question":"获取监管报告中报告类型为半年度报...
处理第 1034 行, 长度: 12309
行内容(截断): {"id":3390154129,"db_name":"supervise","question":"合规问题解决用时最长的五个案例是...
处理第 1035 行, 长度: 39329
行内容(截断): {"id":1510688156,"db_name":"supervise","question":"在2023年提交的所有监管报告中，哪些...
处理第 1036 行, 长度: 26272
行内容(截断): {"id":776982448,"db_name":"supervise","question":"在2023年提交的所有监管报告中，哪些...
处理第 1037 行, 长度: 6129
行内容(截断): {"id":3735593182,"db_name":"supervise","question":"哪些机构的贷款与存款比率在60%到80%...
处理第 1038 行, 长度: 9583
行内容(截断): {"id":1403047777,"db_name":"supervise","question":"核心一级资本充足率与总资本充足率...
处理第 1039 行, 长度: 19238
行内容(截断): {"id":2008864858,"db_name":"supervise","question":"展示2024年所有机构的总负债及其注册...
处理第 1040 行, 长度: 8681
行内容(截断): {"id":4061107202,"db_name":"supervise","question":"信用风险暴露与不良贷款率之间是否...
处理第 1041 行, 长度: 13611
行内容(截断): {"id":1821132508,"db_name":"supervise","question":"在2023年，哪些金融机构的年度报告已...
处理第 1042 行, 长度: 11512
行内容(截断): {"id":1128459706,"db_name":"supervise","question":"获取2023年6月1日不良贷款表中不良贷...
成功加载 1042 条记录
成功加载 1042 个结果
执行查询: ID=3457299966, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-13' AND d.name = '客户服务部' AND (a.check_out - a.check_in) > '15:00:00';
执行预测SQL: SELECT 
    e.name AS name,
    e.employee_id AS employee_id,
    a.check_in AS check_in,
    a.check_out AS check_out
FROM 
    attendance_records a
JOIN employees e ON a.employee_id = e.employee_id
JOIN departments d ON e.department_id = d.id
WHERE 
    a.date = '2024-10-13'
    AND d.name = '客户服务部'
    AND (a.check_out - a.check_in) > INTERVAL '15 hours'
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=1044893251, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-11' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-11' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 478
预测SQL执行成功，行数: 478
执行查询: ID=3626797096, DB=hr
执行标准SQL: SELECT COUNT(*) FROM attendance_records WHERE employee_id = 'H03961' AND date >= '2024-01-01' AND date <= '2024-12-31' AND check_in > '09:00:00';
执行预测SQL: SELECT COUNT(DISTINCT date) AS count FROM attendance_records WHERE employee_id = 'H03961' AND date BETWEEN '2024-01-01' AND '2024-12-31' AND check_in > '09:00:00'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=207527642, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-24' AND a.check_in < '08:30:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-09-24' AND a.check_in < '08:30:00' AND pe.rating = 'A+'
标准SQL执行成功，行数: 411
预测SQL执行成功，行数: 411
执行查询: ID=4093748071, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-05';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, ar.check_in, ar.check_out 
FROM attendance_records ar
JOIN employees e ON ar.employee_id = e.employee_id
JOIN departments d ON e.department_id = d.department_id
WHERE ar.date = '2024-10-05'
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=4123999737, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-21' ORDER BY d.name;
执行预测SQL: SELECT e.name AS name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-21' ORDER BY d.name
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=560968712, DB=hr
执行标准SQL: SELECT COUNT(*) FILTER (WHERE end_date - start_date < 90 AND status = '离职') / COUNT(*) * 100 AS离职比例 FROM probation_employees;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2123418406, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-08' AND d.name = '客户服务部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '客户服务部' 
AND a.date = '2024-10-08' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 461
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回461行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=2685336973, DB=hr
执行标准SQL: SELECT e.name, e.hire_date FROM employees e JOIN probation_employees p ON e.employee_id = p.employee_id WHERE p.status = '在职';
执行预测SQL: SELECT e.name AS name, e.hire_date AS hire_date FROM probation_employees p JOIN employees e ON p.employee_id = e.employee_id
标准SQL执行成功，行数: 2268
预测SQL执行成功，行数: 6645

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2268行, 预测SQL返回6645行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name hire_date]
[35m预测SQL列:[0m [name hire_date]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [郑静 2023-10-13 00:00:00 +0000 +0000]
[35m预测[1]:[0m [王秀英 2016-07-30 00:00:00 +0000 +0000]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [李静 2021-05-16 00:00:00 +0000 +0000]
[35m预测[2]:[0m [张丽 2014-11-22 00:00:00 +0000 +0000]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [郑秀英 2010-03-27 00:00:00 +0000 +0000]
[35m预测[3]:[0m [赵敏 2015-05-10 00:00:00 +0000 +0000]
执行查询: ID=1786804299, DB=hr
执行标准SQL: SELECT d.name AS department_name, e.name AS employee_name, a.check_in, e.remaining_annual_leave FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-22' AND a.check_in > '09:00:00' AND e.remaining_annual_leave < 5;
执行预测SQL: SELECT d.name AS department_name, e.name AS employee_name, a.check_in, e.remaining_annual_leave FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-22' AND a.check_in > '09:00:00' AND e.remaining_annual_leave < 5
已处理 10/1042 个查询...
执行查询: ID=187164736, DB=hr
执行标准SQL: SELECT e.name, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE e.hire_date >= '2023-01-01' AND e.hire_date < '2024-01-01' AND a.date = '2024-10-05';
执行预测SQL: SELECT e.name AS name, pe.rating AS rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE e.hire_date >= '2023-01-01' AND e.hire_date < '2024-01-01' AND a.date = '2024-10-05'
标准SQL执行成功，行数: 667
预测SQL执行成功，行数: 667
执行查询: ID=16656251, DB=hr
执行标准SQL: SELECT e.name, e.hire_date, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE e.hire_date >= '2023-01-01' AND e.hire_date < '2024-01-01' AND a.date = '2024-09-26';
执行预测SQL: SELECT e.name AS name, e.hire_date AS hire_date, pe.rating AS rating 
FROM employees e 
JOIN attendance_records ar ON e.employee_id = ar.employee_id 
JOIN performance_evaluations pe ON e.employee_id = pe.employee_id 
WHERE EXTRACT(YEAR FROM e.hire_date) = 2023 
AND ar.date = '2024-09-26'
标准SQL执行成功，行数: 667
预测SQL执行成功，行数: 667
执行查询: ID=3745687130, DB=hr
执行标准SQL: SELECT COUNT(*) FROM attendance_records WHERE employee_id = 'H05598' AND date >= '2024-01-01' AND date <= '2024-12-31' AND check_out < '18:00:00';
执行预测SQL: SELECT COUNT(DISTINCT date) AS count FROM attendance_records WHERE employee_id = 'H05598' AND date >= '2024-01-01' AND date <= '2024-12-31' AND check_out < '18:00:00'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=2706374430, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-28' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-28' AND a.check_in > '09:00'
标准SQL执行成功，行数: 4963
预测SQL执行成功，行数: 4963
执行查询: ID=1934436050, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-12' AND a.check_in > '09:00:00' AND d.name = '运营部';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '运营部' AND a.date = '2024-10-12' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 490
预测SQL执行成功，行数: 490
执行查询: ID=3074190923, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-11' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-11' AND ar.check_in > '09:00:00'
执行查询: ID=511554832, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-21' AND d.name = '销售部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '销售部' 
AND a.date = '2024-09-21' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 502
预测SQL执行成功，行数: 502
执行查询: ID=2699770862, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-12-11' AND pe.rating = 'C';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name 
FROM performance_evaluations pe 
JOIN employees e ON pe.employee_id = e.employee_id 
JOIN departments d ON e.department_id = d.department_id 
WHERE pe.evaluation_date = '2023-12-11' AND pe.rating = 'C'
执行查询: ID=2054121283, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-22' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-22' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 4912
预测SQL执行成功，行数: 4912
执行查询: ID=1458867293, DB=hr
执行标准SQL: SELECT a.employee_id, e.name, a.award_name, pe.rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2023 AND a.award_name = '创新奖' AND pe.rating = 'A+';
执行预测SQL: SELECT a.employee_id AS employee_id, e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.year = 2023 AND a.award_name = '创新奖' AND pe.rating = 'A+'
标准SQL执行成功，行数: 9
预测SQL执行成功，行数: 9
已处理 20/1042 个查询...
执行查询: ID=3998131614, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '客户服务部' AND a.date = '2024-10-09' AND a.check_in > '08:30:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '客户服务部' AND a.date = '2024-10-09' AND a.check_in > '08:30:00'
标准SQL执行成功，行数: 728
预测SQL执行成功，行数: 728
执行查询: ID=3232263409, DB=hr
执行标准SQL: SELECT COUNT(DISTINCT pe.employee_id) FROM probation_employees pe JOIN awards a ON pe.employee_id = a.employee_id WHERE pe.status = '在职' AND a.award_name = '优秀员工' AND a.year = 2023;
执行预测SQL: SELECT COUNT(DISTINCT a.employee_id) AS count FROM awards a JOIN probation_employees p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '优秀员工奖' AND p.start_date <= '2023-12-31' AND (p.end_date >= '2023-01-01' OR p.end_date IS NULL)
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [count]
[35m预测SQL列:[0m [count]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [13]
[35m预测[1]:[0m [0]
执行查询: ID=3292642794, DB=hr
执行标准SQL: SELECT e.name, a.award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id WHERE e.hire_date BETWEEN '2021-01-01' AND '2021-12-31' AND a.year = 2022;
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id WHERE EXTRACT(YEAR FROM e.hire_date) = 2021 AND a.year = 2022
标准SQL执行成功，行数: 158
预测SQL执行成功，行数: 158
执行查询: ID=1309577663, DB=hr
执行标准SQL: SELECT employee_id FROM attendance_records GROUP BY employee_id HAVING COUNT(DISTINCT date) > 1;
执行预测SQL: SELECT employee_id FROM attendance_records GROUP BY employee_id HAVING COUNT(DISTINCT date) > 1
执行查询: ID=3488243740, DB=hr
执行标准SQL: SELECT d.name AS department_name, e.name AS employee_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-24' AND ar.check_in > '09:30:00' AND e.remaining_annual_leave < 10;
执行预测SQL: SELECT d.name AS department_name, e.name AS employee_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-24' AND a.check_in > '09:30:00' AND e.remaining_annual_leave < 10
标准SQL执行成功，行数: 1534
预测SQL执行成功，行数: 1534
执行查询: ID=651157477, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-19' AND d.name = '销售部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '销售部' 
AND a.date = '2024-09-19' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 487
预测SQL执行成功，行数: 487
执行查询: ID=53102733, DB=hr
执行标准SQL: SELECT d.name AS department_name, e.name AS employee_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-09-26' AND ar.check_in > '09:00:00' AND pe.rating = 'C';
执行预测SQL: SELECT d.name AS department_name, e.name AS employee_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-09-26' AND ar.check_in > '09:00:00' AND pe.rating = 'C'
执行查询: ID=3108523290, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE e.hire_date >= '2021-01-01' AND e.hire_date < '2022-01-01' AND a.year = 2021 AND pe.rating = 'B';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE EXTRACT(YEAR FROM e.hire_date) = 2021 AND a.year = 2021 AND pe.rating = 'B'
标准SQL执行成功，行数: 38
预测SQL执行成功，行数: 38
执行查询: ID=840538968, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '销售部' AND a.date = '2024-10-03' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '销售部' 
AND a.date = '2024-10-03' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 508
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回508行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3192644686, DB=hr
执行标准SQL: SELECT e.name, p.status FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN probation_employees p ON e.employee_id = p.employee_id WHERE a.year = 2020 AND a.award_name = '优秀员工' AND p.status = '在职';
执行预测SQL: SELECT e.name AS name, p.status AS status FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN probation_employees p ON e.employee_id = p.employee_id WHERE a.year = 2020 AND a.award_name = '优秀员工' AND p.status = '在职'
标准SQL执行成功，行数: 13
预测SQL执行成功，行数: 13
已处理 30/1042 个查询...
执行查询: ID=1597119407, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE e.hire_date >= '2023-01-01' AND e.hire_date < '2024-01-01' AND a.year = 2023 AND pe.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE EXTRACT(YEAR FROM e.hire_date) = 2023 AND a.year = 2023 AND pe.rating = 'A+'
标准SQL执行成功，行数: 51
预测SQL执行成功，行数: 51
执行查询: ID=3355699316, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN probation_employees p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-19' AND p.status = '在职';
执行预测SQL: SELECT e.name AS name, d.name AS department_name, a.check_in, a.check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN probation_employees p ON e.employee_id = p.employee_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE a.date = '2024-09-19' 
AND p.end_date >= '2024-09-19' 
AND p.start_date <= '2024-09-19'
标准SQL执行成功，行数: 2268
预测SQL执行成功，行数: 126

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2268行, 预测SQL返回126行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [check_out name department_name check_in]
[35m预测SQL列:[0m [name department_name check_in check_out]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [0000-01-01 20:47:43 +0000 UTC 郑静 人力资源部 0000-01-01 09:37:50 +0000 UTC]
[35m预测[1]:[0m [吴磊 法务部 0000-01-01 08:38:15 +0000 UTC 0000-01-01 20:39:57 +0000 UTC]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [0000-01-01 18:53:16 +0000 UTC 李静 人力资源部 0000-01-01 08:05:37 +0000 UTC]
[35m预测[2]:[0m [赵强 客户服务部 0000-01-01 09:54:46 +0000 UTC 0000-01-01 23:43:42 +0000 UTC]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [0000-01-01 22:09:55 +0000 UTC 郑秀英 行政部 0000-01-01 08:30:48 +0000 UTC]
[35m预测[3]:[0m [李丽 法务部 0000-01-01 09:48:08 +0000 UTC 0000-01-01 22:22:44 +0000 UTC]
执行查询: ID=1396580707, DB=hr
执行标准SQL: SELECT e.employee_id, e.name, e.hire_date, e.remaining_annual_leave, COUNT(a.id) AS days_used_annual_leave
FROM employees e
LEFT JOIN attendance_records a ON e.employee_id = a.employee_id
GROUP BY e.employee_id, e.name, e.hire_date, e.remaining_annual_leave;
执行预测SQL: SELECT e.employee_id AS employee_id, e.name AS name, e.hire_date AS hire_date, e.remaining_annual_leave AS remaining_annual_leave, (15 - e.remaining_annual_leave) AS days_used_annual_leave FROM employees e
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_id name hire_date remaining_annual_leave days_used_annual_leave]
[35m预测SQL列:[0m [hire_date remaining_annual_leave days_used_annual_leave employee_id name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [H00346 孙娜 2012-03-02 00:00:00 +0000 +0000 10 30]
[35m预测[1]:[0m [2013-12-02 00:00:00 +0000 +0000 15 0 H00001 吴芳]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [H05777 郑丽 2020-11-16 00:00:00 +0000 +0000 0 30]
[35m预测[2]:[0m [2021-04-15 00:00:00 +0000 +0000 15 0 H00002 李军]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [H04368 周伟 2017-10-13 00:00:00 +0000 +0000 0 30]
[35m预测[3]:[0m [2014-07-11 00:00:00 +0000 +0000 15 0 H00003 钱娜]
执行查询: ID=2385394779, DB=hr
执行标准SQL: SELECT e.name, a.date, a.check_in, a.check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN awards aw ON e.employee_id = aw.employee_id WHERE aw.year = 2022 AND aw.award_name = '技术突破奖' AND EXTRACT(HOUR FROM (a.check_out - a.check_in)) >= 10;
执行预测SQL: SELECT e.name AS name, a.date AS date, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE e.employee_id IN (
    SELECT employee_id 
    FROM awards 
    WHERE year = 2022 AND award_name = '技术突破奖'
) 
AND ( 
    (a.date::timestamp + a.check_out::time) 
    - (a.date::timestamp + a.check_in::time) 
) > INTERVAL '10 hours'
标准SQL执行成功，行数: 2283
预测SQL执行成功，行数: 2283
执行查询: ID=3598287205, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-20' AND d.name = '质量控制部' AND EXTRACT(HOUR FROM (a.check_out - a.check_in)) > 8;
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '质量控制部' 
AND a.date = '2024-09-20' 
AND (a.date::timestamp + a.check_out::time) - (a.date::timestamp + a.check_in::time) > INTERVAL '8 hours'
标准SQL执行成功，行数: 684
预测SQL执行成功，行数: 770

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回684行, 预测SQL返回770行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [check_in check_out name employee_id]
[35m预测SQL列:[0m [check_in check_out name employee_id]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [0000-01-01 08:17:08 +0000 UTC 0000-01-01 23:34:16 +0000 UTC 李军 H00002]
[35m预测[1]:[0m [0000-01-01 08:17:08 +0000 UTC 0000-01-01 23:34:16 +0000 UTC 李军 H00002]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [0000-01-01 08:26:45 +0000 UTC 0000-01-01 23:21:28 +0000 UTC 赵秀英 H00057]
[35m预测[2]:[0m [0000-01-01 08:26:45 +0000 UTC 0000-01-01 23:21:28 +0000 UTC 赵秀英 H00057]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [0000-01-01 08:21:44 +0000 UTC 0000-01-01 20:32:39 +0000 UTC 吴丽 H00062]
[35m预测[3]:[0m [0000-01-01 08:21:44 +0000 UTC 0000-01-01 20:32:39 +0000 UTC 吴丽 H00062]
执行查询: ID=1157360763, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-09-25' AND e.university = '清华大学' AND a.check_in < '09:00:00';
执行预测SQL: SELECT e.name AS name FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-09-25' AND a.check_in < '09:00:00'
标准SQL执行成功，行数: 508
预测SQL执行成功，行数: 508
执行查询: ID=1456890377, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id JOIN (SELECT employee_id, AVG(EXTRACT(EPOCH FROM (check_out - check_in)) / 3600) AS avg_work_hours FROM attendance_records GROUP BY employee_id) a ON e.employee_id = a.employee_id WHERE pe.rating = 'A+' ORDER BY a.avg_work_hours DESC LIMIT 1;
执行预测SQL: SELECT e.name
FROM performance_evaluations pe
JOIN attendance_records a ON pe.employee_id = a.employee_id
JOIN employees e ON pe.employee_id = e.employee_id
WHERE pe.rating = 'A+'
GROUP BY pe.employee_id, e.name
ORDER BY (SUM(EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600) / COUNT(*)) DESC
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=455172185, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-04' AND d.name = '销售部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '销售部' 
AND a.date = '2024-10-04' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 503
预测SQL执行成功，行数: 503
执行查询: ID=4212530835, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-18' AND a.check_in > '09:00:00' AND p.rating = 'D';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.date = '2024-09-18' AND a.check_in > '09:00:00' AND pe.rating = 'D'
标准SQL执行成功，行数: 808
预测SQL执行成功，行数: 808
执行查询: ID=1240612673, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-25' AND a.check_in > '08:30:00' AND p.rating = 'B+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.date = '2024-09-25' AND a.check_in > '08:30:00' AND pe.rating = 'B+'
标准SQL执行成功，行数: 1190
预测SQL执行成功，行数: 1190
已处理 40/1042 个查询...
执行查询: ID=2857901445, DB=hr
执行标准SQL: SELECT * FROM interviews WHERE interview_date >= '2024-01-01' AND interview_date <= '2024-12-31' ORDER BY interview_count DESC;
执行预测SQL: SELECT id AS interview_id, employee_id, interview_date, interview_count AS interview_count FROM interviews WHERE EXTRACT(YEAR FROM interview_date) = 2024 ORDER BY interview_count DESC
标准SQL执行成功，行数: 468
预测SQL执行成功，行数: 468
执行查询: ID=71265646, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-10' AND a.check_in > '08:30:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, ar.check_in AS check_in, pe.rating AS rating FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-10-10' AND ar.check_in > '08:30:00' AND pe.rating = 'A+'
标准SQL执行成功，行数: 1211
预测SQL执行成功，行数: 1211
执行查询: ID=2168264130, DB=hr
执行标准SQL: SELECT d.name AS department_name, e.name AS employee_name, a.check_in, e.remaining_annual_leave FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-27' AND a.check_in > '09:00:00' AND e.remaining_annual_leave < 10;
执行预测SQL: SELECT d.name AS department_name, e.name AS employee_name, a.check_in, e.remaining_annual_leave 
FROM attendance_records a 
JOIN employees e ON a.employee_id = e.employee_id 
JOIN departments d ON e.department_id = d.department_id 
WHERE a.date = '2024-09-27' 
AND a.check_in > '09:00:00' 
AND e.remaining_annual_leave < 10
执行查询: ID=1505285087, DB=hr
执行标准SQL: SELECT e.name, p.evaluation_date FROM employees e JOIN performance_evaluations p ON e.employee_id = p.employee_id;
执行预测SQL: SELECT e.name AS name, pe.evaluation_date AS evaluation_date FROM employees e LEFT JOIN performance_evaluations pe ON e.employee_id = pe.employee_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1736090929, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-07' AND a.check_in > '09:00:00' AND a.check_out < '17:00:00';
执行预测SQL: SELECT e.name AS name, d.name AS department_name, ar.check_in, ar.check_out FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-07' AND ar.check_in > '09:00:00' AND ar.check_out < '17:00:00'
标准SQL执行成功，行数: 1250
预测SQL执行成功，行数: 1250
执行查询: ID=816170327, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, ar.check_in, ar.check_out FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-05';
执行预测SQL: SELECT e.name AS name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-05'
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3913837113, DB=hr
执行标准SQL: SELECT e.department_id, AVG(i.interview_count) AS avg_interview_count FROM employees e JOIN interviews i ON e.employee_id = i.employee_id GROUP BY e.department_id ORDER BY avg_interview_count DESC LIMIT 1;
执行预测SQL: SELECT e.department_id AS department_id, AVG(COALESCE(i.interview_count, 0)) AS avg_interview_count FROM employees e LEFT JOIN interviews i ON e.employee_id = i.employee_id GROUP BY e.department_id ORDER BY avg_interview_count DESC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=578427607, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.date, a.check_in, a.check_out, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-27' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.employee_id AS employee_id, a.date AS date, a.check_in AS check_in, a.check_out AS check_out, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.date = '2024-09-27' AND pe.rating = 'A+'
标准SQL执行成功，行数: 1638
预测SQL执行成功，行数: 1638
执行查询: ID=2435455132, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN awards aw ON e.employee_id = aw.employee_id WHERE aw.award_name = '最佳团队奖' AND aw.year = 2024 AND a.date = '2024-10-09' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM employees e 
JOIN attendance_records a ON e.employee_id = a.employee_id 
JOIN awards aw ON e.employee_id = aw.employee_id 
WHERE aw.year = 2024 
AND aw.award_name = '最佳团队奖' 
AND a.date = '2024-10-09' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 36
预测SQL执行成功，行数: 36
执行查询: ID=801113743, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-14' AND a.check_in > '09:00:00' AND d.name = '质量控制部';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '质量控制部' 
AND a.date = '2024-10-14' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 510
预测SQL执行成功，行数: 510
已处理 50/1042 个查询...
执行查询: ID=879816496, DB=hr
执行标准SQL: SELECT e.name, a.check_out, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-24' AND a.check_out > '13:00:00' AND p.rating = 'B+';
执行预测SQL: SELECT e.name AS name, a.check_out AS check_out, pe.rating AS rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-09-24' AND a.check_out > '13:00:00' AND pe.rating = 'B+'
标准SQL执行成功，行数: 1247
预测SQL执行成功，行数: 1247
执行查询: ID=2367322111, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-08' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-08' AND ar.check_in > '09:00:00'
执行查询: ID=247458622, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, a.award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.year = 2022;
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, a.award_name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.year = 2022
标准SQL执行成功，行数: 1237
预测SQL执行成功，行数: 1237
执行查询: ID=570267133, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-12' AND a.check_in > '09:00:00' AND p.rating = 'D';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating 
FROM attendance_records a 
JOIN employees e ON a.employee_id = e.employee_id 
JOIN performance_evaluations pe ON e.employee_id = pe.employee_id 
WHERE a.date = '2024-10-12' 
AND a.check_in > '09:00:00' 
AND pe.rating = 'D'
标准SQL执行成功，行数: 770
预测SQL执行成功，行数: 770
执行查询: ID=137546085, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-13' AND a.check_in < '09:30:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-13' AND a.check_in < '09:30:00'
标准SQL执行成功，行数: 749
预测SQL执行成功，行数: 749
执行查询: ID=4072264422, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '客户服务部' AND a.date = '2024-09-22';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON d.id::text = e.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '客户服务部' AND a.date = '2024-09-22'
标准SQL执行成功，行数: 931
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回931行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=4121529769, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.award_name = '质量改进奖' AND a.year = 2023 AND pe.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.year = 2023 AND a.award_name = '质量改进奖' AND pe.rating = 'A+'
标准SQL执行成功，行数: 22
预测SQL执行成功，行数: 22
执行查询: ID=437939056, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-05' AND a.check_in > '08:30:00' AND d.manager_id = 'H05487';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-05' AND a.check_in > '08:30:00' AND d.manager_id = 'H05487'
标准SQL执行成功，行数: 785
预测SQL执行成功，行数: 785
执行查询: ID=2108794903, DB=hr
执行标准SQL: SELECT e.name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-02' AND d.name = '行政部' AND (a.check_out - a.check_in) > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '行政部门' 
AND a.date = '2024-10-02' 
AND (a.check_out::time - a.check_in::time) > INTERVAL '9 hours'
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=2803368869, DB=hr
执行标准SQL: SELECT d.name AS department_name, e.name AS employee_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-03-31' AND pe.rating = 'D';
执行预测SQL: SELECT DISTINCT e.name AS employee_name, d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-03-31' AND pe.rating = 'D'
标准SQL执行成功，行数: 2
预测SQL执行成功，行数: 2
已处理 60/1042 个查询...
执行查询: ID=408783378, DB=hr
执行标准SQL: SELECT name, car_plate FROM employees WHERE employee_type = '正式员工';
执行预测SQL: SELECT name AS employee_name, car_plate AS vehicle_plate FROM employees WHERE employee_type = '正式员工'
标准SQL执行成功，行数: 3355
预测SQL执行成功，行数: 3355
执行查询: ID=1719343281, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-19' AND d.name = '质量控制部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '质量控制部' AND a.date = '2024-09-19' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 498
预测SQL执行成功，行数: 498
执行查询: ID=2395193694, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '客户满意度奖' AND a.year = 2022 AND ar.date = '2024-10-12' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2022 AND a.award_name = '客户满意度奖' AND ar.date = '2024-10-12' AND ar.check_in > '09:00:00'
标准SQL执行成功，行数: 48
预测SQL执行成功，行数: 48
执行查询: ID=2461283805, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-11' AND a.check_in > '09:00:00' AND d.manager_id = 'H00842';
执行预测SQL: SELECT e.name AS name, a.employee_id AS employee_id, a.check_in AS check_in, d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-11' AND a.check_in > '09:00' AND d.manager_id = 'H00842'
标准SQL执行成功，行数: 480
预测SQL执行成功，行数: 480
执行查询: ID=1004841644, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.award_name = '领导力奖' AND a.year = 2023;
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.year = 2023 AND a.award_name = '领导力奖'
标准SQL执行成功，行数: 394
预测SQL执行成功，行数: 394
执行查询: ID=958025096, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN awards aw ON e.employee_id = aw.employee_id WHERE aw.award_name = '领导力奖' AND aw.year = 2023 AND a.date = '2024-10-09' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM awards aw JOIN employees e ON aw.employee_id = e.employee_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE aw.year = 2023 AND aw.award_name = '领导力奖' AND a.date = '2024-10-09' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 209
预测SQL执行成功，行数: 209
执行查询: ID=4156394932, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, d.manager_id FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-02' AND ar.check_in BETWEEN '09:00:00' AND '10:00:00' AND e.employee_type = '实习生';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, d.manager_id AS manager_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN probation_employees p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-02' AND a.check_in BETWEEN '09:00' AND '10:00'
标准SQL执行成功，行数: 1659
预测SQL执行成功，行数: 3308

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1659行, 预测SQL返回3308行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_name department_name manager_id]
[35m预测SQL列:[0m [employee_name department_name manager_id]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [张静 人力资源部 H05487]
[35m预测[1]:[0m [郑静 人力资源部 H05487]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [李静 人力资源部 H05487]
[35m预测[2]:[0m [张静 人力资源部 H05487]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [周娜 销售部 H03372]
[35m预测[3]:[0m [李静 人力资源部 H05487]
执行查询: ID=5535555, DB=hr
执行标准SQL: SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id GROUP BY d.name ORDER BY AVG(EXTRACT(YEAR FROM AGE(date('now'), e.birth_date))) DESC LIMIT 1;
执行预测SQL: SELECT d.name AS department_name, AVG(EXTRACT(YEAR FROM AGE(e.birth_date))) AS average_age 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
GROUP BY d.name 
ORDER BY average_age DESC 
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 列数不匹配: 标准SQL返回1列, 预测SQL返回2列
[1m分类结果:[0m [35m投影错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name]
[35m预测SQL列:[0m [department_name average_age]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [研发部]
[35m预测[1]:[0m [研发部 40.54775828460039]
执行查询: ID=1584866592, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-16' AND p.rating = 'C';
执行预测SQL: SELECT e.name AS name, a.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-16' AND p.rating = 'C'
标准SQL执行成功，行数: 1688
预测SQL执行成功，行数: 1688
执行查询: ID=4123927043, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-08' AND d.name = '研发部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.employee_id AS employee_id, a.check_in AS check_in
FROM attendance_records a
JOIN employees e ON a.employee_id = e.employee_id
JOIN departments d ON e.department_id = d.department_id
WHERE a.date = '2024-10-08'
AND a.check_in > TIME '09:00:00'
AND d.name = '研发部'
标准SQL执行成功，行数: 512
预测SQL执行成功，行数: 512
已处理 70/1042 个查询...
执行查询: ID=2642437739, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '财务部' AND a.date = '2024-09-20' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '财务部' 
AND a.date = '2024-09-20' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 506
预测SQL执行成功，行数: 506
执行查询: ID=1412040002, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '人力资源部' AND a.date = '2024-10-05' AND EXTRACT(HOUR FROM (a.check_out - a.check_in)) >= 8;
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '人力资源部' 
AND a.date = '2024-10-05' 
AND (a.check_out - a.check_in) > INTERVAL '8 hours'
标准SQL执行成功，行数: 772
预测SQL执行成功，行数: 772
执行查询: ID=467771706, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.date, a.check_in, a.check_out, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-14' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.employee_id AS employee_id, a.date AS date, a.check_in AS check_in, a.check_out AS check_out, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.date = '2024-10-14' AND pe.rating = 'A+'
标准SQL执行成功，行数: 1638
预测SQL执行成功，行数: 1638
执行查询: ID=416599650, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-27' AND d.name = '行政部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE a.date = '2024-09-27' 
AND a.check_in > '09:00:00' 
AND d.name = '行政部'
标准SQL执行成功，行数: 476
预测SQL执行成功，行数: 476
执行查询: ID=2074887228, DB=hr
执行标准SQL: SELECT d.name AS department_name, COUNT(e.employee_id) AS employee_count FROM departments d LEFT JOIN employees e ON d.department_id = e.department_id GROUP BY d.name;
执行预测SQL: SELECT d.name AS department_name, COUNT(e.id) AS employee_count FROM departments d LEFT JOIN employees e ON d.department_id = e.department_id GROUP BY d.name
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10
执行查询: ID=4204863942, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE pe.rating = 'A+' ORDER BY e.hire_date DESC LIMIT 1;
执行预测SQL: SELECT e.name FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE pe.rating = 'A+' ORDER BY e.hire_date ASC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name]
[35m预测SQL列:[0m [name]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [吴秀英]
[35m预测[1]:[0m [孙静]
执行查询: ID=603993474, DB=hr
执行标准SQL: SELECT e.employee_id, e.name, e.department_id, a.total_hours, d.avg_hours, ABS(a.total_hours - d.avg_hours) AS difference
FROM (
    SELECT employee_id, SUM(EXTRACT(EPOCH FROM (check_out - check_in)) / 3600) AS total_hours
    FROM attendance_records
    GROUP BY employee_id
) a
JOIN employees e ON a.employee_id = e.employee_id
JOIN (
    SELECT e.department_id, AVG(a.total_hours) AS avg_hours
    FROM (
        SELECT employee_id, SUM(EXTRACT(EPOCH FROM (check_out - check_in)) / 3600) AS total_hours
        FROM attendance_records
        GROUP BY employee_id
    ) a
    JOIN employees e ON a.employee_id = e.employee_id
    GROUP BY e.department_id
) d ON e.department_id = d.department_id
ORDER BY difference DESC;
执行预测SQL: SELECT 
    e.employee_id,
    e.name,
    e.department_id,
    eh.total_hours,
    da.avg_hours,
    (eh.total_hours - da.avg_hours) AS difference
FROM employees e
JOIN (
    SELECT 
        employee_id,
        SUM(EXTRACT(EPOCH FROM (check_out - check_in)) / 3600) AS total_hours
    FROM attendance_records
    GROUP BY employee_id
) eh ON e.employee_id = eh.employee_id
JOIN (
    SELECT 
        d.id AS department_id,
        AVG(eh.total_hours) AS avg_hours
    FROM departments d
    JOIN employees e ON d.id = e.department_id
    JOIN (
        SELECT 
            employee_id,
            SUM(EXTRACT(EPOCH FROM (check_out - check_in)) / 3600) AS total_hours
        FROM attendance_records
        GROUP BY employee_id
    ) eh ON e.employee_id = eh.employee_id
    GROUP BY d.id
) da ON e.department_id = da.department_id
ORDER BY ABS(difference) DESC
预测SQL执行错误: SQL执行失败: pq: operator does not exist: integer = character varying
预测SQL执行错误: SQL执行失败: pq: operator does not exist: integer = character varying
执行查询: ID=4133405205, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out, (a.check_out - a.check_in) AS work_duration FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-05' AND d.name = '研发部' AND (a.check_out - a.check_in) > '10:00:00';
执行预测SQL: SELECT e.name AS name, a.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out, EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600 AS work_duration FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-05' AND d.name = '研发部' AND EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600 > 10
标准SQL执行成功，行数: 558
预测SQL执行成功，行数: 558

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [work_duration name employee_id check_in check_out]
[35m预测SQL列:[0m [name employee_id check_in check_out work_duration]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [14 李强 H00009 0000-01-01 09:20:17 +0000 UTC 0000-01-01 23:27:16 +0000 UTC]
[35m预测[1]:[0m [李强 H00009 0000-01-01 09:20:17 +0000 UTC 0000-01-01 23:27:16 +0000 UTC 14.116388888888888]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [14 王强 H00018 0000-01-01 08:48:35 +0000 UTC 0000-01-01 22:53:52 +0000 UTC]
[35m预测[2]:[0m [王强 H00018 0000-01-01 08:48:35 +0000 UTC 0000-01-01 22:53:52 +0000 UTC 14.088055555555556]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [15 张伟 H00051 0000-01-01 08:02:22 +0000 UTC 0000-01-01 23:55:14 +0000 UTC]
[35m预测[3]:[0m [张伟 H00051 0000-01-01 08:02:22 +0000 UTC 0000-01-01 23:55:14 +0000 UTC 15.88111111111111]
执行查询: ID=1822156377, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, pe.rating AS performance_rating FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id LEFT JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-10-12';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, pe.rating AS performance_rating FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-10-12'
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3941104083, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-11' AND a.check_in > '09:00:00' AND d.name = '销售部';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '销售部' AND a.date = '2024-10-11' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 511
预测SQL执行成功，行数: 511
已处理 80/1042 个查询...
执行查询: ID=1448803792, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, ar.check_in, a.award_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN awards a ON ar.employee_id = a.employee_id WHERE ar.date = '2024-09-26' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, d.name AS department_name, a.check_in, aw.award_name 
FROM attendance_records a 
JOIN employees e ON a.employee_id = e.employee_id 
JOIN departments d ON e.department_id = d.department_id 
JOIN awards aw ON e.employee_id = aw.employee_id 
WHERE a.date = '2024-09-26' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 5013
预测SQL执行成功，行数: 5013
执行查询: ID=2348295774, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-05' AND a.check_in > '09:00:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.employee_id AS employee_id, a.check_in AS check_in, p.rating AS rating FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-05' AND a.check_in > '09:00:00' AND p.rating = 'A+'
标准SQL执行成功，行数: 848
预测SQL执行成功，行数: 848
执行查询: ID=1351044911, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-07' AND d.name = '人力资源部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON d.id::character varying = e.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '人力资源部' 
AND a.date = '2024-10-07' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 528
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回528行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1269433479, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, a.check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-11' AND e.employee_type = '实习生' AND a.check_in < '09:00:00';
执行预测SQL: SELECT e.name AS name, d.name AS department_name, a.check_in 
FROM attendance_records a 
JOIN employees e ON a.employee_id = e.employee_id 
JOIN departments d ON e.department_id = d.department_id 
JOIN probation_employees p ON e.employee_id = p.employee_id 
WHERE a.date = '2024-10-11' AND a.check_in < '09:00:00'
标准SQL执行成功，行数: 1692
预测SQL执行成功，行数: 3361

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1692行, 预测SQL返回3361行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [department_name check_in name]
[35m预测SQL列:[0m [name department_name check_in]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [法务部 0000-01-01 08:44:32 +0000 UTC 吴芳]
[35m预测[1]:[0m [吴芳 法务部 0000-01-01 08:44:32 +0000 UTC]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [质量控制部 0000-01-01 08:56:04 +0000 UTC 李军]
[35m预测[2]:[0m [李军 质量控制部 0000-01-01 08:56:04 +0000 UTC]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [人力资源部 0000-01-01 08:58:23 +0000 UTC 张静]
[35m预测[3]:[0m [刘军 人力资源部 0000-01-01 08:47:01 +0000 UTC]
执行查询: ID=2181400574, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.award_name = '优秀员工' AND pe.rating = 'A+' AND a.year = 2023;
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.year = 2023 AND a.award_name = '优秀员工奖' AND pe.rating = 'A+'
标准SQL执行成功，行数: 11
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回11行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=2992677261, DB=hr
执行标准SQL: SELECT e.department_id, COUNT(DISTINCT pe.employee_id) AS core_talent_count
FROM employees e
JOIN probation_employees pe ON e.employee_id = pe.employee_id
WHERE pe.status = '转正' AND pe.end_date >= datetime('now') - INTERVAL '5 years'
GROUP BY e.department_id;
标准SQL执行错误: SQL执行失败: pq: function datetime(unknown) does not exist
执行预测SQL: SELECT e.department_id, COUNT(DISTINCT pe.employee_id) AS high_potential_to_core_count 
FROM probation_employees pe 
JOIN employees e ON pe.employee_id = e.employee_id 
JOIN performance_evaluations pev ON pe.employee_id = pev.employee_id 
WHERE pe.end_date >= CURRENT_DATE - INTERVAL '5 years' 
AND pev.evaluation_date >= pe.end_date 
AND pev.evaluation_date >= CURRENT_DATE - INTERVAL '5 years' 
AND pev.rating = 'A+' 
GROUP BY e.department_id
标准SQL执行错误: SQL执行失败: pq: function datetime(unknown) does not exist
执行查询: ID=1583766775, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '新人奖' AND a.year = 2024 AND ar.date = '2024-10-08';
执行预测SQL: SELECT e.name AS name FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-10-08' AND e.employee_id IN (SELECT employee_id FROM awards WHERE year = 2024 AND award_name = '新人奖')
标准SQL执行成功，行数: 951
预测SQL执行成功，行数: 951
执行查询: ID=2928703740, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-02' AND a.check_in > '09:00:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.date = '2024-10-02' AND a.check_in > '09:00:00' AND pe.rating = 'A+'
标准SQL执行成功，行数: 772
预测SQL执行成功，行数: 772
执行查询: ID=2166514841, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.award_name = '新人奖' AND a.year = 2024;
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.year = 2024 AND a.award_name = '新人奖'
标准SQL执行成功，行数: 951
预测SQL执行成功，行数: 951
执行查询: ID=2864760744, DB=hr
执行标准SQL: SELECT AVG(EXTRACT(YEAR FROM age(first_management_position_date, hire_date))) AS average_years_to_management
FROM (
    SELECT e.employee_id, e.hire_date, MIN(e.hire_date) AS first_management_position_date
    FROM employees e
    WHERE e.position LIKE '%管理%'
    GROUP BY e.employee_id, e.hire_date
) AS subquery;
执行预测SQL: SELECT 
    AVG(
        (EXTRACT(YEAR FROM (d.first_management_date - e.hire_date)) * 12 + 
         EXTRACT(MONTH FROM (d.first_management_date - e.hire_date))) / 12.0
    ) AS average_years_to_management
FROM 
    employees e
JOIN (
    SELECT 
        manager_id AS employee_id, 
        MIN(date) AS first_management_date
    FROM 
        departments
    GROUP BY 
        manager_id
) d ON e.employee_id = d.employee_id
预测SQL执行错误: SQL执行失败: pq: column "date" does not exist
预测SQL执行错误: SQL执行失败: pq: column "date" does not exist
已处理 90/1042 个查询...
执行查询: ID=2860391364, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '研发部' AND a.date = '2024-10-06' AND EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600 > 10;
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '研发部' 
AND a.date = '2024-10-06' 
AND (CAST(a.check_out AS TIME) - CAST(a.check_in AS TIME)) > INTERVAL '10 hours'
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=1852490763, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.award_name = '技术突破奖' AND pe.rating = 'A+' AND a.year = 2023;
执行预测SQL: SELECT employees.name AS name, awards.award_name AS award_name, performance_evaluations.rating AS rating 
FROM awards 
JOIN employees ON awards.employee_id = employees.employee_id 
JOIN performance_evaluations ON awards.employee_id = performance_evaluations.employee_id 
WHERE awards.year = 2023 AND awards.award_name = '技术突破奖' AND performance_evaluations.rating = 'A+'
标准SQL执行成功，行数: 25
预测SQL执行成功，行数: 25
执行查询: ID=2494653166, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-17' AND a.check_in > '09:00:00' AND p.rating = 'D';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-17' AND a.check_in > '09:00:00' AND p.rating = 'D'
标准SQL执行成功，行数: 821
预测SQL执行成功，行数: 821
执行查询: ID=3084451002, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '项目管理奖' AND a.year = 2024 AND ar.date = '2024-10-03';
执行预测SQL: SELECT DISTINCT e.name 
FROM employees e 
JOIN awards a ON e.employee_id = a.employee_id 
JOIN attendance_records ar ON e.employee_id = ar.employee_id 
WHERE a.year = 2024 
AND a.award_name = '项目管理奖' 
AND ar.date = '2024-10-03'
标准SQL执行成功，行数: 239
预测SQL执行成功，行数: 87

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回239行, 预测SQL返回87行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name]
[35m预测SQL列:[0m [name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [张丽]
[35m预测[1]:[0m [刘丽]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [李娜]
[35m预测[2]:[0m [刘伟]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [周秀英]
[35m预测[3]:[0m [刘军]
执行查询: ID=408688532, DB=hr
执行标准SQL: SELECT e.name, e.hire_date, a.award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id WHERE a.award_name = '领导力奖' AND a.year = 2023 AND e.hire_date > '2017-01-01';
执行预测SQL: SELECT e.name AS name, e.hire_date AS hire_date, a.award_name AS award_name FROM awards a JOIN employees e ON a.employee_id = e.employee_id WHERE a.year = 2023 AND a.award_name = '领导力奖' AND e.hire_date > '2017-01-01'
标准SQL执行成功，行数: 100
预测SQL执行成功，行数: 100
执行查询: ID=4036648411, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-09-16' AND (a.check_out - a.check_in) > '08:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE a.date = '2024-09-16' 
AND e.university = '清华大学' 
AND a.check_out > a.check_in 
AND EXTRACT(EPOCH FROM (a.date::timestamp + a.check_out::time - (a.date::timestamp + a.check_in::time))) / 3600 > 8
标准SQL执行成功，行数: 744
预测SQL执行成功，行数: 744
执行查询: ID=548473863, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2023 AND a.award_name = '领导力奖' AND pe.evaluation_date = '2023-06-04' AND pe.rating = 'D';
执行预测SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2023 AND a.award_name = '领导力奖' AND pe.evaluation_date = '2023-06-04' AND pe.rating = 'D'
执行查询: ID=2286968533, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '客户服务部' AND a.date = '2024-10-12' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.id::text JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '客户服务部' AND a.date = '2024-10-12' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 443
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回443行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3284637113, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-21' AND a.check_in > '09:00:00' AND p.rating = 'B';
执行预测SQL: SELECT e.name AS employee_name, a.check_in AS check_in_time 
FROM employees e 
JOIN attendance_records a ON e.employee_id = a.employee_id 
JOIN performance_evaluations p ON e.employee_id = p.employee_id 
WHERE a.date = '2024-09-21' 
AND p.rating = 'B' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 854
预测SQL执行成功，行数: 854
执行查询: ID=773404511, DB=hr
执行标准SQL: SELECT d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-09-24' AND ar.check_in > '09:00:00' AND pe.rating = 'C';
执行预测SQL: SELECT d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-24' AND a.check_in > '09:00:00' AND p.rating = 'C'
标准SQL执行成功，行数: 851
预测SQL执行成功，行数: 851
已处理 100/1042 个查询...
执行查询: ID=2149393306, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-05' AND d.name = '行政部' AND EXTRACT(HOUR FROM (a.check_out - a.check_in)) >= 9;
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '行政部' 
AND a.date = '2024-10-05' 
AND ( (a.check_out::time + a.date::timestamp) - (a.check_in::time + a.date::timestamp) ) > INTERVAL '9 hours'
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=2477803619, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '财务部' AND a.date = '2024-10-06' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '财务部' AND a.date = '2024-10-06' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 500
预测SQL执行成功，行数: 500
执行查询: ID=821353235, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, d.manager_id FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.rating = 'A+' AND pe.evaluation_date >= '2023-01-01' AND pe.evaluation_date < '2024-01-01';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, d.manager_id AS manager_id FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.id WHERE pe.rating = 'A+' AND EXTRACT(YEAR FROM pe.evaluation_date) = 2023
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=907163187, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-28' AND a.check_in > '09:00:00' AND p.rating = 'A';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.date = '2024-09-28' AND pe.rating = 'A' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 861
预测SQL执行成功，行数: 861
执行查询: ID=811463423, DB=hr
执行标准SQL: SELECT ar.id, ar.employee_id, ar.date, ar.check_in, ar.check_out FROM attendance_records ar JOIN awards a ON ar.employee_id = a.employee_id WHERE a.award_name = '销售冠军' AND a.year = 2023 AND ar.date = '2024-10-01';
执行预测SQL: SELECT a.id AS id, a.employee_id AS employee_id, a.date AS date, a.check_in AS check_in, a.check_out AS check_out FROM attendance_records a JOIN awards w ON a.employee_id = w.employee_id WHERE w.year = 2023 AND w.award_name = '销售冠军' AND a.date = '2024-10-01'
标准SQL执行成功，行数: 131
预测SQL执行成功，行数: 131
执行查询: ID=2913040945, DB=hr
执行标准SQL: SELECT e.department_id, e.employee_id, e.name, MIN(pe.evaluation_date - e.hire_date) AS time_to_first_A_plus FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE pe.rating = 'A+' GROUP BY e.department_id, e.employee_id, e.name ORDER BY e.department_id, time_to_first_A_plus LIMIT 1;
执行预测SQL: SELECT 
    e.department_id AS department_id,
    e.employee_id AS employee_id,
    e.name AS name,
    EXTRACT(EPOCH FROM (pe.first_a_plus_date - e.hire_date)) / 86400 AS time_to_first_a_plus
FROM employees e
JOIN (
    SELECT employee_id, MIN(evaluation_date) AS first_a_plus_date
    FROM performance_evaluations
    WHERE rating = 'A+'
    GROUP BY employee_id
) pe ON e.employee_id = pe.employee_id
ORDER BY e.department_id, time_to_first_a_plus
预测SQL执行错误: SQL执行失败: pq: function pg_catalog.extract(unknown, integer) does not exist
预测SQL执行错误: SQL执行失败: pq: function pg_catalog.extract(unknown, integer) does not exist
执行查询: ID=1736656854, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-22' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-22' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 4912
预测SQL执行成功，行数: 4912
执行查询: ID=2339817132, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2024 AND a.award_name = '优秀员工' AND pe.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM awards a JOIN performance_evaluations pe ON a.employee_id = pe.employee_id JOIN employees e ON a.employee_id = e.employee_id WHERE a.year = 2024 AND a.award_name = '优秀员工' AND pe.rating = 'A+'
标准SQL执行成功，行数: 8
预测SQL执行成功，行数: 8
执行查询: ID=2218878981, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, pe.rating FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-10-29';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, pe.rating AS rating FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-10-29'
标准SQL执行成功，行数: 9
预测SQL执行成功，行数: 9
执行查询: ID=1785434408, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-09-17' AND (a.check_out - a.check_in) > '09:00:00';
执行预测SQL: SELECT 
    e.name AS name, 
    e.employee_id AS employee_id, 
    a.check_in AS check_in, 
    a.check_out AS check_out 
FROM 
    employees e 
JOIN 
    attendance_records a ON e.employee_id = a.employee_id 
WHERE 
    e.university = '清华大学' 
    AND a.date = '2024-09-17' 
    AND (a.check_out - a.check_in) > INTERVAL '9 hours'
标准SQL执行成功，行数: 650
预测SQL执行成功，行数: 650
已处理 110/1042 个查询...
执行查询: ID=2274426817, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2022-06-16' AND pe.rating = 'C';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2022-06-16' AND pe.rating = 'C'
执行查询: ID=1121061015, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.award_name = '优秀员工' AND a.year = 2022 AND pe.evaluation_date = '2022-10-30' AND pe.rating = 'A+';
执行预测SQL: SELECT DISTINCT e.name AS name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.year = 2022 AND a.award_name = '优秀员工' AND pe.evaluation_date = '2022-10-30' AND pe.rating = 'A+'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=1822740611, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-15' AND a.check_in > '09:00:00' AND p.rating = 'B';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-15' AND a.check_in > '09:00' AND p.rating = 'B'
标准SQL执行成功，行数: 850
预测SQL执行成功，行数: 850
执行查询: ID=3049098373, DB=hr
执行标准SQL: SELECT e.name, e.position FROM employees e JOIN departments d ON e.department_id = d.department_id WHERE d.name = '销售部';
执行预测SQL: SELECT e.name AS name, e.position AS position FROM employees e JOIN departments d ON e.department_id = d.department_id WHERE d.name = '销售部'
标准SQL执行成功，行数: 987
预测SQL执行成功，行数: 987
执行查询: ID=2137629249, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-23' AND a.check_in > '09:00:00' AND p.rating = 'D';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM attendance_records a 
JOIN performance_evaluations p ON a.employee_id = p.employee_id 
JOIN employees e ON a.employee_id = e.employee_id 
WHERE a.date = '2024-09-23' 
AND a.check_in > '09:00:00' 
AND p.rating = 'D'
标准SQL执行成功，行数: 811
预测SQL执行成功，行数: 811
执行查询: ID=2240615465, DB=hr
执行标准SQL: SELECT e.name, e.employee_id FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2024-10-14' AND pe.rating = 'D' AND d.name = '客户服务部';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE d.name = '客户服务部' AND pe.rating = 'D' AND pe.evaluation_date = '2024-10-14'
标准SQL执行成功，行数: 2
预测SQL执行成功，行数: 2
执行查询: ID=1309270874, DB=hr
执行标准SQL: SELECT e.name, e.hire_date, a.award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id WHERE a.award_name = '领导力奖' AND a.year = 2023 AND e.hire_date >= '2019-01-01';
执行预测SQL: SELECT e.name AS name, e.hire_date AS hire_date, a.award_name AS award_name 
FROM awards a 
JOIN employees e ON a.employee_id = e.employee_id 
WHERE a.year = 2023 AND a.award_name = '领导力奖' AND e.hire_date >= '2019-01-01'
标准SQL执行成功，行数: 21
预测SQL执行成功，行数: 21
执行查询: ID=2420332715, DB=hr
执行标准SQL: SELECT d.name AS department_name, e.name AS employee_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-09-20' AND ar.check_in > '09:00:00' AND pe.rating = 'A+';
执行预测SQL: SELECT d.name AS department_name, e.name AS employee_name 
FROM employees e 
JOIN departments d ON e.department_id = d.id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
JOIN performance_evaluations pe ON e.employee_id = pe.employee_id 
WHERE a.date = DATE '2024-09-20' 
AND a.check_in > TIME '09:00:00' 
AND pe.rating = 'A+'
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=60966118, DB=hr
执行标准SQL: SELECT e.employee_id, e.name FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id JOIN awards a ON e.employee_id = a.employee_id WHERE pe.rating IN ('B', 'C') AND a.award_name IN ('最佳团队奖', '最佳同事评价奖')
执行预测SQL: SELECT e.employee_id AS employee_id, e.name AS name
FROM employees e
JOIN performance_evaluations pe ON e.employee_id = pe.employee_id
WHERE pe.rating IN ('B+', 'B')
AND EXISTS (SELECT 1 FROM awards a WHERE a.employee_id = e.employee_id)
标准SQL执行成功，行数: 345
预测SQL执行成功，行数: 3292

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回345行, 预测SQL返回3292行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_id name]
[35m预测SQL列:[0m [employee_id name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [H08059 钱磊]
[35m预测[1]:[0m [H00007 李秀英]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [H09235 吴娜]
[35m预测[2]:[0m [H00014 周娜]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [H00381 钱静]
[35m预测[3]:[0m [H00019 周敏]
执行查询: ID=1965264110, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-20' AND a.check_in BETWEEN '08:00:00' AND '09:00:00' AND p.rating = 'B';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-09-20' AND a.check_in >= '08:00:00' AND a.check_in < '09:00:00' AND pe.rating = 'B'
标准SQL执行成功，行数: 856
预测SQL执行成功，行数: 856
已处理 120/1042 个查询...
执行查询: ID=1436736406, DB=hr
执行标准SQL: SELECT e.employee_id, e.name FROM employees e JOIN (SELECT employee_id, MAX(evaluation_date) AS last_evaluation_date FROM performance_evaluations WHERE evaluation_date < '2024-01-01' GROUP BY employee_id) pe ON e.employee_id = pe.employee_id JOIN performance_evaluations pe2 ON pe.employee_id = pe2.employee_id AND pe.last_evaluation_date = pe2.evaluation_date WHERE pe2.rating = 'B';
执行预测SQL: SELECT pe.employee_id AS employee_id, e.name AS name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id WHERE pe.rating = 'B' AND pe.evaluation_date < '2024-01-01' AND pe.evaluation_date = (SELECT MAX(pe2.evaluation_date) FROM performance_evaluations pe2 WHERE pe2.employee_id = pe.employee_id)
标准SQL执行成功，行数: 1466
预测SQL执行成功，行数: 1466
执行查询: ID=2263195811, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-19' AND a.check_in > '09:00:00' AND p.rating = 'B+';
执行预测SQL: SELECT e.name AS employee_name, a.check_in AS check_in_time FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-09-19' AND a.check_in > '09:00' AND pe.rating = 'B+'
标准SQL执行成功，行数: 820
预测SQL执行成功，行数: 820
执行查询: ID=1079007714, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, a.check_in, a.check_out, (a.check_out - a.check_in) AS work_duration FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-24' AND (a.check_out - a.check_in) > '12:00:00';
执行预测SQL: SELECT 
    e.name AS employee_name,
    d.name AS department_name,
    a.check_in,
    a.check_out,
    EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600 AS work_duration
FROM 
    attendance_records a
JOIN 
    employees e ON a.employee_id = e.employee_id
JOIN 
    departments d ON e.department_id = d.department_id
WHERE 
    a.date = '2024-09-24'
    AND EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600 > 12
标准SQL执行成功，行数: 3357
预测SQL执行成功，行数: 3357

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [check_in check_out work_duration employee_name department_name]
[35m预测SQL列:[0m [department_name check_in check_out work_duration employee_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [0000-01-01 08:08:32 +0000 UTC 0000-01-01 23:03:52 +0000 UTC 14 李军 质量控制部]
[35m预测[1]:[0m [质量控制部 0000-01-01 08:08:32 +0000 UTC 0000-01-01 23:03:52 +0000 UTC 14.922222222222222 李军]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [0000-01-01 08:13:09 +0000 UTC 0000-01-01 22:31:41 +0000 UTC 14 刘军 人力资源部]
[35m预测[2]:[0m [人力资源部 0000-01-01 08:13:09 +0000 UTC 0000-01-01 22:31:41 +0000 UTC 14.30888888888889 刘军]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [0000-01-01 08:17:26 +0000 UTC 0000-01-01 21:31:14 +0000 UTC 13 王秀英 行政部]
[35m预测[3]:[0m [行政部 0000-01-01 08:17:26 +0000 UTC 0000-01-01 21:31:14 +0000 UTC 13.23 王秀英]
执行查询: ID=2835428087, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-09-29' AND a.check_in < '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-09-29' AND e.university = '清华大学' AND a.check_in < '09:00:00'
标准SQL执行成功，行数: 528
预测SQL执行成功，行数: 528
执行查询: ID=2600324766, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-11' AND a.check_in > '09:00:00' AND p.rating = 'A';
执行预测SQL: SELECT e.name AS name, ar.check_in AS check_in, pe.rating AS rating FROM employees e JOIN attendance_records ar ON e.employee_id = ar.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-10-11' AND ar.check_in > '09:00:00' AND pe.rating = 'A'
标准SQL执行成功，行数: 881
预测SQL执行成功，行数: 881
执行查询: ID=1290741288, DB=hr
执行标准SQL: SELECT date, check_in, check_out FROM attendance_records WHERE employee_id = 'H03961';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=3714812669, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '厦门大学' AND a.date = '2024-09-23' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE e.university = '厦门大学' 
AND a.date = '2024-09-23' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 500
预测SQL执行成功，行数: 500
执行查询: ID=4217899403, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-19' AND a.check_in > '09:00:00' AND p.rating = 'D';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM attendance_records a JOIN performance_evaluations pe ON a.employee_id = pe.employee_id JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-09-19' AND a.check_in > '09:00:00' AND pe.rating = 'D'
标准SQL执行成功，行数: 810
预测SQL执行成功，行数: 810
执行查询: ID=1946117596, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.date, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-11' AND a.check_in > '08:30:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, ar.date AS date, ar.check_in AS check_in FROM employees e JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE e.university = '清华大学' AND ar.date = '2024-10-11' AND ar.check_in > '08:30:00'
标准SQL执行成功，行数: 753
预测SQL执行成功，行数: 753
执行查询: ID=1268105110, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-10' AND a.check_in > '09:00:00' AND p.rating = 'D';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM attendance_records a 
JOIN employees e ON a.employee_id = e.employee_id 
JOIN performance_evaluations p ON e.employee_id = p.employee_id 
WHERE a.date = '2024-10-10' 
AND a.check_in > '09:00:00' 
AND p.rating = 'D'
标准SQL执行成功，行数: 834
预测SQL执行成功，行数: 834
已处理 130/1042 个查询...
执行查询: ID=910719964, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE e.hire_date >= '2024-01-01' AND a.award_name = '新人奖' AND pe.rating = 'A' AND a.year = 2024;
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE EXTRACT(YEAR FROM e.hire_date) = 2024 AND a.year = 2024 AND a.award_name = '新人奖' AND pe.rating = 'A'
标准SQL执行成功，行数: 11
预测SQL执行成功，行数: 11
执行查询: ID=4215983699, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-26' AND a.check_in BETWEEN '08:00:00' AND '09:00:00' AND p.rating = 'B+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-26' AND a.check_in BETWEEN '08:00' AND '09:00' AND p.rating = 'B+'
标准SQL执行成功，行数: 782
预测SQL执行成功，行数: 782
执行查询: ID=3022631781, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '创新奖' AND a.year = 2023 AND ar.date = '2024-09-25';
执行预测SQL: SELECT DISTINCT e.name AS name
FROM employees e
JOIN awards a ON e.employee_id = a.employee_id
JOIN attendance_records ar ON e.employee_id = ar.employee_id
WHERE a.year = 2023
AND a.award_name = '创新奖'
AND ar.date = '2024-09-25'
标准SQL执行成功，行数: 57
预测SQL执行成功，行数: 38

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回57行, 预测SQL返回38行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name]
[35m预测SQL列:[0m [name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [张娜]
[35m预测[1]:[0m [刘丽]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [周伟]
[35m预测[2]:[0m [刘伟]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [赵敏]
[35m预测[3]:[0m [刘秀英]
执行查询: ID=1326215630, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-24' AND a.check_in > '09:00:00' AND p.rating = 'D';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-09-24' AND a.check_in > '09:00:00' AND p.rating = 'D'
标准SQL执行成功，行数: 854
预测SQL执行成功，行数: 854
执行查询: ID=2739991096, DB=hr
执行标准SQL: SELECT d.name AS department_name, AVG(e.remaining_annual_leave) AS avg_annual_leave FROM departments d JOIN employees e ON d.department_id = e.department_id WHERE d.manager_id = 'H03372' GROUP BY d.name;
执行预测SQL: SELECT d.name AS department_name, AVG(e.remaining_annual_leave) AS avg_annual_leave FROM departments d JOIN employees e ON CAST(d.id AS character varying) = e.department_id WHERE d.manager_id = 'H03372' GROUP BY d.id, d.name
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3094758858, DB=hr
执行标准SQL: SELECT e.name, a.date, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-12' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.date AS date, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-10-12' AND pe.rating = 'A+'
标准SQL执行成功，行数: 1638
预测SQL执行成功，行数: 1638
执行查询: ID=3240116959, DB=hr
执行标准SQL: SELECT e.name, a.date, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN awards aw ON e.employee_id = aw.employee_id WHERE aw.award_name = '质量改进奖' AND aw.year = 2023 AND a.date = '2024-10-03' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.date AS date, a.check_in AS check_in FROM awards aw JOIN employees e ON aw.employee_id = e.employee_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE aw.year = 2023 AND aw.award_name = '质量改进奖' AND a.date = '2024-10-03' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 91
预测SQL执行成功，行数: 91
执行查询: ID=3253971302, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, d.name AS department_name, pe.rating FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE ar.date = '2024-09-15' AND d.name = '财务部' AND pe.rating = 'A+';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, d.name AS department_name, pe.rating AS rating 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN performance_evaluations pe ON e.employee_id = pe.employee_id 
WHERE d.name = '财务部' 
AND pe.rating = 'A+' 
AND pe.evaluation_date::date = '2024-09-15'
标准SQL执行成功，行数: 166
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回166行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3037862925, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '质量控制部' AND a.date = '2024-09-21' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '质量控制部' 
AND a.date = '2024-09-21' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 518
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回518行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1991610345, DB=hr
执行标准SQL: SELECT e.name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-25' AND d.name = '销售部' AND (a.check_out - a.check_in) > '08:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '销售部' 
AND a.date = '2024-09-25' 
AND ( (CAST(a.date AS TIMESTAMP) + a.check_out::TIME) - (CAST(a.date AS TIMESTAMP) + a.check_in::TIME) ) > INTERVAL '8 hours'
ORDER BY e.name
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
已处理 140/1042 个查询...
执行查询: ID=3421802959, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2022 AND a.award_name = '技术突破奖' AND pe.evaluation_date > '2022-07-13';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2022 AND a.award_name = '技术突破奖' AND pe.evaluation_date > '2022-07-13'
标准SQL执行成功，行数: 83
预测SQL执行成功，行数: 83
执行查询: ID=3350855518, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-11' AND a.check_in > '09:00:00' AND d.name = '财务部';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.id = 4 AND a.date = '2024-10-11' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 495
预测SQL执行成功，行数: 495
执行查询: ID=1481678835, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-12' AND a.check_in > '09:00:00' AND d.name = '研发部';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '研发部' AND a.date = '2024-10-12' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 500
预测SQL执行成功，行数: 500
执行查询: ID=1832961045, DB=hr
执行标准SQL: SELECT d.name AS department_name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE pe.evaluation_date = '2023-08-06' AND pe.rating = 'C';
执行预测SQL: SELECT DISTINCT d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-08-06' AND pe.rating = 'C'
标准SQL执行成功，行数: 3
预测SQL执行成功，行数: 3
执行查询: ID=3794832374, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-01' AND (a.check_out - a.check_in) > '12:00:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, ar.check_in, ar.check_out FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-01' AND (ar.check_out - ar.check_in) > INTERVAL '12 hours'
标准SQL执行成功，行数: 3408
预测SQL执行成功，行数: 3408
执行查询: ID=4131389571, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-09' AND a.check_in > '09:00:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-10-09' AND a.check_in > '09:00:00' AND p.rating = 'A+'
标准SQL执行成功，行数: 820
预测SQL执行成功，行数: 820
执行查询: ID=2592420070, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-24' AND a.check_in > '09:00:00' AND d.name = '人力资源部';
执行预测SQL: SELECT e.name AS employee_name, a.check_in AS check_in_time 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '人力资源部' 
AND a.date = '2024-09-24' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 522
预测SQL执行成功，行数: 522
执行查询: ID=1526114356, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '销售部' AND a.date = '2024-10-02' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '销售部' AND a.date = '2024-10-02' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 476
预测SQL执行成功，行数: 476
执行查询: ID=906637391, DB=hr
执行标准SQL: SELECT e.name, a.check_out, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-11' AND a.check_out > '21:00:00' AND p.rating = 'B+';
执行预测SQL: SELECT e.name AS name, a.check_out AS check_out, pe.rating AS rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-10-11' AND a.check_out > TIME '21:00' AND pe.rating = 'B+'
标准SQL执行成功，行数: 527
预测SQL执行成功，行数: 527
执行查询: ID=3180358031, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, e.hire_date FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.rating = 'B' AND pe.evaluation_date >= '2022-01-01' AND pe.evaluation_date < '2023-01-01' ORDER BY e.hire_date;
执行预测SQL: SELECT e.name AS name, d.name AS department_name, e.hire_date AS hire_date FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE EXTRACT(YEAR FROM pe.evaluation_date) = 2022 AND pe.rating = 'B' ORDER BY e.hire_date
标准SQL执行成功，行数: 279
预测SQL执行成功，行数: 279
已处理 150/1042 个查询...
执行查询: ID=1427670664, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-22' AND d.name = '客户服务部';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.id WHERE a.date = '2024-09-22' AND d.name = '客户服务部'
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=2517372671, DB=hr
执行标准SQL: SELECT d.name AS department_name, e.name AS employee_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-09-20' AND ar.check_in > '09:00:00' AND pe.rating = 'B';
执行预测SQL: SELECT d.name AS department_name, e.name AS employee_name 
FROM attendance_records a 
JOIN employees e ON a.employee_id = e.employee_id 
JOIN performance_evaluations p ON e.employee_id = p.employee_id 
JOIN departments d ON e.department_id = d.department_id 
WHERE a.date = '2024-09-20' 
AND a.check_in > TIME '09:00' 
AND p.rating = 'B'
标准SQL执行成功，行数: 834
预测SQL执行成功，行数: 834
执行查询: ID=2374975326, DB=hr
执行标准SQL: SELECT e.name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id WHERE ar.date = '2024-10-02' ORDER BY ar.check_in LIMIT 1;
执行预测SQL: SELECT e.name AS name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-02' ORDER BY a.check_in ASC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=1399658957, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.date, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE e.hire_date >= '2023-01-01' AND e.hire_date < '2024-01-01' AND a.date = '2024-10-10' AND p.rating = 'B+';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.date AS date, pe.rating AS rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE e.hire_date >= '2023-01-01' AND e.hire_date < '2024-01-01' AND a.date = '2024-10-10' AND pe.rating = 'B+'
标准SQL执行成功，行数: 122
预测SQL执行成功，行数: 122
执行查询: ID=1337508734, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.date, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '财务部' AND a.date = '2024-10-04' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.date AS date, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '财务部' AND a.date = '2024-10-04' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 507
预测SQL执行成功，行数: 507
执行查询: ID=2509046712, DB=hr
执行标准SQL: SELECT e.name, a.date, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-17' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.date AS date, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-09-17' AND pe.rating = 'A+'
标准SQL执行成功，行数: 1638
预测SQL执行成功，行数: 1638
执行查询: ID=1196649212, DB=hr
执行标准SQL: SELECT d.name AS department_name
FROM probation_employees pe
JOIN employees e ON pe.employee_id = e.employee_id
JOIN departments d ON e.department_id = d.department_id
GROUP BY pe.employee_id, d.name
ORDER BY COUNT(*) DESC
LIMIT 3;
执行预测SQL: SELECT d.name AS department_name
FROM probation_employees pe
JOIN employees e ON pe.employee_id = e.employee_id
JOIN departments d ON e.department_id = d.department_id
GROUP BY pe.employee_id, d.name
ORDER BY COUNT(*) DESC
LIMIT 3
执行查询: ID=3455582973, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-04' AND d.name = '财务部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-10-04' AND a.check_in > '09:00:00' AND d.name = '财务部'
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=2169239057, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.award_name = '优秀员工' AND a.year = 2023;
执行预测SQL: SELECT DISTINCT a.employee_id, e.name AS employee_name, d.name AS department_name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.year = 2023 AND a.award_name = '优秀员工'
标准SQL执行成功，行数: 69
预测SQL执行成功，行数: 69

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 列数不匹配: 标准SQL返回2列, 预测SQL返回3列
[1m分类结果:[0m [35m投影错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_name department_name]
[35m预测SQL列:[0m [department_name employee_id employee_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [张娜 运营部]
[35m预测[1]:[0m [运营部 H00195 张娜]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [刘伟 客户服务部]
[35m预测[2]:[0m [客户服务部 H00722 刘伟]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [钱娜 销售部]
[35m预测[3]:[0m [销售部 H00753 钱娜]
执行查询: ID=329969630, DB=hr
执行标准SQL: SELECT COUNT(DISTINCT pe.employee_id) FROM probation_employees pe JOIN awards a ON pe.employee_id = a.employee_id WHERE pe.status = '在职' AND a.award_name = '客户满意度奖' AND a.year = 2023;
执行预测SQL: SELECT COUNT(DISTINCT probation_employees.employee_id) AS count FROM probation_employees JOIN awards ON probation_employees.employee_id = awards.employee_id WHERE probation_employees.start_date <= '2023-12-31' AND probation_employees.end_date >= '2023-01-01' AND awards.year = 2023 AND awards.award_name = '客户满意度奖'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [count]
[35m预测SQL列:[0m [count]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [23]
[35m预测[1]:[0m [57]
已处理 160/1042 个查询...
执行查询: ID=1957766738, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-24' AND a.check_in > '09:00:00' AND p.rating = 'C';
执行预测SQL: SELECT e.name AS name, ar.check_in AS check_in 
FROM attendance_records ar 
JOIN employees e ON ar.employee_id = e.employee_id 
JOIN performance_evaluations pe ON e.employee_id = pe.employee_id 
WHERE ar.date = '2024-09-24' 
AND ar.check_in > '09:00:00' 
AND pe.rating = 'C'
标准SQL执行成功，行数: 851
预测SQL执行成功，行数: 851
执行查询: ID=701997867, DB=hr
执行标准SQL: SELECT e.name, a.award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id;
执行预测SQL: SELECT employees.name AS name, awards.award_name AS award_name FROM employees JOIN awards ON employees.employee_id = awards.employee_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=906781191, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-13' AND a.check_in < '08:30:00' AND d.name = '法务部';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '法务部' 
AND a.date = '2024-10-13' 
AND a.check_in < '08:30:00'
标准SQL执行成功，行数: 270
预测SQL执行成功，行数: 270
执行查询: ID=388401260, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-17' AND d.name = '质量控制部' AND EXTRACT(HOUR FROM (a.check_out - a.check_in)) >= 9;
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '质量控制部' 
AND a.date = '2024-09-17' 
AND EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600 > 9
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=1988310183, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-26' AND e.remaining_annual_leave > 10;
执行预测SQL: SELECT e.name AS name, d.name AS department_name, a.check_in, a.check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE a.date = '2024-09-26' 
AND e.remaining_annual_leave > 10
标准SQL执行成功，行数: 2654
预测SQL执行成功，行数: 2654
执行查询: ID=2363197929, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '财务部' AND a.date = '2024-10-09' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '财务部' 
AND a.date = '2024-10-09' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 509
预测SQL执行成功，行数: 509
执行查询: ID=935583315, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-10' AND d.name = '客户服务部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.id = 6 
AND a.date = '2024-10-10' 
AND a.check_in > '09:00:00'
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=3679145520, DB=hr
执行标准SQL: SELECT e.employee_id, e.name, COUNT(a.id) AS active_projects_count
FROM employees e
JOIN awards a ON e.employee_id = a.employee_id
WHERE a.award_name = '创新奖'
GROUP BY e.employee_id, e.name
ORDER BY active_projects_count DESC;
执行预测SQL: SELECT employees.employee_id AS employee_id, employees.name AS name, COUNT(*) AS active_projects_count FROM employees JOIN interviews ON employees.employee_id = interviews.employee_id GROUP BY employees.employee_id, employees.name ORDER BY active_projects_count DESC LIMIT 10
标准SQL执行成功，行数: 973
预测SQL执行成功，行数: 10

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回973行, 预测SQL返回10行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_id name active_projects_count]
[35m预测SQL列:[0m [employee_id name active_projects_count]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [H07431 钱敏 1]
[35m预测[1]:[0m [H03991 吴军 1]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [H07858 王秀英 1]
[35m预测[2]:[0m [H02070 吴芳 1]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [H00942 孙磊 1]
[35m预测[3]:[0m [H05367 郑芳 1]
执行查询: ID=1647521458, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-25' AND ar.check_in > '09:00:00';
标准SQL执行错误: SQL执行失败: pq: syntax error at or near "FROM"
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-25' AND ar.check_in > '09:00:00'
标准SQL执行错误: SQL执行失败: pq: syntax error at or near "FROM"
执行查询: ID=2154404311, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-28' AND d.name = '客户服务部' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, pe.rating AS rating 
FROM employees e 
JOIN departments d ON e.department_id = d.id 
JOIN performance_evaluations pe ON e.employee_id = pe.employee_id 
WHERE d.name = '客户服务部' AND pe.rating = 'A+'
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
已处理 170/1042 个查询...
执行查询: ID=1956887122, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-07' AND a.check_in > '09:00:00' AND d.name = '法务部';
执行预测SQL: SELECT e.name AS name, a.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '法务部' 
AND a.date = '2024-10-07' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 528
预测SQL执行成功，行数: 528
执行查询: ID=541499305, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, ar.check_in, ar.check_out FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-14';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-14'
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=607760760, DB=hr
执行标准SQL: SELECT DISTINCT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '优秀员工' AND a.year = 2021 AND ar.date > '2021-01-01';
执行预测SQL: SELECT DISTINCT e.name AS name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2021 AND a.award_name = '优秀员工' AND ar.date > '2021-01-01'
标准SQL执行成功，行数: 50
预测SQL执行成功，行数: 50
执行查询: ID=3786409554, DB=hr
执行标准SQL: SELECT AVG(e.remaining_annual_leave) AS avg_remaining_annual_leave FROM awards a JOIN employees e ON a.employee_id = e.employee_id WHERE a.year = 2024 AND a.award_name = '领导力奖' AND e.hire_date > '2017-01-01';
执行预测SQL: SELECT AVG(e.remaining_annual_leave) AS avg_remaining_annual_leave
FROM employees e
JOIN awards a ON e.employee_id = a.employee_id
WHERE a.year = 2024
AND a.award_name = '领导力奖'
AND e.hire_date > '2017-01-01'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=1833538335, DB=hr
执行标准SQL: SELECT e.employee_id, e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id WHERE a.award_name IN ('创新奖', '关键决策奖')
执行预测SQL: SELECT DISTINCT e.employee_id AS employee_id, e.name AS name 
FROM employees e 
JOIN awards a ON e.employee_id = a.employee_id 
WHERE a.award_name IN ('质量改进奖', '领导力奖', '创新突破奖') 
AND e.employee_id NOT IN (SELECT employee_id FROM awards WHERE award_name = '优秀员工') 
AND e.employee_id NOT IN (SELECT employee_id FROM performance_evaluations WHERE rating IN ('优秀', '良好'))
标准SQL执行成功，行数: 973
预测SQL执行成功，行数: 1916

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回973行, 预测SQL返回1916行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_id name]
[35m预测SQL列:[0m [employee_id name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [H00003 钱娜]
[35m预测[1]:[0m [H08011 王秀英]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [H00015 王静]
[35m预测[2]:[0m [H04521 郑强]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [H00020 钱娜]
[35m预测[3]:[0m [H02070 吴芳]
执行查询: ID=2571560082, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-12-07' AND pe.rating = 'B';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-12-07' AND pe.rating = 'B'
执行查询: ID=3184081384, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, a.award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE e.hire_date >= '2023-01-01' AND e.hire_date < '2024-01-01' AND a.year = 2023;
执行预测SQL: SELECT e.name AS name, d.name AS department_name, a.award_name AS award_name FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN awards a ON e.employee_id = a.employee_id WHERE EXTRACT(YEAR FROM e.hire_date) = 2023 AND a.year = 2023
标准SQL执行成功，行数: 340
预测SQL执行成功，行数: 340
执行查询: ID=3265054996, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-25' AND d.name = '销售部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-25' AND a.check_in > '09:00:00' AND d.name = '销售部'
标准SQL执行成功，行数: 518
预测SQL执行成功，行数: 518
执行查询: ID=1987469456, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '质量控制部' AND a.date = '2024-09-20' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '质量控制部' 
AND a.date = '2024-09-20' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 511
预测SQL执行成功，行数: 511
执行查询: ID=3475714298, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-29' AND d.name = '客户服务部' AND EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600 > 10;
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out
FROM employees e
JOIN departments d ON e.department_id::integer = d.id
JOIN attendance_records a ON e.employee_id = a.employee_id
WHERE d.name = '客户服务部'
AND a.date = '2024-09-29'
AND (a.check_out - a.check_in) > INTERVAL '10 hours'
预测SQL执行错误: SQL执行失败: pq: invalid input syntax for type integer: "D00008"
预测SQL执行错误: SQL执行失败: pq: invalid input syntax for type integer: "D00008"
已处理 180/1042 个查询...
执行查询: ID=3158837504, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-04' AND a.check_in > '08:30:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.date = '2024-10-04' AND a.check_in > '08:30:00' AND pe.rating = 'A+'
标准SQL执行成功，行数: 1227
预测SQL执行成功，行数: 1227
执行查询: ID=1341335041, DB=hr
执行标准SQL: SELECT employee_id, COUNT(*) AS late_days FROM attendance_records WHERE check_in > '09:00:00' GROUP BY employee_id;
执行预测SQL: SELECT e.employee_id, COUNT(CASE WHEN a.check_in > '08:00:00' THEN 1 END) AS late_days 
FROM employees e 
LEFT JOIN attendance_records a ON e.employee_id = a.employee_id 
GROUP BY e.employee_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_id late_days]
[35m预测SQL列:[0m [employee_id late_days]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [H06903 10]
[35m预测[1]:[0m [H06903 30]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [H05342 16]
[35m预测[2]:[0m [H05342 30]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [H06140 14]
[35m预测[3]:[0m [H06140 30]
执行查询: ID=1248129462, DB=hr
执行标准SQL: SELECT e.name, e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-15' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-09-15' AND p.rating = 'A+'
标准SQL执行成功，行数: 1638
预测SQL执行成功，行数: 1638
执行查询: ID=2929076718, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '最佳团队奖' AND a.year = 2021 AND ar.date = '2024-09-19';
执行预测SQL: SELECT DISTINCT e.name AS name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2021 AND a.award_name = '最佳团队奖' AND ar.date = '2024-09-19'
标准SQL执行成功，行数: 107
预测SQL执行成功，行数: 65

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回107行, 预测SQL返回65行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name]
[35m预测SQL列:[0m [name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [钱强]
[35m预测[1]:[0m [刘丽]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [张静]
[35m预测[2]:[0m [刘军]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [赵丽]
[35m预测[3]:[0m [刘娜]
执行查询: ID=860593492, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '客户服务部' AND a.date = '2024-09-21';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.id::character varying 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '客户服务部' AND a.date = '2024-09-21'
标准SQL执行成功，行数: 931
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回931行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=803138423, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-23' AND a.check_in < '09:30:00' AND d.name = '财务部';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '财务部' 
AND a.date = '2024-09-23' 
AND a.check_in < '09:30:00'
标准SQL执行成功，行数: 754
预测SQL执行成功，行数: 754
执行查询: ID=1392351924, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-09' AND a.check_in > '09:00:00' AND e.employee_type = '实习生';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.employee_type = '实习生' AND a.date = '2024-10-09' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 1664
预测SQL执行成功，行数: 1664
执行查询: ID=2647170145, DB=hr
执行标准SQL: SELECT e.name, a.date, a.check_in, a.check_out FROM awards a1 JOIN employees e ON a1.employee_id = e.employee_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a1.award_name = '项目管理奖' AND a1.year = 2023 AND a.date = '2024-09-23';
执行预测SQL: SELECT e.name AS name, a.date AS date, a.check_in AS check_in, a.check_out AS check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN awards aw ON e.employee_id = aw.employee_id WHERE aw.year = 2023 AND aw.award_name = '项目管理奖' AND a.date = '2024-09-23'
标准SQL执行成功，行数: 314
预测SQL执行成功，行数: 314
执行查询: ID=2581619009, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE e.hire_date >= '2022-01-01' AND e.hire_date < '2023-01-01' AND a.year = 2023 AND pe.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE EXTRACT(YEAR FROM e.hire_date) = 2022 AND a.year = 2023 AND pe.rating = 'A+'
标准SQL执行成功，行数: 32
预测SQL执行成功，行数: 32
执行查询: ID=2697889458, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-13' AND d.name = '人力资源部';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-13' AND d.name = '人力资源部'
已处理 190/1042 个查询...
执行查询: ID=3387668548, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '行政部' AND a.date = '2024-09-18' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '行政部' 
AND a.date = '2024-09-18' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 498
预测SQL执行成功，行数: 498
执行查询: ID=1417292000, DB=hr
执行标准SQL: SELECT '导师计划' AS factor, COUNT(*) AS contribution FROM employees WHERE employee_id IN (SELECT employee_id FROM performance_evaluations WHERE rating = 'A+') UNION ALL SELECT '培训课程' AS factor, COUNT(*) AS contribution FROM employees WHERE employee_id IN (SELECT employee_id FROM performance_evaluations WHERE rating = 'A+') UNION ALL SELECT '轮岗经历' AS factor, COUNT(*) AS contribution FROM employees WHERE employee_id IN (SELECT employee_id FROM performance_evaluations WHERE rating = 'A+') ORDER BY contribution DESC;
执行预测SQL: SELECT '导师计划' AS factor, '数据库中未存储关于导师计划、培训课程、轮岗经历等影响新员工成长的关键因素数据' AS contribution UNION ALL
SELECT '培训课程', '数据库中未存储关于导师计划、培训课程、轮岗经历等影响新员工成长的关键因素数据' UNION ALL
SELECT '轮岗经历', '数据库中未存储关于导师计划、培训课程、轮岗经历等影响新员工成长的关键因素数据'
标准SQL执行成功，行数: 3
预测SQL执行成功，行数: 3

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [factor contribution]
[35m预测SQL列:[0m [factor contribution]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [导师计划 1638]
[35m预测[1]:[0m [导师计划 数据库中未存储关于导师计划、培训课程、轮岗经历等影响新员工成长的关键因素数据]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [培训课程 1638]
[35m预测[2]:[0m [培训课程 数据库中未存储关于导师计划、培训课程、轮岗经历等影响新员工成长的关键因素数据]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [轮岗经历 1638]
[35m预测[3]:[0m [轮岗经历 数据库中未存储关于导师计划、培训课程、轮岗经历等影响新员工成长的关键因素数据]
执行查询: ID=1597423542, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '销售部' AND a.date = '2024-09-20' AND a.check_in > '08:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '销售部' 
AND a.date = '2024-09-20' 
AND a.check_in > '08:00:00'
标准SQL执行成功，行数: 987
预测SQL执行成功，行数: 987
执行查询: ID=3397723976, DB=hr
执行标准SQL: SELECT e.department_id, e.employee_id, e.name, MAX(AGE(date('now'), e.birth_date)) AS max_age FROM employees e GROUP BY e.department_id, e.employee_id, e.name;
执行预测SQL: SELECT d.department_id AS department_id, e.employee_id AS employee_id, e.name AS name, EXTRACT(YEAR FROM AGE(e.birth_date)) AS max_age FROM departments d JOIN employees e ON d.department_id = e.department_id WHERE (d.department_id, e.birth_date) IN (SELECT department_id, MIN(birth_date) FROM employees GROUP BY department_id)
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10000行, 预测SQL返回10行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [department_id employee_id name max_age]
[35m预测SQL列:[0m [department_id employee_id name max_age]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [D00003 H09049 吴伟 53]
[35m预测[1]:[0m [D00008 H00387 张军 55]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [D00005 H06690 钱芳 29]
[35m预测[2]:[0m [D00002 H00814 刘娜 55]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [D00010 H04888 周伟 34]
[35m预测[3]:[0m [D00005 H02651 刘丽 55]
执行查询: ID=339893232, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-30' AND d.name = '人力资源部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '人力资源部' 
AND a.date = '2024-09-30' 
AND a.check_in > '09:00:00'::time
标准SQL执行成功，行数: 517
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回517行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=244305078, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-18' AND d.name = '研发部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '研发部' AND a.date = '2024-09-18' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 510
预测SQL执行成功，行数: 510
执行查询: ID=2030661443, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-28' AND a.check_in > '09:30:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-09-28' AND a.check_in > '09:30:00' AND pe.rating = 'A+'
标准SQL执行成功，行数: 411
预测SQL执行成功，行数: 411
执行查询: ID=2290320497, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-17' AND a.check_in > '09:00:00' AND p.rating = 'B';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, p.rating AS rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-17' AND a.check_in > '09:00' AND p.rating = 'B'
标准SQL执行成功，行数: 862
预测SQL执行成功，行数: 862
执行查询: ID=2134005508, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.date, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-22' AND p.rating = 'D';
执行预测SQL: SELECT e.name AS name, a.employee_id AS employee_id, a.date AS date, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.date = '2024-09-22' AND pe.rating = 'D'
标准SQL执行成功，行数: 1655
预测SQL执行成功，行数: 1655
执行查询: ID=3179866905, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.date, a.check_in, a.check_out, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-03' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.employee_id AS employee_id, a.date AS date, a.check_in AS check_in, a.check_out AS check_out, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-10-03' AND pe.rating = 'A+'
标准SQL执行成功，行数: 1638
预测SQL执行成功，行数: 1638
已处理 200/1042 个查询...
执行查询: ID=1447725797, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '客户服务部' AND a.date = '2024-10-07' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE a.date = '2024-10-07' 
AND a.check_in > TIME '09:00' 
AND d.name = '客户服务部'
标准SQL执行成功，行数: 459
预测SQL执行成功，行数: 459
执行查询: ID=3166523944, DB=hr
执行标准SQL: SELECT ar.employee_id, ar.date, ar.check_in, ar.check_out, pe.rating FROM attendance_records ar JOIN performance_evaluations pe ON ar.employee_id = pe.employee_id;
执行预测SQL: SELECT a.employee_id AS employee_id, a.date AS date, a.check_in AS check_in, a.check_out AS check_out, p.rating AS rating FROM attendance_records a LEFT JOIN performance_evaluations p ON a.employee_id = p.employee_id
标准SQL执行成功，行数: 300000
预测SQL执行成功，行数: 300000
执行查询: ID=3133264714, DB=hr
执行标准SQL: SELECT e.name, a.award_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN awards a ON e.employee_id = a.employee_id WHERE ar.date = '2024-10-05' AND ar.check_in > '09:00:00' AND a.year = 2021;
执行预测SQL: SELECT e.name AS employee_name, a.award_name 
FROM attendance_records ar 
JOIN employees e ON ar.employee_id = e.employee_id 
JOIN awards a ON e.employee_id = a.employee_id 
WHERE ar.date = '2024-10-05' 
AND ar.check_in > '09:00' 
AND a.year = 2021
标准SQL执行成功，行数: 482
预测SQL执行成功，行数: 482
执行查询: ID=2850698943, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '质量控制部' AND a.date = '2024-09-25' AND a.check_in > '08:30:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM attendance_records a 
JOIN employees e ON a.employee_id = e.employee_id 
JOIN departments d ON e.department_id::integer = d.id 
WHERE a.date = '2024-09-25' 
AND a.check_in > '08:30:00' 
AND d.name = '质量控制部'
预测SQL执行错误: SQL执行失败: pq: invalid input syntax for type integer: "D00008"
预测SQL执行错误: SQL执行失败: pq: invalid input syntax for type integer: "D00008"
执行查询: ID=2860363666, DB=hr
执行标准SQL: WITH QuarterlyPerformance AS (SELECT EXTRACT(YEAR FROM evaluation_date) AS year, EXTRACT(QUARTER FROM evaluation_date) AS quarter, employee_id, RANK() OVER (PARTITION BY EXTRACT(YEAR FROM evaluation_date), EXTRACT(QUARTER FROM evaluation_date) ORDER BY rating DESC) AS performance_rank FROM performance_evaluations WHERE evaluation_date >= date('now') - INTERVAL '3 years'), QuarterlyAttendance AS (SELECT EXTRACT(YEAR FROM date) AS year, EXTRACT(QUARTER FROM date) AS quarter, employee_id, COUNT(*) FILTER (WHERE check_in IS NOT NULL AND check_out IS NOT NULL) AS full_attendance_days, COUNT(*) AS total_days, RANK() OVER (PARTITION BY EXTRACT(YEAR FROM date), EXTRACT(QUARTER FROM date) ORDER BY COUNT(*) FILTER (WHERE check_in IS NOT NULL AND check_out IS NOT NULL) DESC) AS attendance_rank FROM attendance_records WHERE date >= date('now') - INTERVAL '3 years' GROUP BY EXTRACT(YEAR FROM date), EXTRACT(QUARTER FROM date), employee_id) SELECT qp.year, qp.quarter, qp.employee_id FROM QuarterlyPerformance qp JOIN QuarterlyAttendance qa ON qp.year = qa.year AND qp.quarter = qa.quarter AND qp.employee_id = qa.employee_id WHERE qp.performance_rank = 1 AND qa.attendance_rank = 1;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3284872060, DB=hr
执行标准SQL: SELECT a.employee_id, e.name, a.award_name, pe.rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2023 AND pe.rating = 'A+';
执行预测SQL: SELECT a.employee_id AS employee_id, e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.year = 2023 AND pe.rating = 'A+'
标准SQL执行成功，行数: 236
预测SQL执行成功，行数: 236
执行查询: ID=1370529433, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '质量改进奖' AND a.year = 2022 AND ar.date = '2024-10-04' AND ar.check_in > '08:00:00';
执行预测SQL: SELECT e.name AS name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2022 AND a.award_name = '质量改进奖' AND ar.date = '2024-10-04' AND ar.check_in > '09:00:00'
标准SQL执行成功，行数: 200
预测SQL执行成功，行数: 110

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回200行, 预测SQL返回110行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name]
[35m预测SQL列:[0m [name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [钱静]
[35m预测[1]:[0m [李磊]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [李磊]
[35m预测[2]:[0m [孙军]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [孙军]
[35m预测[3]:[0m [吴娜]
执行查询: ID=4101493476, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-03' AND a.check_in > '09:00:00' AND d.name = '客户服务部';
执行预测SQL: SELECT d.name AS name, e.employee_id AS employee_id, a.check_in AS check_in_time 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '客户服务部' 
AND a.date = '2024-10-03' 
AND a.check_in > TIME '09:00:00'
标准SQL执行成功，行数: 471
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回471行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1724137514, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '人力资源部' AND a.date = '2024-10-02' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '人力资源部' 
AND a.date = '2024-10-02' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 513
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回513行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3595600525, DB=hr
执行标准SQL: SELECT e.name, p.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '优秀员工' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, pe.rating AS rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2023 AND a.award_name = '优秀员工' AND pe.rating = 'A+'
标准SQL执行成功，行数: 11
预测SQL执行成功，行数: 11
已处理 210/1042 个查询...
执行查询: ID=815548435, DB=hr
执行标准SQL: SELECT d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-05-31' AND pe.rating = 'A+';
执行预测SQL: SELECT DISTINCT departments.name AS department_name 
FROM performance_evaluations 
JOIN employees ON performance_evaluations.employee_id = employees.employee_id 
JOIN departments ON employees.department_id = departments.department_id 
WHERE performance_evaluations.evaluation_date = '2023-05-31' 
AND performance_evaluations.rating = 'A+'
标准SQL执行成功，行数: 2
预测SQL执行成功，行数: 2
执行查询: ID=2061849622, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-02' AND a.check_in > '09:00:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.date = '2024-10-02' AND pe.rating = 'A+' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 772
预测SQL执行成功，行数: 772
执行查询: ID=1250267679, DB=hr
执行标准SQL: SELECT ar.date, ar.check_in, ar.check_out FROM attendance_records ar JOIN awards a ON ar.employee_id = a.employee_id WHERE a.award_name = '销售冠军' AND a.year = 2021 AND ar.date = '2024-09-18';
执行预测SQL: SELECT date AS attendance_date, check_in AS check_in_time, check_out AS check_out_time FROM attendance_records WHERE employee_id IN (SELECT employee_id FROM awards WHERE year = 2021 AND award_name = '销售冠军') AND date = '2024-09-18'
标准SQL执行成功，行数: 137
预测SQL执行成功，行数: 137
执行查询: ID=1929429344, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-05-27' AND pe.rating = 'A+';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name 
FROM performance_evaluations pe 
JOIN employees e ON pe.employee_id = e.employee_id 
JOIN departments d ON e.department_id = d.department_id 
WHERE pe.evaluation_date = '2023-05-27' AND pe.rating = 'A+'
执行查询: ID=3689323727, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-16' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-16' AND ar.check_in > '09:00:00'
执行查询: ID=2977986068, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM employees e JOIN departments d ON e.department_id = d.department_id;
执行预测SQL: SELECT employees.name AS employee_name, departments.name AS department_name FROM employees LEFT JOIN departments ON employees.department_id = departments.id::text
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据行数不匹配 (策略: exact_column_names)
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_name department_name]
[35m预测SQL列:[0m [employee_name department_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [吴芳 法务部]
[35m预测[1]:[0m [吴芳 <nil>]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [李军 质量控制部]
[35m预测[2]:[0m [李军 <nil>]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [钱娜 财务部]
[35m预测[3]:[0m [钱娜 <nil>]
执行查询: ID=3402561235, DB=hr
执行标准SQL: SELECT * FROM employees ORDER BY hire_date ASC, position DESC LIMIT 1;
执行预测SQL: SELECT id, employee_id, name, birth_date, hire_date, start_work_date, remaining_annual_leave, department_id, position AS job_title, phone_number, car_plate, university, major, employee_type FROM employees ORDER BY hire_date ASC, position ASC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=3958686389, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE e.department_id = 'D00007' AND pe.rating = 'A' AND pe.evaluation_date >= '2024-01-01' AND pe.evaluation_date < '2025-01-01';
执行预测SQL: SELECT e.name FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE d.department_id = 'D00007' AND EXTRACT(YEAR FROM pe.evaluation_date) = 2024 AND pe.rating = 'A'
标准SQL执行成功，行数: 12
预测SQL执行成功，行数: 12
执行查询: ID=3786147845, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '创新奖' AND a.year = 2022 AND ar.date = '2024-10-12' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT DISTINCT e.name AS name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2022 AND a.award_name = '创新奖' AND ar.date = '2024-10-12' AND ar.check_in > '09:00'
标准SQL执行成功，行数: 32
预测SQL执行成功，行数: 29

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回32行, 预测SQL返回29行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name]
[35m预测SQL列:[0m [name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [刘磊]
[35m预测[1]:[0m [刘伟]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [王伟]
[35m预测[2]:[0m [刘军]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [张丽]
[35m预测[3]:[0m [刘磊]
执行查询: ID=1159542995, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-23' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-23' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 4988
预测SQL执行成功，行数: 4988
已处理 220/1042 个查询...
执行查询: ID=3254827737, DB=hr
执行标准SQL: SELECT COUNT(DISTINCT a.employee_id) FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.award_name = '质量改进奖' AND a.year = 2023 AND p.rating = 'A+';
执行预测SQL: SELECT COUNT(DISTINCT a.employee_id) AS count FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '质量改进奖' AND p.rating = 'A+'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=3909320290, DB=hr
执行标准SQL: SELECT d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-23' AND ar.check_in > '08:00:00' AND ar.check_out < '18:00:00';
执行预测SQL: SELECT DISTINCT d.name AS department_name 
FROM attendance_records ar 
JOIN employees e ON ar.employee_id = e.employee_id 
JOIN departments d ON e.department_id = d.department_id 
WHERE ar.date = '2024-09-23' 
AND ar.check_in > '08:00:00' 
AND ar.check_out < '18:00:00'
标准SQL执行成功，行数: 3420
预测SQL执行成功，行数: 10

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回3420行, 预测SQL返回10行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [department_name]
[35m预测SQL列:[0m [department_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [法务部]
[35m预测[1]:[0m [人力资源部]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [人力资源部]
[35m预测[2]:[0m [客户服务部]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [研发部]
[35m预测[3]:[0m [市场部]
执行查询: ID=628072208, DB=hr
执行标准SQL: SELECT d.name AS department_name, e.name AS employee_name FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN awards a ON e.employee_id = a.employee_id JOIN interviews i ON e.employee_id = i.employee_id WHERE a.award_name = '优秀员工' AND i.interview_date = '2023-10-09';
执行预测SQL: SELECT DISTINCT e.name AS employee_name, d.name AS department_name 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN interviews i ON e.employee_id = i.employee_id 
JOIN awards a ON e.employee_id = a.employee_id 
WHERE i.interview_date::date = '2023-10-09' 
AND a.year = 2023 
AND a.award_name LIKE '%优秀员工%'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=3286899081, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-12' AND a.check_in < '09:00:00' AND p.rating = 'B+';
执行预测SQL: SELECT e.name AS name, ar.check_in AS check_in FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-10-12' AND ar.check_in < '09:00:00' AND pe.rating = 'B+'
标准SQL执行成功，行数: 776
预测SQL执行成功，行数: 776
执行查询: ID=2517269758, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-20' AND a.check_in > '09:00:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM attendance_records a 
JOIN employees e ON a.employee_id = e.employee_id 
JOIN performance_evaluations p ON a.employee_id = p.employee_id 
WHERE a.date = '2024-09-20' 
AND a.check_in > '09:00:00' 
AND p.rating = 'A+'
标准SQL执行成功，行数: 854
预测SQL执行成功，行数: 854
执行查询: ID=3866100328, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2021 AND a.award_name = '质量改进奖' AND pe.rating = 'B+';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM awards a JOIN performance_evaluations pe ON a.employee_id = pe.employee_id JOIN employees e ON a.employee_id = e.employee_id WHERE a.year = 2021 AND a.award_name = '质量改进奖' AND pe.rating = 'B+'
标准SQL执行成功，行数: 32
预测SQL执行成功，行数: 32
执行查询: ID=3469101707, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-29' AND a.check_in > '08:30:00' AND d.name = '客户服务部';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '客户服务部' 
AND a.date = '2024-09-29' 
AND a.check_in > '08:30:00'
标准SQL执行成功，行数: 715
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回715行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=2797510377, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, d.manager_id FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-16' AND ar.check_in > '08:30:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, d.manager_id AS manager_id FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-16' AND ar.check_in > '08:30:00'
标准SQL执行成功，行数: 7463
预测SQL执行成功，行数: 7463
执行查询: ID=2587625643, DB=hr
执行标准SQL: SELECT e.name, e.position, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-10-01' AND a.check_in > '09:00:00' AND e.position = '顾问';
执行预测SQL: SELECT e.name AS name, e.position AS position, a.check_in AS check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-01' AND a.check_in > '09:00' AND e.position = '顾问'
标准SQL执行成功，行数: 507
预测SQL执行成功，行数: 507
执行查询: ID=2556819995, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '客户服务部' AND a.date = '2024-09-23' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM attendance_records a 
JOIN employees e ON a.employee_id = e.employee_id 
JOIN departments d ON e.department_id = d.department_id 
WHERE a.date = '2024-09-23' 
AND a.check_in > '09:00:00' 
AND d.name = '客户服务部'
标准SQL执行成功，行数: 452
预测SQL执行成功，行数: 452
已处理 230/1042 个查询...
执行查询: ID=2163155798, DB=hr
执行标准SQL: SELECT a.year, e.name, a.award_name, pe.status
FROM awards a
JOIN employees e ON a.employee_id = e.employee_id
LEFT JOIN probation_employees pe ON a.employee_id = pe.employee_id
WHERE a.award_name = '创新奖' AND a.year >= EXTRACT(YEAR FROM date('now')) - 5;
执行预测SQL: SELECT 
  a.year AS year, 
  e.name AS name, 
  a.award_name AS award_name, 
  p.status AS status 
FROM 
  awards a 
JOIN 
  employees e ON a.employee_id = e.employee_id 
LEFT JOIN 
  probation_employees p ON a.employee_id = p.employee_id 
WHERE 
  a.award_name = '技术创新奖' 
  AND a.year >= EXTRACT(YEAR FROM CURRENT_DATE) - 5
标准SQL执行成功，行数: 347
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回347行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1599035554, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-06' AND a.check_in > '09:00:00' AND d.name = '财务部';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '财务部' 
AND a.date = '2024-10-06' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 500
预测SQL执行成功，行数: 500
执行查询: ID=3248411469, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-04' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-04' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 5047
预测SQL执行成功，行数: 5047
执行查询: ID=2257279104, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-04';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-04'
执行查询: ID=2036213054, DB=hr
执行标准SQL: SELECT a.employee_id, a.award_name, pe.rating, pe.evaluation_date FROM awards a JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.year = 2023 AND pe.evaluation_date >= '2023-01-01' AND pe.evaluation_date < '2024-01-01';
执行预测SQL: SELECT a.employee_id AS employee_id, a.award_name AS award_name, pe.rating AS rating, pe.evaluation_date AS evaluation_date FROM awards a INNER JOIN performance_evaluations pe ON a.employee_id = pe.employee_id WHERE a.year = 2023 AND EXTRACT(YEAR FROM pe.evaluation_date) = 2023
标准SQL执行成功，行数: 404
预测SQL执行成功，行数: 404
执行查询: ID=2231439732, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-10' AND ar.check_in > '09:30:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-10' AND a.check_in > '09:30:00'
标准SQL执行成功，行数: 2473
预测SQL执行成功，行数: 2473
执行查询: ID=1852561007, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-19';
执行预测SQL: SELECT e.name AS name, d.name AS department_name, ar.check_in, ar.check_out FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE ar.date = '2024-09-19'
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3057784484, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-03' AND d.name = '行政部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '行政部' AND a.date = '2024-10-03' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 477
预测SQL执行成功，行数: 477
执行查询: ID=604055577, DB=hr
执行标准SQL: SELECT e.department_id, AVG(e.remaining_annual_leave) AS avg_remaining_annual_leave FROM employees e GROUP BY e.department_id ORDER BY avg_remaining_annual_leave DESC LIMIT 1;
执行预测SQL: SELECT employees.department_id AS department_id, AVG(employees.remaining_annual_leave) AS avg_remaining_annual_leave 
FROM employees 
GROUP BY employees.department_id 
ORDER BY avg_remaining_annual_leave DESC 
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=1799658813, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-27' AND a.check_in < '10:00:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM attendance_records a JOIN performance_evaluations pe ON a.employee_id = pe.employee_id JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-09-27' AND a.check_in < '10:00:00' AND pe.rating = 'A+'
标准SQL执行成功，行数: 1638
预测SQL执行成功，行数: 1638
已处理 240/1042 个查询...
执行查询: ID=556306212, DB=hr
执行标准SQL: SELECT interview_date, interview_count FROM interviews WHERE interview_date >= '2024-01-01' AND interview_date < '2025-01-01';
执行预测SQL: SELECT interview_date AS interview_date, interview_count AS interview_count FROM interviews WHERE interview_date BETWEEN '2024-01-01' AND '2024-12-31'
标准SQL执行成功，行数: 468
预测SQL执行成功，行数: 468
执行查询: ID=3669286537, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-20' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-20' AND ar.check_in > '09:00:00'
执行查询: ID=1975822937, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, d.name AS department_name, pe.rating FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE d.name = '研发部' AND pe.rating = 'B+' AND ar.date = '2024-09-29';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, d.name AS department_name, pe.rating AS rating FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE d.name = '研发部' AND pe.evaluation_date = '2024-09-29' AND pe.rating = 'B+'
标准SQL执行成功，行数: 169
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回169行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1362951886, DB=hr
执行标准SQL: SELECT ar.id, ar.employee_id, ar.date, ar.check_in, ar.check_out FROM attendance_records ar JOIN awards a ON ar.employee_id = a.employee_id WHERE a.award_name = '销售冠军' AND a.year = 2022 AND ar.date = '2024-10-10';
执行预测SQL: SELECT a.id AS id, a.employee_id AS employee_id, a.date AS date, a.check_in AS check_in, a.check_out AS check_out 
FROM attendance_records a 
WHERE a.employee_id IN (SELECT employee_id FROM awards WHERE year = 2022 AND award_name = '销售冠军') 
AND a.date = '2024-10-10'
标准SQL执行成功，行数: 149
预测SQL执行成功，行数: 149
执行查询: ID=2799760973, DB=hr
执行标准SQL: SELECT e.name, e.hire_date, a.award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id WHERE a.award_name = '客户满意度奖' AND a.year = 2023 AND e.hire_date > '2020-06-19';
执行预测SQL: SELECT e.name AS name, e.hire_date AS hire_date, a.award_name AS award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id WHERE a.year = 2023 AND a.award_name = '客户满意度奖' AND e.hire_date > '2020-06-19'
标准SQL执行成功，行数: 119
预测SQL执行成功，行数: 119
执行查询: ID=1692765210, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-22' AND a.check_in > '09:00:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-09-22' AND a.check_in > '09:00:00' AND pe.rating = 'A+'
标准SQL执行成功，行数: 795
预测SQL执行成功，行数: 795
执行查询: ID=804998806, DB=hr
执行标准SQL: SELECT d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2022-06-20' AND pe.rating = 'C';
执行预测SQL: SELECT DISTINCT departments.name AS department_name FROM performance_evaluations JOIN employees ON performance_evaluations.employee_id = employees.employee_id JOIN departments ON employees.department_id = departments.department_id WHERE performance_evaluations.rating = 'C' AND performance_evaluations.evaluation_date = '2022-06-20'
标准SQL执行成功，行数: 2
预测SQL执行成功，行数: 2
执行查询: ID=170694593, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.award_name = '客户满意度奖' AND a.year = 2024 AND pe.rating = 'C';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2024 AND a.award_name = '客户满意度奖' AND pe.rating = 'C'
标准SQL执行成功，行数: 7
预测SQL执行成功，行数: 7
执行查询: ID=2091607073, DB=hr
执行标准SQL: SELECT e.name, AVG(EXTRACT(EPOCH FROM (ar.check_out - ar.check_in)) / 3600) AS avg_work_hours FROM employees e JOIN attendance_records ar ON e.employee_id = ar.employee_id JOIN awards a ON e.employee_id = a.employee_id WHERE a.award_name = '项目管理奖' AND a.year = 2023 GROUP BY e.name HAVING AVG(EXTRACT(EPOCH FROM (ar.check_out - ar.check_in)) / 3600) > 10;
执行预测SQL: SELECT e.name AS name, AVG(EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600) AS avg_work_hours FROM awards w JOIN employees e ON w.employee_id = e.employee_id JOIN attendance_records a ON w.employee_id = a.employee_id WHERE w.year = 2023 AND w.award_name = '项目管理奖' GROUP BY e.name HAVING AVG(EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600) > 10
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=2894384990, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-03-09' AND pe.rating = 'D';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-03-09' AND pe.rating = 'D'
已处理 250/1042 个查询...
执行查询: ID=1149281173, DB=hr
执行标准SQL: SELECT e.employee_id, e.name, e.major, e.hire_date, pe.rating, a.award_name
FROM employees e
JOIN performance_evaluations pe ON e.employee_id = pe.employee_id
LEFT JOIN awards a ON e.employee_id = a.employee_id
WHERE e.major IS NOT NULL AND e.hire_date < date('now') - INTERVAL '5 years'
ORDER BY pe.rating DESC;
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=1884200158, DB=hr
执行标准SQL: SELECT e.name, d.name AS department_name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-08';
执行预测SQL: SELECT e.name AS name, d.name AS department_name, ar.check_in, ar.check_out FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-10-08'
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2557740373, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-26' AND a.check_in > '09:00:00' AND d.name = '人力资源部';
执行预测SQL: SELECT e.name AS employee_name, e.employee_id, a.check_in 
FROM employees e 
JOIN departments d ON CAST(e.department_id AS integer) = d.id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '人力资源部' 
AND a.date = '2024-09-26' 
AND a.check_in > '09:00:00'
预测SQL执行错误: SQL执行失败: pq: invalid input syntax for type integer: "D00008"
预测SQL执行错误: SQL执行失败: pq: invalid input syntax for type integer: "D00008"
执行查询: ID=3799739588, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-28' AND a.check_in > '09:00:00' AND p.rating = 'A+';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM employees e 
JOIN attendance_records a ON e.employee_id = a.employee_id 
JOIN performance_evaluations p ON e.employee_id = p.employee_id 
WHERE a.date = '2024-09-28' 
AND a.check_in > '09:00:00' 
AND p.rating = 'A+'
标准SQL执行成功，行数: 817
预测SQL执行成功，行数: 817
执行查询: ID=1074403791, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '研发部' AND a.date = '2024-09-20' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, a.check_in AS check_in_time 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '研发部' 
AND a.date = '2024-09-20' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 515
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回515行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1640643914, DB=hr
执行标准SQL: SELECT d.name AS department_name, e.name AS employee_name FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-10-13' AND ar.check_in > '09:00:00' AND pe.rating = 'A+';
执行预测SQL: SELECT d.name AS department_name, e.name AS employee_name FROM employees e JOIN departments d ON e.department_id = d.department_id WHERE e.employee_id IN (SELECT employee_id FROM attendance_records WHERE date = '2024-10-13' AND check_in > '09:00:00') AND e.employee_id IN (SELECT employee_id FROM performance_evaluations WHERE rating = 'A+')
标准SQL执行成功，行数: 792
预测SQL执行成功，行数: 792
执行查询: ID=3875469036, DB=hr
执行标准SQL: SELECT e.name, a.award_name, p.rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '销售冠军' AND p.rating IN ('B', 'A+', 'A')
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating 
FROM awards a 
JOIN employees e ON a.employee_id = e.employee_id 
JOIN performance_evaluations pe ON a.employee_id = pe.employee_id 
WHERE a.year = 2023 
AND a.award_name = '销售冠军' 
AND pe.rating IN ('A', 'B')
标准SQL执行成功，行数: 62
预测SQL执行成功，行数: 47

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回62行, 预测SQL返回47行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name award_name rating]
[35m预测SQL列:[0m [name award_name rating]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [周秀英 销售冠军 A+]
[35m预测[1]:[0m [周强 销售冠军 A]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [刘军 销售冠军 A+]
[35m预测[2]:[0m [张伟 销售冠军 A]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [钱磊 销售冠军 A+]
[35m预测[3]:[0m [钱娜 销售冠军 A]
执行查询: ID=1182082319, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-17' AND d.name = '财务部' AND EXTRACT(HOUR FROM (a.check_out - a.check_in)) >= 9;
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '财务部' 
AND a.date = '2024-09-17' 
AND (a.check_out - a.check_in) > INTERVAL '9 hours'
标准SQL执行成功，行数: 675
预测SQL执行成功，行数: 675
执行查询: ID=219564979, DB=hr
执行标准SQL: SELECT e.name AS employee_name, e.employee_id, a.check_in, d.name AS department_name, d.manager_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-18' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, a.employee_id, a.check_in, d.name AS department_name, d.manager_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-18' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 4952
预测SQL执行成功，行数: 4952
执行查询: ID=2296352057, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN awards aw ON e.employee_id = aw.employee_id WHERE aw.award_name = '技术突破奖' AND aw.year = 2023 AND a.date = '2024-09-23' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in 
FROM employees e 
JOIN attendance_records a ON e.employee_id = a.employee_id 
JOIN awards aw ON e.employee_id = aw.employee_id 
WHERE aw.year = 2023 
AND aw.award_name = '技术突破奖' 
AND a.date = '2024-09-23' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 76
预测SQL执行成功，行数: 76
已处理 260/1042 个查询...
执行查询: ID=3848854887, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '运营部' AND a.date = '2024-09-26';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON d.id::text = e.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '运营部' AND a.date = '2024-09-26'
标准SQL执行成功，行数: 979
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回979行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=4144781586, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.year = 2020 AND a.award_name = '优秀员工' AND p.rating = 'C' AND p.evaluation_date >= '2023-01-01' AND p.evaluation_date < '2024-01-01';
执行预测SQL: SELECT DISTINCT e.name AS name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2020 AND a.award_name = '优秀员工' AND pe.evaluation_date BETWEEN '2023-01-01' AND '2023-12-31' AND pe.rating = 'C'
标准SQL执行成功，行数: 8
预测SQL执行成功，行数: 8
执行查询: ID=543593806, DB=hr
执行标准SQL: SELECT e.name, a.check_in, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-03' AND a.check_in > '09:00:00' AND p.rating = 'C';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in, pe.rating AS rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.date = '2024-10-03' AND a.check_in > '09:00:00' AND pe.rating = 'C'
标准SQL执行成功，行数: 861
预测SQL执行成功，行数: 861
执行查询: ID=3302179394, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-12' AND d.name = '法务部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '法务部' 
AND a.date = '2024-10-12' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 501
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回501行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1798514231, DB=hr
执行标准SQL: WITH InterviewCounts AS (SELECT EXTRACT(YEAR FROM interview_date) AS year, department_id, COUNT(*) AS total_interviews FROM interviews JOIN employees ON interviews.employee_id = employees.employee_id WHERE interview_date >= date('now') - INTERVAL '5 years' GROUP BY year, department_id), HiredCounts AS (SELECT EXTRACT(YEAR FROM hire_date) AS year, department_id, COUNT(*) AS total_hired FROM employees WHERE hire_date >= date('now') - INTERVAL '5 years' GROUP BY year, department_id) SELECT ic.year, ic.department_id, (hc.total_hired / ic.total_interviews) AS hire_rate FROM InterviewCounts ic JOIN HiredCounts hc ON ic.year = hc.year AND ic.department_id = hc.department_id ORDER BY ic.year, hire_rate DESC;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2882208186, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-12';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-12'
标准SQL执行成功，行数: 990
预测SQL执行成功，行数: 990
执行查询: ID=2752876678, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '领导力奖' AND a.year = 2023 AND ar.date = '2024-10-01' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2023 AND a.award_name = '领导力奖' AND ar.date = '2024-10-01' AND ar.check_in > '09:00:00'
标准SQL执行成功，行数: 204
预测SQL执行成功，行数: 204
执行查询: ID=2550918549, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '销售冠军' AND a.year = 2023 AND ar.date = '2024-09-22' AND ar.check_in > '09:00:00';
执行预测SQL: SELECT DISTINCT e.name AS name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2023 AND a.award_name = '销售冠军' AND ar.date = '2024-09-22' AND ar.check_in > '09:00:00'
标准SQL执行成功，行数: 66
预测SQL执行成功，行数: 46

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回66行, 预测SQL返回46行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name]
[35m预测SQL列:[0m [name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [周敏]
[35m预测[1]:[0m [刘丽]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [赵静]
[35m预测[2]:[0m [刘军]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [钱娜]
[35m预测[3]:[0m [刘敏]
执行查询: ID=2654497153, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-10' AND a.check_in > '09:00:00' AND d.name = '人力资源部';
执行预测SQL: SELECT e.name AS name, a.check_in AS check_in_time 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '人力资源部' 
AND a.date = '2024-10-10' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 515
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回515行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=776263740, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-04-20' AND pe.rating = 'D';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name 
FROM performance_evaluations pe 
JOIN employees e ON pe.employee_id = e.employee_id 
JOIN departments d ON e.department_id = d.department_id 
WHERE pe.evaluation_date::date = '2023-04-20' AND pe.rating = 'D'
标准SQL执行成功，行数: 2
预测SQL执行成功，行数: 2
已处理 270/1042 个查询...
执行查询: ID=1728657056, DB=hr
执行标准SQL: SELECT COUNT(DISTINCT pe.employee_id) * 1.0 / COUNT(DISTINCT e.employee_id) AS award_and_performance_ratio
FROM employees e
LEFT JOIN (
    SELECT a.employee_id
    FROM awards a
    WHERE a.year >= EXTRACT(YEAR FROM date('now')) - 2
    INTERSECT
    SELECT p.employee_id
    FROM performance_evaluations p
    WHERE p.evaluation_date >= date('now') - INTERVAL '2 years'
) pe ON e.employee_id = pe.employee_id;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4069271992, DB=hr
执行标准SQL: SELECT e.employee_id, e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE e.hire_date >= '2023-01-01' AND e.hire_date < '2024-01-01' AND a.award_name = '优秀员工' AND pe.rating = 'A+' AND pe.evaluation_date >= '2023-01-01' AND pe.evaluation_date < '2024-01-01';
执行预测SQL: SELECT 
    e.employee_id AS employee_id,
    e.name AS name,
    a.award_name AS award_name,
    pe.rating AS rating
FROM 
    employees e
JOIN 
    awards a ON e.employee_id = a.employee_id
JOIN 
    performance_evaluations pe ON e.employee_id = pe.employee_id
WHERE 
    EXTRACT(YEAR FROM e.hire_date) = 2023
    AND a.year = 2023
    AND a.award_name = '优秀员工奖'
    AND pe.rating = 'A+'
标准SQL执行成功，行数: 11
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回11行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=2408826226, DB=hr
执行标准SQL: SELECT e.name, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '客户服务部' AND a.date = '2024-09-21' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS employee_name, a.check_in AS check_in_time 
FROM employees e 
JOIN departments d ON e.department_id = d.department_id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '客户服务部' 
AND a.date = '2024-09-21' 
AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 465
预测SQL执行成功，行数: 465
执行查询: ID=2252548426, DB=hr
执行标准SQL: SELECT employee_id, SUM(EXTRACT(EPOCH FROM (check_out - check_in))) AS total_work_seconds FROM attendance_records GROUP BY employee_id;
执行预测SQL: SELECT e.employee_id, SUM(EXTRACT(EPOCH FROM (a.check_out - a.check_in))) AS total_work_seconds
FROM employees e
LEFT JOIN attendance_records a ON e.employee_id = a.employee_id
GROUP BY e.employee_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=141603518, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-15' AND d.name = '客户服务部' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in 
FROM employees e 
JOIN departments d ON e.department_id = d.id::text 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '客户服务部' 
AND a.date = '2024-09-15' 
AND a.check_in > '09:00:00'::time
标准SQL执行成功，行数: 483
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回483行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3509550647, DB=hr
执行标准SQL: SELECT e.name, a.date, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN awards aw ON e.employee_id = aw.employee_id WHERE aw.award_name = '创新奖' AND aw.year = 2021 AND a.date = '2024-10-05' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, a.date AS date, a.check_in AS check_in FROM awards aw JOIN employees e ON aw.employee_id = e.employee_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE aw.year = 2021 AND aw.award_name = '创新奖' AND a.date = '2024-10-05' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 39
预测SQL执行成功，行数: 39
执行查询: ID=102704152, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2024 AND pe.rating = 'C';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating 
FROM employees e 
JOIN awards a ON e.employee_id = a.employee_id 
JOIN performance_evaluations pe ON e.employee_id = pe.employee_id 
WHERE a.year = 2024 AND pe.rating = 'C'
标准SQL执行成功，行数: 383
预测SQL执行成功，行数: 383
执行查询: ID=4066261878, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2024 AND a.award_name = '领导力奖' AND pe.rating = 'C';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2024 AND a.award_name = '领导力奖' AND pe.rating = 'C'
标准SQL执行成功，行数: 87
预测SQL执行成功，行数: 87
执行查询: ID=7133946, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '质量控制部' AND a.date = '2024-09-19' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '质量控制部' AND a.date = '2024-09-19' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 498
预测SQL执行成功，行数: 498
执行查询: ID=2339648, DB=hr
执行标准SQL: SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.award_name = '项目管理奖' AND a.year = 2024 AND ar.date = '2024-09-23';
执行预测SQL: SELECT DISTINCT e.name 
FROM employees e 
JOIN awards a ON e.employee_id = a.employee_id 
JOIN attendance_records ar ON e.employee_id = ar.employee_id 
WHERE a.year = 2024 
AND a.award_name = '项目管理奖' 
AND ar.date = '2024-09-23'
标准SQL执行成功，行数: 239
预测SQL执行成功，行数: 87

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回239行, 预测SQL返回87行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name]
[35m预测SQL列:[0m [name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [张丽]
[35m预测[1]:[0m [刘丽]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [李娜]
[35m预测[2]:[0m [刘伟]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [周秀英]
[35m预测[3]:[0m [刘军]
已处理 280/1042 个查询...
执行查询: ID=1476916008, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, pe.rating AS performance_rating FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id LEFT JOIN performance_evaluations pe ON e.employee_id = pe.employee_id AND pe.evaluation_date = '2024-09-20' WHERE ar.date = '2024-09-20';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, pe.rating AS performance_rating FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id LEFT JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-09-20'
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据行数不匹配 (策略: exact_column_names)
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_name department_name performance_rating]
[35m预测SQL列:[0m [department_name performance_rating employee_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [吴芳 法务部 <nil>]
[35m预测[1]:[0m [法务部 A+ 吴芳]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [李军 质量控制部 <nil>]
[35m预测[2]:[0m [质量控制部 C 李军]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [钱娜 财务部 <nil>]
[35m预测[3]:[0m [财务部 A 钱娜]
执行查询: ID=2848971755, DB=hr
执行标准SQL: SELECT e.name AS employee_name, d.name AS department_name, d.manager_id FROM attendance_records ar JOIN employees e ON ar.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE ar.date = '2024-09-26' AND ar.check_in > '09:30:00';
执行预测SQL: SELECT e.name AS employee_name, d.name AS department_name, d.manager_id AS manager_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-26' AND a.check_in > '09:30:00'
标准SQL执行成功，行数: 2464
预测SQL执行成功，行数: 2464
执行查询: ID=1510555187, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-03' AND a.check_in > '09:00:00';
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-03' AND a.check_in > '09:00:00'
标准SQL执行成功，行数: 493
预测SQL执行成功，行数: 493
执行查询: ID=1954114065, DB=hr
执行标准SQL: SELECT e.name, e.employee_id, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-01' AND d.name = '研发部' AND EXTRACT(EPOCH FROM (a.check_out - a.check_in)) / 3600 > 10;
执行预测SQL: SELECT e.name AS name, e.employee_id AS employee_id, a.check_in AS check_in, a.check_out AS check_out 
FROM employees e 
JOIN departments d ON e.department_id = d.id 
JOIN attendance_records a ON e.employee_id = a.employee_id 
WHERE d.name = '研发部' 
AND a.date = '2024-10-01' 
AND (a.check_out - a.check_in) > INTERVAL '10 hours'
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
预测SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=3968556416, DB=hr
执行标准SQL: SELECT e.name, a.award_name, pe.rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2023 AND a.award_name = '优秀员工' AND pe.evaluation_date >= '2023-01-01' AND pe.evaluation_date < '2024-01-01';
执行预测SQL: SELECT e.name AS name, a.award_name AS award_name, pe.rating AS rating FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE a.year = 2023 AND a.award_name = '优秀员工' AND pe.evaluation_date BETWEEN '2023-01-01' AND '2023-12-31'
标准SQL执行成功，行数: 27
预测SQL执行成功，行数: 27
执行查询: ID=2192717523, DB=loan_user
执行标准SQL: SELECT d.cust_no, d.acct_bal, l.loan_balance, l.loan_type FROM deposit_account_info d JOIN loan_detail_info l ON d.cust_no = l.cust_id WHERE d.data_dt = '2024-07-19' AND l.dw_date = '2024-07-19' AND d.acct_bal > 100000 AND l.loan_balance > 500000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=747211607, DB=loan_user
执行标准SQL: SELECT cust_no, wealth_bal FROM financial_products WHERE data_dt = '2024-07-02' AND currency = 'USD' AND wealth_bal > 5000000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=218132520, DB=loan_user
执行标准SQL: SELECT rs_type_name, rs_type_id FROM five_level_classification WHERE rs_type = '不良' AND data_dt = '2024-07-22';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=175056471, DB=loan_user
执行标准SQL: SELECT c.customer_name, o.occupation_name, lr.description FROM customer c JOIN occupation o ON c.occupation_id = o.id JOIN loan_repayment lr ON c.id = lr.loan_application_id ORDER BY lr.repayment_amount DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=334027216, DB=loan_user
执行标准SQL: SELECT c.customer_name, c.id_number, c.phone_number, c.email, c.address FROM customer c JOIN occupation o ON c.occupation_id = o.id WHERE o.occupation_name = '护士' ORDER BY c.customer_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 290/1042 个查询...
执行查询: ID=3272129262, DB=loan_user
执行标准SQL: SELECT COUNT(DISTINCT da.cust_no) FROM deposit_account_info da JOIN loan_detail_info ld ON da.cust_no = ld.cust_id WHERE da.data_dt = '2024-08-19' AND da.bank_nm = '沈阳分行' AND da.cust_type = '对私' AND ld.cust_type = '对私' AND ld.dw_date = '2024-07-19';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2889578956, DB=loan_user
执行标准SQL: SELECT c.curr_code, c.curr_full_name, b.bank_name, b.bank_level FROM currency c JOIN bank_orgnization b ON c.data_dt = b.data_dt WHERE c.curr_class = '外币' AND c.data_dt = '2023-06-30';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=88302712, DB=loan_user
执行标准SQL: SELECT deposit_id, deposit_name FROM deposit_type WHERE data_dt = '2024-07-22';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1348647978, DB=loan_user
执行标准SQL: SELECT d.card_no, d.cust_nm, d.residential_address FROM debit_card_information d WHERE d.open_date = '2024-07-15' AND d.current_bal > 2000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1016905624, DB=loan_user
执行标准SQL: SELECT customer_id, credit_score FROM loan_credit WHERE credit_date = '2003-06-22' AND credit_score > 0.75;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3611732895, DB=loan_user
执行标准SQL: SELECT c.gender, c.customer_name, lr.repayment_amount FROM customer c JOIN loan_repayment lr ON c.id = lr.loan_application_id GROUP BY c.gender, c.customer_name, lr.repayment_amount;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1319754722, DB=loan_user
执行标准SQL: SELECT la.loan_amount, da.cust_name FROM loan_application la JOIN deposit_account_info da ON la.customer_id = da.cust_no ORDER BY la.loan_amount DESC LIMIT 1;
标准SQL执行错误: SQL执行失败: pq: operator does not exist: integer = character varying
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: operator does not exist: integer = character varying
执行查询: ID=2123954700, DB=loan_user
执行标准SQL: SELECT COUNT(DISTINCT fp.cust_no) FROM financial_products fp JOIN debit_card_information dci ON fp.cust_no = dci.cust_no WHERE fp.wealth_bal > 1000000 AND dci.card_state = '正常'
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4161720938, DB=loan_user
执行标准SQL: SELECT dai.cust_name, dai.ci_ref_acct, dai.act_mon_avg_bal FROM deposit_account_info dai JOIN bank_orgnization bo ON dai.org_no = bo.bank_id WHERE dai.data_dt = '2024-07-19' AND dai.acct_type_code = '活期' AND dai.org_nm = '沈阳余淮支行' AND dai.act_mon_avg_bal > 50000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1485816909, DB=loan_user
执行标准SQL: SELECT c.customer_name, l.loan_amount FROM customer c JOIN loan_application l ON c.id = l.customer_id WHERE l.loan_amount > 30000 AND l.status = 'PENDING'
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 300/1042 个查询...
执行查询: ID=864749016, DB=loan_user
执行标准SQL: WITH top_20_customers AS (SELECT cust_id FROM loan_detail_info ORDER BY loan_amount DESC LIMIT 20) SELECT d.deposit_type_name, COUNT(*) AS customer_count FROM top_20_customers t JOIN loan_detail_info l ON t.cust_id = l.cust_id JOIN deposit_type d ON l.dw_date = d.data_dt GROUP BY d.deposit_type_name
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3380354553, DB=loan_user
执行标准SQL: SELECT curr_code, curr_full_name FROM currency WHERE curr_class = '外币' ORDER BY curr_code ASC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=146146439, DB=loan_user
执行标准SQL: SELECT la.customer_id, la.loan_amount FROM loan_application la ORDER BY la.loan_amount DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2245911258, DB=loan_user
执行标准SQL: SELECT f.cast_type, AVG(f.wealth_sta_m_avg_bal_b) AS avg_monthly_balance FROM financial_products f WHERE f.data_dt BETWEEN '2024-07-01' AND '2024-07-31' GROUP BY f.cast_type;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=904046704, DB=loan_user
执行标准SQL: SELECT * FROM loan_detail_info WHERE loandate_s > '2024-04-01';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2037290745, DB=loan_user
执行标准SQL: WITH age_group_avg AS (SELECT CASE WHEN DATE_PART('year', AGE(date('now'), c.birth_date)) BETWEEN 0 AND 20 THEN '0-20' WHEN DATE_PART('year', AGE(date('now'), c.birth_date)) BETWEEN 21 AND 40 THEN '21-40' WHEN DATE_PART('year', AGE(date('now'), c.birth_date)) BETWEEN 41 AND 60 THEN '41-60' ELSE '61+' END as age_group, AVG(l.loan_amount) as avg_loan_amount FROM customer c JOIN loan_application l ON c.id = l.customer_id GROUP BY age_group) SELECT c.customer_name, aga.age_group, l.loan_amount, aga.avg_loan_amount FROM customer c JOIN loan_application l ON c.id = l.customer_id JOIN age_group_avg aga ON CASE WHEN DATE_PART('year', AGE(date('now'), c.birth_date)) BETWEEN 0 AND 20 THEN '0-20' WHEN DATE_PART('year', AGE(date('now'), c.birth_date)) BETWEEN 21 AND 40 THEN '21-40' WHEN DATE_PART('year', AGE(date('now'), c.birth_date)) BETWEEN 41 AND 60 THEN '41-60' ELSE '61+' END = aga.age_group WHERE l.loan_amount > aga.avg_loan_amount * 1.5 ORDER BY l.loan_amount DESC
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1073845704, DB=loan_user
执行标准SQL: SELECT birth_date, gender FROM customer;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1970903262, DB=loan_user
执行标准SQL: SELECT d.cust_id, d.loan_balance FROM loan_detail_info d JOIN deposit_account_info a ON d.cust_id = a.cust_no WHERE d.loan_balance > 500000 AND d.dw_date = '2024-07-19' AND a.bank_no = 'BANK_006';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2098164166, DB=loan_user
执行标准SQL: SELECT ldi.reportid, ldi.loan_balance, c.curr_full_name, flc.rs_type_name FROM loan_detail_info ldi JOIN currency c ON ldi.currency_type = c.curr_code JOIN five_level_classification flc ON ldi.judgelevel = flc.rs_type_id WHERE ldi.loan_balance > 1000000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3382000879, DB=loan_user
执行标准SQL: SELECT ldi.cust_id, c.curr_full_name, ldi.loan_balance FROM loan_detail_info ldi JOIN currency c ON ldi.currency_type = c.curr_code WHERE ldi.loan_balance > 1000000 ORDER BY ldi.loan_balance DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 310/1042 个查询...
执行查询: ID=2579167658, DB=loan_user
执行标准SQL: SELECT ub.customer_id, COUNT(DISTINCT ub.behavior_type) AS behavior_type_count FROM user_behavior ub WHERE ub.behavior_date >= date('now') - INTERVAL '1 year' GROUP BY ub.customer_id ORDER BY behavior_type_count DESC LIMIT 5
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1454085576, DB=loan_user
执行标准SQL: SELECT SUM(age1 + age2 + age3 + age4 + age5 + age6) AS total_overdue_amount, COUNT(*) AS account_count FROM credit_card_data WHERE corporation = 'Corp3' AND dw_date = '2024-07-03';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1846154246, DB=loan_user
执行标准SQL: SELECT * FROM loan_detail_info WHERE cust_id = '1004';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3291969349, DB=loan_user
执行标准SQL: SELECT c.customer_name, t.transfer_amount, t.transfer_date FROM customer c JOIN transfer t ON c.id = t.source_customer_id OR c.id = t.target_customer_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3977283654, DB=loan_user
执行标准SQL: SELECT ub.customer_id, ub.behavior_type, lr.repayment_amount FROM user_behavior ub LEFT JOIN loan_repayment lr ON ub.customer_id = lr.loan_application_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2512363543, DB=loan_user
执行标准SQL: SELECT dai.cust_name, dai.acct_bal, dt.deposit_name FROM deposit_account_info dai JOIN deposit_type dt ON dai.arl_pdp_code = dt.deposit_id WHERE dai.data_dt = '2024-07-21' AND dai.acct_bal > 50000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4035425926, DB=loan_user
执行标准SQL: WITH customer_total AS (SELECT c.id, c.customer_name, c.province, SUM(l.loan_amount) as total_loan FROM customer c JOIN loan_application l ON c.id = l.customer_id GROUP BY c.id, c.customer_name, c.province), province_total AS (SELECT province, SUM(loan_amount) as province_total FROM loan_application l JOIN customer c ON l.customer_id = c.id GROUP BY province) SELECT ct.customer_name, ct.province, ct.total_loan, (ct.total_loan / pt.province_total * 100) as percentage FROM customer_total ct JOIN province_total pt ON ct.province = pt.province ORDER BY percentage DESC
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=82349614, DB=loan_user
执行标准SQL: WITH province_occupation_approval AS (SELECT c.province, o.occupation_name, COUNT(*) as total_applications, SUM(CASE WHEN la.status = 'APPROVED' THEN 1 ELSE 0 END) / COUNT(*) as approval_rate, ROW_NUMBER() OVER (PARTITION BY c.province ORDER BY SUM(CASE WHEN la.status = 'APPROVED' THEN 1 ELSE 0 END) / COUNT(*) DESC) as rank FROM customer c JOIN occupation o ON c.occupation_id = o.id JOIN loan_application la ON c.id = la.customer_id GROUP BY c.province, o.occupation_name) SELECT province, occupation_name, approval_rate FROM province_occupation_approval WHERE rank = 1 ORDER BY approval_rate DESC
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3816528329, DB=loan_user
执行标准SQL: WITH branch_total AS (SELECT bank_nm, SUM(current_bal + fixed_bal) AS total_deposit FROM debit_card_information GROUP BY bank_nm), top_customers AS (SELECT bank_nm, cust_nm, current_bal + fixed_bal AS deposit, ROW_NUMBER() OVER (PARTITION BY bank_nm ORDER BY current_bal + fixed_bal DESC) AS rank FROM debit_card_information) SELECT tc.bank_nm, SUM(tc.deposit) / bt.total_deposit AS top_10_ratio FROM top_customers tc JOIN branch_total bt ON tc.bank_nm = bt.bank_nm WHERE tc.rank <= 10 GROUP BY tc.bank_nm, bt.total_deposit
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3967240206, DB=loan_user
执行标准SQL: SELECT cust_nm, tel_no FROM debit_card_information WHERE cust_nm LIKE '%Lee%';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 320/1042 个查询...
执行查询: ID=2555762315, DB=loan_user
执行标准SQL: SELECT ub.customer_id, ub.behavior_type, lr.repayment_amount FROM user_behavior ub LEFT JOIN loan_repayment lr ON ub.customer_id = lr.loan_application_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1472446382, DB=loan_user
执行标准SQL: SELECT DISTINCT lr.loan_application_id, lc.customer_id FROM loan_repayment lr JOIN loan_application la ON lr.loan_application_id = la.id JOIN loan_credit lc ON la.customer_id = lc.customer_id WHERE lr.repayment_date = '2021-11-10' AND lc.credit_score > 0.75;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=837468015, DB=loan_user
执行标准SQL: SELECT * FROM loan_repayment WHERE repayment_amount > 900;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3614707278, DB=loan_user
执行标准SQL: SELECT dci.cust_no, dci.cust_nm, dci.card_no, dci.residential_address FROM debit_card_information dci WHERE dci.data_dt = '2024-07-09' AND dci.card_state = '正常' AND dci.residential_address = '987 Willow Street';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3381297740, DB=loan_user
执行标准SQL: SELECT ld.cust_id, ld.loan_balance FROM loan_detail_info ld;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3209601254, DB=loan_user
执行标准SQL: SELECT lt.loan_type_name, COUNT(DISTINCT d.cust_no) AS user_count FROM loan_type lt LEFT JOIN debit_card_information d ON lt.loan_type_code = d.cust_no GROUP BY lt.loan_type_name
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1181974520, DB=loan_user
执行标准SQL: SELECT ld.loan_type, COUNT(DISTINCT ld.cust_id) AS customer_count FROM loan_detail_info ld GROUP BY ld.loan_type;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4290316983, DB=loan_user
执行标准SQL: SELECT credit_score, description FROM loan_credit WHERE credit_date = '2011-04-13';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4121525980, DB=loan_user
执行标准SQL: SELECT SUM(fp.wealth_bal) AS total_wealth_bal, SUM(fp.wealth_bal_t) AS total_wealth_bal_t FROM financial_products fp WHERE fp.data_dt = '2024-07-14' AND fp.bank_nm = '沈阳余淮支行' AND fp.cast_type = '对公';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1634196262, DB=loan_user
执行标准SQL: SELECT customer_id, credit_score FROM loan_credit WHERE credit_date = '2003-06-22' AND credit_score > 0.75;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 330/1042 个查询...
执行查询: ID=2019378478, DB=loan_user
执行标准SQL: SELECT source_customer_id, target_customer_id FROM transfer;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=522536270, DB=loan_user
执行标准SQL: SELECT loan_type_name FROM loan_type WHERE loan_type_code = 'MORTGAGE';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=126227619, DB=loan_user
执行标准SQL: SELECT cust_nm, card_no FROM debit_card_information WHERE data_dt = '2024-07-05' AND card_state = '正常';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2456368123, DB=loan_user
执行标准SQL: SELECT f.bank_nm, f.cast_type, COUNT(*) AS product_count FROM financial_products f GROUP BY f.bank_nm, f.cast_type;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1564372003, DB=loan_user
执行标准SQL: SELECT deposit_name, deposit_type_id FROM deposit_type ORDER BY deposit_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2160477527, DB=loan_user
执行标准SQL: SELECT la.status, la.loan_amount FROM loan_application la;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1462437870, DB=loan_user
执行标准SQL: SELECT customer_id FROM loan_credit WHERE credit_score = 0.77;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4083934626, DB=loan_user
执行标准SQL: SELECT lt.description, lr.repayment_amount FROM loan_type lt JOIN loan_application la ON lt.id = la.loan_type_id JOIN loan_repayment lr ON la.id = lr.loan_application_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2872120818, DB=loan_user
执行标准SQL: SELECT rs_type_id, rs_type_name FROM five_level_classification WHERE rs_type_name = '可疑';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1283326851, DB=loan_user
执行标准SQL: SELECT card_no, closing_date FROM debit_card_information WHERE closing_date > '2024-07-05';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 340/1042 个查询...
执行查询: ID=531921010, DB=loan_user
执行标准SQL: SELECT card_type_nm, card_state FROM debit_card_information WHERE card_type_nm IS NOT NULL;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1418289021, DB=loan_user
执行标准SQL: SELECT cust_id, SUM(loan_balance) AS total_loan_balance FROM loan_detail_info WHERE dw_date = '2024-07-19' AND loan_balance > 100000 GROUP BY cust_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=137242606, DB=loan_user
执行标准SQL: WITH customer_balances AS (SELECT d.bank_nm, d.cust_no, SUM(d.current_bal + d.fixed_bal) AS deposit_balance, SUM(CASE WHEN lt.loan_type_name IS NOT NULL THEN d.current_bal + d.fixed_bal ELSE 0 END) AS loan_balance FROM debit_card_information d LEFT JOIN loan_type lt ON d.cust_no = lt.loan_type_code GROUP BY d.bank_nm, d.cust_no) SELECT bank_nm, CORR(deposit_balance, loan_balance) AS correlation_coefficient FROM customer_balances GROUP BY bank_nm
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2672242323, DB=loan_user
执行标准SQL: SELECT DATE_TRUNC('month', t.transfer_date) AS month, SUM(t.transfer_amount) AS total_transfer, SUM(l.loan_amount) AS total_loan FROM transfer t FULL OUTER JOIN loan_detail_info l ON DATE_TRUNC('month', t.transfer_date) = DATE_TRUNC('month', l.loandate_s) GROUP BY month ORDER BY month;
标准SQL执行错误: SQL执行失败: pq: function date_trunc(unknown, character varying) does not exist
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: function date_trunc(unknown, character varying) does not exist
执行查询: ID=2845015839, DB=loan_user
执行标准SQL: SELECT customer_name, phone_number FROM customer WHERE province = '上海市';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1582007502, DB=loan_user
执行标准SQL: SELECT credit_score, credit_date FROM loan_credit WHERE customer_id = 533302;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=283689317, DB=loan_user
执行标准SQL: SELECT * FROM transfer ORDER BY transfer_amount DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1594346019, DB=loan_user
执行标准SQL: SELECT customer_id, COUNT(DISTINCT behavior_type) AS unique_behavior_types FROM user_behavior GROUP BY customer_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3342713409, DB=loan_user
执行标准SQL: SELECT COUNT(DISTINCT da.cust_no) FROM deposit_account_info da JOIN credit_card_data cc ON da.cust_no = cc.custr_nbr WHERE da.bank_nm = '沈阳分行' AND da.data_dt = '2024-07-22' AND da.acct_bal > 100000 AND (cc.age1 > 5000 OR cc.age2 > 5000 OR cc.age3 > 5000 OR cc.age4 > 5000 OR cc.age5 > 5000 OR cc.age6 > 5000)
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=842726032, DB=loan_user
执行标准SQL: SELECT card_no, cust_nm FROM debit_card_information WHERE bank_nm = '北京分行';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 350/1042 个查询...
执行查询: ID=236915033, DB=loan_user
执行标准SQL: WITH monthly_applications AS (SELECT customer_id, DATE_TRUNC('month', apply_date) as apply_month FROM loan_application), consecutive_months AS (SELECT customer_id, apply_month, LEAD(apply_month, 2) OVER (PARTITION BY customer_id ORDER BY apply_month) as next_two_month FROM monthly_applications) SELECT COUNT(DISTINCT customer_id) as customer_count FROM consecutive_months WHERE next_two_month = apply_month + INTERVAL '2 months'
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4229311898, DB=loan_user
执行标准SQL: SELECT f.cust_no, f.bank_nm FROM financial_products f ORDER BY f.cust_no;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=258690623, DB=loan_user
执行标准SQL: SELECT occupation_code, occupation_name FROM occupation ORDER BY occupation_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3376193292, DB=loan_user
执行标准SQL: SELECT COUNT(*) FROM financial_products fp JOIN debit_card_information dci ON fp.cust_no = dci.cust_no WHERE fp.wealth_bal > 10 * (dci.current_bal + dci.fixed_bal)
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=116553538, DB=loan_user
执行标准SQL: SELECT ld.loan_orgno, ld.loan_balance FROM loan_detail_info ld WHERE ld.loan_amount > 70000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=646950911, DB=loan_user
执行标准SQL: SELECT lt.loan_type_name, ub.behavior_type FROM loan_type lt LEFT JOIN loan_repayment lr ON lt.id = lr.loan_application_id LEFT JOIN user_behavior ub ON lr.loan_application_id = ub.customer_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=109259315, DB=loan_user
执行标准SQL: SELECT bank_level, COUNT(*) AS institution_count FROM bank_orgnization GROUP BY bank_level;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2700778328, DB=loan_user
执行标准SQL: SELECT current_bal, fixed_bal FROM debit_card_information WHERE data_dt = '2024-07-15' AND bank_nm = '北京东单支行' AND cust_nm = 'Olivia Lee';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4212764935, DB=loan_user
执行标准SQL: SELECT c.customer_name, lc.description FROM loan_credit lc JOIN customer c ON lc.customer_id = c.id WHERE lc.credit_date = '2017-10-31' AND lc.credit_score > 0.85 ORDER BY lc.credit_score DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4269406178, DB=loan_user
执行标准SQL: SELECT la.loan_amount FROM loan_application la WHERE la.loan_type_id = (SELECT id FROM loan_type WHERE loan_type_code = 'CAR');
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 360/1042 个查询...
执行查询: ID=1128360712, DB=loan_user
执行标准SQL: SELECT lt.loan_type_name, AVG(lr.repayment_amount) as avg_repayment_amount, COUNT(lr.id) as repayment_count FROM loan_repayment lr JOIN loan_application la ON lr.loan_application_id = la.id JOIN loan_type lt ON la.loan_type_id = lt.id GROUP BY lt.loan_type_name
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2724005771, DB=loan_user
执行标准SQL: SELECT acc_name1, bank, category, day_opened FROM credit_card_data WHERE corporation = 'Corp3' ORDER BY day_opened DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3382134012, DB=loan_user
执行标准SQL: SELECT customer_name, address FROM customer;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1545912595, DB=loan_user
执行标准SQL: WITH loan_sum AS (SELECT loan_orgno, SUM(loan_amount) as total_loan FROM loan_detail_info WHERE EXTRACT(YEAR FROM loandate_s) = 2023 GROUP BY loan_orgno), debit_sum AS (SELECT bank_no, SUM(current_bal) as total_debit FROM debit_card_information WHERE EXTRACT(YEAR FROM data_dt) = 2023 GROUP BY bank_no) SELECT bo.bank_name, ls.total_loan, ds.total_debit, ls.total_loan / NULLIF(ds.total_debit, 0) as loan_debit_ratio FROM bank_orgnization bo LEFT JOIN loan_sum ls ON bo.bank_id = ls.loan_orgno LEFT JOIN debit_sum ds ON bo.bank_id = ds.bank_no ORDER BY loan_debit_ratio DESC
标准SQL执行错误: SQL执行失败: pq: function pg_catalog.extract(unknown, character varying) does not exist
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: function pg_catalog.extract(unknown, character varying) does not exist
执行查询: ID=2397640501, DB=loan_user
执行标准SQL: SELECT * FROM loan_repayment WHERE repayment_amount = (SELECT repayment_amount FROM loan_repayment ORDER BY ABS(repayment_amount - (SELECT AVG(repayment_amount) FROM loan_repayment)) LIMIT 1);
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=561955406, DB=loan_user
执行标准SQL: SELECT DISTINCT l.customer_id FROM loan_credit l JOIN financial_products f ON l.credit_date = f.data_dt WHERE l.credit_score > 0.8 AND f.data_dt >= '2024-07-01' AND f.data_dt < '2024-08-01';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1986127383, DB=loan_user
执行标准SQL: SELECT EXTRACT(YEAR FROM apply_date) as year, EXTRACT(MONTH FROM apply_date) as month, COUNT(CASE WHEN status = 'APPROVED' THEN 1 END) / COUNT(*) as approval_rate FROM loan_application GROUP BY year, month ORDER BY year, month
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1657316021, DB=loan_user
执行标准SQL: WITH new_customers AS (SELECT DISTINCT ON (cust_id) cust_id, loan_orgno, loan_amount FROM loan_detail_info WHERE loandate_s BETWEEN '2024-01-01' AND '2024-03-31' AND cust_id NOT IN (SELECT cust_id FROM loan_detail_info WHERE loandate_s < '2024-01-01')) SELECT bo.bank_name, COUNT(nc.cust_id) as new_customer_count, AVG(nc.loan_amount) as avg_loan_amount FROM bank_orgnization bo LEFT JOIN new_customers nc ON bo.bank_id = nc.loan_orgno GROUP BY bo.bank_name ORDER BY new_customer_count DESC
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2162181589, DB=loan_user
执行标准SQL: SELECT dai.bank_nm, AVG(la.loan_term) as avg_loan_term, AVG(la.loan_amount) as avg_loan_amount FROM loan_application la JOIN deposit_account_info dai ON la.customer_id = dai.cust_noeger GROUP BY dai.bank_nm
标准SQL执行错误: SQL执行失败: pq: column dai.cust_noeger does not exist
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: column dai.cust_noeger does not exist
执行查询: ID=2307971258, DB=loan_user
执行标准SQL: SELECT customer_id, credit_score, credit_date FROM loan_credit;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 370/1042 个查询...
执行查询: ID=2557946358, DB=loan_user
执行标准SQL: SELECT l.cust_id, l.loan_balance FROM loan_detail_info l WHERE l.loandate_e < '2026-01-01';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3214990589, DB=loan_user
执行标准SQL: SELECT apply_date, loan_amount FROM loan_application;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=140188268, DB=loan_user
执行标准SQL: SELECT la.customer_id, la.loan_amount FROM loan_application la JOIN loan_type lt ON la.loan_type_id = lt.id WHERE lt.loan_type_name = '住房贷款' AND la.status = 'APPROVED' ORDER BY la.loan_amount DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2839950527, DB=loan_user
执行标准SQL: SELECT dai.org_nm, dai.bank_nm, SUM(dai.acct_bal) as total_balance FROM deposit_account_info dai GROUP BY dai.org_nm, dai.bank_nm ORDER BY total_balance DESC LIMIT 5
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2833646672, DB=loan_user
执行标准SQL: SELECT * FROM loan_repayment WHERE description = '严琳';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=508839263, DB=loan_user
执行标准SQL: SELECT rs_type, COUNT(*) AS count FROM five_level_classification GROUP BY rs_type;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3720034566, DB=loan_user
执行标准SQL: SELECT rs_type, COUNT(*) FROM five_level_classification GROUP BY rs_type;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1167041688, DB=loan_user
执行标准SQL: SELECT b.bank_name, f.cust_no, f.wealth_bal FROM bank_orgnization b JOIN financial_products f ON b.bank_id = f.bank_no;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1532873158, DB=loan_user
执行标准SQL: SELECT loan_type_name, description FROM loan_type ORDER BY loan_type_code;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2367133121, DB=loan_user
执行标准SQL: SELECT b1.bank_name, b2.bank_name AS parent_name FROM bank_orgnization b1 LEFT JOIN bank_orgnization b2 ON b1.bank_parent = b2.bank_id WHERE b1.bank_level = '2';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 380/1042 个查询...
执行查询: ID=2982430979, DB=loan_user
执行标准SQL: WITH ranked_loans AS (SELECT c.province, c.customer_name, l.loan_amount, ROW_NUMBER() OVER (PARTITION BY c.province ORDER BY l.loan_amount DESC) as rank FROM customer c JOIN loan_application l ON c.id = l.customer_id) SELECT province, customer_name, loan_amount FROM ranked_loans WHERE rank <= 3 ORDER BY province, loan_amount DESC
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4126585093, DB=loan_user
执行标准SQL: SELECT * FROM transfer WHERE source_customer_id = 376252;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1577554550, DB=loan_user
执行标准SQL: SELECT c.customer_name, c.gender, o.occupation_name FROM customer c JOIN occupation o ON c.occupation_id = o.id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1654794343, DB=loan_user
执行标准SQL: SELECT COUNT(DISTINCT fp.cust_no) AS customer_count, SUM(fp.wealth_bal_f) AS total_non_guaranteed_wealth_balance FROM financial_products fp JOIN bank_orgnization bo ON fp.bank_no = bo.bank_id WHERE bo.bank_name = '沈阳余淮支行' AND fp.data_dt >= '2024-07-01' AND fp.data_dt <= '2024-07-31' AND fp.wealth_bal_f IS NOT NULL;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2092588313, DB=loan_user
执行标准SQL: SELECT customer_id FROM loan_credit WHERE credit_score > 0.8;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2021025668, DB=loan_user
执行标准SQL: SELECT c1.customer_name AS source_customer_name, c2.customer_name AS target_customer_name, t.transfer_amount FROM transfer t JOIN customer c1 ON t.source_customer_id = c1.id JOIN customer c2 ON t.target_customer_id = c2.id WHERE t.transfer_amount > 5000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=891116215, DB=loan_user
执行标准SQL: SELECT la.customer_id FROM loan_application la JOIN loan_status ls ON la.status = ls.loan_status_code WHERE la.apply_date >= '2019-01-01' AND la.apply_date < '2020-01-01' AND ls.loan_status_code = 'APPROVED';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3533102799, DB=loan_user
执行标准SQL: SELECT dci.card_type, dci.card_type_nm, COUNT(DISTINCT dci.cust_no) AS customer_count, AVG(fp.wealth_bal) AS avg_wealth_bal FROM debit_card_information dci LEFT JOIN financial_products fp ON dci.cust_no = fp.cust_no GROUP BY dci.card_type, dci.card_type_nm
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2160175524, DB=loan_user
执行标准SQL: SELECT c.customer_name, a.loan_amount FROM customer c JOIN loan_application a ON c.id = a.customer_id ORDER BY a.apply_date ASC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=305358980, DB=loan_user
执行标准SQL: SELECT SUM(acct_bal) AS total_acct_bal, SUM(act_year_avg_bal) AS total_act_year_avg_bal FROM deposit_account_info WHERE data_dt = '2024-07-19' AND cust_type = '对私';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 390/1042 个查询...
执行查询: ID=3219483220, DB=loan_user
执行标准SQL: SELECT c.customer_name, o.occupation_name FROM customer c JOIN occupation o ON c.occupation_id = o.id JOIN loan_repayment lr ON c.id = lr.loan_application_id WHERE lr.repayment_amount < 500;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3553634354, DB=loan_user
执行标准SQL: SELECT d.cust_name, d.acct_bal FROM deposit_account_info d WHERE d.data_dt = '2023-07-19 00:00:00';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1610907085, DB=loan_user
执行标准SQL: SELECT dai.cust_no, dai.acct_bal, la.loan_amount, la.apply_date FROM deposit_account_info dai LEFT JOIN loan_application la ON dai.cust_noeger = la.customer_id ORDER BY dai.acct_bal DESC, la.apply_date DESC LIMIT 1
标准SQL执行错误: SQL执行失败: pq: column dai.cust_noeger does not exist
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: column dai.cust_noeger does not exist
执行查询: ID=1410414363, DB=loan_user
执行标准SQL: SELECT o.occupation_name, COUNT(c.id) AS customer_count FROM occupation o LEFT JOIN customer c ON o.id = c.occupation_id GROUP BY o.occupation_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3954115529, DB=loan_user
执行标准SQL: SELECT c.customer_name, t.transfer_amount FROM transfer t JOIN customer c ON t.source_customer_id = c.id WHERE t.transfer_date = '2016-06-11' AND t.transfer_amount > 5000 ORDER BY t.transfer_amount DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1086674624, DB=loan_user
执行标准SQL: SELECT ldi.cust_id, ldi.loan_balance, ldi.loan_type, c.curr_full_name FROM loan_detail_info ldi JOIN currency c ON ldi.currency_type = c.curr_code WHERE ldi.loandate_s > '2024-07-01' AND ldi.loan_balance > 1000000 ORDER BY ldi.loan_balance DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1680159550, DB=loan_user
执行标准SQL: SELECT * FROM user_behavior WHERE behavior_date = '2018-06-26';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2548352227, DB=loan_user
执行标准SQL: SELECT * FROM loan_repayment WHERE EXTRACT(DOW FROM repayment_date) IN (0, 6);
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1833243393, DB=loan_user
执行标准SQL: SELECT dt.deposit_name, lt.loan_type_name, COUNT(DISTINCT c.id) AS customer_count FROM customer c JOIN deposit_account_info dai ON c.id_number = dai.cert_code JOIN deposit_type dt ON dai.arl_pdp_code = dt.deposit_id LEFT JOIN loan_application la ON c.id = la.customer_id LEFT JOIN loan_type lt ON la.loan_type_id = lt.id GROUP BY dt.deposit_name, lt.loan_type_name ORDER BY customer_count DESC
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3824204712, DB=loan_user
执行标准SQL: SELECT c.customer_name, lr.repayment_amount FROM loan_repayment lr JOIN loan_application la ON lr.loan_application_id = la.id JOIN customer c ON la.customer_id = c.id WHERE lr.repayment_date = '2021-11-10' AND lr.repayment_amount > 20 ORDER BY lr.repayment_amount DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 400/1042 个查询...
执行查询: ID=3260667731, DB=loan_user
执行标准SQL: SELECT lt.loan_type_name, AVG(lc.credit_score) AS average_credit_score FROM loan_type lt JOIN loan_application la ON lt.id = la.loan_type_id JOIN loan_credit lc ON la.customer_id = lc.customer_id GROUP BY lt.loan_type_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=732762958, DB=loan_user
执行标准SQL: SELECT loan_type_name, loan_type_code FROM loan_type WHERE loan_type_code IS NOT NULL;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=330418458, DB=loan_user
执行标准SQL: SELECT ls.loan_status_name, COUNT(la.id) AS count FROM loan_status ls JOIN loan_application la ON ls.loan_status_code = la.status GROUP BY ls.loan_status_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=245397134, DB=loan_user
执行标准SQL: SELECT customer_id, description FROM loan_credit;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2669572809, DB=loan_user
执行标准SQL: SELECT dci.cust_nm, dci.cust_id, dci.tel_no, dci.card_no, dci.current_bal FROM debit_card_information dci WHERE dci.data_dt = '2024-07-15 00:00:00' AND dci.bank_nm = '北京东单支行';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2085255506, DB=loan_user
执行标准SQL: SELECT l.cust_type, SUM(l.loan_amount) AS total_amount FROM loan_detail_info l GROUP BY l.cust_type ORDER BY l.cust_type;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1984536651, DB=loan_user
执行标准SQL: SELECT *, (loan_balance / loan_amount) AS balance_ratio FROM loan_detail_info ORDER BY balance_ratio DESC LIMIT 10;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=258245311, DB=loan_user
执行标准SQL: SELECT la.customer_id, SUM(la.loan_amount) AS total_loan_amount FROM loan_application la JOIN loan_type lt ON la.loan_type_id = lt.id WHERE lt.loan_type_name = '住房贷款' AND la.status = 'REJECTED' AND EXTRACT(YEAR FROM la.apply_date) = 2019 GROUP BY la.customer_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1895651034, DB=loan_user
执行标准SQL: SELECT * FROM bank_orgnization;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=134489693, DB=loan_user
执行标准SQL: SELECT ldi.reportid, ldi.cust_id, ldi.loan_balance, ldi.blc_capital, c.curr_full_name, flc.rs_type_name FROM loan_detail_info ldi JOIN currency c ON ldi.currency_type = c.curr_code JOIN five_level_classification flc ON ldi.judgelevel = flc.rs_type_id WHERE ldi.blc_capital > 10000 AND ldi.dw_date = '2024-07-22';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 410/1042 个查询...
执行查询: ID=2899938404, DB=loan_user
执行标准SQL: SELECT card_state, open_date FROM debit_card_information WHERE card_state = '正常';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1614542471, DB=loan_user
执行标准SQL: SELECT c.customer_name, t.transfer_amount, t.transfer_date FROM transfer t JOIN customer c ON t.source_customer_id = c.id WHERE t.transfer_date = '2023-06-30' ORDER BY t.transfer_amount DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2860028194, DB=loan_user
执行标准SQL: SELECT b.bank_name, b.bank_level FROM bank_orgnization b WHERE b.data_dt = '2023-06-30';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2112082105, DB=loan_user
执行标准SQL: SELECT cust_no, SUM(wealth_bal_f) AS total_wealth_bal_f FROM financial_products WHERE data_dt = '2024-07-02' GROUP BY cust_no ORDER BY total_wealth_bal_f DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1900105170, DB=loan_user
执行标准SQL: SELECT SUM(loan_amount) FROM loan_application WHERE status = 'REJECTED' AND apply_date >= '2019-01-01' AND apply_date <= '2019-12-31';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3724611031, DB=loan_user
执行标准SQL: SELECT d.org_nm, SUM(d.acct_bal) AS total_balance FROM deposit_account_info d JOIN bank_orgnization b ON d.bank_no = b.bank_id WHERE d.data_dt = '2024-07-21' AND d.bank_no = 'BANK_003' AND d.cust_type = '对公' GROUP BY d.org_nm;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3179484363, DB=loan_user
执行标准SQL: SELECT lr.loan_application_id, SUM(lr.repayment_amount) AS total_repayment, COUNT(ub.id) AS behavior_count, AVG(lr.repayment_amount) AS avg_repayment_amount FROM loan_repayment lr LEFT JOIN user_behavior ub ON lr.loan_application_id = ub.customer_id GROUP BY lr.loan_application_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3200437107, DB=loan_user
执行标准SQL: SELECT bank_name, bank_level, data_dt FROM bank_orgnization;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2071923254, DB=loan_user
执行标准SQL: WITH top_depositors AS (SELECT c.id, c.customer_name, c.occupation_id, dai.acct_bal FROM customer c JOIN deposit_account_info dai ON c.id_number = dai.cert_code ORDER BY dai.acct_bal DESC LIMIT (SELECT COUNT(*) * 0.1 FROM customer)) SELECT td.customer_name, td.acct_bal AS deposit_balance, td.occupation_id FROM top_depositors td LEFT JOIN loan_application la ON td.id = la.customer_id WHERE la.id IS NULL
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3565838054, DB=loan_user
执行标准SQL: SELECT dai.org_nm, COUNT(CASE WHEN la.status = 'APPROVED' THEN 1 END) / COUNT(*) as approval_rate FROM loan_application la JOIN deposit_account_info dai ON la.customer_id = dai.cust_noeger GROUP BY dai.org_nm
标准SQL执行错误: SQL执行失败: pq: column dai.cust_noeger does not exist
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: column dai.cust_noeger does not exist
已处理 420/1042 个查询...
执行查询: ID=1893298039, DB=loan_user
执行标准SQL: SELECT cust_name, acct_bal FROM deposit_account_info WHERE data_dt BETWEEN '2023-07-01' AND '2023-07-31';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2315630941, DB=loan_user
执行标准SQL: SELECT b.bank_name, d.cust_name, d.acct_bal, d.cur_type FROM bank_orgnization b JOIN deposit_account_info d ON b.bank_id = d.bank_no WHERE d.acct_bal > 100000 AND d.cur_type = 'USD' AND b.data_dt = '2023-06-30';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=870110560, DB=loan_user
执行标准SQL: SELECT d.cust_name, d.acct_type_code, d.acct_bal, c.curr_full_name FROM deposit_account_info d JOIN currency c ON d.cur_type = c.curr_code WHERE d.data_dt = '2024-07-19' AND d.acct_bal > 100000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1308562229, DB=loan_user
执行标准SQL: SELECT cust_nm, card_no FROM debit_card_information WHERE card_state = '正常' AND open_date > '2024-07-01' ORDER BY open_date DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1986404179, DB=loan_user
执行标准SQL: SELECT deposit_name, deposit_type_id FROM deposit_type ORDER BY deposit_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2032902123, DB=loan_user
执行标准SQL: SELECT source_customer_id, COUNT(*) AS transfer_count, MODE() WITHIN GROUP (ORDER BY transfer_amount) AS most_common_amount FROM transfer GROUP BY source_customer_id ORDER BY transfer_count DESC LIMIT 10;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3109098948, DB=loan_user
执行标准SQL: SELECT COUNT(DISTINCT c.id) AS customer_count, SUM(ldi.loan_balance) AS total_loan_balance FROM customer c JOIN credit_card_data ccd ON c.id_number = ccd.custr_nbr JOIN loan_detail_info ldi ON c.id_number = ldi.cust_id WHERE c.province = '上海市' AND ccd.acct_sts = '正常';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=188271146, DB=loan_user
执行标准SQL: SELECT ldi.reportid, ldi.loan_balance, flc.rs_type_name, ldi.loan_type FROM loan_detail_info ldi JOIN five_level_classification flc ON ldi.judgelevel = flc.rs_type_id WHERE ldi.loan_balance > 15000 AND ldi.dw_date = '2024-07-22';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=7209425, DB=loan_user
执行标准SQL: WITH customer_loans AS (SELECT c.id, MAX(CASE WHEN lt.loan_type_name = '房贷' THEN l.loan_amount END) as house_loan, MAX(CASE WHEN lt.loan_type_name = '车贷' THEN l.loan_amount END) as car_loan FROM customer c JOIN loan_application l ON c.id = l.customer_id JOIN loan_type lt ON l.loan_type_id = lt.id WHERE lt.loan_type_name IN ('房贷', '车贷') GROUP BY c.id) SELECT COUNT(*) as customer_count FROM customer_loans WHERE house_loan IS NOT NULL AND car_loan IS NOT NULL AND house_loan > car_loan
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1065176696, DB=loan_user
执行标准SQL: SELECT dci.cust_nm, SUM(dci.current_bal + dci.fixed_bal) AS total_balance FROM debit_card_information dci JOIN bank_orgnization bo ON dci.bank_no = bo.bank_id WHERE dci.data_dt = '2024-07-19' AND bo.bank_name = '杭州上城区支行' GROUP BY dci.cust_nm ORDER BY total_balance DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 430/1042 个查询...
执行查询: ID=953680810, DB=loan_user
执行标准SQL: SELECT vouch_type, AVG(loan_amount) AS avg_loan_amount, PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY loan_amount) AS median_loan_amount, PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY loan_amount) - PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY loan_amount) AS iqr_loan_amount FROM loan_detail_info GROUP BY vouch_type
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2393859347, DB=loan_user
执行标准SQL: SELECT SUM(t.transfer_amount) FROM transfer t JOIN loan_credit lc ON t.source_customer_id = lc.customer_id OR t.target_customer_id = lc.customer_id WHERE t.transfer_date = '2020-11-03' AND lc.credit_score > 0.8
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=749612150, DB=loan_user
执行标准SQL: SELECT COUNT(DISTINCT c.id) FROM customer c JOIN loan_application la ON c.id = la.customer_id JOIN occupation o ON c.occupation_id = o.id WHERE la.loan_amount > 50000 AND o.occupation_name = '护士'
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3260359700, DB=loan_user
执行标准SQL: SELECT ld.cust_id, ld.loan_amount FROM loan_detail_info ld WHERE ld.dw_date BETWEEN '2024-07-01' AND '2024-07-31';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2869045188, DB=loan_user
执行标准SQL: SELECT DATE_TRUNC('month', apply_date) as month, COUNT(*) as total_applications, SUM(CASE WHEN status = 'APPROVED' THEN 1 ELSE 0 END) / COUNT(*) as approval_rate FROM loan_application GROUP BY month ORDER BY month
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2139894777, DB=loan_user
执行标准SQL: SELECT b.bank_name, SUM(f.wealth_bal) AS total_wealth_bal FROM financial_products f JOIN bank_orgnization b ON f.bank_no = b.bank_id WHERE f.data_dt = '2024-07-02' AND f.cast_type = '对公' GROUP BY b.bank_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2426521027, DB=loan_user
执行标准SQL: SELECT c.customer_name, l.status FROM customer c LEFT JOIN loan_application l ON c.id = l.customer_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3310012060, DB=loan_user
执行标准SQL: SELECT lt.loan_type_name, COUNT(la.customer_id) AS customer_count, SUM(la.loan_amount) AS total_loan_amount FROM loan_type lt JOIN loan_application la ON lt.id = la.loan_type_id GROUP BY lt.loan_type_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1454101538, DB=loan_user
执行标准SQL: SELECT CASE WHEN DATE_PART('year', AGE(date('now'), c.birth_date)) BETWEEN 0 AND 20 THEN '0-20' WHEN DATE_PART('year', AGE(date('now'), c.birth_date)) BETWEEN 21 AND 40 THEN '21-40' WHEN DATE_PART('year', AGE(date('now'), c.birth_date)) BETWEEN 41 AND 60 THEN '41-60' ELSE '61+' END as age_group, COUNT(CASE WHEN l.status = 'APPROVED' THEN 1 END) / COUNT(*) as approval_rate FROM customer c JOIN loan_application l ON c.id = l.customer_id GROUP BY age_group ORDER BY age_group
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1355579742, DB=loan_user
执行标准SQL: SELECT repayment_amount, repayment_date FROM loan_repayment WHERE loan_application_id = 323803;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 440/1042 个查询...
执行查询: ID=2730549341, DB=loan_user
执行标准SQL: SELECT lc.customer_id, lc.credit_score FROM loan_credit lc JOIN bank_orgnization bo ON lc.credit_date = bo.data_dt WHERE bo.bank_name = '杭州上城区支行' AND bo.data_dt = '2023-06-30' ORDER BY lc.credit_score DESC LIMIT 1;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1021718263, DB=loan_user
执行标准SQL: SELECT * FROM loan_repayment WHERE repayment_date < '2020-02-25';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=405520388, DB=loan_user
执行标准SQL: SELECT t.transfer_amount, t.transfer_date FROM transfer t JOIN customer c ON t.source_customer_id = c.id WHERE c.customer_name = '关飞';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1969682603, DB=loan_user
执行标准SQL: SELECT c.customer_name, c.id_number, s.loan_status_name FROM customer c JOIN loan_application a ON c.id = a.customer_id JOIN loan_status s ON a.status = s.loan_status_code;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=797442197, DB=loan_user
执行标准SQL: SELECT * FROM user_behavior WHERE behavior_type LIKE '%ILL%';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3086691704, DB=loan_user
执行标准SQL: SELECT * FROM transfer ORDER BY transfer_amount ASC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1652118460, DB=loan_user
执行标准SQL: SELECT * FROM user_behavior WHERE description IS NOT NULL;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=729818388, DB=loan_user
执行标准SQL: SELECT current_bal FROM debit_card_information WHERE cust_nm = 'James Taylor' AND bank_nm = '杭州上城区支行' AND data_dt = '2024-07-09';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3319537046, DB=loan_user
执行标准SQL: SELECT * FROM loan_type WHERE description ILIKE '%Loan%';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=981960336, DB=loan_user
执行标准SQL: SELECT c.curr_code, c.curr_full_name, COUNT(ccd.curr_num) AS account_count FROM currency c LEFT JOIN credit_card_data ccd ON c.curr_code = ccd.curr_num GROUP BY c.curr_code, c.curr_full_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 450/1042 个查询...
执行查询: ID=446364127, DB=loan_user
执行标准SQL: SELECT AVG(f.wealth_t_m_avg_bal_a) AS avg_guaranteed_balance FROM financial_products f;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1464013698, DB=loan_user
执行标准SQL: SELECT lt.loan_type_name, lt.description FROM loan_status ls JOIN loan_type lt ON ls.id = lt.id WHERE ls.loan_status_code = 'APPROVED';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2417924945, DB=loan_user
执行标准SQL: SELECT c.customer_name, DATE_PART('year', AGE(date('now'), c.birth_date)) as age, l.loan_amount FROM customer c JOIN loan_application l ON c.id = l.customer_id WHERE EXTRACT(YEAR FROM l.apply_date) = 2023 ORDER BY age DESC LIMIT 5
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3366689482, DB=loan_user
执行标准SQL: SELECT COUNT(DISTINCT lc.customer_id) FROM loan_credit lc JOIN financial_products fp ON lc.customer_id = fp.cust_no JOIN bank_orgnization bo ON fp.bank_no = bo.bank_id WHERE bo.bank_name = '杭州上城区支行' AND bo.data_dt = '2023-06-30' AND lc.credit_score > 0.75;
标准SQL执行错误: SQL执行失败: pq: operator does not exist: integer = character varying
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: operator does not exist: integer = character varying
执行查询: ID=3973811473, DB=loan_user
执行标准SQL: SELECT rs_type, COUNT(*) as count FROM five_level_classification WHERE data_dt = '2024-07-22' GROUP BY rs_type ORDER BY count DESC
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1905559813, DB=loan_user
执行标准SQL: SELECT flc.rs_type_name, COUNT(ub.id) AS behavior_count FROM five_level_classification flc LEFT JOIN user_behavior ub ON flc.rs_type_name = ub.behavior_type GROUP BY flc.rs_type_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=6017603, DB=loan_user
执行标准SQL: SELECT * FROM transfer ORDER BY transfer_date;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2286869285, DB=loan_user
执行标准SQL: SELECT card_type, card_type_nm, card_state FROM debit_card_information WHERE data_dt = '2024-07-09' AND bank_nm = '杭州上城区支行' AND cust_nm = 'James Taylor';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1590803091, DB=loan_user
执行标准SQL: SELECT SUM(wealth_bal) FROM financial_products WHERE data_dt = '2024-07-02' AND currency = 'USD';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3414285101, DB=loan_user
执行标准SQL: SELECT ub.customer_id, COUNT(ub.id) AS behavior_count, MAX(lc.credit_score) AS latest_credit_score FROM user_behavior ub JOIN loan_credit lc ON ub.customer_id = lc.customer_id GROUP BY ub.customer_id ORDER BY ub.customer_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 460/1042 个查询...
执行查询: ID=3246518573, DB=loan_user
执行标准SQL: SELECT t.transfer_amount, c1.customer_name AS source_customer_name, c2.customer_name AS target_customer_name FROM transfer t JOIN customer c1 ON t.source_customer_id = c1.id JOIN customer c2 ON t.target_customer_id = c2.id WHERE t.transfer_date = '2023-06-30' AND t.transfer_amount > 1000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=104815069, DB=loan_user
执行标准SQL: SELECT * FROM customer WHERE customer_name = '饶丽';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3801446621, DB=loan_user
执行标准SQL: SELECT d.card_no, d.cust_nm FROM debit_card_information d WHERE d.data_dt = '2024-07-14' AND d.card_state = '正常';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=368801370, DB=loan_user
执行标准SQL: SELECT ldi.cust_id, ldi.loan_balance, flc.rs_type_name, c.curr_full_name FROM loan_detail_info ldi JOIN five_level_classification flc ON ldi.judgelevel = flc.rs_type_id JOIN currency c ON ldi.currency_type = c.curr_code WHERE ldi.dw_date = '2024-07-19' AND ldi.loan_balance > 500000 ORDER BY ldi.loan_balance DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=852089580, DB=loan_user
执行标准SQL: SELECT COUNT(*) FROM deposit_account_info dai JOIN bank_orgnization bo ON dai.bank_no = bo.bank_id WHERE dai.data_dt = '2024-07-19' AND dai.acct_bal > 100000 AND dai.gender_code = '男' AND bo.bank_name = '沈阳分行';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1377442693, DB=loan_user
执行标准SQL: SELECT * FROM loan_type WHERE loan_type_name = '汽车贷款';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2349708736, DB=loan_user
执行标准SQL: SELECT c.customer_name, la.loan_amount FROM customer c JOIN loan_application la ON c.id = la.customer_id WHERE la.loan_amount > 10000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3911124385, DB=loan_user
执行标准SQL: WITH customer_scores AS (SELECT c.id, c.customer_name, COALESCE(SUM(dai.acct_bal), 0) AS total_deposit, AVG(lc.credit_score) AS avg_credit_score, AVG(CASE WHEN ldi.judgelevel = '1' THEN 100 WHEN ldi.judgelevel = '2' THEN 80 WHEN ldi.judgelevel = '3' THEN 60 WHEN ldi.judgelevel = '4' THEN 40 WHEN ldi.judgelevel = '5' THEN 20 ELSE 0 END) AS loan_repayment_score FROM customer c LEFT JOIN deposit_account_info dai ON c.id_number = dai.cert_code LEFT JOIN loan_credit lc ON c.id = lc.customer_id LEFT JOIN loan_detail_info ldi ON c.id_number = ldi.cust_id GROUP BY c.id, c.customer_name) SELECT customer_name, total_deposit, avg_credit_score, loan_repayment_score, (COALESCE(total_deposit / 1000000, 0) * 0.4 + COALESCE(avg_credit_score / 1000, 0) * 0.3 + COALESCE(loan_repayment_score / 100, 0) * 0.3) AS composite_score FROM customer_scores ORDER BY composite_score DESC LIMIT 20
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3773516021, DB=loan_user
执行标准SQL: SELECT occupation_code, description FROM occupation WHERE occupation_name = '护士';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1642595147, DB=loan_user
执行标准SQL: SELECT ub.customer_id, ub.behavior_type, lc.credit_score FROM user_behavior ub JOIN loan_credit lc ON ub.customer_id = lc.customer_id WHERE ub.behavior_date BETWEEN '2021-08-01' AND '2021-08-31';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 470/1042 个查询...
执行查询: ID=2547804030, DB=loan_user
执行标准SQL: SELECT lt.loan_type_name, ls.loan_status_name, ls.description FROM loan_type lt JOIN loan_status ls ON lt.id = ls.id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1574302461, DB=loan_user
执行标准SQL: SELECT f.bank_nm, SUM(f.wealth_bal) AS total_wealth_bal FROM financial_products f WHERE f.data_dt = '2024-07-02' AND f.cast_type = '对公' GROUP BY f.bank_nm;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=576649992, DB=loan_user
执行标准SQL: SELECT la.customer_id, lt.loan_type_name, la.loan_amount, la.loan_term, la.apply_date, la.status FROM loan_application la JOIN loan_type lt ON la.loan_type_id = lt.id WHERE lt.loan_type_name = '住房贷款' AND la.apply_date >= '2019-01-01' AND la.apply_date <= '2019-12-31' AND la.status = 'REJECTED';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=278921693, DB=loan_user
执行标准SQL: SELECT cust_no, wealth_bal_f FROM financial_products WHERE data_dt = '2024-07-19' AND wealth_bal_f > 100000 ORDER BY wealth_bal_f DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2923698873, DB=loan_user
执行标准SQL: SELECT customer_name, email FROM customer;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2256662449, DB=loan_user
执行标准SQL: WITH quarterly_stats AS (SELECT c.id, c.customer_name, DATE_TRUNC('quarter', l.apply_date) as quarter, COUNT(CASE WHEN l.status = 'APPROVED' THEN 1 END) / COUNT(*) as success_rate FROM customer c JOIN loan_application l ON c.id = l.customer_id GROUP BY c.id, c.customer_name, quarter) SELECT customer_name, quarter, success_rate, LAG(success_rate) OVER (PARTITION BY id ORDER BY quarter) as prev_quarter_rate, success_rate - LAG(success_rate) OVER (PARTITION BY id ORDER BY quarter) as rate_change FROM quarterly_stats ORDER BY customer_name, quarter
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=956063573, DB=loan_user
执行标准SQL: SELECT dai.cust_name, dai.acct_bal FROM deposit_account_info dai WHERE dai.data_dt = '2024-07-19' AND dai.cur_type = 'USD' ORDER BY dai.acct_bal DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=568233943, DB=loan_user
执行标准SQL: SELECT customer_name, id_number, phone_number, email FROM customer WHERE birth_date > '1980-01-01';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=665248378, DB=loan_user
执行标准SQL: SELECT c.customer_name, o.occupation_name, la.loan_amount FROM customer c JOIN occupation o ON c.occupation_id = o.id JOIN loan_application la ON c.id = la.customer_id ORDER BY la.loan_amount DESC LIMIT 5
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1030650241, DB=loan_user
执行标准SQL: SELECT cust_type, loan_balance FROM loan_detail_info;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 480/1042 个查询...
执行查询: ID=1979307069, DB=loan_user
执行标准SQL: SELECT SUM(d.current_bal) AS total_current_bal, SUM(d.fixed_bal) AS total_fixed_bal FROM debit_card_information d JOIN bank_orgnization b ON d.bank_no = b.bank_id WHERE b.bank_name = '杭州上城区支行' AND b.data_dt = '2023-06-30';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=645950570, DB=loan_user
执行标准SQL: SELECT flc.rs_type_name, ls.loan_status_name FROM five_level_classification flc JOIN loan_status ls ON flc.rs_type = '不良' WHERE flc.data_dt = '2024-07-22';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=3312818819, DB=loan_user
执行标准SQL: SELECT * FROM customer WHERE id_number = 'c839d762-6392-4005-8386-ed4e2c50997a';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=527420496, DB=loan_user
执行标准SQL: SELECT credit_score, description FROM loan_credit WHERE credit_date = '2003-06-22';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2918505586, DB=loan_user
执行标准SQL: SELECT d.cust_name, d.acct_bal FROM deposit_account_info d JOIN bank_orgnization b ON d.bank_no = b.bank_id WHERE d.data_dt = '2024-07-21' AND d.acct_bal > 50000 AND b.bank_name = '杭州分行';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1280121870, DB=loan_user
执行标准SQL: SELECT l.cust_id, l.loan_balance, d.acct_bal FROM loan_detail_info l JOIN deposit_account_info d ON l.cust_id = d.cust_no WHERE l.loan_balance > 10000;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2006837077, DB=loan_user
执行标准SQL: SELECT f.rs_type_name, COUNT(*) AS user_count, SUM(l.loan_balance) AS total_balance FROM five_level_classification f JOIN loan_detail_info l ON f.rs_type_id = l.judgelevel GROUP BY f.rs_type_name;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=938785076, DB=loan_user
执行标准SQL: SELECT deposit_name FROM deposit_type WHERE data_dt = '2024-07-22';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=182531082, DB=loan_user
执行标准SQL: SELECT * FROM transfer WHERE transfer_amount > 500;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1098966204, DB=loan_user
执行标准SQL: SELECT c.customer_name, c.id_number, lc.credit_score FROM customer c JOIN loan_credit lc ON c.id = lc.customer_id WHERE c.province = '河北省' AND lc.credit_score > 0.8 ORDER BY lc.credit_score DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 490/1042 个查询...
执行查询: ID=2906434348, DB=loan_user
执行标准SQL: WITH age_groups AS (SELECT c.id, CASE WHEN EXTRACT(YEAR FROM AGE(date('now'), c.birth_date)) BETWEEN 20 AND 30 THEN '20-30' WHEN EXTRACT(YEAR FROM AGE(date('now'), c.birth_date)) BETWEEN 31 AND 40 THEN '31-40' WHEN EXTRACT(YEAR FROM AGE(date('now'), c.birth_date)) BETWEEN 41 AND 50 THEN '41-50' ELSE '51+' END AS age_group FROM customer c) SELECT ag.age_group, lt.loan_type_name, COUNT(la.id) AS total_applications, SUM(CASE WHEN la.status = 'APPROVED' THEN 1 ELSE 0 END) / COUNT(la.id) AS success_rate FROM age_groups ag JOIN loan_application la ON ag.id = la.customer_id JOIN loan_type lt ON la.loan_type_id = lt.id GROUP BY ag.age_group, lt.loan_type_name ORDER BY ag.age_group, success_rate DESC
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4018894094, DB=loan_user
执行标准SQL: SELECT ls.loan_status_name, o.occupation_name FROM loan_status ls JOIN occupation o ON ls.loan_status_code = 'APPROVED' AND o.occupation_code = 'NURSE';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2317494329, DB=loan_user
执行标准SQL: SELECT o.occupation_name, COUNT(DISTINCT c.id) as customer_count, AVG(l.loan_amount) as avg_loan_amount FROM occupation o JOIN customer c ON o.id = c.occupation_id JOIN loan_application l ON c.id = l.customer_id GROUP BY o.occupation_name HAVING COUNT(DISTINCT c.id) > 100 ORDER BY customer_count DESC
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2459941756, DB=loan_user
执行标准SQL: SELECT f.cust_no, f.org_nm, f.currency, f.wealth_bal_f FROM financial_products f JOIN currency c ON f.currency = c.curr_code WHERE f.data_dt = '2024-07-14' AND f.org_nm = '沈阳余淮支行' AND f.currency = 'SGD';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=627241378, DB=loan_user
执行标准SQL: SELECT id_number, phone_number FROM customer;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3818857737, DB=loan_user
执行标准SQL: SELECT cust_nm, open_date FROM debit_card_information WHERE open_date >= '2024-07-05';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1788527678, DB=loan_user
执行标准SQL: WITH top_customers AS (SELECT cust_no FROM financial_products WHERE wealth_bal > (SELECT PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY wealth_bal) FROM financial_products)) SELECT COUNT(DISTINCT ub.customer_id) FROM top_customers tc JOIN user_behavior ub ON tc.cust_noeger = ub.customer_id WHERE ub.behavior_type = 'LOGIN' AND ub.behavior_date >= date('now') - INTERVAL '30 days'
标准SQL执行错误: SQL执行失败: pq: column tc.cust_noeger does not exist
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: column tc.cust_noeger does not exist
执行查询: ID=1240825133, DB=loan_user
执行标准SQL: SELECT lc.customer_id, lc.credit_score, ub.description FROM loan_credit lc JOIN user_behavior ub ON lc.customer_id = ub.customer_id WHERE lc.credit_date = '2023-12-10';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1225880496, DB=loan_user
执行标准SQL: SELECT bank_id, bank_name FROM bank_orgnization;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1895296880, DB=loan_user
执行标准SQL: SELECT lr.repayment_amount, la.loan_amount FROM loan_repayment lr JOIN loan_application la ON lr.loan_application_id = la.id WHERE lr.repayment_date = '2024-01-20';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 500/1042 个查询...
执行查询: ID=1454533076, DB=loan_user
执行标准SQL: SELECT c.curr_code, c.curr_full_name, COUNT(t.id) AS transfer_count FROM currency c LEFT JOIN transfer t ON c.curr_code = t.source_customer_id AND t.transfer_date < c.data_dt WHERE c.data_dt = '2023-06-30' AND c.curr_class = '外币' GROUP BY c.curr_code, c.curr_full_name;
标准SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: operator does not exist: character varying = integer
执行查询: ID=3316681947, DB=loan_user
执行标准SQL: SELECT repayment_amount FROM loan_repayment WHERE loan_application_id = 742969 AND repayment_date = '2021-11-10';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2982717712, DB=loan_user
执行标准SQL: SELECT d.deposit_type_name, AVG(l.loan_amount) AS avg_loan_amount, STDDEV(l.loan_amount) AS stddev_loan_amount FROM deposit_type d JOIN loan_detail_info l ON d.data_dt = l.dw_date GROUP BY d.deposit_type_name
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=279794629, DB=loan_user
执行标准SQL: SELECT c.customer_name, o.occupation_name, lr.repayment_date FROM customer c JOIN occupation o ON c.occupation_id = o.id JOIN loan_repayment lr ON c.id = lr.loan_application_id;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2733048479, DB=loan_user
执行标准SQL: SELECT lt.loan_type_name, AVG(la.loan_amount) as avg_loan_amount, AVG(dai.acct_bal) as avg_deposit_balance FROM loan_application la JOIN loan_type lt ON la.loan_type_id = lt.id JOIN deposit_account_info dai ON la.customer_id = dai.cust_noeger GROUP BY lt.loan_type_name
标准SQL执行错误: SQL执行失败: pq: column dai.cust_noeger does not exist
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: column dai.cust_noeger does not exist
执行查询: ID=1486729335, DB=loan_user
执行标准SQL: SELECT COUNT(DISTINCT lb.customer_id) FROM loan_application lb JOIN user_behavior ub ON lb.customer_id = ub.customer_id WHERE lb.apply_date = '2019-01-10' AND lb.status = 'REJECTED' AND ub.behavior_date = '2017-10-24' AND ub.behavior_type = 'LOGIN';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=760463294, DB=loan_user
执行标准SQL: SELECT c.customer_name, la.loan_amount FROM loan_application la JOIN customer c ON la.customer_id = c.id JOIN loan_credit lc ON c.id = lc.customer_id WHERE la.apply_date >= '2019-01-01' AND la.apply_date < '2020-01-01' AND lc.credit_score > 0.8 ORDER BY la.loan_amount DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=84990606, DB=loan_user
执行标准SQL: SELECT * FROM loan_detail_info WHERE loan_balance > 500000 ORDER BY loan_balance DESC;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2524485514, DB=loan_user
执行标准SQL: SELECT customer_id, credit_score FROM loan_credit WHERE credit_date = '2003-06-22' AND credit_score > 0.75;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3030054295, DB=loan_user
执行标准SQL: SELECT customer_name, birth_date FROM customer WHERE birth_date > '1990-01-01' ORDER BY birth_date
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 510/1042 个查询...
执行查询: ID=2842932086, DB=loan_user
执行标准SQL: WITH credit_change AS (SELECT customer_id, MAX(credit_score) - MIN(credit_score) as score_increase FROM loan_credit WHERE credit_date >= date('now') - INTERVAL '1 year' GROUP BY customer_id) SELECT cc.customer_id, cc.score_increase, lc.credit_score as current_score FROM credit_change cc JOIN loan_credit lc ON cc.customer_id = lc.customer_id WHERE lc.credit_date = (SELECT MAX(credit_date) FROM loan_credit WHERE customer_id = cc.customer_id) ORDER BY cc.score_increase DESC LIMIT 5
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2650630480, DB=loan_user
执行标准SQL: SELECT ub.behavior_type, COUNT(DISTINCT ub.customer_id) AS user_count FROM user_behavior ub GROUP BY ub.behavior_type;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3532447015, DB=loan_user
执行标准SQL: WITH deposit_customers AS (SELECT DISTINCT dt.deposit_name, dai.cust_no FROM deposit_type dt JOIN deposit_account_info dai ON dt.deposit_id = dai.arl_pdp_code WHERE dai.data_dt <= date('now') - INTERVAL '1 year'), recent_customers AS (SELECT DISTINCT dt.deposit_name, dai.cust_no FROM deposit_type dt JOIN deposit_account_info dai ON dt.deposit_id = dai.arl_pdp_code WHERE dai.data_dt > date('now') - INTERVAL '1 year') SELECT dc.deposit_name, COUNT(DISTINCT dc.cust_no) AS original_customers, COUNT(DISTINCT rc.cust_no) AS retained_customers, COUNT(DISTINCT rc.cust_no) / COUNT(DISTINCT dc.cust_no) AS retention_rate FROM deposit_customers dc LEFT JOIN recent_customers rc ON dc.deposit_name = rc.deposit_name AND dc.cust_no = rc.cust_no GROUP BY dc.deposit_name ORDER BY retention_rate DESC
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2513228683, DB=loan_user
执行标准SQL: SELECT SUM(t.transfer_amount) FROM deposit_account_info d JOIN transfer t ON d.cust_noeger = t.source_customer_id WHERE d.data_dt = '2024-07-19' AND d.bank_nm = '沈阳分行';
标准SQL执行错误: SQL执行失败: pq: column d.cust_noeger does not exist
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
标准SQL执行错误: SQL执行失败: pq: column d.cust_noeger does not exist
执行查询: ID=3023054014, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, MAX(ss.profit) AS max_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-06' GROUP BY s.store_name, s.manager_name ORDER BY max_profit DESC LIMIT 1;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name, ss.total_profit AS max_profit 
FROM 
  (SELECT ss.store_id, SUM(ss.profit) AS total_profit 
   FROM salesstatistics ss 
   WHERE ss.date = '2023-05-06' 
   GROUP BY ss.store_id) AS ss 
JOIN stores s ON ss.store_id = s.store_id 
ORDER BY ss.total_profit DESC 
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=252107871, DB=retail
执行标准SQL: SELECT profit, sales_quantity FROM salesstatistics;
执行预测SQL: SELECT profit AS profit, sales_quantity AS sales_quantity FROM salesstatistics
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2902085248, DB=retail
执行标准SQL: SELECT * FROM salesorders WHERE order_date = '2023-05-08';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=1743968577, DB=retail
执行标准SQL: SELECT e.name, e.position, s.store_name, so.total_amount FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN stores s ON so.store_id = s.store_id WHERE s.store_name = '数码广场店' AND so.order_date = '2023-05-05' AND so.total_amount > 7000;
执行预测SQL: SELECT e.name AS name, e.position AS position, s.store_name AS store_name, so.total_amount AS total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id WHERE so.order_date = '2023-05-05' AND s.store_name = '数码广场店' AND so.total_amount > 7000
标准SQL执行成功，行数: 74
预测SQL执行成功，行数: 74
执行查询: ID=3620145899, DB=retail
执行标准SQL: SELECT * FROM salesstatistics ORDER BY profit DESC LIMIT 1;
执行预测SQL: SELECT statistic_id AS statistic_id, store_id AS store_id, product_id AS product_id, employee_id AS employee_id, date AS date, sales_quantity AS sales_quantity, sales_amount AS sales_amount, profit AS profit FROM salesstatistics WHERE profit = (SELECT MAX(profit) FROM salesstatistics)
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=2283742907, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(od.quantity * od.unit_price) AS total_sales, p.product_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.order_date >= '2023-05-01' AND so.order_date < '2023-06-01' AND p.supplier_name = '苹果官方旗舰店' GROUP BY s.store_name, e.name, p.product_name HAVING SUM(od.quantity * od.unit_price) > 10000;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 520/1042 个查询...
执行查询: ID=3238938312, DB=retail
执行标准SQL: SELECT p.product_name, p.supplier_name FROM products p JOIN orderdetails od ON p.product_id = od.product_id JOIN salesorders so ON od.order_id = so.order_id JOIN stores st ON so.store_id = st.store_id WHERE st.store_name = '电子城旗舰店';
执行预测SQL: SELECT DISTINCT p.product_name, p.supplier_name 
FROM products p 
JOIN orderdetails od ON p.product_id = od.product_id 
JOIN salesorders so ON od.order_id = so.order_id 
JOIN stores st ON so.store_id = st.store_id 
WHERE st.store_name = '电子城旗舰店'
标准SQL执行成功，行数: 1031
预测SQL执行成功，行数: 80

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1031行, 预测SQL返回80行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [product_name supplier_name]
[35m预测SQL列:[0m [product_name supplier_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [Nintendo Switch 小米官方旗舰店]
[35m预测[1]:[0m [华为Mate 40 Pro 小米官方旗舰店]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [戴森V11 戴尔官方旗舰店]
[35m预测[2]:[0m [Nintendo Switch 苹果官方旗舰店]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [戴森V11 苹果官方旗舰店]
[35m预测[3]:[0m [小米电视4A 索尼官方旗舰店]
执行查询: ID=2878333594, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, e.position FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'iPad Air' AND ss.date = '2023-05-09';
执行预测SQL: SELECT DISTINCT stores.store_name AS store_name, employees.name AS employee_name, employees.position AS position FROM salesorders JOIN stores ON salesorders.store_id = stores.store_id JOIN employees ON salesorders.employee_id = employees.employee_id JOIN orderdetails ON salesorders.order_id = orderdetails.order_id JOIN products ON orderdetails.product_id = products.product_id WHERE products.product_name = 'iPad Air' AND salesorders.order_date = '2023-05-09'
标准SQL执行成功，行数: 124
预测SQL执行成功，行数: 97

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回124行, 预测SQL返回97行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_name position store_name]
[35m预测SQL列:[0m [store_name employee_name position]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [王帅 销售经理 数码广场店]
[35m预测[1]:[0m [创客空间店 冯梅 技术支持]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [陈玉华 销售顾问 智慧街店]
[35m预测[2]:[0m [创客空间店 吕洁 技术支持]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [王霞 技术支持 数字大道店]
[35m预测[3]:[0m [创客空间店 张红 技术支持]
执行查询: ID=754309478, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name FROM stores s JOIN salesstatistics ss ON s.store_id = ss.store_id WHERE ss.date = '2023-05-05' AND ss.sales_amount > 10000;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name 
FROM stores s 
JOIN (
    SELECT store_id 
    FROM salesorders 
    JOIN stores ON salesorders.store_id = stores.store_id 
    WHERE order_date = '2023-05-05' 
    GROUP BY store_id 
    HAVING SUM(total_amount) > 10000
) sub ON s.store_id = sub.store_id
预测SQL执行错误: SQL执行失败: pq: column reference "store_id" is ambiguous
预测SQL执行错误: SQL执行失败: pq: column reference "store_id" is ambiguous
执行查询: ID=711957819, DB=retail
执行标准SQL: SELECT e.name, so.total_amount FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id WHERE so.order_date = '2023-05-07' AND so.total_amount > 10000;
执行预测SQL: SELECT e.name AS name, so.total_amount AS total_amount
FROM salesorders so
JOIN employees e ON so.employee_id = e.employee_id
WHERE so.order_date = '2023-05-07'
AND so.total_amount > 10000
标准SQL执行成功，行数: 650
预测SQL执行成功，行数: 650
执行查询: ID=1769127756, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = '索尼WH-1000XM4' AND ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' GROUP BY s.store_name, e.name HAVING SUM(ss.profit) > 5000;
执行预测SQL: SELECT 
    s.store_name AS store_name,
    e.name AS employee_name,
    SUM(ss.profit) AS total_profit
FROM 
    salesstatistics ss
JOIN 
    products p ON ss.product_id = p.product_id
JOIN 
    stores s ON ss.store_id = s.store_id
JOIN 
    employees e ON ss.employee_id = e.employee_id
WHERE 
    p.product_name = '索尼WH-1000XM4'
    AND ss.date BETWEEN '2023-05-01' AND '2023-05-31'
GROUP BY 
    s.store_id, e.employee_id
HAVING 
    SUM(ss.profit) > 5000
标准SQL执行成功，行数: 2
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=435444064, DB=retail
执行标准SQL: SELECT DISTINCT e.employee_id, e.name FROM employees e JOIN salesorders s ON e.employee_id = s.employee_id JOIN orderdetails od ON s.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'Nintendo Switch' AND s.order_date BETWEEN '2023-05-01' AND '2023-05-31' AND s.total_amount > 5000;
执行预测SQL: SELECT DISTINCT e.employee_id AS employee_id, e.name AS name FROM employees e JOIN salesorders s ON e.employee_id = s.employee_id JOIN orderdetails od ON s.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'Nintendo Switch' AND s.order_date BETWEEN '2023-05-01' AND '2023-05-31' AND s.total_amount > 5000
标准SQL执行成功，行数: 858
预测SQL执行成功，行数: 858
执行查询: ID=2637911653, DB=retail
执行标准SQL: SELECT p.product_name, MAX(ss.sales_amount) AS max_sales_amount FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id GROUP BY p.product_name ORDER BY max_sales_amount DESC LIMIT 1;
执行预测SQL: SELECT p.product_name, s.sales_amount AS max_sales_amount
FROM salesstatistics s
JOIN products p ON s.product_id = p.product_id
WHERE s.sales_amount = (SELECT MAX(sales_amount) FROM salesstatistics)
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=424774041, DB=retail
执行标准SQL: SELECT od.order_detail_id, p.product_name, so.total_amount FROM orderdetails od JOIN products p ON od.product_id = p.product_id JOIN salesorders so ON od.order_id = so.order_id;
执行预测SQL: SELECT od.order_detail_id AS order_detail_id, p.product_name AS product_name, so.total_amount AS total_amount FROM orderdetails od JOIN products p ON od.product_id = p.product_id JOIN salesorders so ON od.order_id = so.order_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1958922267, DB=retail
执行标准SQL: SELECT e.name, st.store_name FROM employees e JOIN stores st ON e.store_id = st.store_id;
执行预测SQL: SELECT employees.name AS name, stores.store_name AS store_name FROM employees JOIN stores ON employees.store_id = stores.store_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1850407582, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(ss.sales_amount) AS total_sales_amount FROM stores s JOIN salesstatistics ss ON s.store_id = ss.store_id WHERE ss.date = '2023-05-08' GROUP BY s.store_name, s.manager_name;
执行预测SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-08' GROUP BY s.store_id, s.store_name, s.manager_name
标准SQL执行成功，行数: 1108
预测SQL执行成功，行数: 1051

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1108行, 预测SQL返回1051行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name total_sales_amount]
[35m预测SQL列:[0m [store_name manager_name total_sales_amount]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [数码广场店 何柳 16845.37]
[35m预测[1]:[0m [科技中心店 易柳 10626.77]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [创新路专卖店 邹淑珍 9173.53]
[35m预测[2]:[0m [数字大道店 鞠秀云 11149.28]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [电子城旗舰店 景波 1846.22]
[35m预测[3]:[0m [数字大道店 陈东 12815.75]
已处理 530/1042 个查询...
执行查询: ID=3887504470, DB=retail
执行标准SQL: SELECT so.order_id, e.name FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id WHERE so.total_amount > 7000;
执行预测SQL: SELECT s.order_id AS order_id, e.name AS name
FROM salesorders s
JOIN employees e ON s.employee_id = e.employee_id
WHERE s.total_amount > 7000
标准SQL执行成功，行数: 7118
预测SQL执行成功，行数: 7118
执行查询: ID=3068871934, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(od.quantity * od.unit_price) AS total_sales, p.product_name FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON so.store_id = s.store_id JOIN products p ON od.product_id = p.product_id WHERE p.supplier_name = '苹果官方旗舰店' AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_name, e.name, p.product_name HAVING SUM(od.quantity * od.unit_price) > 10000;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2869270561, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-06' AND p.product_name = 'iPhone 13' AND ss.profit > 4000;
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=3219161296, DB=retail
执行标准SQL: SELECT * FROM salesorders WHERE order_id = 'b8b62bfe-a35d-4ff5-9bc9-654b5f67fed2';
执行预测SQL: SELECT order_id AS order_id, store_id AS store_id, employee_id AS employee_id, order_date AS order_date, total_amount AS total_amount FROM salesorders WHERE order_id = 'b8b62bfe-a35d-4ff5-9bc9-654b5f67fed2'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=4084880534, DB=retail
执行标准SQL: SELECT e.name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id GROUP BY e.name;
执行预测SQL: SELECT e.name, SUM(so.total_amount) AS total_sales FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id GROUP BY e.employee_id
标准SQL执行成功，行数: 5835
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回5835行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name total_sales]
[35m预测SQL列:[0m [name total_sales]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [杨敏 13890.41]
[35m预测[1]:[0m [鲁宇 9528.67]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [池秀兰 1976.55]
[35m预测[2]:[0m [王佳 16818.92]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [高丽娟 19832.38]
[35m预测[3]:[0m [陈雷 1894.8]
执行查询: ID=758163770, DB=retail
执行标准SQL: SELECT p.product_name, p.sale_price, p.purchase_price FROM products p;
执行预测SQL: SELECT product_name AS product_name, sale_price AS sale_price, purchase_price AS purchase_price FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2553064409, DB=retail
执行标准SQL: SELECT e.name AS employee_name, s.manager_name AS store_manager_name FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON so.store_id = s.store_id WHERE so.order_date >= '2023-05-01' AND so.order_date < '2023-06-01' AND so.total_amount > 10000 GROUP BY e.name, s.manager_name;
执行预测SQL: SELECT e.name AS employee_name, s.manager_name AS store_manager_name 
FROM salesorders so
JOIN stores s ON so.store_id = s.store_id
JOIN employees e ON so.employee_id = e.employee_id
WHERE EXTRACT(MONTH FROM so.order_date) = 5 
AND EXTRACT(YEAR FROM so.order_date) = 2023
GROUP BY e.name, s.manager_name, so.employee_id, s.store_id
HAVING SUM(so.total_amount) > 10000
标准SQL执行成功，行数: 5521
预测SQL执行成功，行数: 5523

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回5521行, 预测SQL返回5523行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_manager_name employee_name]
[35m预测SQL列:[0m [employee_name store_manager_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [杨婷婷 曾旭]
[35m预测[1]:[0m [丁刚 李欢]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [郑荣 苏利]
[35m预测[2]:[0m [丁志强 李桂珍]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [郭静 佘婷]
[35m预测[3]:[0m [丁慧 夏想]
执行查询: ID=2558715347, DB=retail
执行标准SQL: SELECT employee_id, store_id FROM employees;
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=2334672967, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, p.product_name, ss.profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-07' AND p.product_name = 'Apple Watch Series 7';
执行预测SQL: SELECT s.store_name AS store_name, e.name AS employee_name, p.product_name AS product_name, ss.profit AS profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-07' AND p.product_name = 'Apple Watch Series 7'
标准SQL执行成功，行数: 110
预测SQL执行成功，行数: 110
执行查询: ID=3673770320, DB=retail
执行标准SQL: SELECT DISTINCT s.store_name, e.name AS manager_name FROM stores s JOIN employees e ON s.store_id = e.store_id JOIN salesorders so ON s.store_id = so.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.order_date = '2023-05-05' AND so.total_amount > 10000 AND p.sale_price > 5000 AND e.position = '销售经理';
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name 
FROM stores s 
JOIN salesorders so ON s.store_id = so.store_id 
WHERE so.order_date = '2023-05-05' 
AND so.total_amount > 10000 
AND EXISTS (
    SELECT 1 
    FROM orderdetails od 
    JOIN products p ON od.product_id = p.product_id 
    WHERE od.order_id = so.order_id 
    AND p.sale_price > 5000
)
标准SQL执行成功，行数: 98
预测SQL执行成功，行数: 495

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回98行, 预测SQL返回495行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name]
[35m预测SQL列:[0m [store_name manager_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 刘桂香]
[35m预测[1]:[0m [未来城店 王建军]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [创客空间店 吴鹏]
[35m预测[2]:[0m [创客空间店 王丹]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [创客空间店 张鹏]
[35m预测[3]:[0m [创客空间店 李云]
已处理 540/1042 个查询...
执行查询: ID=1434650665, DB=retail
执行标准SQL: SELECT od.order_detail_id, p.product_name, od.quantity FROM orderdetails od JOIN products p ON od.product_id = p.product_id;
执行预测SQL: SELECT orderdetails.order_detail_id AS order_detail_id, products.product_name AS product_name, orderdetails.quantity AS quantity FROM orderdetails LEFT JOIN products ON orderdetails.product_id = products.product_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=4072489559, DB=retail
执行标准SQL: SELECT * FROM salesorders WHERE store_id = '0887d06a-27a8-46b4-98d6-514702e698da';
执行预测SQL: SELECT order_id AS order_id, store_id AS store_id, employee_id AS employee_id, order_date AS order_date, total_amount AS total_amount FROM salesorders WHERE store_id = '0887d06a-27a8-46b4-98d6-514702e698da'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=3987499786, DB=retail
执行标准SQL: SELECT e.employee_id, e.name FROM employees e JOIN salesstatistics ss ON e.employee_id = ss.employee_id JOIN orderdetails od ON ss.product_id = od.product_id WHERE ss.date >= '2023-05-01' AND ss.date < '2023-06-01' AND ss.sales_quantity > od.quantity GROUP BY e.employee_id, e.name;
执行预测SQL: SELECT s.employee_id AS employee_id, e.name AS name FROM (SELECT employee_id, SUM(sales_quantity) AS sales_statistic_quantity FROM salesstatistics WHERE date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY employee_id) s JOIN (SELECT o.employee_id, SUM(od.quantity) AS order_details_quantity FROM orderdetails od JOIN salesorders o ON od.order_id = o.order_id WHERE o.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY o.employee_id) o ON s.employee_id = o.employee_id JOIN employees e ON s.employee_id = e.employee_id WHERE s.sales_statistic_quantity > o.order_details_quantity
标准SQL执行成功，行数: 2456
预测SQL执行成功，行数: 2456
执行查询: ID=3272650586, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(so.total_amount) AS total_sales_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'iPad Air' AND so.order_date = '2023-05-01' GROUP BY s.store_name, e.name;
执行预测SQL: SELECT stores.store_name AS store_name, employees.name AS employee_name, SUM(salesorders.total_amount) AS total_sales_amount FROM salesorders JOIN orderdetails ON salesorders.order_id = orderdetails.order_id JOIN products ON orderdetails.product_id = products.product_id JOIN stores ON salesorders.store_id = stores.store_id JOIN employees ON salesorders.employee_id = employees.employee_id WHERE salesorders.order_date = '2023-05-01' AND products.product_name = 'iPad Air' GROUP BY stores.store_id, employees.employee_id, stores.store_name, employees.name
标准SQL执行成功，行数: 131
预测SQL执行成功，行数: 131
执行查询: ID=1170763492, DB=retail
执行标准SQL: SELECT pd.product_name, SUM(od.quantity) AS total_quantity, so.order_date
FROM orderdetails od
JOIN salesorders so ON od.order_id = so.order_id
JOIN products pd ON od.product_id = pd.product_id
GROUP BY pd.product_name, so.order_date;
执行预测SQL: SELECT p.product_name, od.quantity AS total_quantity, so.order_date 
FROM products p 
JOIN orderdetails od ON p.product_id = od.product_id 
JOIN salesorders so ON od.order_id = so.order_id
标准SQL执行成功，行数: 90
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回90行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [product_name total_quantity order_date]
[35m预测SQL列:[0m [total_quantity order_date product_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [iPad Air 178 2023-05-02 00:00:00 +0000 +0000]
[35m预测[1]:[0m [1 2023-05-02 00:00:00 +0000 +0000 戴森V11]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [索尼WH-1000XM4 178 2023-05-09 00:00:00 +0000 +0000]
[35m预测[2]:[0m [1 2023-05-06 00:00:00 +0000 +0000 iPhone 13]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [Nintendo Switch 185 2023-05-07 00:00:00 +0000 +0000]
[35m预测[3]:[0m [1 2023-05-04 00:00:00 +0000 +0000 iPhone 13]
执行查询: ID=3307597619, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date >= '2023-05-01' AND so.order_date < '2023-06-01' GROUP BY s.store_name, s.manager_name ORDER BY total_sales DESC LIMIT 1;
执行预测SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date >= '2023-05-01' AND so.order_date < '2023-06-01' GROUP BY s.store_id ORDER BY total_sales DESC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name total_sales]
[35m预测SQL列:[0m [manager_name total_sales store_name]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [数字大道店 张兰英 54537.63]
[35m预测[1]:[0m [臧红 19998.86 电子城旗舰店]
执行查询: ID=2824509879, DB=retail
执行标准SQL: SELECT e.name, e.position, s.store_name, p.product_name, ss.sales_quantity FROM employees e JOIN salesstatistics ss ON e.employee_id = ss.employee_id JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE s.store_name = '数码广场店' AND p.product_name = 'iPhone 13' AND ss.date = '2023-05-03' AND ss.sales_quantity > 1;
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=348511856, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-07' GROUP BY s.store_name, s.manager_name ORDER BY total_sales DESC LIMIT 1;
执行预测SQL: SELECT 
    s.store_name AS store_name,
    s.manager_name AS manager_name,
    SUM(so.total_amount) AS total_sales
FROM 
    salesorders so
JOIN 
    stores s ON so.store_id = s.store_id
WHERE 
    so.order_date = '2023-05-07'
GROUP BY 
    s.store_id, s.store_name, s.manager_name
ORDER BY 
    total_sales DESC
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name total_sales]
[35m预测SQL列:[0m [store_name manager_name total_sales]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [智能生活馆 王丽娟 31318.97]
[35m预测[1]:[0m [电子城旗舰店 臧红 19998.86]
执行查询: ID=3403500771, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '索尼WH-1000XM4' AND so.order_date = '2023-05-01' AND so.total_amount > 8000;
执行预测SQL: SELECT s.store_name AS store_name, e.name AS employee_name, so.total_amount AS total_amount 
FROM salesorders so 
JOIN orderdetails od ON so.order_id = od.order_id 
JOIN products p ON od.product_id = p.product_id 
JOIN stores s ON so.store_id = s.store_id 
JOIN employees e ON so.employee_id = e.employee_id 
WHERE p.product_name = '索尼WH-1000XM4' 
AND so.order_date = '2023-05-01' 
AND so.total_amount > 8000
标准SQL执行成功，行数: 89
预测SQL执行成功，行数: 89
执行查询: ID=1837973022, DB=retail
执行标准SQL: SELECT purchase_price, sale_price FROM products WHERE product_id = '9e847a4c-3927-45a2-9a3d-a400cdec1d6a';
执行预测SQL: SELECT purchase_price AS purchase_price, sale_price AS sale_price FROM products
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [purchase_price sale_price]
[35m预测SQL列:[0m [purchase_price sale_price]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [5455.22 18441.43]
[35m预测[1]:[0m [3201.61 2744.4]
已处理 550/1042 个查询...
执行查询: ID=1041289855, DB=retail
执行标准SQL: SELECT product_id, unit_price, quantity FROM orderdetails;
执行预测SQL: SELECT product_id AS product_id, unit_price AS unit_price, quantity AS quantity FROM orderdetails
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2902800338, DB=retail
执行标准SQL: SELECT e.name AS employee_name, s.store_name FROM employees e JOIN salesstatistics ss ON e.employee_id = ss.employee_id JOIN products p ON ss.product_id = p.product_id JOIN stores s ON e.store_id = s.store_id WHERE p.product_name = 'Apple Watch Series 7' AND ss.date = '2023-05-06';
执行预测SQL: SELECT DISTINCT e.name AS employee_name, s.store_name 
FROM employees e 
JOIN salesorders so ON e.employee_id = so.employee_id 
JOIN stores s ON so.store_id = s.store_id 
JOIN orderdetails od ON so.order_id = od.order_id 
JOIN products p ON od.product_id = p.product_id 
WHERE p.product_name = 'Apple Watch Series 7' 
AND so.order_date = '2023-05-06'
标准SQL执行成功，行数: 137
预测SQL执行成功，行数: 106

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回137行, 预测SQL返回106行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_name store_name]
[35m预测SQL列:[0m [employee_name store_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [王桂珍 未来城店]
[35m预测[1]:[0m [亓军 电子城旗舰店]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [刘英 科技中心店]
[35m预测[2]:[0m [任雪梅 创新路专卖店]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [孙金凤 数字大道店]
[35m预测[3]:[0m [何秀珍 科技中心店]
执行查询: ID=2465572579, DB=retail
执行标准SQL: SELECT st.store_name, SUM(od.quantity) AS total_quantity, SUM(so.total_amount) AS total_sales FROM orderdetails od JOIN salesorders so ON od.order_id = so.order_id JOIN stores st ON so.store_id = st.store_id GROUP BY st.store_name ORDER BY total_quantity DESC LIMIT 1;
执行预测SQL: SELECT s.store_name, COUNT(so.order_id) AS total_quantity, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id GROUP BY s.store_name ORDER BY total_quantity DESC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name total_quantity total_sales]
[35m预测SQL列:[0m [total_quantity total_sales store_name]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 1588 1.152176211e+07]
[35m预测[1]:[0m [1049 1.152176211e+07 创客空间店]
执行查询: ID=4232056788, DB=retail
执行标准SQL: SELECT DISTINCT e.name AS employee_name, p.category_name AS product_category FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.order_date >= '2023-05-01' AND so.order_date < '2023-06-01' AND so.total_amount > 10000;
执行预测SQL: SELECT DISTINCT e.name AS employee_name, p.category_name AS product_category
FROM salesorders s
JOIN employees e ON s.employee_id = e.employee_id
JOIN orderdetails od ON s.order_id = od.order_id
JOIN products p ON od.product_id = p.product_id
WHERE s.order_date BETWEEN '2023-05-01' AND '2023-05-31'
AND s.total_amount > 10000
标准SQL执行成功，行数: 5168
预测SQL执行成功，行数: 5168
执行查询: ID=3813879652, DB=retail
执行标准SQL: SELECT e.name AS employee_name, s.store_name, SUM(so.total_amount) AS total_amount FROM employees e JOIN stores s ON e.store_id = s.store_id JOIN salesorders so ON s.store_id = so.store_id GROUP BY e.name, s.store_name;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1308038325, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_name, s.manager_name;
执行预测SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_id, s.store_name, s.manager_name
标准SQL执行成功，行数: 9087
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回9087行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name total_sales_amount]
[35m预测SQL列:[0m [manager_name total_sales_amount store_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [数字大道店 迟兵 7218.31]
[35m预测[1]:[0m [龚丽丽 14316.45 创客空间店]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [智慧街店 李桂花 6156.46]
[35m预测[2]:[0m [高俊 6705.12 智慧街店]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [数字大道店 祝平 13535.97]
[35m预测[3]:[0m [谢丽娟 19634.73 创客空间店]
执行查询: ID=3746071071, DB=retail
执行标准SQL: SELECT pd.product_name, SUM(od.quantity) AS total_quantity
FROM orderdetails od
JOIN salesorders so ON od.order_id = so.order_id
JOIN products pd ON od.product_id = pd.product_id
WHERE so.order_date BETWEEN '2023-05-01' AND '2023-05-31'
GROUP BY pd.product_name
HAVING SUM(od.quantity) > 5;
执行预测SQL: SELECT p.product_name, SUM(ss.sales_quantity) AS total_quantity FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id WHERE ss.date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY p.product_id, p.product_name HAVING SUM(ss.sales_quantity) > 5
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=2561670271, DB=retail
执行标准SQL: SELECT p.product_name, SUM(od.quantity) AS total_quantity, p.sale_price FROM products p JOIN orderdetails od ON p.product_id = od.product_id GROUP BY p.product_name, p.sale_price;
执行预测SQL: SELECT p.product_name, SUM(s.sales_quantity) AS total_quantity, p.sale_price 
FROM products p 
JOIN salesstatistics s ON p.product_id = s.product_id 
GROUP BY p.product_id, p.product_name, p.sale_price
标准SQL执行成功，行数: 9996
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回9996行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [product_name total_quantity sale_price]
[35m预测SQL列:[0m [product_name total_quantity sale_price]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [Apple Watch Series 7 2 8235.44]
[35m预测[1]:[0m [iPhone 13 2 7672.24]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [佳能EOS R6 2 12601.83]
[35m预测[2]:[0m [佳能EOS R6 1 2455.75]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [小米电视4A 1 7392.8]
[35m预测[3]:[0m [华为Mate 40 Pro 1 9378.69]
执行查询: ID=3159630797, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS sales_manager_name, ss.profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-01' AND p.product_name = '佳能EOS R6' AND e.position = '销售经理';
执行预测SQL: SELECT 
    s.store_name AS store_name,
    s.manager_name AS sales_manager_name,
    ss.profit AS profit
FROM 
    salesstatistics ss
JOIN 
    products p ON ss.product_id = p.product_id
JOIN 
    stores s ON ss.store_id = s.store_id
WHERE 
    p.product_name = '佳能EOS R6'
    AND ss.date = '2023-05-01'
标准SQL执行成功，行数: 24
预测SQL执行成功，行数: 117

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回24行, 预测SQL返回117行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name sales_manager_name profit]
[35m预测SQL列:[0m [store_name sales_manager_name profit]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创新路专卖店 秦杰 1447.62]
[35m预测[1]:[0m [创新路专卖店 温淑珍 1447.62]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [智慧街店 张宁 3021.11]
[35m预测[2]:[0m [科技园店 朱兰英 1874.76]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [科技园店 刘桂兰 4073.31]
[35m预测[3]:[0m [数码广场店 李磊 3645.05]
执行查询: ID=4216280203, DB=retail
执行标准SQL: SELECT st.store_name, st.phone, st.address FROM stores st;
执行预测SQL: SELECT store_name AS store_name, phone AS phone, address AS address FROM stores
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 560/1042 个查询...
执行查询: ID=731373976, DB=retail
执行标准SQL: SELECT so.order_id, p.product_name FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.total_amount < 5000;
执行预测SQL: SELECT so.order_id AS order_id, p.product_name AS product_name FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.total_amount < 5000
标准SQL执行成功，行数: 1785
预测SQL执行成功，行数: 1785
执行查询: ID=170942591, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(ss.sales_quantity) AS total_sales_quantity, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id WHERE ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' AND e.position = '销售顾问' GROUP BY s.store_name, e.name ORDER BY total_sales_quantity DESC LIMIT 1;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3730467553, DB=retail
执行标准SQL: SELECT s.store_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = '小米电视4A' AND ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' GROUP BY s.store_name;
执行预测SQL: SELECT s.store_name, SUM(ss.profit) AS total_profit 
FROM salesstatistics ss 
JOIN stores s ON ss.store_id = s.store_id 
WHERE ss.product_id IN (SELECT product_id FROM products WHERE product_name = '小米电视4A') 
AND ss.date BETWEEN '2023-05-01' AND '2023-05-31' 
GROUP BY ss.store_id, s.store_name
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 980

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回980行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name total_profit]
[35m预测SQL列:[0m [store_name total_profit]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 309943.39]
[35m预测[1]:[0m [智慧街店 2339.29]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [数码广场店 277969.79]
[35m预测[2]:[0m [未来城店 3438.58]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [电子城旗舰店 257880.19]
[35m预测[3]:[0m [智慧街店 2648.32]
执行查询: ID=2909047140, DB=retail
执行标准SQL: SELECT e.name AS employee_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-06' AND s.store_name = '智慧街店' AND p.product_name = '小米电视4A' GROUP BY e.name;
执行预测SQL: SELECT e.name AS employee_name, SUM(od.quantity * (p.sale_price - p.purchase_price)) AS total_profit 
FROM salesorders s 
JOIN orderdetails od ON s.order_id = od.order_id 
JOIN products p ON od.product_id = p.product_id 
JOIN employees e ON s.employee_id = e.employee_id 
JOIN stores st ON s.store_id = st.store_id 
WHERE s.order_date = '2023-05-06' 
AND st.store_name = '智慧街店' 
AND p.product_name = '小米电视4A' 
GROUP BY e.name
标准SQL执行成功，行数: 11
预测SQL执行成功，行数: 13

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回11行, 预测SQL返回13行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_name total_profit]
[35m预测SQL列:[0m [total_profit employee_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [刘红梅 385.28]
[35m预测[1]:[0m [15161.69 刘红梅]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [厉丽娟 4342.28]
[35m预测[2]:[0m [5635.29 朱涛]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [叶鑫 2859.88]
[35m预测[3]:[0m [1652.93 李晶]
执行查询: ID=2998787786, DB=retail
执行标准SQL: SELECT store_name, phone FROM stores;
执行预测SQL: SELECT store_name AS store_name, phone AS phone FROM stores
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3020408935, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name FROM stores s JOIN salesstatistics ss ON s.store_id = ss.store_id WHERE ss.date = '2023-05-08' AND ss.profit > 1000;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name FROM stores s WHERE s.store_id IN (SELECT store_id FROM salesstatistics WHERE date = '2023-05-08' GROUP BY store_id HAVING SUM(profit) > 1000)
标准SQL执行成功，行数: 962
预测SQL执行成功，行数: 962
执行查询: ID=3729612424, DB=retail
执行标准SQL: SELECT p.category_name, SUM(ss.sales_quantity) AS total_sales FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id GROUP BY p.category_name;
执行预测SQL: SELECT p.category_name, SUM(od.quantity) AS total_sales FROM orderdetails od JOIN products p ON od.product_id = p.product_id GROUP BY p.category_name
标准SQL执行成功，行数: 9
预测SQL执行成功，行数: 9

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [category_name total_sales]
[35m预测SQL列:[0m [category_name total_sales]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [电视 1525]
[35m预测[1]:[0m [电视 1519]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [智能手表 1438]
[35m预测[2]:[0m [智能手表 1435]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [耳机 1529]
[35m预测[3]:[0m [耳机 1567]
执行查询: ID=1558062721, DB=retail
执行标准SQL: SELECT s.store_name, e.name FROM stores s JOIN employees e ON s.store_id = e.store_id;
执行预测SQL: SELECT stores.store_name AS store_name, employees.name AS employee_name FROM stores JOIN employees ON stores.store_id = employees.store_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3748358677, DB=retail
执行标准SQL: SELECT so.order_id FROM salesorders so WHERE so.total_amount > (SELECT AVG(total_amount) FROM salesorders);
执行预测SQL: SELECT order_id AS order_id FROM salesorders WHERE total_amount > (SELECT AVG(total_amount) FROM salesorders)
标准SQL执行成功，行数: 5024
预测SQL执行成功，行数: 5024
执行查询: ID=281510090, DB=retail
执行标准SQL: SELECT * FROM salesorders WHERE order_date BETWEEN '2023-05-01' AND '2023-05-31';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
已处理 570/1042 个查询...
执行查询: ID=930082852, DB=retail
执行标准SQL: SELECT e.name, so.order_date, so.total_amount FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id;
执行预测SQL: SELECT e.name AS name, so.order_date AS order_date, so.total_amount AS total_amount FROM employees e LEFT JOIN salesorders so ON e.employee_id = so.employee_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=874677465, DB=retail
执行标准SQL: SELECT e.name, SUM(so.total_amount) AS total_sales FROM employees e LEFT JOIN salesorders so ON e.employee_id = so.employee_id GROUP BY e.name;
执行预测SQL: SELECT e.name, SUM(so.total_amount) AS total_sales FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id GROUP BY e.employee_id
标准SQL执行成功，行数: 5835
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回5835行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name total_sales]
[35m预测SQL列:[0m [name total_sales]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [杨敏 13890.41]
[35m预测[1]:[0m [鲁宇 9528.67]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [池秀兰 1976.55]
[35m预测[2]:[0m [王佳 16818.92]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [高丽娟 19832.38]
[35m预测[3]:[0m [陈雷 1894.8]
执行查询: ID=1675790879, DB=retail
执行标准SQL: SELECT e.name, SUM(ss.sales_quantity) AS total_sales, SUM(ss.profi) AS, total_profit FROM salesstatistics ss JOIN employees e ON ss.employee_id = e.employee_id GROUP BY e.name;
标准SQL执行错误: SQL执行失败: pq: syntax error at or near ","
执行预测SQL: SELECT e.name, SUM(ss.sales_quantity) AS total_quantity, SUM(ss.profit) AS total_profit 
FROM employees e 
LEFT JOIN salesstatistics ss ON e.employee_id = ss.employee_id 
GROUP BY e.employee_id, e.name
标准SQL执行错误: SQL执行失败: pq: syntax error at or near ","
执行查询: ID=1635802249, DB=retail
执行标准SQL: SELECT DISTINCT s.store_name FROM stores s JOIN salesorders so ON s.store_id = so.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '佳能EOS R6' AND so.order_date >= '2023-05-01' AND so.order_date < '2023-06-01' AND so.total_amount > 10000;
执行预测SQL: SELECT DISTINCT s.store_name AS store_name
FROM salesorders so
JOIN orderdetails od ON so.order_id = od.order_id
JOIN products p ON od.product_id = p.product_id
JOIN stores s ON so.store_id = s.store_id
WHERE p.product_name = '佳能EOS R6'
AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31'
AND so.total_amount > 10000
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10
执行查询: ID=2425848754, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-05' GROUP BY s.store_name, s.manager_name ORDER BY total_sales DESC LIMIT 1;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name, SUM(so.total_amount) AS total_sales 
FROM salesorders so 
JOIN stores s ON so.store_id = s.store_id 
WHERE so.order_date = '2023-05-05' 
GROUP BY s.store_id 
ORDER BY total_sales DESC 
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name total_sales]
[35m预测SQL列:[0m [store_name manager_name total_sales]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [智慧街店 李波 27496.71]
[35m预测[1]:[0m [创新路专卖店 吕鑫 19953.35]
执行查询: ID=2746220287, DB=retail
执行标准SQL: SELECT s.store_name, SUM(ss.sales_quantity) AS total_quantity, SUM(ss.sales_amount) AS total_amount FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id GROUP BY s.store_name;
执行预测SQL: SELECT s.store_name, SUM(od.quantity) AS total_quantity, SUM(od.quantity * od.unit_price) AS total_amount FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN stores s ON so.store_id = s.store_id GROUP BY s.store_name
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name total_quantity total_amount]
[35m预测SQL列:[0m [store_name total_quantity total_amount]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 1556 1.161100751e+07]
[35m预测[1]:[0m [创客空间店 1588 1.682022955e+07]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [数码广场店 1498 1.079583975e+07]
[35m预测[2]:[0m [数码广场店 1501 1.621679908e+07]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [电子城旗舰店 1552 1.138988782e+07]
[35m预测[3]:[0m [电子城旗舰店 1517 1.684447052e+07]
执行查询: ID=4181874210, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(ss.sales_quantity) AS total_sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' GROUP BY s.store_name, s.manager_name ORDER BY total_sales_quantity DESC LIMIT 1;
执行预测SQL: SELECT s.store_name, s.manager_name, SUM(ss.sales_quantity) AS total_sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_id, s.store_name, s.manager_name ORDER BY total_sales_quantity DESC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name total_sales_quantity]
[35m预测SQL列:[0m [store_name manager_name total_sales_quantity]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [数字大道店 张玉梅 8]
[35m预测[1]:[0m [创客空间店 龚丽丽 2]
执行查询: ID=1518878415, DB=retail
执行标准SQL: SELECT so.order_id, so.total_amount FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id WHERE e.name = '王丽';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=729031894, DB=retail
执行标准SQL: SELECT od.order_detail_id, od.unit_price FROM orderdetails od JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '戴尔灵越15';
执行预测SQL: SELECT orderdetails.order_detail_id AS order_detail_id, orderdetails.unit_price AS unit_price
FROM orderdetails
JOIN products ON orderdetails.product_id = products.product_id
WHERE products.product_id = '35710343-90e8-47c1-9546-5abcff309bbd'
标准SQL执行成功，行数: 963
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回963行, 预测SQL返回1行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [order_detail_id unit_price]
[35m预测SQL列:[0m [order_detail_id unit_price]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [262832d5-b2f4-4ebf-b7c6-6e95cc674f65 12445.38]
[35m预测[1]:[0m [2819896d-44da-41dd-8f3e-901877711a0c 3671.12]
执行查询: ID=415457057, DB=retail
执行标准SQL: SELECT s.store_name, ss.sales_amount, ss.date FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id;
执行预测SQL: SELECT s.store_name, ss.date, SUM(ss.sales_amount) AS sales_amount FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id GROUP BY s.store_id, ss.date
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 580/1042 个查询...
执行查询: ID=2711834209, DB=retail
执行标准SQL: SELECT p.product_name FROM products p JOIN orderdetails od ON p.product_id = od.product_id JOIN salesorders so ON od.order_id = so.order_id JOIN stores s ON so.store_id = s.store_id WHERE p.purchase_price > 4000 AND s.store_name = '未来城店';
执行预测SQL: SELECT p.product_name AS product_name
FROM products p
JOIN orderdetails od ON p.product_id = od.product_id
JOIN salesorders so ON od.order_id = so.order_id
JOIN stores s ON so.store_id = s.store_id
WHERE s.store_name LIKE '%未来城%'
AND p.purchase_price > 4000
标准SQL执行成功，行数: 815
预测SQL执行成功，行数: 815
执行查询: ID=1625040088, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-09' GROUP BY s.store_name, s.manager_name HAVING SUM(so.total_amount) > 10000;
执行预测SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales 
FROM salesorders so 
JOIN stores s ON so.store_id = s.store_id 
WHERE so.order_date = '2023-05-09' 
GROUP BY s.store_id 
HAVING SUM(so.total_amount) > 10000
标准SQL执行成功，行数: 618
预测SQL执行成功，行数: 623

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回618行, 预测SQL返回623行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name total_sales]
[35m预测SQL列:[0m [store_name manager_name total_sales]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 张娟 14317.11]
[35m预测[1]:[0m [智慧街店 陈春梅 13631.57]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [智能生活馆 张杨 17211.66]
[35m预测[2]:[0m [电子城旗舰店 唐燕 15322.22]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [智慧街店 朱丹丹 16768.43]
[35m预测[3]:[0m [创新路专卖店 王帅 13555.54]
执行查询: ID=3394370453, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-02' GROUP BY s.store_name, s.manager_name ORDER BY total_sales DESC LIMIT 1;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-02' GROUP BY s.store_id ORDER BY total_sales DESC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [total_sales store_name manager_name]
[35m预测SQL列:[0m [total_sales store_name manager_name]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [30667.37 未来城店 王娜]
[35m预测[1]:[0m [19987.33 创客空间店 何超]
执行查询: ID=1323956071, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-09' AND ss.sales_amount > 1000;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name 
FROM stores s 
WHERE s.store_id IN (
    SELECT store_id 
    FROM salesorders 
    WHERE order_date = '2023-05-09' 
    GROUP BY store_id 
    HAVING SUM(total_amount) > 1000
)
标准SQL执行成功，行数: 1097
预测SQL执行成功，行数: 1113

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1097行, 预测SQL返回1113行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name]
[35m预测SQL列:[0m [store_name manager_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 丁桂香]
[35m预测[1]:[0m [科技中心店 叶洋]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [创客空间店 王丹]
[35m预测[2]:[0m [创新路专卖店 郑建华]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [智能生活馆 杨娜]
[35m预测[3]:[0m [创新路专卖店 李婷婷]
执行查询: ID=3696477446, DB=retail
执行标准SQL: SELECT e.name AS employee_name, p.category_name AS product_category FROM salesorders s JOIN employees e ON s.employee_id = e.employee_id JOIN orderdetails od ON s.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE s.order_date >= '2023-05-01' AND s.order_date < '2023-06-01' AND s.total_amount > 10000 GROUP BY e.name, p.category_name;
执行预测SQL: SELECT e.name AS employee_name, p.category_name AS product_category
FROM salesorders s
JOIN employees e ON s.employee_id = e.employee_id
JOIN orderdetails od ON s.order_id = od.order_id
JOIN products p ON od.product_id = p.product_id
WHERE s.order_date BETWEEN '2023-05-01' AND '2023-05-31'
AND (SELECT SUM(od2.unit_price * od2.quantity) FROM orderdetails od2 WHERE od2.order_id = s.order_id) > 10000
标准SQL执行成功，行数: 5168
预测SQL执行成功，行数: 6857

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回5168行, 预测SQL返回6857行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_name product_category]
[35m预测SQL列:[0m [employee_name product_category]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [靳瑜 手机]
[35m预测[1]:[0m [安瑜 手机]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [戴敏 智能手表]
[35m预测[2]:[0m [张杨 智能手表]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [周红霞 智能手表]
[35m预测[3]:[0m [郭洁 手机]
执行查询: ID=4263762934, DB=retail
执行标准SQL: SELECT s.store_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id GROUP BY s.store_name;
执行预测SQL: SELECT s.store_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id GROUP BY s.store_name
执行查询: ID=1452830768, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, od.unit_price * od.quantity AS sales_amount, p.product_name FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON so.store_id = s.store_id JOIN products p ON od.product_id = p.product_id WHERE so.order_date >= '2023-05-01' AND so.order_date < '2023-06-01' AND p.supplier_name = '索尼官方旗舰店' AND od.unit_price * od.quantity > 10000;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4210000185, DB=retail
执行标准SQL: SELECT so.order_id, so.total_amount, od.product_id, od.quantity FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id WHERE so.total_amount > 5000;
执行预测SQL: SELECT s.order_id AS order_id, s.total_amount AS total_amount, od.product_id AS product_id, od.quantity AS quantity FROM salesorders s JOIN orderdetails od ON s.order_id = od.order_id WHERE s.total_amount > 5000
标准SQL执行成功，行数: 8215
预测SQL执行成功，行数: 8215
执行查询: ID=2309159488, DB=retail
执行标准SQL: SELECT p.product_name, ss.sales_amount FROM products p JOIN salesstatistics ss ON p.product_id = ss.product_id WHERE ss.date = '2023-05-02';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=3856696435, DB=retail
执行标准SQL: SELECT ss.sales_quantity, s.store_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-01' OR ss.date = '2023-05-06';
执行预测SQL: SELECT s.sales_quantity, st.store_name FROM salesstatistics s JOIN stores st ON s.store_id = st.store_id WHERE s.date BETWEEN '2023-05-01' AND '2023-05-31'
标准SQL执行成功，行数: 2264
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2264行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [sales_quantity store_name]
[35m预测SQL列:[0m [store_name sales_quantity]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [1 智能生活馆]
[35m预测[1]:[0m [智能生活馆 2]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [2 未来城店]
[35m预测[2]:[0m [智能生活馆 1]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [2 智慧街店]
[35m预测[3]:[0m [数字大道店 2]
已处理 590/1042 个查询...
执行查询: ID=3385775144, DB=retail
执行标准SQL: SELECT product_name, sale_price, purchase_price FROM products;
执行预测SQL: SELECT product_name AS product_name, sale_price AS sale_price, purchase_price AS purchase_price FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=898352649, DB=retail
执行标准SQL: SELECT s.store_name, SUM(ss.sales_quantity) AS total_sales_quantity FROM stores s JOIN salesstatistics ss ON s.store_id = ss.store_id JOIN products p ON ss.product_id = p.product_id WHERE p.category_name = '智能手表' AND p.supplier_name = '索尼官方旗舰店' AND ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' GROUP BY s.store_name HAVING SUM(ss.sales_quantity) > 10;
执行预测SQL: SELECT s.store_name, SUM(ss.sales_quantity) AS total_sales_quantity 
FROM salesstatistics ss 
JOIN products p ON ss.product_id = p.product_id 
JOIN stores s ON ss.store_id = s.store_id 
WHERE ss.date BETWEEN '2023-05-01' AND '2023-05-31' 
AND p.category_name = '智能手表' 
AND p.supplier_name = '索尼官方旗舰店' 
GROUP BY s.store_id 
HAVING SUM(ss.sales_quantity) > 10
标准SQL执行成功，行数: 9
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回9行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1057968799, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, AVG(so.total_amount) AS avg_order_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date >= '2023-05-01' AND so.order_date < '2023-06-01' GROUP BY s.store_name, s.manager_name HAVING AVG(so.total_amount) > 10000;
执行预测SQL: SELECT sub.store_id AS store_id, s.store_name, s.manager_name, sub.avg_order_amount 
FROM 
(SELECT store_id, AVG(total_amount) AS avg_order_amount 
 FROM salesorders 
 WHERE order_date BETWEEN '2023-05-01' AND '2023-05-31' 
 GROUP BY store_id 
 HAVING AVG(total_amount) > 10000) AS sub 
INNER JOIN stores s ON sub.store_id = s.store_id
标准SQL执行成功，行数: 5079
预测SQL执行成功，行数: 5523

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回5079行, 预测SQL返回5523行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name avg_order_amount]
[35m预测SQL列:[0m [store_id store_name manager_name avg_order_amount]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [数字大道店 祝平 13535.97]
[35m预测[1]:[0m [79f1a79c-d16b-48b4-88a4-97cae64507ab 智能生活馆 陆超 11391.6]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [智能生活馆 鞠云 11700.68]
[35m预测[2]:[0m [90eae933-1940-4d78-9a91-a555de6dfe51 智能生活馆 陈成 14329.94]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [创新路专卖店 刘宁 16140.61]
[35m预测[3]:[0m [95eead28-167c-4b82-8c1d-b7e537f2968f 数字大道店 张兰英 16957.46]
执行查询: ID=1042797521, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, p.product_name, ss.sales_quantity, ss.sales_amount, ss.profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-02' AND p.product_name = 'iPad Air';
执行预测SQL: SELECT 
    s.store_name AS store_name,
    e.name AS employee_name,
    p.product_name AS product_name,
    ss.sales_quantity AS sales_quantity,
    ss.sales_amount AS sales_amount,
    ss.profit AS profit
FROM 
    salesstatistics ss
JOIN 
    stores s ON ss.store_id = s.store_id
JOIN 
    employees e ON ss.employee_id = e.employee_id
JOIN 
    products p ON ss.product_id = p.product_id
WHERE 
    ss.date = '2023-05-02'
    AND p.product_name = 'iPad Air'
标准SQL执行成功，行数: 112
预测SQL执行成功，行数: 112
执行查询: ID=2349214824, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'iPhone 13' AND ss.date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_name, e.name;
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=1437353225, DB=retail
执行标准SQL: SELECT s.store_name, SUM(ss.sales_quantity) AS total_sales_quantity, SUM(ss.sales_amount) AS total_sales_amount FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' GROUP BY s.store_name ORDER BY total_sales_quantity DESC LIMIT 1;
执行预测SQL: SELECT stores.store_name, SUM(orderdetails.quantity) AS total_sales_quantity, SUM(orderdetails.quantity * orderdetails.unit_price) AS total_sales_amount
FROM salesorders
JOIN orderdetails ON salesorders.order_id = orderdetails.order_id
JOIN stores ON salesorders.store_id = stores.store_id
WHERE salesorders.order_date BETWEEN '2023-05-01' AND '2023-05-31'
GROUP BY stores.store_id, stores.store_name
ORDER BY total_sales_quantity DESC
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [total_sales_amount store_name total_sales_quantity]
[35m预测SQL列:[0m [total_sales_amount store_name total_sales_quantity]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [1.161100751e+07 创客空间店 1556]
[35m预测[1]:[0m [17933.58 创客空间店 2]
执行查询: ID=2159290753, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(so.total_amount) AS total_sales_amount FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON e.store_id = s.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'Apple Watch Series 7' AND so.order_date = '2023-05-09' GROUP BY s.store_name, e.name;
执行预测SQL: SELECT s.store_name AS store_name, e.name AS employee_name, SUM(so.total_amount) AS total_sales_amount 
FROM salesorders so 
JOIN employees e ON so.employee_id = e.employee_id 
JOIN stores s ON so.store_id = s.store_id 
WHERE so.order_date = '2023-05-09' 
AND so.order_id IN (
    SELECT DISTINCT od.order_id 
    FROM orderdetails od 
    JOIN products p ON od.product_id = p.product_id 
    WHERE p.product_name = 'Apple Watch Series 7'
) 
GROUP BY s.store_id, e.employee_id, s.store_name, e.name
标准SQL执行成功，行数: 122
预测SQL执行成功，行数: 122
执行查询: ID=3028653636, DB=retail
执行标准SQL: SELECT quantity, unit_price FROM orderdetails;
执行预测SQL: SELECT quantity AS sales_quantity, unit_price AS unit_price FROM orderdetails
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=699540097, DB=retail
执行标准SQL: SELECT DISTINCT s.store_name, e.name AS employee_name, e.position FROM stores s JOIN employees e ON s.store_id = e.store_id JOIN salesstatistics ss ON e.employee_id = ss.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'Nintendo Switch' AND ss.date >= '2023-05-01' AND ss.date <= '2023-05-31';
执行预测SQL: SELECT DISTINCT s.store_name AS store_name, e.name AS employee_name, e.position AS position 
FROM orderdetails od 
JOIN salesorders so ON od.order_id = so.order_id 
JOIN stores s ON so.store_id = s.store_id 
JOIN employees e ON so.employee_id = e.employee_id 
JOIN products p ON od.product_id = p.product_id 
WHERE p.product_name = 'Nintendo Switch' 
AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31'
标准SQL执行成功，行数: 1021
预测SQL执行成功，行数: 1021
执行查询: ID=1931659377, DB=retail
执行标准SQL: SELECT * FROM salesstatistics WHERE sales_quantity > 1;
执行预测SQL: SELECT statistic_id AS statistic_id, store_id AS store_id, product_id AS product_id, employee_id AS employee_id, date AS date, sales_quantity AS sales_quantity, sales_amount AS sales_amount, profit AS profit FROM salesstatistics WHERE sales_quantity > 1
标准SQL执行成功，行数: 4902
预测SQL执行成功，行数: 4902
已处理 600/1042 个查询...
执行查询: ID=3746361325, DB=retail
执行标准SQL: SELECT s.store_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'Nintendo Switch' AND ss.date >= '2023-05-01' AND ss.date < '2023-06-01' GROUP BY s.store_name;
执行预测SQL: SELECT s.store_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'Nintendo Switch' AND ss.date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_name
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10
执行查询: ID=716876897, DB=retail
执行标准SQL: SELECT so.order_date, SUM(so.total_amount) AS total_sales FROM salesorders so GROUP BY so.order_date;
执行预测SQL: SELECT order_date, total_amount AS total_sales FROM salesorders
标准SQL执行成功，行数: 9
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回9行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [order_date total_sales]
[35m预测SQL列:[0m [order_date total_sales]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [2023-05-01 00:00:00 +0000 +0000 1.193330312e+07]
[35m预测[1]:[0m [2023-05-02 00:00:00 +0000 +0000 11391.6]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [2023-05-05 00:00:00 +0000 +0000 1.206154854e+07]
[35m预测[2]:[0m [2023-05-06 00:00:00 +0000 +0000 14329.94]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [2023-05-07 00:00:00 +0000 +0000 1.235167119e+07]
[35m预测[3]:[0m [2023-05-04 00:00:00 +0000 +0000 16957.46]
执行查询: ID=2607128675, DB=retail
执行标准SQL: SELECT st.store_name, SUM(so.total_amount) AS total_sales, COUNT(so.order_id) AS total_orders FROM salesorders so JOIN stores st ON so.store_id = st.store_id GROUP BY st.store_name;
执行预测SQL: SELECT s.store_name, SUM(so.total_amount) AS total_sales, COUNT(so.order_id) AS total_orders FROM salesorders so JOIN stores s ON so.store_id = s.store_id GROUP BY s.store_id, s.store_name
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [total_sales total_orders store_name]
[35m预测SQL列:[0m [total_sales total_orders store_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [1.152176211e+07 1049 创客空间店]
[35m预测[1]:[0m [14316.45 1 创客空间店]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [1.076418508e+07 1004 数码广场店]
[35m预测[2]:[0m [6705.12 1 智慧街店]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [1.106667016e+07 1031 电子城旗舰店]
[35m预测[3]:[0m [19634.73 1 创客空间店]
执行查询: ID=285217611, DB=retail
执行标准SQL: SELECT * FROM orderdetails WHERE quantity = 2;
执行预测SQL: SELECT order_detail_id AS order_detail_id, order_id AS order_id, product_id AS product_id, quantity AS quantity, unit_price AS unit_price FROM orderdetails WHERE quantity = 2
标准SQL执行成功，行数: 4969
预测SQL执行成功，行数: 4969
执行查询: ID=780164755, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, e.position FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = '戴尔灵越15' AND ss.date = '2023-05-01';
执行预测SQL: SELECT stores.store_name AS store_name, employees.name AS employee_name, employees.position AS position FROM salesorders JOIN employees ON salesorders.employee_id = employees.employee_id JOIN stores ON salesorders.store_id = stores.store_id JOIN orderdetails ON salesorders.order_id = orderdetails.order_id JOIN products ON orderdetails.product_id = products.product_id WHERE products.product_name = '戴尔灵越15' AND salesorders.order_date = '2023-05-01'
标准SQL执行成功，行数: 114
预测SQL执行成功，行数: 97

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回114行, 预测SQL返回97行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name employee_name position]
[35m预测SQL列:[0m [store_name employee_name position]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [电子城旗舰店 曾桂芳 技术支持]
[35m预测[1]:[0m [智能生活馆 刘亮 销售顾问]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [智慧街店 王想 销售顾问]
[35m预测[2]:[0m [科技中心店 隆桂芝 客户服务]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [科技园店 李玉珍 销售顾问]
[35m预测[3]:[0m [智能生活馆 兰雪梅 客户服务]
执行查询: ID=936656745, DB=retail
执行标准SQL: SELECT e.name, e.position, st.store_name FROM employees e JOIN stores st ON e.store_id = st.store_id;
执行预测SQL: SELECT employees.name AS name, employees.position AS position, stores.store_name AS store_name FROM employees INNER JOIN stores ON employees.store_id = stores.store_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1245782625, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = '佳能EOS R6' AND ss.date = '2023-05-03' GROUP BY s.store_name, e.name;
执行预测SQL: SELECT 
    s.store_name AS store_name,
    e.name AS employee_name,
    SUM((p.sale_price - p.purchase_price) * od.quantity) AS total_profit
FROM 
    orderdetails od
JOIN 
    salesorders so ON od.order_id = so.order_id
JOIN 
    employees e ON so.employee_id = e.employee_id
JOIN 
    stores s ON so.store_id = s.store_id
JOIN 
    products p ON od.product_id = p.product_id
WHERE 
    p.product_name = '佳能EOS R6'
    AND so.order_date = '2023-05-03'
GROUP BY 
    s.store_id, e.employee_id, s.store_name, e.name
标准SQL执行成功，行数: 106
预测SQL执行成功，行数: 107

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回106行, 预测SQL返回107行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name employee_name total_profit]
[35m预测SQL列:[0m [employee_name total_profit store_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 孙勇 4574.8]
[35m预测[1]:[0m [李秀珍 -6153.59 电子城旗舰店]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [创客空间店 徐畅 1701.09]
[35m预测[2]:[0m [马红 -2643.15 创新路专卖店]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [创客空间店 李莹 2200.63]
[35m预测[3]:[0m [刘敏 -1321.92 电子城旗舰店]
执行查询: ID=1283619082, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'iPhone 13' AND ss.date = '2023-05-05' GROUP BY s.store_name, e.name;
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=1656453304, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, ss.sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-06' AND p.product_name = '华为Mate 40 Pro' AND ss.sales_quantity > 1;
执行预测SQL: SELECT s.store_name AS store_name, e.name AS employee_name, ss.sales_quantity AS sales_quantity 
FROM salesstatistics ss 
JOIN stores s ON ss.store_id = s.store_id 
JOIN employees e ON ss.employee_id = e.employee_id 
JOIN products p ON ss.product_id = p.product_id 
WHERE ss.date = '2023-05-06' 
AND p.product_name = '华为Mate 40 Pro' 
AND ss.sales_quantity > 1
标准SQL执行成功，行数: 55
预测SQL执行成功，行数: 55
执行查询: ID=366199293, DB=retail
执行标准SQL: SELECT od.order_detail_id, p.product_name, od.quantity FROM orderdetails od JOIN products p ON od.product_id = p.product_id;
执行预测SQL: SELECT orderdetails.order_detail_id AS order_detail_id, products.product_name AS product_name, orderdetails.quantity AS quantity FROM orderdetails JOIN products ON orderdetails.product_id = products.product_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 610/1042 个查询...
执行查询: ID=3334478107, DB=retail
执行标准SQL: SELECT e.name, e.position, s.phone FROM employees e JOIN stores s ON e.store_id = s.store_id;
执行预测SQL: SELECT employees.name AS name, employees.position AS position, stores.phone AS phone FROM employees JOIN stores ON employees.store_id = stores.store_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=4270219527, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, od.quantity FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON so.store_id = s.store_id JOIN products p ON od.product_id = p.product_id WHERE so.order_date = '2023-05-05' AND p.product_name = '戴尔灵越15' AND od.quantity > 1;
执行预测SQL: SELECT s.store_name AS store_name, e.name AS employee_name, SUM(od.quantity) AS quantity 
FROM salesorders so 
JOIN orderdetails od ON so.order_id = od.order_id 
JOIN products p ON od.product_id = p.product_id 
JOIN employees e ON so.employee_id = e.employee_id 
JOIN stores s ON so.store_id = s.store_id 
WHERE so.order_date = '2023-05-05' 
AND p.product_name = '戴尔灵越15' 
GROUP BY s.store_name, e.name 
HAVING SUM(od.quantity) > 1
标准SQL执行成功，行数: 44
预测SQL执行成功，行数: 44
执行查询: ID=1514093143, DB=retail
执行标准SQL: SELECT so.order_id, so.total_amount, od.product_id, od.quantity FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id WHERE so.total_amount > 5000;
执行预测SQL: SELECT s.order_id AS order_id, s.total_amount AS total_amount, od.product_id AS product_id, od.quantity AS quantity FROM salesorders s JOIN orderdetails od ON s.order_id = od.order_id WHERE s.total_amount > 5000
标准SQL执行成功，行数: 8215
预测SQL执行成功，行数: 8215
执行查询: ID=2669644548, DB=retail
执行标准SQL: SELECT e.name, so.order_id, so.total_amount FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id;
执行预测SQL: SELECT e.name AS employee_name, s.order_id, s.total_amount FROM employees e JOIN salesorders s ON e.employee_id = s.employee_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=805828737, DB=retail
执行标准SQL: SELECT ss.statistic_id, ss.date FROM salesstatistics ss WHERE ss.profit > 3000;
执行预测SQL: SELECT statistic_id AS statistic_id, date AS sales_date FROM salesstatistics WHERE profit > 3000
标准SQL执行成功，行数: 4272
预测SQL执行成功，行数: 4272
执行查询: ID=3997676800, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'Apple Watch Series 7' AND so.order_date = '2023-05-01' AND so.total_amount > 7000;
执行预测SQL: SELECT s.store_name AS store_name, e.name AS employee_name, so.total_amount AS total_amount FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id WHERE p.product_name = 'Apple Watch Series 7' AND so.order_date = '2023-05-01' AND so.total_amount > 7000
标准SQL执行成功，行数: 83
预测SQL执行成功，行数: 83
执行查询: ID=4161491201, DB=retail
执行标准SQL: SELECT p.product_name, p.remaining_quantity, p.category_name FROM products p;
执行预测SQL: SELECT product_name AS product_name, remaining_quantity AS remaining_quantity, category_name AS category_name FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1127435173, DB=retail
执行标准SQL: SELECT e.employee_id, e.name, e.position FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.order_date = '2023-05-07' AND p.category_name = '相机' AND so.total_amount > 15000;
执行预测SQL: SELECT DISTINCT s.employee_id AS employee_id, e.name AS name, e.position AS position 
FROM salesorders s 
JOIN employees e ON s.employee_id = e.employee_id 
WHERE s.order_id IN (
    SELECT DISTINCT od.order_id 
    FROM salesorders s 
    JOIN orderdetails od ON s.order_id = od.order_id 
    JOIN products p ON od.product_id = p.product_id 
    WHERE s.order_date = '2023-05-07' 
    AND p.category_name = '相机' 
    AND s.total_amount > 15000
)
标准SQL执行成功，行数: 31
预测SQL执行成功，行数: 31
执行查询: ID=2902593996, DB=retail
执行标准SQL: SELECT s.store_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id WHERE p.product_name = 'iPhone 13' AND ss.date = '2023-05-03' GROUP BY s.store_name;
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=3388599532, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-08' GROUP BY s.store_id ORDER BY total_sales DESC LIMIT 1;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name, SUM(so.total_amount) AS total_sales 
FROM salesorders so 
JOIN stores s ON so.store_id = s.store_id 
WHERE so.order_date = '2023-05-08' 
GROUP BY s.store_id, s.store_name, s.manager_name 
ORDER BY total_sales DESC 
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
已处理 620/1042 个查询...
执行查询: ID=4098005311, DB=retail
执行标准SQL: SELECT e.name AS employee_name, ss.sales_quantity, ss.sales_amount FROM salesstatistics ss JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-03' AND s.store_name = '数字大道店' AND p.product_name = 'Nintendo Switch';
执行预测SQL: SELECT e.name AS employee_name, SUM(od.quantity) AS sales_quantity, SUM(od.quantity * od.unit_price) AS sales_amount 
FROM salesorders s 
JOIN orderdetails od ON s.order_id = od.order_id 
JOIN products p ON od.product_id = p.product_id 
JOIN employees e ON s.employee_id = e.employee_id 
JOIN stores st ON s.store_id = st.store_id 
WHERE st.store_name = '数字大道店' 
AND p.product_name = 'Nintendo Switch' 
AND s.order_date = '2023-05-03' 
GROUP BY e.name
标准SQL执行成功，行数: 9
预测SQL执行成功，行数: 11

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回9行, 预测SQL返回11行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [sales_amount employee_name sales_quantity]
[35m预测SQL列:[0m [employee_name sales_quantity sales_amount]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [14175.89 田凤兰 2]
[35m预测[1]:[0m [何建 2 28565.64]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [17290.71 马建 2]
[35m预测[2]:[0m [刘飞 2 38218.86]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [19324.54 宋利 2]
[35m预测[3]:[0m [岳晨 2 11571.1]
执行查询: ID=923028298, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id WHERE ss.date = '2023-05-05' AND p.product_name = '戴森V11' AND ss.profit > 500;
执行预测SQL: SELECT s.store_name AS store_name, e.name AS employee_name
FROM salesstatistics ss
JOIN stores s ON ss.store_id = s.store_id
JOIN employees e ON ss.employee_id = e.employee_id
WHERE ss.product_id IN (
    SELECT product_id 
    FROM products 
    WHERE product_name = '戴森V11'
)
AND ss.date = '2023-05-05'
AND ss.profit > 500
标准SQL执行成功，行数: 96
预测SQL执行成功，行数: 96
执行查询: ID=1361891626, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-09' AND ss.sales_amount > 2000;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name 
FROM salesstatistics ss 
JOIN stores s ON ss.store_id = s.store_id 
WHERE ss.date = '2023-05-09' 
GROUP BY ss.store_id, s.store_name, s.manager_name 
HAVING SUM(ss.sales_amount) > 2000
标准SQL执行成功，行数: 1089
预测SQL执行成功，行数: 1089
执行查询: ID=1630147030, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name FROM stores s JOIN salesorders so ON s.store_id = so.store_id WHERE so.order_date = '2023-05-01' AND so.total_amount > 10000;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name FROM stores s JOIN (SELECT store_id, SUM(total_amount) AS total_sales FROM salesorders WHERE order_date = '2023-05-01' GROUP BY store_id HAVING SUM(total_amount) > 10000) so ON s.store_id = so.store_id
标准SQL执行成功，行数: 607
预测SQL执行成功，行数: 607
执行查询: ID=3263175989, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, e.name AS employee_name FROM salesstatistics ss JOIN employees e ON ss.employee_id = e.employee_id JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-09' AND p.product_name = 'iPhone 13';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=378330460, DB=retail
执行标准SQL: SELECT sales_amount, remaining_quantity FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id WHERE p.product_id = '81bfd69e-1240-48bf-a302-313c0255a1c9';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=4052285642, DB=retail
执行标准SQL: SELECT s.store_name, s.address, s.phone FROM stores s;
执行预测SQL: SELECT store_name AS store_name, address AS address, phone AS phone FROM stores
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1549729846, DB=retail
执行标准SQL: SELECT s.store_name, e.name, so.total_amount FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-02' AND so.total_amount > 2000;
执行预测SQL: SELECT s.store_name AS store_name, e.name AS name, so.total_amount AS total_amount 
FROM salesorders so 
JOIN employees e ON so.employee_id = e.employee_id 
JOIN stores s ON so.store_id = s.store_id 
WHERE so.order_date = '2023-05-02' AND so.total_amount > 2000
标准SQL执行成功，行数: 1088
预测SQL执行成功，行数: 1088
执行查询: ID=3935894550, DB=retail
执行标准SQL: SELECT store_id, SUM(sales_quantity) AS total_sales_quantity, SUM(profit) AS total_profit FROM salesstatistics GROUP BY store_id;
执行预测SQL: SELECT store_id, SUM(sales_quantity) AS total_sales_quantity, SUM(profit) AS total_profit FROM salesstatistics GROUP BY store_id
执行查询: ID=3331362186, DB=retail
执行标准SQL: SELECT s.store_name, st.profit, s.manager_name FROM salesstatistics st JOIN stores s ON st.store_id = s.store_id WHERE st.date = '2023-05-07' AND st.profit > 1000;
执行预测SQL: SELECT s.store_name AS store_name, ss.profit AS profit, s.manager_name AS manager_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-07' AND ss.profit > 1000
标准SQL执行成功，行数: 901
预测SQL执行成功，行数: 901
已处理 630/1042 个查询...
执行查询: ID=1128623969, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, ss.sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-08' ORDER BY ss.sales_quantity DESC LIMIT 1;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name, ss.sales_quantity AS sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-08' ORDER BY ss.sales_quantity DESC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=2501471268, DB=retail
执行标准SQL: SELECT ss.store_id, SUM(ss.profit) AS total_profit FROM salesstatistics ss WHERE ss.date = '2023-05-09' GROUP BY ss.store_id ORDER BY total_profit DESC LIMIT 1;
执行预测SQL: SELECT so.store_id, SUM(od.quantity * (p.sale_price - p.purchase_price)) AS total_profit FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.order_date = '2023-05-09' GROUP BY so.store_id ORDER BY total_profit DESC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_id total_profit]
[35m预测SQL列:[0m [store_id total_profit]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [bceea123-d14b-4271-a969-962ec25f6a06 4986.74]
[35m预测[1]:[0m [1c4263b7-a1c8-4aa9-894c-7f28db6e8aab 36454.64]
执行查询: ID=1462073315, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(od.quantity * od.unit_price) AS total_sales FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id WHERE p.product_name = '佳能EOS R6' AND so.order_date >= '2023-05-01' AND so.order_date < '2023-06-01' GROUP BY s.store_name, e.name HAVING SUM(od.quantity * od.unit_price) > 5000;
执行预测SQL: SELECT 
    s.store_name AS store_name,
    e.name AS employee_name,
    so.total_amount AS total_sales
FROM 
    salesorders so
JOIN 
    stores s ON so.store_id = s.store_id
JOIN 
    employees e ON so.employee_id = e.employee_id
JOIN 
    orderdetails od ON so.order_id = od.order_id
JOIN 
    products p ON od.product_id = p.product_id
WHERE 
    p.product_name = '佳能EOS R6'
    AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31'
    AND so.total_amount > 5000
标准SQL执行成功，行数: 911
预测SQL执行成功，行数: 832

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回911行, 预测SQL返回832行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name employee_name total_sales]
[35m预测SQL列:[0m [employee_name total_sales store_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创新路专卖店 王军 23748.51]
[35m预测[1]:[0m [郭洁 11673.71 未来城店]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [科技园店 周帆 19695.69]
[35m预测[2]:[0m [徐畅 12793.54 创客空间店]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [科技中心店 孙桂花 13777.5]
[35m预测[3]:[0m [张璐 16739.42 数字大道店]
执行查询: ID=1581647710, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, e.position FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'iPad Air' AND ss.date >= '2023-05-01' AND ss.date <= '2023-05-31';
执行预测SQL: SELECT s.store_name AS store_name, e.name AS employee_name, e.position AS position FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id WHERE p.product_name = 'iPad Air' AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31'
标准SQL执行成功，行数: 1033
预测SQL执行成功，行数: 1033
执行查询: ID=801232665, DB=retail
执行标准SQL: SELECT category_name, sale_price FROM products;
执行预测SQL: SELECT category_name AS category_name, sale_price AS sale_price FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=456965504, DB=retail
执行标准SQL: SELECT s.store_name, COUNT(e.employee_id) AS sales_manager_count FROM stores s JOIN salesstatistics ss ON s.store_id = ss.store_id JOIN employees e ON s.store_id = e.store_id WHERE ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' AND ss.sales_amount > 10000 AND e.position = '销售经理' GROUP BY s.store_name;
执行预测SQL: SELECT s.store_name, COUNT(e.employee_id) AS sales_manager_count 
FROM stores s 
JOIN employees e ON s.store_id = e.store_id 
WHERE e.position = '销售经理' 
AND s.store_id IN (
    SELECT store_id 
    FROM salesorders 
    WHERE order_date BETWEEN '2023-05-01' AND '2023-05-31' 
    GROUP BY store_id 
    HAVING SUM(total_amount) > 10000
) 
GROUP BY s.store_name
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name sales_manager_count]
[35m预测SQL列:[0m [store_name sales_manager_count]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 141]
[35m预测[1]:[0m [创客空间店 127]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [电子城旗舰店 127]
[35m预测[2]:[0m [电子城旗舰店 110]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [数码广场店 100]
[35m预测[3]:[0m [数码广场店 123]
执行查询: ID=3382493010, DB=retail
执行标准SQL: SELECT p.product_name, p.remaining_quantity, SUM(od.quantity) AS sold_quantity FROM products p LEFT JOIN orderdetails od ON p.product_id = od.product_id GROUP BY p.product_name, p.remaining_quantity;
执行预测SQL: SELECT products.product_name, products.remaining_quantity, SUM(salesstatistics.sales_quantity) AS sold_quantity FROM products LEFT JOIN salesstatistics ON products.product_id = salesstatistics.product_id GROUP BY products.product_id, products.product_name, products.remaining_quantity
标准SQL执行成功，行数: 8905
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回8905行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [remaining_quantity sold_quantity product_name]
[35m预测SQL列:[0m [product_name remaining_quantity sold_quantity]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [49.2 3 佳能EOS R6]
[35m预测[1]:[0m [iPhone 13 19.32 2]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [41.39 1 佳能EOS R6]
[35m预测[2]:[0m [佳能EOS R6 24.64 1]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [39.94 2 佳能EOS R6]
[35m预测[3]:[0m [华为Mate 40 Pro 23.97 1]
执行查询: ID=571189478, DB=retail
执行标准SQL: SELECT so.order_id, so.order_date, so.total_amount FROM salesorders so;
执行预测SQL: SELECT order_id AS order_id, order_date AS order_date, total_amount AS total_amount FROM salesorders
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3197967117, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, p.product_name, ss.sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-06' AND p.product_name = '华为Mate 40 Pro' AND ss.sales_quantity > 1;
执行预测SQL: SELECT 
    s.store_name AS store_name,
    e.name AS employee_name,
    p.product_name AS product_name,
    ss.sales_quantity AS sales_quantity
FROM 
    salesstatistics ss
JOIN 
    stores s ON ss.store_id = s.store_id
JOIN 
    employees e ON ss.employee_id = e.employee_id
JOIN 
    products p ON ss.product_id = p.product_id
WHERE 
    ss.date::date = '2023-05-06' 
    AND ss.sales_quantity > 1
    AND p.product_name = '华为Mate 40 Pro'
标准SQL执行成功，行数: 55
预测SQL执行成功，行数: 55
执行查询: ID=426781097, DB=retail
执行标准SQL: SELECT s.store_name, e.name, e.position FROM stores s JOIN employees e ON s.store_id = e.store_id;
执行预测SQL: SELECT stores.store_name AS store_name, employees.name AS employee_name, employees.position AS job_title FROM employees JOIN stores ON employees.store_id = stores.store_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 640/1042 个查询...
执行查询: ID=3095201302, DB=retail
执行标准SQL: SELECT e.name AS employee_name, SUM(od.quantity * od.unit_price) AS total_sales_amount FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-01' AND s.store_name = '创客空间店' AND p.product_name = '华为Mate 40 Pro' GROUP BY e.name;
执行预测SQL: SELECT e.name AS employee_name, SUM(od.quantity * od.unit_price) AS total_sales_amount FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores st ON so.store_id = st.store_id WHERE st.store_name = '创客空间店' AND p.product_name = '华为Mate 40 Pro' AND so.order_date = '2023-05-01' GROUP BY e.name
标准SQL执行成功，行数: 12
预测SQL执行成功，行数: 12
执行查询: ID=3814813462, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, e.position FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = '戴森V11' AND ss.date >= '2023-05-01' AND ss.date <= '2023-05-31';
执行预测SQL: SELECT DISTINCT s.store_name AS store_name, e.name AS employee_name, e.position AS position FROM orderdetails od JOIN salesorders so ON od.order_id = so.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id WHERE p.product_name = '戴森V11' AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31'
标准SQL执行成功，行数: 985
预测SQL执行成功，行数: 984

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回985行, 预测SQL返回984行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name employee_name position]
[35m预测SQL列:[0m [store_name employee_name position]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [智能生活馆 胡海燕 技术支持]
[35m预测[1]:[0m [科技园店 陈晶 技术支持]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [电子城旗舰店 李秀梅 技术支持]
[35m预测[2]:[0m [未来城店 杨彬 客户服务]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [数字大道店 龚勇 技术支持]
[35m预测[3]:[0m [智能生活馆 卢玉梅 客户服务]
执行查询: ID=609043667, DB=retail
执行标准SQL: SELECT od.order_detail_id, p.product_name, od.quantity FROM orderdetails od JOIN products p ON od.product_id = p.product_id;
执行预测SQL: SELECT orderdetails.order_detail_id AS order_detail_id, products.product_name AS product_name, orderdetails.quantity AS quantity FROM orderdetails INNER JOIN products ON orderdetails.product_id = products.product_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1259543351, DB=retail
执行标准SQL: SELECT DISTINCT e.employee_id, e.name FROM employees e JOIN salesstatistics s ON e.employee_id = s.employee_id JOIN products p ON s.product_id = p.product_id WHERE s.date = '2023-05-06' AND s.sales_quantity > 1 AND p.supplier_name = '戴尔官方旗舰店';
执行预测SQL: SELECT DISTINCT s.employee_id AS employee_id, e.name AS name 
FROM salesstatistics s 
JOIN employees e ON s.employee_id = e.employee_id 
JOIN products p ON s.product_id = p.product_id 
WHERE s.date = '2023-05-06' 
AND s.sales_quantity > 1 
AND p.supplier_name = '戴尔官方旗舰店'
标准SQL执行成功，行数: 62
预测SQL执行成功，行数: 62
执行查询: ID=3115466033, DB=retail
执行标准SQL: SELECT product_name, sale_price FROM products;
执行预测SQL: SELECT product_name AS product_name, sale_price AS sale_price FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1445435683, DB=retail
执行标准SQL: SELECT manager_name, phone FROM stores;
执行预测SQL: SELECT manager_name AS store_manager, phone AS contact_phone FROM stores
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1024575513, DB=retail
执行标准SQL: SELECT so.total_amount, st.store_name FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id JOIN stores st ON so.store_id = st.store_id WHERE e.name = '范莹' AND so.order_date = '2023-05-07';
执行预测SQL: SELECT s.total_amount AS total_amount, st.store_name AS store_name FROM salesorders s JOIN employees e ON s.employee_id = e.employee_id JOIN stores st ON s.store_id = st.store_id WHERE e.name = '范莹' AND s.order_date = '2023-05-07'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=1356118157, DB=retail
执行标准SQL: SELECT s.store_name, SUM(so.total_amount) AS total_sales FROM stores s JOIN salesorders so ON s.store_id = so.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'Apple Watch Series 7' AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_name HAVING SUM(so.total_amount) > 10000;
执行预测SQL: SELECT s.store_name AS store_name, SUM(od.quantity * od.unit_price) AS total_sales 
FROM orderdetails od 
JOIN products p ON od.product_id = p.product_id 
JOIN salesorders so ON od.order_id = so.order_id 
JOIN stores s ON so.store_id = s.store_id 
WHERE p.product_name = 'Apple Watch Series 7' 
AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31' 
GROUP BY s.store_id 
HAVING SUM(od.quantity * od.unit_price) > 10000
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 675

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回675行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name total_sales]
[35m预测SQL列:[0m [store_name total_sales]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 1.02777831e+06]
[35m预测[1]:[0m [创客空间店 20460.94]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [电子城旗舰店 995821.57]
[35m预测[2]:[0m [智慧街店 33425.18]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [数码广场店 1.07613719e+06]
[35m预测[3]:[0m [科技园店 12002.78]
执行查询: ID=2779355161, DB=retail
执行标准SQL: SELECT s.store_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_name;
执行预测SQL: SELECT s.store_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_id, s.store_name
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name total_sales]
[35m预测SQL列:[0m [total_sales store_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 1.152176211e+07]
[35m预测[1]:[0m [14316.45 创客空间店]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [数码广场店 1.076418508e+07]
[35m预测[2]:[0m [6705.12 智慧街店]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [电子城旗舰店 1.106667016e+07]
[35m预测[3]:[0m [19634.73 创客空间店]
执行查询: ID=3800488480, DB=retail
执行标准SQL: SELECT store_name, manager_name FROM stores;
执行预测SQL: SELECT store_name AS store_name, manager_name AS manager_name FROM stores
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 650/1042 个查询...
执行查询: ID=52927163, DB=retail
执行标准SQL: SELECT p.product_name, p.sale_price, p.remaining_quantity FROM products p;
执行预测SQL: SELECT product_name AS product_name, sale_price AS sale_price, remaining_quantity AS remaining_quantity FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=4140737645, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(so.total_amount) AS total_sales_amount FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON so.store_id = s.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'iPhone 13' AND so.order_date = '2023-05-01' GROUP BY s.store_name, e.name;
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=3812947992, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '索尼WH-1000XM4' AND so.order_date = '2023-05-08' AND so.total_amount > 15000;
执行预测SQL: SELECT DISTINCT stores.store_name AS store_name, employees.name AS employee_name, salesorders.total_amount AS total_amount FROM salesorders JOIN employees ON salesorders.employee_id = employees.employee_id JOIN stores ON salesorders.store_id = stores.store_id JOIN orderdetails ON salesorders.order_id = orderdetails.order_id JOIN products ON orderdetails.product_id = products.product_id WHERE salesorders.order_date = '2023-05-08' AND products.product_name = '索尼WH-1000XM4耳机' AND salesorders.total_amount > 15000
标准SQL执行成功，行数: 32
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回32行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=2237439168, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, MAX(ss.sales_quantity) AS max_sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-09' GROUP BY s.store_name, s.manager_name ORDER BY max_sales_quantity DESC LIMIT 1;
执行预测SQL: SELECT s.store_name, s.manager_name, s2.total_sales_quantity AS max_sales_quantity 
FROM stores s 
JOIN (
    SELECT so.store_id, SUM(od.quantity) AS total_sales_quantity 
    FROM salesorders so 
    JOIN orderdetails od ON so.order_id = od.order_id 
    WHERE so.order_date = '2023-05-09' 
    GROUP BY so.store_id 
    ORDER BY total_sales_quantity DESC 
    LIMIT 1
) s2 
ON s.store_id = s2.store_id
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name max_sales_quantity]
[35m预测SQL列:[0m [store_name manager_name max_sales_quantity]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [数码广场店 杨峰 2]
[35m预测[1]:[0m [科技园店 王燕 2]
执行查询: ID=3083869006, DB=retail
执行标准SQL: SELECT SUM(profit) AS total_profit FROM salesstatistics;
执行预测SQL: SELECT SUM(profit) AS total_profit FROM salesstatistics
执行查询: ID=106112262, DB=retail
执行标准SQL: SELECT so.order_id, s.store_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.employee_id = 'a4fddd73-a996-4afc-b014-4daf6a9c778a';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=886303610, DB=retail
执行标准SQL: SELECT s.store_name, SUM(ss.sales_quantity) AS total_sales_quantity FROM employees e JOIN salesstatistics ss ON e.employee_id = ss.employee_id JOIN stores s ON e.store_id = s.store_id WHERE e.name = '黄萍' AND ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' GROUP BY s.store_name ORDER BY total_sales_quantity DESC LIMIT 1;
执行预测SQL: SELECT s.store_name AS store_name, SUM(od.quantity) AS total_sales_quantity FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN stores s ON so.store_id = s.store_id WHERE so.employee_id IN (SELECT employee_id FROM employees WHERE name = '黄萍') AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_name ORDER BY total_sales_quantity DESC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name total_sales_quantity]
[35m预测SQL列:[0m [total_sales_quantity store_name]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [未来城店 3]
[35m预测[1]:[0m [2 创新路专卖店]
执行查询: ID=1529918379, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, ss.profit FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'Nintendo Switch' AND ss.date = '2023-05-08';
执行预测SQL: SELECT DISTINCT st.store_name AS store_name, e.name AS employee_name, ss.profit AS profit FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores st ON ss.store_id = st.store_id JOIN employees e ON ss.employee_id = e.employee_id WHERE ss.date = '2023-05-08' AND p.product_name = 'Nintendo Switch'
标准SQL执行成功，行数: 109
预测SQL执行成功，行数: 109
执行查询: ID=3470071233, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '索尼WH-1000XM4' AND so.order_date = '2023-05-05';
执行预测SQL: SELECT 
    stores.store_name AS store_name,
    employees.name AS employee_name,
    salesorders.total_amount AS total_amount
FROM 
    salesorders
JOIN 
    orderdetails ON salesorders.order_id = orderdetails.order_id
JOIN 
    products ON orderdetails.product_id = products.product_id
JOIN 
    stores ON salesorders.store_id = stores.store_id
JOIN 
    employees ON salesorders.employee_id = employees.employee_id
WHERE 
    products.product_name = '索尼WH-1000XM4'
    AND salesorders.order_date = '2023-05-05'
标准SQL执行成功，行数: 107
预测SQL执行成功，行数: 107
执行查询: ID=616988720, DB=retail
执行标准SQL: SELECT e.name, e.position, p.product_name FROM employees e JOIN salesstatistics ss ON e.employee_id = ss.employee_id JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-05' AND s.store_name = '智能生活馆' AND p.supplier_name = '小米官方旗舰店';
执行预测SQL: SELECT DISTINCT e.name AS name, e.position AS position, p.product_name AS product_name 
FROM salesorders s 
JOIN stores st ON s.store_id = st.store_id 
JOIN employees e ON s.employee_id = e.employee_id 
JOIN orderdetails od ON s.order_id = od.order_id 
JOIN products p ON od.product_id = p.product_id 
WHERE s.order_date = '2023-05-05' 
AND st.store_name = '智能生活馆' 
AND p.supplier_name = '小米官方旗舰店'
标准SQL执行成功，行数: 7
预测SQL执行成功，行数: 10

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回7行, 预测SQL返回10行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [product_name name position]
[35m预测SQL列:[0m [name position product_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [戴尔灵越15 刘亮 销售顾问]
[35m预测[1]:[0m [刘丽华 销售经理 iPhone 13]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [佳能EOS R6 易莹 销售顾问]
[35m预测[2]:[0m [吴丽娟 销售经理 Apple Watch Series 7]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [iPhone 13 欧成 销售顾问]
[35m预测[3]:[0m [周阳 销售顾问 索尼WH-1000XM4]
已处理 660/1042 个查询...
执行查询: ID=4131869213, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-07' ORDER BY ss.profit DESC LIMIT 1;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name FROM stores s WHERE s.store_id = (SELECT store_id FROM salesstatistics WHERE date = '2023-05-07' GROUP BY store_id ORDER BY SUM(profit) DESC LIMIT 1)
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=2632379040, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, p.product_name, ss.profit FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id WHERE p.product_name = '索尼WH-1000XM4' AND ss.date = '2023-05-09';
执行预测SQL: SELECT 
    s.store_name AS store_name,
    e.name AS employee_name,
    p.product_name AS product_name,
    (od.quantity * (od.unit_price - p.purchase_price)) AS profit
FROM 
    salesorders so
JOIN 
    orderdetails od ON so.order_id = od.order_id
JOIN 
    products p ON od.product_id = p.product_id
JOIN 
    stores s ON so.store_id = s.store_id
JOIN 
    employees e ON so.employee_id = e.employee_id
WHERE 
    so.order_date = '2023-05-09'
    AND p.product_name = '索尼WH-1000XM4'
标准SQL执行成功，行数: 97
预测SQL执行成功，行数: 120

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回97行, 预测SQL返回120行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_name product_name profit store_name]
[35m预测SQL列:[0m [profit store_name employee_name product_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [黄秀华 索尼WH-1000XM4 3253.31 未来城店]
[35m预测[1]:[0m [1331.63 科技中心店 郑健 索尼WH-1000XM4]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [孙秀荣 索尼WH-1000XM4 2793.02 科技中心店]
[35m预测[2]:[0m [-3892.85 创新路专卖店 李鹏 索尼WH-1000XM4]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [孙杨 索尼WH-1000XM4 4722.74 科技园店]
[35m预测[3]:[0m [12595.42 科技中心店 钟志强 索尼WH-1000XM4]
执行查询: ID=1347772939, DB=retail
执行标准SQL: SELECT p.product_name, od.quantity, od.unit_price FROM orderdetails od JOIN products p ON od.product_id = p.product_id JOIN salesorders so ON od.order_id = so.order_id WHERE p.product_name = '佳能EOS R6';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=2314844420, DB=retail
执行标准SQL: SELECT s.store_name, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-03';
执行预测SQL: SELECT salesorders.total_amount, stores.store_name FROM salesorders JOIN stores ON salesorders.store_id = stores.store_id WHERE salesorders.order_date = '2023-05-03'
标准SQL执行成功，行数: 1176
预测SQL执行成功，行数: 1176
执行查询: ID=1029843679, DB=retail
执行标准SQL: SELECT * FROM orderdetails WHERE quantity > 1;
执行预测SQL: SELECT order_detail_id AS order_detail_id, order_id AS order_id, product_id AS product_id, quantity AS quantity, unit_price AS unit_price FROM orderdetails WHERE quantity > 1
标准SQL执行成功，行数: 4969
预测SQL执行成功，行数: 4969
执行查询: ID=973958071, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'iPhone 13' AND so.order_date = '2023-05-05';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=3235376159, DB=retail
执行标准SQL: SELECT so.order_id, so.total_amount, s.store_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-05';
执行预测SQL: SELECT so.order_id AS order_id, so.total_amount AS total_amount, st.store_name AS store_name FROM salesorders so JOIN stores st ON so.store_id = st.store_id WHERE so.order_date = '2023-05-05'
标准SQL执行成功，行数: 1145
预测SQL执行成功，行数: 1145
执行查询: ID=590339570, DB=retail
执行标准SQL: SELECT p.product_name, od.order_id FROM orderdetails od JOIN products p ON od.product_id = p.product_id WHERE od.quantity > 1;
执行预测SQL: SELECT p.product_name AS product_name, od.order_id AS order_id FROM orderdetails od JOIN products p ON od.product_id = p.product_id WHERE od.quantity > 1
标准SQL执行成功，行数: 4969
预测SQL执行成功，行数: 4969
执行查询: ID=947155024, DB=retail
执行标准SQL: SELECT so.order_id, so.order_date, so.total_amount FROM salesorders so WHERE so.order_date BETWEEN '2023-05-01' AND '2023-05-31';
执行预测SQL: SELECT order_id AS order_id, order_date AS order_date, total_amount AS total_amount FROM salesorders WHERE order_date BETWEEN '2023-05-01' AND '2023-05-31'
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=143868964, DB=retail
执行标准SQL: SELECT employee_id, SUM(sales_quantity) FROM salesstatistics GROUP BY employee_id;
执行预测SQL: SELECT employee_id, SUM(sales_quantity) AS sum FROM salesstatistics GROUP BY employee_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 670/1042 个查询...
执行查询: ID=801054820, DB=retail
执行标准SQL: SELECT category_name, remaining_quantity FROM products;
执行预测SQL: SELECT category_name AS category, remaining_quantity AS remaining_quantity FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=956049949, DB=retail
执行标准SQL: SELECT e.name AS employee_name, SUM(ss.sales_quantity) AS total_sales, s.store_name FROM salesstatistics ss JOIN employees e ON ss.employee_id = e.employee_id JOIN stores s ON e.store_id = s.store_id GROUP BY e.name, s.store_name;
执行预测SQL: SELECT e.name AS employee_name, s.store_name, SUM(od.quantity) AS total_sales FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON so.store_id = s.store_id JOIN orderdetails od ON so.order_id = od.order_id GROUP BY e.name, s.store_name
标准SQL执行成功，行数: 9067
预测SQL执行成功，行数: 9067

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [employee_name total_sales store_name]
[35m预测SQL列:[0m [employee_name store_name total_sales]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [鄢勇 1 创客空间店]
[35m预测[1]:[0m [鄢勇 创客空间店 2]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [何强 1 电子城旗舰店]
[35m预测[2]:[0m [何强 电子城旗舰店 2]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [周桂花 1 科技园店]
[35m预测[3]:[0m [周桂花 科技园店 2]
执行查询: ID=1812261268, DB=retail
执行标准SQL: SELECT od.order_id, od.product_id FROM orderdetails od;
执行预测SQL: SELECT order_id AS order_id, product_id AS product_id FROM orderdetails
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=573573963, DB=retail
执行标准SQL: SELECT * FROM salesstatistics WHERE date = '2023-05-05';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=2726627092, DB=retail
执行标准SQL: SELECT e.name AS employee_name, ss.sales_quantity, ss.sales_amount FROM employees e JOIN salesstatistics ss ON e.employee_id = ss.employee_id JOIN stores s ON e.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE s.store_name = '科技园店' AND p.product_name = 'iPhone 13' AND ss.date = '2023-05-01';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=3682087832, DB=retail
执行标准SQL: SELECT e.name FROM employees e JOIN salesstatistics ss ON e.employee_id = ss.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-09' AND p.product_name = 'Apple Watch Series 7' AND p.supplier_name = '任天堂官方旗舰店';
执行预测SQL: SELECT e.name AS name
FROM employees e
JOIN salesorders so ON e.employee_id = so.employee_id
JOIN orderdetails od ON so.order_id = od.order_id
JOIN products p ON od.product_id = p.product_id
WHERE p.product_name = 'Apple Watch Series 7'
AND p.supplier_name = '任天堂官方旗舰店'
AND so.order_date = '2023-05-09'
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 14

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回14行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [name]
[35m预测SQL列:[0m [name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [程敏]
[35m预测[1]:[0m [冯龙]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [王金凤]
[35m预测[2]:[0m [罗亮]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [李倩]
[35m预测[3]:[0m [张雪]
执行查询: ID=994704464, DB=retail
执行标准SQL: SELECT so.total_amount, s.store_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-06';
执行预测SQL: SELECT salesorders.total_amount AS total_amount, stores.store_name AS store_name FROM salesorders JOIN stores ON salesorders.store_id = stores.store_id WHERE salesorders.order_date = '2023-05-06'
标准SQL执行成功，行数: 1091
预测SQL执行成功，行数: 1091
执行查询: ID=2258930244, DB=retail
执行标准SQL: SELECT so.order_id, od.quantity, od.unit_price FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id WHERE so.order_date = '2023-05-06';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=251367692, DB=retail
执行标准SQL: SELECT e.name AS employee_name, s.store_name, p.product_name, SUM(o.total_amount) AS total_sales_amount FROM salesorders o JOIN employees e ON o.employee_id = e.employee_id JOIN stores s ON o.store_id = s.store_id JOIN orderdetails d ON o.order_id = d.order_id JOIN products p ON d.product_id = p.product_id WHERE o.order_date = '2023-05-07' AND s.store_name = '智慧街店' AND p.product_name = '佳能EOS R6' GROUP BY e.name, s.store_name, p.product_name;
执行预测SQL: SELECT 
    e.name AS employee_name,
    s.store_name,
    p.product_name,
    SUM(so.total_amount) AS total_sales_amount
FROM 
    salesorders so
JOIN 
    stores s ON so.store_id = s.store_id
JOIN 
    employees e ON so.employee_id = e.employee_id
JOIN 
    orderdetails od ON so.order_id = od.order_id
JOIN 
    products p ON od.product_id = p.product_id
WHERE 
    s.store_name = '智慧街店'
    AND p.product_name = '佳能EOS R6'
    AND so.order_date = '2023-05-07'
GROUP BY 
    e.name, s.store_name, p.product_name
标准SQL执行成功，行数: 8
预测SQL执行成功，行数: 8
执行查询: ID=4178948313, DB=retail
执行标准SQL: SELECT st.store_name, SUM(od.quantity) AS total_quantity, SUM(od.quantity * od.unit_price) AS total_sales FROM orderdetails od JOIN salesorders so ON od.order_id = so.order_id JOIN stores st ON so.store_id = st.store_id GROUP BY st.store_name;
执行预测SQL: SELECT s.store_name, SUM(od.quantity) AS total_quantity, SUM(od.quantity * od.unit_price) AS total_sales 
FROM orderdetails od 
JOIN salesorders so ON od.order_id = so.order_id 
JOIN stores s ON so.store_id = s.store_id 
GROUP BY s.store_id, s.store_name
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name total_quantity total_sales]
[35m预测SQL列:[0m [total_quantity total_sales store_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 1588 1.682022955e+07]
[35m预测[1]:[0m [2 17933.58 创客空间店]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [数码广场店 1501 1.621679908e+07]
[35m预测[2]:[0m [2 7163.18 智慧街店]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [电子城旗舰店 1517 1.684447052e+07]
[35m预测[3]:[0m [2 29109.52 创客空间店]
已处理 680/1042 个查询...
执行查询: ID=635779591, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(od.quantity * od.unit_price) AS total_amount FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id WHERE p.product_name = '佳能EOS R6' AND so.order_date = '2023-05-05' GROUP BY s.store_name, e.name;
执行预测SQL: SELECT stores.store_name AS store_name, employees.name AS employee_name, salesorders.total_amount AS total_amount 
FROM products 
JOIN orderdetails ON products.product_id = orderdetails.product_id 
JOIN salesorders ON orderdetails.order_id = salesorders.order_id 
JOIN stores ON salesorders.store_id = stores.store_id 
JOIN employees ON salesorders.employee_id = employees.employee_id 
WHERE products.product_name = '佳能EOS R6' 
AND salesorders.order_date = '2023-05-05'
标准SQL执行成功，行数: 134
预测SQL执行成功，行数: 134

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name employee_name total_amount]
[35m预测SQL列:[0m [store_name employee_name total_amount]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 刘建华 9604.6]
[35m预测[1]:[0m [未来城店 郭洁 11673.71]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [创客空间店 周刚 14790.53]
[35m预测[2]:[0m [创客空间店 徐畅 12793.54]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [创客空间店 徐畅 13989.69]
[35m预测[3]:[0m [智能生活馆 刘琳 4548.89]
执行查询: ID=2326522926, DB=retail
执行标准SQL: SELECT * FROM products WHERE sale_price > 15000;
执行预测SQL: SELECT product_id AS product_id, product_name AS product_name, category_name AS category_name, purchase_price AS purchase_price, sale_price AS sale_price, remaining_quantity AS remaining_quantity, supplier_name AS supplier_name, description AS description FROM products WHERE sale_price > 15000
标准SQL执行成功，行数: 2771
预测SQL执行成功，行数: 2771
执行查询: ID=845825777, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, p.product_name, ss.sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-08' AND p.product_name = '索尼WH-1000XM4' AND ss.sales_quantity > 1;
执行预测SQL: SELECT 
    s.store_name AS store_name,
    e.name AS employee_name,
    p.product_name AS product_name,
    SUM(od.quantity) AS sales_quantity
FROM 
    salesorders so
JOIN 
    orderdetails od ON so.order_id = od.order_id
JOIN 
    products p ON od.product_id = p.product_id
JOIN 
    stores s ON so.store_id = s.store_id
JOIN 
    employees e ON so.employee_id = e.employee_id
WHERE 
    so.order_date = '2023-05-08'
    AND p.product_name = '索尼WH-1000XM4'
GROUP BY 
    s.store_name, e.name, p.product_name
HAVING 
    SUM(od.quantity) > 1
标准SQL执行成功，行数: 62
预测SQL执行成功，行数: 61

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回62行, 预测SQL返回61行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [product_name sales_quantity store_name employee_name]
[35m预测SQL列:[0m [store_name employee_name product_name sales_quantity]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [索尼WH-1000XM4 2 创新路专卖店 李鹏]
[35m预测[1]:[0m [创客空间店 刘玉华 索尼WH-1000XM4 2]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [索尼WH-1000XM4 2 智慧街店 梁玉梅]
[35m预测[2]:[0m [创客空间店 吴楠 索尼WH-1000XM4 2]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [索尼WH-1000XM4 2 未来城店 徐颖]
[35m预测[3]:[0m [创客空间店 李琴 索尼WH-1000XM4 2]
执行查询: ID=1519890808, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, p.product_name, ss.sales_amount FROM salesstatistics ss JOIN employees e ON ss.employee_id = e.employee_id JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-01' AND ss.sales_amount > 1000 AND p.supplier_name = '戴森官方旗舰店';
执行预测SQL: SELECT 
    s.store_name AS store_name,
    e.name AS employee_name,
    p.product_name AS product_name,
    od.quantity * od.unit_price AS sales_amount
FROM 
    orderdetails od
JOIN 
    salesorders so ON od.order_id = so.order_id
JOIN 
    products p ON od.product_id = p.product_id
JOIN 
    employees e ON so.employee_id = e.employee_id
JOIN 
    stores s ON so.store_id = s.store_id
WHERE 
    so.order_date = '2023-05-01'
    AND od.quantity * od.unit_price > 1000
    AND p.supplier_name = '戴森官方旗舰店'
标准SQL执行成功，行数: 92
预测SQL执行成功，行数: 102

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回92行, 预测SQL返回102行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name employee_name product_name sales_amount]
[35m预测SQL列:[0m [employee_name product_name sales_amount store_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [科技园店 冯建 iPad Air 12805.43]
[35m预测[1]:[0m [罗秀荣 Nintendo Switch 14010.22 数码广场店]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [数字大道店 袁瑜 Nintendo Switch 11062.52]
[35m预测[2]:[0m [尚超 Nintendo Switch 30637 电子城旗舰店]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [未来城店 方瑞 戴尔灵越15 5103.11]
[35m预测[3]:[0m [王建 Apple Watch Series 7 12495.7 数字大道店]
执行查询: ID=624803127, DB=retail
执行标准SQL: SELECT od.order_id, od.quantity FROM orderdetails od WHERE od.product_id = 'fba9543e-90b3-4a3d-b29e-bcf4518c4e3d';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=4067103855, DB=retail
执行标准SQL: SELECT s.store_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id GROUP BY s.store_name;
执行预测SQL: SELECT s.store_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id GROUP BY s.store_id, s.store_name
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name total_sales]
[35m预测SQL列:[0m [store_name total_sales]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 1.152176211e+07]
[35m预测[1]:[0m [创客空间店 14316.45]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [数码广场店 1.076418508e+07]
[35m预测[2]:[0m [智慧街店 6705.12]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [电子城旗舰店 1.106667016e+07]
[35m预测[3]:[0m [创客空间店 19634.73]
执行查询: ID=2670659765, DB=retail
执行标准SQL: SELECT so.order_id, SUM(od.quantity) AS total_quantity FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id WHERE so.order_date = '2023-05-06' GROUP BY so.order_id;
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=4067388605, DB=retail
执行标准SQL: SELECT so.order_id, so.order_date, e.name FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id;
执行预测SQL: SELECT salesorders.order_id AS order_id, salesorders.order_date AS order_date, employees.name AS name FROM salesorders INNER JOIN employees ON salesorders.employee_id = employees.employee_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=383590974, DB=retail
执行标准SQL: SELECT product_name, supplier_name FROM products;
执行预测SQL: SELECT product_name AS product_name, supplier_name AS supplier_name FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=4056403376, DB=retail
执行标准SQL: SELECT p.sale_price, p.supplier_name FROM products p;
执行预测SQL: SELECT sale_price AS sale_price, supplier_name AS supplier_name FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 690/1042 个查询...
执行查询: ID=3670992366, DB=retail
执行标准SQL: SELECT od.order_detail_id, p.product_name, od.unit_price FROM orderdetails od JOIN products p ON od.product_id = p.product_id;
执行预测SQL: SELECT orderdetails.order_detail_id AS order_detail_id, products.product_name AS product_name, products.sale_price AS unit_price FROM orderdetails JOIN products ON orderdetails.product_id = products.product_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [order_detail_id product_name unit_price]
[35m预测SQL列:[0m [order_detail_id product_name unit_price]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [2819896d-44da-41dd-8f3e-901877711a0c 戴森V11 3671.12]
[35m预测[1]:[0m [2819896d-44da-41dd-8f3e-901877711a0c 戴森V11 2744.4]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [f8baa4f0-7290-4fee-ae8b-0ede89047443 iPhone 13 17116.47]
[35m预测[2]:[0m [f8baa4f0-7290-4fee-ae8b-0ede89047443 iPhone 13 14850.94]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [8b4487dd-0457-4c61-b957-459b6f43c704 iPhone 13 16919.45]
[35m预测[3]:[0m [8b4487dd-0457-4c61-b957-459b6f43c704 iPhone 13 11373.68]
执行查询: ID=2335581270, DB=retail
执行标准SQL: SELECT s.store_name, s.phone FROM stores s JOIN salesorders so ON s.store_id = so.store_id WHERE so.total_amount > 3000 AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31';
执行预测SQL: SELECT s.store_name AS store_name, s.phone AS phone FROM stores s JOIN salesorders so ON s.store_id = so.store_id WHERE so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_id HAVING SUM(so.total_amount) > 3000
标准SQL执行成功，行数: 9316
预测SQL执行成功，行数: 9316
执行查询: ID=2535524828, DB=retail
执行标准SQL: SELECT store_name, manager_name FROM stores;
执行预测SQL: SELECT store_name AS store_name, manager_name AS manager_name FROM stores
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=120259515, DB=retail
执行标准SQL: SELECT e.name, st.phone FROM employees e JOIN stores st ON e.store_id = st.store_id;
执行预测SQL: SELECT employees.name AS name, stores.phone AS phone FROM employees JOIN stores ON employees.store_id = stores.store_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1670319692, DB=retail
执行标准SQL: SELECT e.name AS employee_name, ss.sales_quantity, ss.profit FROM salesstatistics ss JOIN employees e ON ss.employee_id = e.employee_id JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-09' AND s.store_name = '创新路专卖店' AND p.product_name = 'iPad Air';
执行预测SQL: SELECT e.name AS employee_name, ss.sales_quantity, ss.profit 
FROM employees e 
JOIN salesstatistics ss ON e.employee_id = ss.employee_id 
JOIN stores s ON ss.store_id = s.store_id 
JOIN products p ON ss.product_id = p.product_id 
WHERE s.store_name = '创新路专卖店' 
AND p.product_name = 'iPad Air' 
AND ss.date = '2023-05-09'
标准SQL执行成功，行数: 13
预测SQL执行成功，行数: 13
执行查询: ID=4086419825, DB=retail
执行标准SQL: SELECT e.name, e.position, s.store_name, so.total_amount FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-07' AND s.store_name = '未来城店' AND so.total_amount > 15000;
执行预测SQL: SELECT e.name AS name, e.position AS position, s.store_name AS store_name, SUM(so.total_amount) AS total_amount 
FROM salesorders so 
JOIN employees e ON so.employee_id = e.employee_id 
JOIN stores s ON so.store_id = s.store_id 
WHERE so.order_date = '2023-05-07' 
AND s.store_name = '未来城店' 
GROUP BY e.employee_id, s.store_name 
HAVING SUM(so.total_amount) > 15000
标准SQL执行成功，行数: 24
预测SQL执行成功，行数: 24
执行查询: ID=3256730396, DB=retail
执行标准SQL: SELECT pd.product_name, pd.sale_price - pd.purchase_price AS price_difference
FROM products pd;
执行预测SQL: SELECT product_name, (sale_price - purchase_price) AS price_difference FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2107889479, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name FROM stores s JOIN salesorders so ON s.store_id = so.store_id WHERE so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_id HAVING SUM(so.total_amount) > 10000;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name 
FROM stores s 
WHERE s.store_id IN (
    SELECT store_id 
    FROM salesorders 
    WHERE order_date BETWEEN '2023-05-01' AND '2023-05-31' 
    GROUP BY store_id 
    HAVING SUM(total_amount) > 10000
)
标准SQL执行成功，行数: 5523
预测SQL执行成功，行数: 5523
执行查询: ID=595252998, DB=retail
执行标准SQL: SELECT st.store_name, SUM(ss.profit) AS total_profit, SUM(ss.sales_quantity) AS total_sales_quantity FROM salesstatistics ss JOIN stores st ON ss.store_id = st.store_id GROUP BY st.store_name;
执行预测SQL: SELECT s.store_name, SUM(od.quantity * (od.unit_price - p.purchase_price)) AS total_profit, SUM(od.quantity) AS total_sales_quantity 
FROM salesorders so 
JOIN orderdetails od ON so.order_id = od.order_id 
JOIN products p ON od.product_id = p.product_id 
JOIN stores s ON so.store_id = s.store_id 
GROUP BY s.store_id, s.store_name
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name total_profit total_sales_quantity]
[35m预测SQL列:[0m [total_sales_quantity store_name total_profit]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 2.80669732e+06 1556]
[35m预测[1]:[0m [2 创客空间店 2212.32]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [数码广场店 2.63566884e+06 1498]
[35m预测[2]:[0m [2 智慧街店 -3369.02]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [电子城旗舰店 2.70206242e+06 1552]
[35m预测[3]:[0m [2 创客空间店 7149.54]
执行查询: ID=2271451016, DB=retail
执行标准SQL: SELECT * FROM salesorders WHERE store_id = '64921abb-1d54-4e03-a15e-ea42f058f31c';
执行预测SQL: SELECT order_id AS "订单编号", store_id AS "门店ID", employee_id AS "员工ID", order_date AS "下单日期", total_amount AS "总金额" FROM salesorders WHERE store_id = '64921abb-1d54-4e03-a15e-ea42f058f31c'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
已处理 700/1042 个查询...
执行查询: ID=3431877623, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, p.product_name, so.total_amount FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON e.store_id = s.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.order_date = '2023-05-06' AND p.product_name = '小米电视4A' AND so.total_amount > 10000;
执行预测SQL: SELECT 
    stores.store_name AS store_name,
    employees.name AS employee_name,
    products.product_name AS product_name,
    salesorders.total_amount AS total_amount
FROM 
    salesorders
JOIN employees ON salesorders.employee_id = employees.employee_id
JOIN stores ON salesorders.store_id = stores.store_id
JOIN orderdetails ON salesorders.order_id = orderdetails.order_id
JOIN products ON orderdetails.product_id = products.product_id
WHERE 
    salesorders.order_date = '2023-05-06'
    AND products.product_name = '小米电视4A'
    AND salesorders.total_amount > 10000
标准SQL执行成功，行数: 67
预测SQL执行成功，行数: 67
执行查询: ID=1818716672, DB=retail
执行标准SQL: SELECT DISTINCT s.store_name FROM stores s JOIN salesstatistics ss ON s.store_id = ss.store_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'Nintendo Switch' AND ss.date >= '2023-05-01' AND ss.date < '2023-06-01' AND ss.profit > 1000;
执行预测SQL: SELECT DISTINCT s.store_name
预测SQL执行错误: SQL执行失败: pq: missing FROM-clause entry for table "s"
预测SQL执行错误: SQL执行失败: pq: missing FROM-clause entry for table "s"
执行查询: ID=3062953566, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, od.quantity, od.unit_price * od.quantity AS total_amount FROM orderdetails od JOIN salesorders so ON od.order_id = so.order_id JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON e.store_id = s.store_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '索尼WH-1000XM4' AND so.order_date = '2023-05-09';
执行预测SQL: SELECT 
    s.store_name AS store_name,
    e.name AS employee_name,
    SUM(od.quantity) AS quantity,
    SUM(od.quantity * od.unit_price) AS total_amount
FROM 
    orderdetails od
JOIN 
    salesorders so ON od.order_id = so.order_id
JOIN 
    products p ON od.product_id = p.product_id
JOIN 
    employees e ON so.employee_id = e.employee_id
JOIN 
    stores s ON so.store_id = s.store_id
WHERE 
    p.product_name = '索尼WH-1000XM4'
    AND so.order_date = '2023-05-09'
GROUP BY 
    s.store_id, e.employee_id
标准SQL执行成功，行数: 120
预测SQL执行成功，行数: 120
执行查询: ID=3908942610, DB=retail
执行标准SQL: SELECT so.order_id, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE s.store_name = '科技中心店';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=208218356, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-03' GROUP BY s.store_name, s.manager_name ORDER BY total_sales DESC LIMIT 1;
执行预测SQL: SELECT s.store_name, s.manager_name, s2.total_sales 
FROM (
    SELECT s.store_id, SUM(so.total_amount) AS total_sales 
    FROM salesorders so 
    JOIN stores s ON so.store_id = s.store_id 
    WHERE so.order_date = '2023-05-03' 
    GROUP BY s.store_id
) AS s2 
JOIN stores s ON s2.store_id = s.store_id 
ORDER BY s2.total_sales DESC 
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name total_sales]
[35m预测SQL列:[0m [total_sales store_name manager_name]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [智能生活馆 王秀芳 47660.39]
[35m预测[1]:[0m [19996.57 创新路专卖店 吴静]
执行查询: ID=4174482566, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, ss.sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-03' ORDER BY ss.sales_quantity DESC LIMIT 1;
执行预测SQL: SELECT 
    s.store_name AS store_name, 
    s.manager_name AS manager_name, 
    SUM(ss.sales_quantity) AS sales_quantity
FROM 
    salesstatistics ss
JOIN 
    stores s ON ss.store_id = s.store_id
WHERE 
    ss.date = '2023-05-03'
GROUP BY 
    s.store_id, s.store_name, s.manager_name
ORDER BY 
    sales_quantity DESC
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name sales_quantity]
[35m预测SQL列:[0m [store_name manager_name sales_quantity]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [电子城旗舰店 赵玉华 2]
[35m预测[1]:[0m [智慧街店 高俊 2]
执行查询: ID=1762340720, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'iPad Air' AND so.order_date = '2023-05-01';
执行预测SQL: SELECT stores.store_name AS store_name, employees.name AS employee_name, salesorders.total_amount AS total_amount FROM products JOIN orderdetails ON products.product_id = orderdetails.product_id JOIN salesorders ON orderdetails.order_id = salesorders.order_id JOIN stores ON salesorders.store_id = stores.store_id JOIN employees ON salesorders.employee_id = employees.employee_id WHERE products.product_name = 'iPad Air' AND salesorders.order_date = '2023-05-01'
标准SQL执行成功，行数: 131
预测SQL执行成功，行数: 131
执行查询: ID=1734342716, DB=retail
执行标准SQL: SELECT store_id, SUM(total_amount) AS total_sales FROM salesorders GROUP BY store_id;
执行预测SQL: SELECT store_id, SUM(total_amount) AS total_sales FROM salesorders GROUP BY store_id
执行查询: ID=3698654694, DB=retail
执行标准SQL: SELECT e.position, COUNT(so.order_id) AS order_count FROM employees e LEFT JOIN salesorders so ON e.employee_id = so.employee_id GROUP BY e.position;
执行预测SQL: SELECT e.position, COUNT(so.order_id) AS order_count FROM employees e LEFT JOIN salesorders so ON e.employee_id = so.employee_id GROUP BY e.employee_id, e.position
标准SQL执行成功，行数: 4
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回4行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [position order_count]
[35m预测SQL列:[0m [position order_count]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [技术支持 1977]
[35m预测[1]:[0m [技术支持 1]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [销售经理 1994]
[35m预测[2]:[0m [销售顾问 1]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [客户服务 1978]
[35m预测[3]:[0m [客户服务 1]
执行查询: ID=3114650274, DB=retail
执行标准SQL: SELECT * FROM salesstatistics WHERE store_id = 'eecdb2bd-fa18-4c73-84a2-35e3dc390ad5';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
已处理 710/1042 个查询...
执行查询: ID=2085424302, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(o.total_amount) AS total_sales FROM stores s JOIN salesorders o ON s.store_id = o.store_id WHERE o.order_date >= '2023-05-01' AND o.order_date <= '2023-05-31' GROUP BY s.store_id HAVING SUM(o.total_amount) > 10000;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name, sub.total_sales AS total_sales FROM stores s JOIN (SELECT so.store_id, SUM(so.total_amount) AS total_sales FROM salesorders so WHERE so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY so.store_id HAVING SUM(so.total_amount) > 10000) sub ON s.store_id = sub.store_id
标准SQL执行成功，行数: 5523
预测SQL执行成功，行数: 5523
执行查询: ID=662177839, DB=retail
执行标准SQL: SELECT DISTINCT s.store_name FROM stores s JOIN salesorders so ON s.store_id = so.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.order_date = '2023-05-02' AND so.total_amount > 10000 AND p.supplier_name = '华为官方旗舰店';
执行预测SQL: SELECT s.store_name
FROM salesorders so
JOIN orderdetails od ON so.order_id = od.order_id
JOIN products p ON od.product_id = p.product_id
JOIN stores s ON so.store_id = s.store_id
WHERE so.order_date = '2023-05-02'
  AND p.supplier_name = '华为官方旗舰店'
GROUP BY s.store_id
HAVING SUM(od.quantity * od.unit_price) > 10000
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 75

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回75行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name]
[35m预测SQL列:[0m [store_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店]
[35m预测[1]:[0m [科技中心店]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [创新路专卖店]
[35m预测[2]:[0m [数字大道店]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [数字大道店]
[35m预测[3]:[0m [智能生活馆]
执行查询: ID=3976972213, DB=retail
执行标准SQL: SELECT pd.product_name, SUM(od.quantity) AS total_quantity, so.order_id
FROM orderdetails od
JOIN salesorders so ON od.order_id = so.order_id
JOIN products pd ON od.product_id = pd.product_id
WHERE so.order_date = '2023-05-02'
GROUP BY pd.product_name, so.order_id
ORDER BY total_quantity DESC
LIMIT 1;
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=783788015, DB=retail
执行标准SQL: SELECT so.order_id, so.order_date, so.total_amount FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id WHERE e.employee_id = '8282299e-10e9-48e4-b28e-a57fbd96cd4d';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=2306528451, DB=retail
执行标准SQL: SELECT s.store_name, s.manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-04' GROUP BY s.store_name, s.manager_name ORDER BY total_sales DESC LIMIT 1;
执行预测SQL: SELECT s.store_name AS store_name, s.manager_name AS manager_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-04' GROUP BY s.store_id, s.store_name, s.manager_name ORDER BY total_sales DESC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name manager_name total_sales]
[35m预测SQL列:[0m [manager_name total_sales store_name]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [科技中心店 丁博 26403.22]
[35m预测[1]:[0m [王秀英 19953.28 数字大道店]
执行查询: ID=1834111948, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, e.position FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = '华为Mate 40 Pro' AND ss.date = '2023-05-01';
执行预测SQL: SELECT s.store_name AS store_name, e.name AS employee_name, e.position AS position 
FROM salesorders so 
JOIN orderdetails od ON so.order_id = od.order_id 
JOIN products p ON od.product_id = p.product_id 
JOIN employees e ON so.employee_id = e.employee_id 
JOIN stores s ON so.store_id = s.store_id 
WHERE p.product_name = '华为Mate 40 Pro' AND so.order_date = '2023-05-01'
标准SQL执行成功，行数: 100
预测SQL执行成功，行数: 90

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回100行, 预测SQL返回90行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [position store_name employee_name]
[35m预测SQL列:[0m [position store_name employee_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [销售经理 创客空间店 李斌]
[35m预测[1]:[0m [技术支持 电子城旗舰店 章建]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [销售顾问 科技园店 李帆]
[35m预测[2]:[0m [客户服务 科技中心店 张博]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [客户服务 未来城店 陈磊]
[35m预测[3]:[0m [销售顾问 智慧街店 胡伟]
执行查询: ID=1718600359, DB=retail
执行标准SQL: SELECT e.name AS employee_name, s.manager_name AS store_manager_name FROM salesstatistics ss JOIN employees e ON ss.employee_id = e.employee_id JOIN stores s ON e.store_id = s.store_id WHERE ss.date = '2023-05-06' AND ss.sales_amount > 10000;
执行预测SQL: SELECT e.name AS employee_name, s.manager_name AS store_manager_name FROM salesstatistics ss JOIN employees e ON ss.employee_id = e.employee_id JOIN stores s ON e.store_id = s.store_id WHERE ss.date = '2023-05-06' AND ss.sales_amount > 10000
执行查询: ID=2900121322, DB=retail
执行标准SQL: SELECT s.store_name, e.name AS employee_name, SUM(od.quantity * od.unit_price) AS total_amount FROM stores s JOIN employees e ON s.store_id = e.store_id JOIN salesorders so ON e.employee_id = so.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '戴尔灵越15' AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31' GROUP BY s.store_name, e.name HAVING SUM(od.quantity * od.unit_price) > 5000;
执行预测SQL: SELECT DISTINCT s.store_name AS store_name, e.name AS employee_name, so.total_amount AS total_amount 
FROM salesorders so 
JOIN orderdetails od ON so.order_id = od.order_id 
JOIN products p ON od.product_id = p.product_id 
JOIN stores s ON so.store_id = s.store_id 
JOIN employees e ON so.employee_id = e.employee_id 
WHERE p.product_name = '戴尔灵越15' 
AND so.order_date BETWEEN '2023-05-01' AND '2023-05-31' 
AND so.total_amount > 5000
标准SQL执行成功，行数: 850
预测SQL执行成功，行数: 782

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回850行, 预测SQL返回782行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name employee_name total_amount]
[35m预测SQL列:[0m [store_name employee_name total_amount]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 陈华 26881.94]
[35m预测[1]:[0m [创客空间店 黄秀珍 13755.33]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [科技中心店 吴刚 38557.58]
[35m预测[2]:[0m [创新路专卖店 薛志强 7769.16]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [智能生活馆 沈玉梅 24692.24]
[35m预测[3]:[0m [智能生活馆 陈秀芳 13609.36]
执行查询: ID=1605466649, DB=retail
执行标准SQL: SELECT product_id, remaining_quantity, sale_price FROM products;
执行预测SQL: SELECT product_id AS product_id, remaining_quantity AS remaining_quantity, sale_price AS sale_price FROM products
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=330758085, DB=retail
执行标准SQL: SELECT s.store_name, COUNT(e.employee_id) AS employee_count FROM stores s LEFT JOIN employees e ON s.store_id = e.store_id GROUP BY s.store_name;
执行预测SQL: SELECT stores.store_name, COUNT(employees.employee_id) AS employee_count FROM employees JOIN stores ON employees.store_id = stores.store_id GROUP BY stores.store_id
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [store_name employee_count]
[35m预测SQL列:[0m [store_name employee_count]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [创客空间店 1049]
[35m预测[1]:[0m [创客空间店 1]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [数码广场店 1004]
[35m预测[2]:[0m [智慧街店 1]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [电子城旗舰店 1031]
[35m预测[3]:[0m [创客空间店 1]
已处理 720/1042 个查询...
执行查询: ID=1887568974, DB=retail
执行标准SQL: SELECT e.name AS employee_name, e.position, od.quantity FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-05' AND s.store_name = '科技中心店' AND p.product_name = '戴森V11' AND od.quantity > 1;
执行预测SQL: SELECT e.name AS employee_name, e.position, SUM(od.quantity) AS quantity 
FROM salesorders so 
JOIN orderdetails od ON so.order_id = od.order_id 
JOIN employees e ON so.employee_id = e.employee_id 
JOIN stores st ON so.store_id = st.store_id 
JOIN products p ON od.product_id = p.product_id 
WHERE so.order_date = '2023-05-05' 
AND st.store_name = '科技中心店' 
AND p.product_name = '戴森V11' 
GROUP BY e.employee_id, e.name, e.position 
HAVING SUM(od.quantity) > 1
标准SQL执行成功，行数: 8
预测SQL执行成功，行数: 8
执行查询: ID=1544829110, DB=retail
执行标准SQL: SELECT so.order_id, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE s.store_name = '数码广场店';
执行预测SQL: SELECT so.order_id AS order_id, so.total_amount AS total_amount FROM salesorders so JOIN stores st ON so.store_id = st.store_id WHERE st.store_name = '数码广场店'
标准SQL执行成功，行数: 1004
预测SQL执行成功，行数: 1004
执行查询: ID=1389319035, DB=risk_control
执行标准SQL: SELECT a.assessment_id, a.risk_level, a.impact_score, e.event_type, e.event_description FROM risk_assessments a JOIN risk_events e ON a.event_id = e.event_id WHERE a.risk_level = '高' AND a.impact_score > 8
执行预测SQL: SELECT ra.assessment_id AS assessment_id, ra.risk_level AS risk_level, ra.impact_score AS impact_score, re.event_type AS event_type, re.event_description AS event_description FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id WHERE ra.risk_level = '高' AND ra.impact_score > 8
标准SQL执行成功，行数: 661
预测SQL执行成功，行数: 661
执行查询: ID=955757206, DB=risk_control
执行标准SQL: SELECT event_id FROM risk_events WHERE event_type = '合规风险';
执行预测SQL: SELECT event_id AS event_id FROM risk_events WHERE event_type = '合规风险'
标准SQL执行成功，行数: 1996
预测SQL执行成功，行数: 1996
执行查询: ID=1687223871, DB=risk_control
执行标准SQL: SELECT re.event_description, a.status FROM alerts a JOIN risk_events re ON a.event_id = re.event_id WHERE a.alert_type = '欺诈嫌疑';
执行预测SQL: SELECT re.event_description AS event_description, al.audit_result AS event_status 
FROM alerts a 
JOIN risk_events re ON a.event_id = re.event_id 
JOIN audit_logs al ON re.event_id = al.event_id 
WHERE a.alert_type = 'fraud'
标准SQL执行成功，行数: 2043
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2043行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=948809000, DB=risk_control
执行标准SQL: SELECT r.report_type, AVG(e.severity) as avg_severity FROM risk_reports r JOIN risk_events e ON r.event_id = e.event_id WHERE r.approval_status = '已批准' GROUP BY r.report_type ORDER BY avg_severity DESC;
执行预测SQL: SELECT 
    r.report_type, 
    AVG(re.severity) AS avg_severity
FROM 
    risk_reports r
JOIN 
    risk_events re ON r.event_id = re.event_id
WHERE 
    r.approval_status = 'approved'
GROUP BY 
    r.report_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回5行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=2131857844, DB=risk_control
执行标准SQL: SELECT risk_level, COUNT(*) AS customer_count, AVG(credit_score) AS avg_credit_score FROM customers GROUP BY risk_level ORDER BY customer_count DESC
执行预测SQL: SELECT risk_level, COUNT(*) AS customer_count, AVG(credit_score) AS avg_credit_score FROM customers GROUP BY risk_level
标准SQL执行成功，行数: 3
预测SQL执行成功，行数: 3
执行查询: ID=1810509227, DB=risk_control
执行标准SQL: SELECT ri.indicator_id, ri.indicator_name, ml.monitoring_date, ml.actual_value FROM risk_indicators ri JOIN risk_monitoring_logs ml ON ri.indicator_id = ml.indicator_id WHERE ml.monitoring_date >= '2023-10-01' AND ml.monitoring_date < '2023-11-01';
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2704266530, DB=risk_control
执行标准SQL: SELECT rr.report_id, rr.report_date, rr.author, rr.event_id FROM risk_reports rr WHERE rr.approval_status = '已批准';
执行预测SQL: SELECT report_id AS report_id, report_date AS report_date, author AS author, event_id AS event_id FROM risk_reports WHERE approval_status = '已批准'
标准SQL执行成功，行数: 3284
预测SQL执行成功，行数: 3284
执行查询: ID=3816194798, DB=risk_control
执行标准SQL: SELECT c.risk_level, t.transaction_type, CASE WHEN t.amount <= 1000 THEN '低额' WHEN t.amount <= 10000 THEN '中额' ELSE '高额' END as amount_range, COUNT(*) as transaction_count, AVG(t.risk_score) as avg_risk_score FROM customers c JOIN transactions t ON c.customer_id = t.customer_id GROUP BY c.risk_level, t.transaction_type, CASE WHEN t.amount <= 1000 THEN '低额' WHEN t.amount <= 10000 THEN '中额' ELSE '高额' END ORDER BY c.risk_level, t.transaction_type, amount_range
执行预测SQL: SELECT 
    c.risk_level,
    t.transaction_type,
    CASE
        WHEN t.amount < 1000 THEN 'Low'
        WHEN t.amount BETWEEN 1000 AND 5000 THEN 'Medium'
        ELSE 'High'
    END AS amount_range,
    COUNT(*) AS transaction_count,
    AVG(t.risk_score) AS avg_risk_score
FROM 
    customers c
JOIN 
    transactions t ON c.customer_id = t.customer_id
GROUP BY 
    c.risk_level, t.transaction_type, amount_range
ORDER BY 
    c.risk_level, t.transaction_type, amount_range
标准SQL执行成功，行数: 39
预测SQL执行成功，行数: 38

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回39行, 预测SQL返回38行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [risk_level transaction_type amount_range transaction_count avg_risk_score]
[35m预测SQL列:[0m [risk_level transaction_type amount_range transaction_count avg_risk_score]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [中 取款 中额 3 74.33333333333333]
[35m预测[1]:[0m [中 取款 High 627 51.02870813397129]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [中 取款 低额 2 5]
[35m预测[2]:[0m [中 取款 Low 2 5]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [中 取款 高额 625 50.9472]
[35m预测[3]:[0m [中 取款 Medium 1 70]
已处理 730/1042 个查询...
执行查询: ID=3476903471, DB=risk_control
执行标准SQL: SELECT a.audit_id, a.audit_result, al.alert_content FROM audit_logs a JOIN alerts al ON a.alert_id = al.alert_id WHERE a.event_id = 'RE4692';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=451357687, DB=risk_control
执行标准SQL: SELECT r.report_id, r.report_type, e.event_description, a.risk_level FROM risk_reports r JOIN risk_events e ON r.event_id = e.event_id LEFT JOIN risk_assessments a ON e.event_id = a.event_id WHERE r.author = '周婷';
执行预测SQL: SELECT risk_reports.report_id AS report_id, risk_reports.report_type AS report_type, risk_events.event_description AS event_description, risk_assessments.risk_level AS risk_level FROM risk_reports JOIN risk_events ON risk_reports.event_id = risk_events.event_id JOIN risk_assessments ON risk_events.event_id = risk_assessments.event_id WHERE risk_reports.author = '周婷'
标准SQL执行成功，行数: 977
预测SQL执行成功，行数: 977
执行查询: ID=880512967, DB=risk_control
执行标准SQL: SELECT rr.report_id, rr.report_date, rr.author, rr.approval_status FROM risk_reports rr WHERE rr.report_date > '2023-01-01';
执行预测SQL: SELECT report_id AS report_id, report_date AS report_date, author AS author, approval_status AS approval_status FROM risk_reports WHERE report_date > '2023-01-01'
标准SQL执行成功，行数: 9971
预测SQL执行成功，行数: 9971
执行查询: ID=4205370122, DB=risk_control
执行标准SQL: SELECT e.event_id, e.event_description, a.risk_level, a.impact_score, a.probability_score, a.mitigation_plan FROM risk_events e LEFT JOIN risk_assessments a ON e.event_id = a.event_id WHERE e.event_description LIKE '%系统%' ORDER BY a.risk_level DESC, e.occurrence_time DESC;
执行预测SQL: SELECT re.event_id AS event_id, re.event_description AS event_description, ra.risk_level AS risk_level, ra.impact_score AS impact_score, ra.probability_score AS probability_score, ra.mitigation_plan AS mitigation_plan FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE re.event_description LIKE '%系统%'
标准SQL执行成功，行数: 2046
预测SQL执行成功，行数: 2046
执行查询: ID=2721513399, DB=risk_control
执行标准SQL: WITH current_values AS (SELECT indicator_id, actual_value as current_value FROM risk_monitoring_logs rml WHERE monitoring_date = (SELECT MAX(monitoring_date) FROM risk_monitoring_logs WHERE indicator_id = rml.indicator_id)), past_values AS (SELECT indicator_id, actual_value as past_value FROM risk_monitoring_logs rml WHERE monitoring_date = (SELECT MAX(monitoring_date) FROM risk_monitoring_logs WHERE indicator_id = rml.indicator_id AND monitoring_date <= date('now') - INTERVAL '30 days')) SELECT ri.indicator_id, ri.indicator_name, cv.current_value, pv.past_value, (cv.current_value - pv.past_value) / pv.past_value * 100 as change_percentage FROM risk_indicators ri LEFT JOIN current_values cv ON ri.indicator_id = cv.indicator_id LEFT JOIN past_values pv ON ri.indicator_id = pv.indicator_id
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=1697295436, DB=risk_control
执行标准SQL: SELECT re.event_id, re.event_description, ra.risk_level, ra.mitigation_plan FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE ra.risk_level = '高' AND ra.assessor = '曾强';
执行预测SQL: SELECT re.event_id AS event_id, re.event_description AS event_description, ra.risk_level AS risk_level, ra.mitigation_plan AS mitigation_plan FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id WHERE ra.risk_level = '高风险' AND ra.assessor = '曾强'
标准SQL执行成功，行数: 350
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回350行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=2228217319, DB=risk_control
执行标准SQL: SELECT DISTINCT c.customer_name FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.transaction_type = '投资' AND t.risk_score > 60;
执行预测SQL: SELECT DISTINCT c.customer_name AS customer_name FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.transaction_type = '投资' AND t.risk_score > 60
标准SQL执行成功，行数: 197
预测SQL执行成功，行数: 197
执行查询: ID=1939667217, DB=risk_control
执行标准SQL: SELECT re.event_id, re.created_at, re.status FROM risk_events re;
执行预测SQL: SELECT event_id AS event_id, created_at AS creation_time, status AS current_status FROM risk_events
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2175309220, DB=risk_control
执行标准SQL: SELECT c.customer_name, t.risk_score FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.credit_score < 600;
执行预测SQL: SELECT customers.customer_name AS customer_name, transactions.risk_score AS risk_score FROM customers INNER JOIN transactions ON customers.customer_id = transactions.customer_id WHERE customers.credit_score < 600
标准SQL执行成功，行数: 3337
预测SQL执行成功，行数: 3337
执行查询: ID=1016775966, DB=risk_control
执行标准SQL: SELECT t.amount, c.customer_name FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.transaction_date >= '2023-12-01' AND t.transaction_date < '2024-01-01' AND t.status = '成功';
执行预测SQL: SELECT t.amount AS amount, c.customer_name AS customer_name FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.transaction_date BETWEEN '2023-12-01' AND '2023-12-31' AND t.status = '成功'
标准SQL执行成功，行数: 283
预测SQL执行成功，行数: 274

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回283行, 预测SQL返回274行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [amount customer_name]
[35m预测SQL列:[0m [amount customer_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [694370.72 赵丽]
[35m预测[1]:[0m [694370.72 赵丽]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [666984.59 杨敏]
[35m预测[2]:[0m [666984.59 杨敏]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [46858.67 周敏]
[35m预测[3]:[0m [46858.67 周敏]
已处理 740/1042 个查询...
执行查询: ID=629791557, DB=risk_control
执行标准SQL: SELECT alert_type, alert_content FROM alerts;
执行预测SQL: SELECT alert_type AS type, alert_content AS content FROM alerts
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=4191869630, DB=risk_control
执行标准SQL: SELECT report_id, report_type, approved_by FROM risk_reports;
执行预测SQL: SELECT report_id AS report_id, report_type AS report_type, approved_by AS approved_by FROM risk_reports
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3240782233, DB=risk_control
执行标准SQL: SELECT transaction_type, COUNT(*) as total_count, SUM(CASE WHEN status = '成功' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) as success_rate, AVG(risk_score) as avg_risk_score FROM transactions GROUP BY transaction_type ORDER BY avg_risk_score DESC;
执行预测SQL: SELECT 
    transaction_type,
    COUNT(*) AS total_count,
    CAST(SUM(CASE WHEN status = '成功' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS DECIMAL(10,2)) AS success_rate,
    AVG(risk_score) AS avg_risk_score
FROM transactions
GROUP BY transaction_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [transaction_type total_count success_rate avg_risk_score]
[35m预测SQL列:[0m [transaction_type total_count success_rate avg_risk_score]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [取款 2012 32.10735586481113 51.381709741550694]
[35m预测[1]:[0m [取款 2012 0.32 51.381709741550694]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [贷款 2084 32.869481765834934 51.2010556621881]
[35m预测[2]:[0m [贷款 2084 0.33 51.2010556621881]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [投资 2006 34.74576271186441 51.16849451645065]
[35m预测[3]:[0m [存款 1958 0.34 50.77987742594484]
执行查询: ID=1390189932, DB=risk_control
执行标准SQL: SELECT a.alert_id, a.alert_content, rc.rule_description FROM alerts a JOIN rule_configurations rc ON a.rule_id = rc.rule_id;
执行预测SQL: SELECT a.alert_id AS alert_id, a.alert_content AS alert_content, rc.rule_description AS rule_description FROM alerts a INNER JOIN rule_configurations rc ON a.rule_id = rc.rule_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2842460105, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, t.status FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id ORDER BY t.transaction_date DESC LIMIT 1;
执行预测SQL: SELECT c.customer_id AS customer_id, c.customer_name AS customer_name, t.status AS status FROM customers c JOIN (SELECT *, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY transaction_date DESC) AS rn FROM transactions) t ON c.customer_id = t.customer_id WHERE t.rn = 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [customer_name status customer_id]
[35m预测SQL列:[0m [customer_id customer_name status]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [周芳 成功 CU3901]
[35m预测[1]:[0m [CU0001 兴业科技有限公司 处理中]
执行查询: ID=3963285376, DB=risk_control
执行标准SQL: SELECT i.indicator_id, i.indicator_name, AVG(l.actual_value) as avg_value, STDDEV(l.actual_value) as std_dev, CASE WHEN AVG(l.actual_value) != 0 THEN STDDEV(l.actual_value) / AVG(l.actual_value) ELSE NULL END as coefficient_of_variation FROM risk_indicators i JOIN risk_monitoring_logs l ON i.indicator_id = l.indicator_id GROUP BY i.indicator_id, i.indicator_name ORDER BY coefficient_of_variation DESC NULLS LAST;
执行预测SQL: SELECT 
  ri.indicator_id,
  ri.indicator_name,
  ROUND(AVG(rm.actual_value), 2) AS avg_value,
  ROUND(STDDEV(rm.actual_value), 2) AS std_dev,
  ROUND((STDDEV(rm.actual_value) / NULLIF(AVG(rm.actual_value), 0)), 2) AS coefficient_of_variation
FROM 
  risk_monitoring_logs rm
JOIN 
  risk_indicators ri ON rm.indicator_id = ri.indicator_id
GROUP BY 
  ri.indicator_id, ri.indicator_name
ORDER BY 
  ri.indicator_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2546181421, DB=risk_control
执行标准SQL: SELECT DISTINCT c.customer_id, c.customer_name FROM customers c JOIN transactions t1 ON c.customer_id = t1.customer_id JOIN transactions t2 ON c.customer_id = t2.customer_id JOIN audit_logs a ON t2.transaction_id = a.transaction_id WHERE t1.risk_score > 80 AND t2.amount > 500000 AND a.audit_result = '拒绝' AND t1.transaction_date >= date('now') - INTERVAL '1 year' AND t2.transaction_date >= date('now') - INTERVAL '1 year'
执行预测SQL: SELECT c.customer_id AS customer_id, c.customer_name AS customer_name
FROM customers c
WHERE c.customer_id IN (
    SELECT t.customer_id
    FROM transactions t
    JOIN audit_logs a ON t.transaction_id = a.transaction_id
    WHERE t.amount > 500000
    AND a.audit_result = '未通过'
    AND t.transaction_date >= CURRENT_DATE - INTERVAL '1 year'
)
AND c.customer_id IN (
    SELECT t2.customer_id
    FROM transactions t2
    WHERE t2.risk_score >= 80
    AND t2.transaction_date >= CURRENT_DATE - INTERVAL '1 year'
)
标准SQL执行成功，行数: -1
预测SQL执行成功，行数: -1
执行查询: ID=2755620243, DB=risk_control
执行标准SQL: SELECT AVG(impact_score) AS average_impact_score FROM risk_assessments WHERE mitigation_plan IS NULL;
执行预测SQL: SELECT AVG(impact_score) AS average_impact_score FROM risk_assessments WHERE mitigation_plan IS NULL
执行查询: ID=3751427783, DB=risk_control
执行标准SQL: SELECT alert_id, alert_content, status FROM alerts;
执行预测SQL: SELECT alert_id AS alert_id, alert_content AS alert_content, status AS status FROM alerts
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2897506811, DB=risk_control
执行标准SQL: WITH customer_risks AS (SELECT c.customer_id, c.customer_name, COUNT(CASE WHEN t.risk_score > 80 AND t.transaction_date >= date('now') - INTERVAL '90 days' THEN 1 END) as high_risk_transactions, COUNT(CASE WHEN a.status = '未处理' THEN 1 END) as unresolved_alerts, c.credit_score FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id LEFT JOIN alerts a ON t.event_id = a.event_id GROUP BY c.customer_id, c.customer_name) SELECT customer_name, (high_risk_transactions * 2 + unresolved_alerts * 3 + 1000.0 / NULLIF(credit_score, 0)) as risk_index FROM customer_risks ORDER BY risk_index DESC LIMIT 10;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
已处理 750/1042 个查询...
执行查询: ID=1765860698, DB=risk_control
执行标准SQL: SELECT event_type, COUNT(*) as occurrence_count, AVG(severity) as avg_severity FROM risk_events WHERE EXTRACT(YEAR FROM occurrence_time) = 2023 GROUP BY event_type ORDER BY occurrence_count DESC, avg_severity DESC
执行预测SQL: SELECT event_type, COUNT(*) AS occurrence_count, AVG(severity) AS avg_severity FROM risk_events WHERE occurrence_time >= '2023-01-01' AND occurrence_time < '2024-01-01' GROUP BY event_type ORDER BY occurrence_count DESC
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=2186954842, DB=risk_control
执行标准SQL: SELECT rr.*, re.event_type, re.event_description FROM risk_reports rr LEFT JOIN risk_events re ON rr.event_id = re.event_id WHERE rr.report_content LIKE '%合规风险%'
执行预测SQL: SELECT rr.report_id AS report_id, rr.report_type AS report_type, rr.report_date AS report_date, rr.report_content AS report_content, rr.author AS author, rr.approval_status AS approval_status, rr.approved_by AS approved_by, rr.event_id AS event_id, re.event_type AS event_type, re.event_description AS event_description FROM risk_reports rr JOIN risk_events re ON rr.event_id = re.event_id WHERE rr.report_content LIKE '%合规风险%'
标准SQL执行成功，行数: 2042
预测SQL执行成功，行数: 2042
执行查询: ID=1001861352, DB=risk_control
执行标准SQL: SELECT ri.indicator_id, ri.update_frequency, ri.data_source FROM risk_indicators ri;
执行预测SQL: SELECT indicator_id AS indicator_id, update_frequency AS update_frequency, data_source AS data_source FROM risk_indicators
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3688441488, DB=risk_control
执行标准SQL: SELECT re.event_id, re.event_type, re.status, rr.report_content, rr.report_date FROM risk_events re LEFT JOIN risk_reports rr ON re.event_id = rr.event_id WHERE re.status != '已解决' AND rr.report_date = (SELECT MAX(report_date) FROM risk_reports WHERE event_id = re.event_id)
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2337622346, DB=risk_control
执行标准SQL: SELECT r.rule_type, AVG(alert_count) as avg_alert_count, MAX(r.updated_at) as last_update_time FROM rule_configurations r LEFT JOIN (SELECT rule_id, COUNT(*) as alert_count FROM alerts GROUP BY rule_id) a ON r.rule_id = a.rule_id GROUP BY r.rule_type ORDER BY avg_alert_count DESC;
执行预测SQL: SELECT rc.rule_type, COALESCE(AVG(alert_counts.alert_count), 0) AS avg_alert_count, MAX(rc.updated_at) AS last_update_time 
FROM rule_configurations rc 
LEFT JOIN (SELECT rule_id, COUNT(*) AS alert_count FROM alerts GROUP BY rule_id) AS alert_counts 
ON rc.rule_id = alert_counts.rule_id 
GROUP BY rc.rule_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=1820971007, DB=risk_control
执行标准SQL: SELECT event_type, COUNT(event_id) AS event_count FROM risk_events GROUP BY event_type ORDER BY event_count DESC;
执行预测SQL: SELECT event_type, COUNT(*) as event_count FROM risk_events GROUP BY event_type ORDER BY event_count DESC
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=3328333298, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, c.credit_score FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.transaction_date >= '2023-01-01' AND t.transaction_date < '2024-01-01' AND c.credit_score < 700;
执行预测SQL: SELECT DISTINCT t.customer_id AS customer_id, c.customer_name AS customer_name, c.credit_score AS credit_score FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.transaction_date >= '2023-01-01' AND t.transaction_date < '2024-01-01' AND c.credit_score < 700
标准SQL执行成功，行数: 6675
预测SQL执行成功，行数: 6675
执行查询: ID=547790744, DB=risk_control
执行标准SQL: SELECT re.event_id, re.event_type, rr.report_id FROM risk_events re JOIN risk_reports rr ON re.event_id = rr.event_id;
执行预测SQL: SELECT risk_events.event_id AS event_id, risk_events.event_type AS event_type, risk_reports.report_id AS report_id FROM risk_events INNER JOIN risk_reports ON risk_events.event_id = risk_reports.event_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3644288071, DB=risk_control
执行标准SQL: SELECT COUNT(*) FROM risk_reports WHERE EXTRACT(YEAR FROM report_date) = 2023 AND approval_status = '已拒绝'
执行预测SQL: SELECT COUNT(*) AS count FROM risk_reports WHERE approval_status = 'rejected' AND report_date BETWEEN '2023-01-01' AND '2023-12-31'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [count]
[35m预测SQL列:[0m [count]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [3432]
[35m预测[1]:[0m [0]
执行查询: ID=3802320452, DB=risk_control
执行标准SQL: SELECT ra.assessment_id, ra.mitigation_plan, ra.assessor FROM risk_assessments ra;
执行预测SQL: SELECT assessment_id AS assessment_id, mitigation_plan AS mitigation_plan, assessor AS assessor FROM risk_assessments
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 760/1042 个查询...
执行查询: ID=3489018825, DB=risk_control
执行标准SQL: SELECT m.log_id, m.actual_value, m.is_exceeding_threshold FROM risk_monitoring_logs m JOIN risk_indicators i ON m.indicator_id = i.indicator_id;
执行预测SQL: SELECT rml.log_id AS log_id, rml.actual_value AS actual_value, rml.is_exceeding_threshold AS is_exceeding_threshold FROM risk_monitoring_logs rml WHERE (rml.indicator_id, rml.monitoring_date) IN (SELECT indicator_id, MAX(monitoring_date) FROM risk_monitoring_logs GROUP BY indicator_id)
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2505821643, DB=risk_control
执行标准SQL: SELECT rc.rule_id, rc.rule_name, COUNT(a.alert_id) as alert_count FROM rule_configurations rc LEFT JOIN alerts a ON rc.rule_id = a.rule_id GROUP BY rc.rule_id, rc.rule_name ORDER BY alert_count DESC
执行预测SQL: SELECT rc.rule_id, rc.rule_name, COUNT(a.alert_id) AS alert_count FROM rule_configurations rc JOIN alerts a ON rc.rule_id = a.rule_id GROUP BY rc.rule_id, rc.rule_name
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3072597279, DB=risk_control
执行标准SQL: SELECT re.event_id, re.event_description, t.transaction_id, t.amount FROM risk_events re JOIN transactions t ON re.event_id = t.event_id WHERE re.event_type = '信用风险' AND t.status = '成功';
执行预测SQL: SELECT 
    re.event_id AS event_id,
    re.event_description AS event_description,
    t.transaction_id AS transaction_id,
    t.amount AS amount
FROM 
    risk_events re
JOIN 
    transactions t ON re.event_id = t.event_id
WHERE 
    re.event_type = '信用风险' 
    AND t.status = '成功'
标准SQL执行成功，行数: 710
预测SQL执行成功，行数: 710
执行查询: ID=260033616, DB=risk_control
执行标准SQL: SELECT c.risk_level, COUNT(c.customer_id) AS customer_count FROM customers c GROUP BY c.risk_level;
执行预测SQL: SELECT risk_level, COUNT(*) AS customer_count FROM customers GROUP BY risk_level
标准SQL执行成功，行数: 3
预测SQL执行成功，行数: 3
执行查询: ID=2369245761, DB=risk_control
执行标准SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY total_amount) AS median_transaction_amount
FROM (
    SELECT c.customer_id, SUM(t.amount) AS total_amount
    FROM customers c
    JOIN transactions t ON c.customer_id = t.customer_id
    WHERE c.registration_date < '2019-01-01' AND c.risk_level = '高'
    GROUP BY c.customer_id
) AS customer_transactions;
执行预测SQL: SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY total_amount) AS median_transaction_amount
FROM (
    SELECT SUM(t.amount) AS total_amount
    FROM customers c
    JOIN transactions t ON c.customer_id = t.customer_id
    WHERE c.registration_date < '2019-01-01' AND c.risk_level = '高'
    GROUP BY c.customer_id
) AS sub
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=1787317276, DB=risk_control
执行标准SQL: SELECT rc.rule_name, re.event_description FROM rule_configurations rc JOIN alerts a ON rc.rule_id = a.rule_id JOIN risk_events re ON a.event_id = re.event_id WHERE a.alert_level = '高';
执行预测SQL: SELECT rc.rule_name AS rule_name, re.event_description AS event_description FROM alerts a JOIN rule_configurations rc ON a.rule_id = rc.rule_id JOIN risk_events re ON a.event_id = re.event_id WHERE a.alert_level = '高'
标准SQL执行成功，行数: 3300
预测SQL执行成功，行数: 3300
执行查询: ID=1447865488, DB=risk_control
执行标准SQL: SELECT event_id, created_at, status FROM risk_events;
执行预测SQL: SELECT event_id AS event_id, created_at AS created_at, status AS status FROM risk_events
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3560291801, DB=risk_control
执行标准SQL: WITH monthly_events AS (SELECT DATE_TRUNC('month', created_at) as month, event_type, COUNT(*) as event_count FROM risk_events GROUP BY DATE_TRUNC('month', created_at), event_type) SELECT current_month.month, current_month.event_type, current_month.event_count, previous_month.event_count as previous_month_count, CASE WHEN previous_month.event_count > 0 THEN ROUND((current_month.event_count - previous_month.event_count) / previous_month.event_count * 100, 2) ELSE NULL END as month_over_month_growth FROM monthly_events current_month LEFT JOIN monthly_events previous_month ON current_month.event_type = previous_month.event_type AND current_month.month = previous_month.month + INTERVAL '1 month' ORDER BY current_month.month DESC, current_month.event_type;
执行预测SQL: SELECT 
    TO_CHAR(occurrence_time, 'YYYY-MM') AS month,
    event_type,
    COUNT(*) AS event_count,
    LAG(COUNT(*), 1) OVER (PARTITION BY event_type ORDER BY TO_CHAR(occurrence_time, 'YYYY-MM')) AS previous_month_count,
    ((COUNT(*) - LAG(COUNT(*), 1) OVER (PARTITION BY event_type ORDER BY TO_CHAR(occurrence_time, 'YYYY-MM'))) * 100.0 / NULLIF(LAG(COUNT(*), 1) OVER (PARTITION BY event_type ORDER BY TO_CHAR(occurrence_time, 'YYYY-MM')), 0)) AS month_over_month_growth
FROM risk_events
GROUP BY 
    TO_CHAR(occurrence_time, 'YYYY-MM'),
    event_type
ORDER BY 
    TO_CHAR(occurrence_time, 'YYYY-MM'),
    event_type
标准SQL执行成功，行数: 60
预测SQL执行成功，行数: 60

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [previous_month_count month_over_month_growth month event_type event_count]
[35m预测SQL列:[0m [month_over_month_growth month event_type event_count previous_month_count]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [168 0 2023-12-01 00:00:00 +0000 +0000 信用风险 155]
[35m预测[1]:[0m [<nil> 2023-01 信用风险 162 <nil>]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [161 0 2023-12-01 00:00:00 +0000 +0000 合规风险 159]
[35m预测[2]:[0m [<nil> 2023-01 合规风险 144 <nil>]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [180 0 2023-12-01 00:00:00 +0000 +0000 市场风险 174]
[35m预测[3]:[0m [<nil> 2023-01 市场风险 180 <nil>]
执行查询: ID=2152701139, DB=risk_control
执行标准SQL: SELECT DATE_TRUNC('month', transaction_date) as month, AVG(amount) as avg_amount, COUNT(*) as transaction_count FROM transactions GROUP BY DATE_TRUNC('month', transaction_date) ORDER BY month
执行预测SQL: SELECT TO_CHAR(transaction_date, 'YYYY-MM') AS month, AVG(amount) AS avg_amount, COUNT(*) AS transaction_count FROM transactions GROUP BY TO_CHAR(transaction_date, 'YYYY-MM') ORDER BY month
标准SQL执行成功，行数: 12
预测SQL执行成功，行数: 12

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [month avg_amount transaction_count]
[35m预测SQL列:[0m [avg_amount transaction_count month]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [2023-01-01 00:00:00 +0000 +0000 504692.49478855723 804]
[35m预测[1]:[0m [504692.49478855723 804 2023-01]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [2023-02-01 00:00:00 +0000 +0000 511331.2631523179 755]
[35m预测[2]:[0m [511331.2631523179 755 2023-02]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [2023-03-01 00:00:00 +0000 +0000 517692.63593967515 862]
[35m预测[3]:[0m [517692.63593967515 862 2023-03]
执行查询: ID=558233205, DB=risk_control
执行标准SQL: SELECT rr.report_id, rr.report_type, rr.approved_by, re.event_description, re.severity FROM risk_reports rr LEFT JOIN risk_events re ON rr.event_id = re.event_id WHERE rr.approval_status = '已批准' ORDER BY re.severity DESC, rr.report_date DESC
执行预测SQL: SELECT r.report_id AS report_id, r.report_type AS report_type, r.approved_by AS approved_by, e.event_description AS event_description, e.severity AS severity FROM risk_reports r JOIN risk_events e ON r.event_id = e.event_id WHERE r.approval_status = '已批准'
标准SQL执行成功，行数: 3284
预测SQL执行成功，行数: 3284
已处理 770/1042 个查询...
执行查询: ID=3381293646, DB=risk_control
执行标准SQL: SELECT c.customer_name, c.risk_level, t.status FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id;
执行预测SQL: SELECT c.customer_name AS customer_name, c.risk_level AS risk_level, t.status AS status FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3077667667, DB=risk_control
执行标准SQL: SELECT c.customer_name, t.transaction_type, t.status FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.risk_level = '高';
执行预测SQL: SELECT customers.customer_name AS 客户名称, transactions.transaction_type AS 交易类型, transactions.status AS 交易状态 FROM customers JOIN transactions ON customers.customer_id = transactions.customer_id WHERE customers.risk_level = '高'
标准SQL执行成功，行数: 3366
预测SQL执行成功，行数: 3366
执行查询: ID=2339616488, DB=risk_control
执行标准SQL: SELECT * FROM risk_reports WHERE author = '孙宇' AND approval_status = '待审批'
执行预测SQL: SELECT 
  report_id AS report_id,
  report_type AS report_type,
  report_date AS report_date,
  report_content AS report_content,
  author AS author,
  approval_status AS approval_status,
  approved_by AS approved_by,
  event_id AS event_id
FROM 
  risk_reports
WHERE 
  author = '孙宇' 
  AND approval_status = '待审批'
标准SQL执行成功，行数: 325
预测SQL执行成功，行数: 325
执行查询: ID=1797007792, DB=risk_control
执行标准SQL: SELECT a.alert_content, e.event_description FROM alerts a JOIN risk_events e ON a.event_id = e.event_id WHERE a.status = '未处理';
执行预测SQL: SELECT alerts.alert_content AS alert_content, risk_events.event_description AS event_description FROM alerts JOIN risk_events ON alerts.event_id = risk_events.event_id WHERE alerts.status = '未处理'
标准SQL执行成功，行数: 3306
预测SQL执行成功，行数: 3306
执行查询: ID=298505495, DB=risk_control
执行标准SQL: SELECT risk_level, COUNT(*) AS customer_count FROM customers WHERE risk_level IN ('中', '高') GROUP BY risk_level;
执行预测SQL: SELECT risk_level AS risk_level, COUNT(*) AS customer_count FROM customers WHERE risk_level IN ('中', '高') GROUP BY risk_level
标准SQL执行成功，行数: 2
预测SQL执行成功，行数: 2
执行查询: ID=612300483, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, COUNT(t.transaction_id) AS transaction_count, AVG(t.risk_score) AS avg_risk_score FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id GROUP BY c.customer_id;
执行预测SQL: SELECT 
    customers.customer_id, 
    customers.customer_name, 
    COUNT(transactions.transaction_id) AS transaction_count, 
    AVG(transactions.risk_score) AS avg_risk_score 
FROM 
    customers 
INNER JOIN 
    transactions 
ON 
    customers.customer_id = transactions.customer_id 
GROUP BY 
    customers.customer_id, 
    customers.customer_name
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3872938276, DB=risk_control
执行标准SQL: SELECT DATE_TRUNC('month', registration_date,) as month, COUNT(*) as new_high_risk_customers FROM customers WHERE risk_level = '高' GROUP BY DATE_TRUNC('month', registration_date) ORDER BY month
标准SQL执行错误: SQL执行失败: pq: syntax error at or near ")"
执行预测SQL: SELECT DATE_TRUNC('month', registration_date) AS month, COUNT(*) AS new_high_risk_customers FROM customers WHERE risk_level = '高' GROUP BY DATE_TRUNC('month', registration_date) ORDER BY month
标准SQL执行错误: SQL执行失败: pq: syntax error at or near ")"
执行查询: ID=4293195588, DB=risk_control
执行标准SQL: WITH latest_logs AS (SELECT indicator_id, MAX(monitoring_date) AS latest_date FROM risk_monitoring_logs GROUP BY indicator_id) SELECT i.indicator_name, l.monitoring_date, l.actual_value, a.alert_id, a.alert_level, a.alert_content, au.audit_result, au.audit_comments FROM risk_indicators i JOIN latest_logs ll ON i.indicator_id = ll.indicator_id JOIN risk_monitoring_logs l ON ll.indicator_id = l.indicator_id AND ll.latest_date = l.monitoring_date LEFT JOIN alerts a ON l.log_id = a.rule_id LEFT JOIN audit_logs au ON a.alert_id = au.alert_id WHERE i.threshold_value < l.actual_value ORDER BY l.monitoring_date DESC
执行预测SQL: SELECT 
    ri.indicator_name AS indicator_name,
    lmt.monitoring_date AS monitoring_date,
    lmt.actual_value AS actual_value,
    a.alert_id AS alert_id,
    a.alert_level AS alert_level,
    a.alert_content AS alert_content,
    al.audit_result AS audit_result,
    al.audit_comments AS audit_comments
FROM 
    (SELECT 
        *,
        ROW_NUMBER() OVER (PARTITION BY indicator_id ORDER BY monitoring_date DESC) AS rn
     FROM 
        risk_monitoring_logs) lmt
JOIN 
    risk_indicators ri ON lmt.indicator_id = ri.indicator_id
JOIN 
    rule_configurations rc ON ri.indicator_id = rc.indicator_id
JOIN 
    alerts a ON rc.rule_id = a.rule_id
JOIN 
    audit_logs al ON a.alert_id = al.alert_id
WHERE 
    ri.risk_level = 'high'
    AND lmt.rn = 1
预测SQL执行错误: SQL执行失败: pq: column ri.risk_level does not exist
预测SQL执行错误: SQL执行失败: pq: column ri.risk_level does not exist
执行查询: ID=3735769324, DB=risk_control
执行标准SQL: SELECT risk_level, COUNT(*) as customer_count, AVG(credit_score) as avg_credit_score FROM customers GROUP BY risk_level
执行预测SQL: SELECT risk_level AS risk_level, COUNT(customer_id) AS customer_count, AVG(credit_score) AS avg_credit_score FROM customers GROUP BY risk_level
标准SQL执行成功，行数: 3
预测SQL执行成功，行数: 3
执行查询: ID=3555900229, DB=risk_control
执行标准SQL: SELECT alert_type, MAX(EXTRACT(EPOCH FROM (resolved_time - alert_time))) AS max_processing_time FROM (SELECT a.alert_type, a.alert_time, l.audit_time AS resolved_time FROM alerts a JOIN audit_logs l ON a.alert_id = l.alert_id WHERE a.status = '已解决') AS resolved_alerts GROUP BY alert_type ORDER BY max_processing_time DESC;
执行预测SQL: SELECT a.alert_type, MAX(EXTRACT(EPOCH FROM (a.resolved_time - a.alert_time))) AS max_processing_time 
FROM (
    SELECT alerts.alert_id, alerts.alert_type, alerts.alert_time,
           (SELECT MAX(al.audit_time) 
            FROM audit_logs al 
            WHERE al.alert_id = alerts.alert_id 
              AND al.audit_type = 'status_change' 
              AND al.audit_result = '已解决') AS resolved_time 
    FROM alerts 
    WHERE alerts.status = '已解决' 
      AND EXISTS (
          SELECT 1 
          FROM audit_logs al 
          WHERE al.alert_id = alerts.alert_id 
            AND al.audit_type = 'status_change' 
            AND al.audit_result = '已解决'
      )
) AS a 
GROUP BY a.alert_type 
ORDER BY max_processing_time DESC
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回5行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
已处理 780/1042 个查询...
执行查询: ID=390806390, DB=risk_control
执行标准SQL: SELECT c.customer_name, t.amount, t.transaction_date FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.transaction_date >= '2023-11-01' AND t.transaction_date < '2023-12-01' AND t.amount > 100000;
执行预测SQL: SELECT c.customer_name, t.amount, t.transaction_date FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.transaction_date BETWEEN '2023-11-01' AND '2023-11-30' AND t.amount > 100000
标准SQL执行成功，行数: 760
预测SQL执行成功，行数: 736

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回760行, 预测SQL返回736行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [customer_name amount transaction_date]
[35m预测SQL列:[0m [transaction_date customer_name amount]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [吴丽 771401.19 2023-11-14 10:33:00.298834 +0000 +0000]
[35m预测[1]:[0m [2023-11-14 10:33:00.298834 +0000 +0000 吴丽 771401.19]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [陈丽 470592.73 2023-11-10 07:09:18.842518 +0000 +0000]
[35m预测[2]:[0m [2023-11-10 07:09:18.842518 +0000 +0000 陈丽 470592.73]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [中天制造有限公司 199035.61 2023-11-06 18:02:57.098369 +0000 +0000]
[35m预测[3]:[0m [2023-11-06 18:02:57.098369 +0000 +0000 中天制造有限公司 199035.61]
执行查询: ID=2736578842, DB=risk_control
执行标准SQL: SELECT SUM(threshold_value) FROM risk_indicators WHERE indicator_name LIKE '%财务%';
执行预测SQL: SELECT SUM(threshold_value) AS sum FROM risk_indicators WHERE indicator_name LIKE '%财务%'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=453782697, DB=risk_control
执行标准SQL: SELECT customer_name, credit_score FROM customers;
执行预测SQL: SELECT customer_name AS name, credit_score AS credit_score FROM customers
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=605680231, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, t.transaction_id, t.transaction_date, t.risk_score FROM customers c JOIN transactions t ON c.customer_id = t.customer_id ORDER BY t.transaction_date DESC;
执行预测SQL: SELECT c.customer_id AS customer_id, c.customer_name AS customer_name, t.transaction_id AS transaction_id, t.transaction_date AS transaction_date, t.risk_score AS risk_score FROM customers c JOIN (SELECT customer_id, transaction_id, transaction_date, risk_score, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY transaction_date DESC) AS rn FROM transactions) t ON c.customer_id = t.customer_id WHERE t.rn = 1
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=591035595, DB=risk_control
执行标准SQL: SELECT log_id, actual_value FROM risk_monitoring_logs WHERE is_exceeding_threshold = TRUE;
执行预测SQL: SELECT risk_monitoring_logs.log_id AS log_id, risk_monitoring_logs.actual_value AS actual_value FROM risk_monitoring_logs JOIN risk_indicators ON risk_monitoring_logs.indicator_id = risk_indicators.indicator_id WHERE risk_monitoring_logs.actual_value > risk_indicators.threshold_value
标准SQL执行成功，行数: 2953
预测SQL执行成功，行数: 5032

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2953行, 预测SQL返回5032行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [log_id actual_value]
[35m预测SQL列:[0m [log_id actual_value]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [ML0001 98.85]
[35m预测[1]:[0m [ML0001 98.85]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [ML0002 28.61]
[35m预测[2]:[0m [ML0003 87.16]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [ML0006 54.55]
[35m预测[3]:[0m [ML0006 54.55]
执行查询: ID=154773295, DB=risk_control
执行标准SQL: SELECT t.transaction_id, t.transaction_date, t.amount, t.risk_score, AVG(t.risk_score) OVER () AS avg_risk_score FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE c.risk_level = '高';
执行预测SQL: SELECT 
    t.transaction_id, 
    t.transaction_date, 
    t.amount, 
    t.risk_score, 
    (SELECT AVG(t2.risk_score) FROM transactions t2 JOIN customers c2 ON t2.customer_id = c2.customer_id WHERE c2.risk_level = '高') AS avg_risk_score
FROM 
    transactions t
JOIN 
    customers c ON t.customer_id = c.customer_id
WHERE 
    c.risk_level = '高'
标准SQL执行成功，行数: 3366
预测SQL执行成功，行数: 3366
执行查询: ID=2894945358, DB=risk_control
执行标准SQL: SELECT t.transaction_id, t.risk_score FROM transactions t JOIN customers c ON t.customer_id = c.customer_id;
执行预测SQL: SELECT transaction_id AS transaction_id, risk_score AS risk_score FROM transactions
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3936841885, DB=risk_control
执行标准SQL: SELECT report_type, COUNT(*) AS count FROM risk_reports WHERE approval_status = '已拒绝' GROUP BY report_type;
执行预测SQL: SELECT report_type, COUNT(*) AS count FROM risk_reports WHERE approval_status = '已拒绝' GROUP BY report_type
执行查询: ID=2451684746, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, c.credit_score, c.risk_level FROM customers c WHERE c.risk_level = '高' AND c.credit_score < 600;
执行预测SQL: SELECT customer_id AS customer_id, customer_name AS customer_name, credit_score AS credit_score, risk_level AS risk_level
FROM customers
WHERE credit_score < 600 AND risk_level = '高'
标准SQL执行成功，行数: 1148
预测SQL执行成功，行数: 1148
执行查询: ID=1650691143, DB=risk_control
执行标准SQL: SELECT c.risk_level, AVG(t.amount) as avg_transaction_amount, COUNT(t.transaction_id) / COUNT(DISTINCT c.customer_id) as avg_transaction_count FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.transaction_date >= datetime('now') - INTERVAL '1 year' GROUP BY c.risk_level
标准SQL执行错误: SQL执行失败: pq: function datetime(unknown) does not exist
执行预测SQL: SELECT 
    c.risk_level, 
    AVG(t.amount) AS avg_transaction_amount, 
    COUNT(t.transaction_id) / COUNT(DISTINCT c.customer_id) AS avg_transactions_per_customer
FROM 
    customers c
JOIN 
    transactions t ON c.customer_id = t.customer_id
WHERE 
    t.transaction_date >= CURRENT_DATE - INTERVAL '1 year'
    AND c.risk_level IS NOT NULL
GROUP BY 
    c.risk_level
标准SQL执行错误: SQL执行失败: pq: function datetime(unknown) does not exist
已处理 790/1042 个查询...
执行查询: ID=3897186376, DB=risk_control
执行标准SQL: SELECT rr.* FROM risk_reports rr JOIN risk_events re ON rr.event_id = re.event_id WHERE re.event_type = '流动性风险';
执行预测SQL: SELECT 
    r.report_id AS report_id,
    r.report_type AS report_type,
    r.report_date AS report_date,
    r.report_content AS report_content,
    r.author AS author,
    r.approval_status AS approval_status,
    r.approved_by AS approved_by,
    r.event_id AS event_id
FROM 
    risk_reports r
JOIN 
    risk_events e ON r.event_id = e.event_id
WHERE 
    e.event_type = '流动性风险'
标准SQL执行成功，行数: 1967
预测SQL执行成功，行数: 1967
执行查询: ID=1076275288, DB=risk_control
执行标准SQL: SELECT COUNT(DISTINCT c.customer_id) AS customer_count, SUM(t.amount) AS total_transaction_amount FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.credit_score BETWEEN 600 AND 800;
执行预测SQL: SELECT COUNT(DISTINCT c.customer_id) AS customer_count, SUM(t.amount) AS total_transaction_amount FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id WHERE c.credit_score BETWEEN 600 AND 800
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=1120727301, DB=risk_control
执行标准SQL: SELECT report_content FROM risk_reports WHERE approved_by = '王思远' AND report_date >= '2023-03-01' AND report_date < '2023-04-01';
执行预测SQL: SELECT report_content AS report_content FROM risk_reports WHERE approved_by = '王思远' AND report_date >= '2023-03-01' AND report_date < '2023-04-01'
标准SQL执行成功，行数: 175
预测SQL执行成功，行数: 175
执行查询: ID=1080125465, DB=risk_control
执行标准SQL: SELECT re.event_id, rr.report_id, rr.approval_status FROM risk_events re JOIN risk_reports rr ON re.event_id = rr.event_id WHERE re.event_type = '合规风险';
执行预测SQL: SELECT risk_events.event_id AS event_id, risk_reports.report_id AS report_id, risk_reports.approval_status AS approval_status FROM risk_events INNER JOIN risk_reports ON risk_events.event_id = risk_reports.event_id
标准SQL执行成功，行数: 1996
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1996行, 预测SQL返回10000行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [event_id report_id approval_status]
[35m预测SQL列:[0m [event_id report_id approval_status]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [RE0009 RR0009 待审批]
[35m预测[1]:[0m [RE0001 RR0001 已拒绝]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [RE0023 RR0023 待审批]
[35m预测[2]:[0m [RE0002 RR0002 已批准]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [RE0026 RR0026 待审批]
[35m预测[3]:[0m [RE0003 RR0003 已批准]
执行查询: ID=136539419, DB=risk_control
执行标准SQL: SELECT * FROM transactions WHERE transaction_date BETWEEN '2023-06-01' AND '2023-06-30';
执行预测SQL: SELECT transaction_id AS transaction_id, customer_id AS customer_id, transaction_type AS transaction_type, amount AS amount, transaction_date AS transaction_date, status AS status, risk_score AS risk_score, event_id AS event_id FROM transactions WHERE transaction_date >= '2023-06-01' AND transaction_date < '2023-07-01'
标准SQL执行成功，行数: 781
预测SQL执行成功，行数: 806

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回781行, 预测SQL返回806行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [transaction_id customer_id transaction_type amount transaction_date status risk_score event_id]
[35m预测SQL列:[0m [customer_id transaction_type amount transaction_date status risk_score event_id transaction_id]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [TR0003 CU0003 贷款 106372.22 2023-06-03 06:51:50.613625 +0000 +0000 处理中 8 RE0003]
[35m预测[1]:[0m [CU0003 贷款 106372.22 2023-06-03 06:51:50.613625 +0000 +0000 处理中 8 RE0003 TR0003]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [TR0016 CU0016 取款 660256.83 2023-06-20 23:37:31.870434 +0000 +0000 失败 84 RE0016]
[35m预测[2]:[0m [CU0016 取款 660256.83 2023-06-20 23:37:31.870434 +0000 +0000 失败 84 RE0016 TR0016]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [TR0020 CU0020 贷款 723262.68 2023-06-13 04:19:11.079519 +0000 +0000 失败 83 RE0020]
[35m预测[3]:[0m [CU0020 贷款 723262.68 2023-06-13 04:19:11.079519 +0000 +0000 失败 83 RE0020 TR0020]
执行查询: ID=3750047672, DB=risk_control
执行标准SQL: SELECT re.event_id, re.event_type, re.event_description, al.audit_id, al.audit_type, al.audit_result FROM risk_events re JOIN audit_logs al ON re.event_id = al.event_id WHERE re.severity = 3;
执行预测SQL: SELECT 
    re.event_id AS event_id,
    re.event_type AS event_type,
    re.event_description AS event_description,
    al.audit_id AS audit_id,
    al.audit_type AS audit_type,
    al.audit_result AS audit_result
FROM 
    risk_events re
JOIN 
    audit_logs al ON re.event_id = al.event_id
WHERE 
    re.severity = 3
标准SQL执行成功，行数: 1928
预测SQL执行成功，行数: 1928
执行查询: ID=3909298542, DB=risk_control
执行标准SQL: SELECT ri.indicator_name, ri.threshold_value, rml.actual_value FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id WHERE rml.actual_value > ri.threshold_value;
执行预测SQL: SELECT ri.indicator_name AS indicator_name, ri.threshold_value AS threshold_value, rml.actual_value AS actual_value FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id WHERE rml.actual_value > ri.threshold_value
标准SQL执行成功，行数: 5032
预测SQL执行成功，行数: 5032
执行查询: ID=2762771801, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, c.credit_score, t.status FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id;
执行预测SQL: SELECT c.customer_id AS customer_id, c.customer_name AS customer_name, c.credit_score AS credit_score, t.status AS transaction_status FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2830564670, DB=risk_control
执行标准SQL: SELECT re.event_id, re.event_description, a.alert_level, a.alert_content FROM risk_events re JOIN alerts a ON re.event_id = a.event_id WHERE a.alert_level = '高';
执行预测SQL: SELECT re.event_id AS event_id, re.event_description AS event_description, a.alert_level AS alert_level, a.alert_content AS alert_content FROM risk_events re JOIN alerts a ON re.event_id = a.event_id WHERE a.alert_level = '高'
标准SQL执行成功，行数: 3300
预测SQL执行成功，行数: 3300
执行查询: ID=942591775, DB=risk_control
执行标准SQL: SELECT re.event_id, re.event_description, a.alert_id, a.alert_time FROM risk_events re JOIN alerts a ON re.event_id = a.event_id ORDER BY a.alert_time;
执行预测SQL: SELECT risk_events.event_id AS event_id, risk_events.event_description AS event_desc, alerts.alert_id AS alert_id, alerts.alert_time AS alert_time FROM risk_events JOIN alerts ON risk_events.event_id = alerts.event_id ORDER BY alerts.alert_time
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 800/1042 个查询...
执行查询: ID=3295587616, DB=risk_control
执行标准SQL: SELECT c.risk_level, AVG(t.amount) as avg_transaction_amount, COUNT(t.transaction_id) / COUNT(DISTINCT c.customer_id) as avg_transaction_count FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id AND t.transaction_date >= date('now') - INTERVAL '90 days' GROUP BY c.risk_level
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3932804573, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, c.credit_score FROM customers c WHERE c.risk_level = '高' AND c.credit_score < 700;
执行预测SQL: SELECT customer_id AS 客户ID, customer_name AS 客户名称, credit_score AS 信用评分 FROM customers WHERE risk_level = '高' AND credit_score < 700
标准SQL执行成功，行数: 2249
预测SQL执行成功，行数: 2249
执行查询: ID=862533692, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.credit_score, t.transaction_id, t.status FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.status = '失败';
执行预测SQL: SELECT 
    c.customer_id AS customer_id,
    c.credit_score AS credit_score,
    t.transaction_id AS transaction_id,
    t.status AS status
FROM 
    customers c
JOIN (
    SELECT 
        transaction_id, 
        customer_id, 
        status, 
        transaction_date
    FROM 
        transactions
    WHERE 
        status = '失败'
    AND (customer_id, transaction_date) IN (
        SELECT 
            customer_id, 
            MAX(transaction_date)
        FROM 
            transactions
        WHERE 
            status = '失败'
        GROUP BY 
            customer_id
    )
) t ON c.customer_id = t.customer_id
标准SQL执行成功，行数: 3258
预测SQL执行成功，行数: 3258
执行查询: ID=2759801136, DB=risk_control
执行标准SQL: SELECT ra.assessment_id, ra.event_id, c.customer_id, c.customer_name, c.credit_score FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id JOIN transactions t ON re.event_id = t.event_id JOIN customers c ON t.customer_id = c.customer_id WHERE ra.risk_level = '高' AND c.credit_score > 700
执行预测SQL: SELECT ra.assessment_id AS assessment_id, ra.event_id AS event_id, t.customer_id AS customer_id, c.customer_name AS customer_name, c.credit_score AS credit_score FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id JOIN transactions t ON re.event_id = t.event_id JOIN customers c ON t.customer_id = c.customer_id WHERE ra.risk_level = 'high' AND c.credit_score > 700
标准SQL执行成功，行数: 1114
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1114行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1448319074, DB=risk_control
执行标准SQL: SELECT * FROM customers WHERE customer_type = '企业' ORDER BY credit_score DESC LIMIT 10
执行预测SQL: SELECT customer_id AS customer_id, customer_name AS customer_name, customer_type AS customer_type, credit_score AS credit_score, risk_level AS risk_level, registration_date AS registration_date, last_update_date AS last_update_date FROM customers WHERE customer_type = '企业' ORDER BY credit_score DESC LIMIT 10
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: 10
执行查询: ID=2148910450, DB=risk_control
执行标准SQL: SELECT DATE_TRUNC('month', created_at) as month, COUNT(*) as new_rules, AVG(SUM(CASE WHEN is_active THEN 1 ELSE 0 END)) OVER (ORDER BY DATE_TRUNC('month', created_at) ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) as avg_active_rules FROM rule_configurations GROUP BY DATE_TRUNC('month', created_at) ORDER BY month
执行预测SQL: SELECT DATE_TRUNC('month', created_at) AS month, COUNT(*) AS new_rules, COUNT(CASE WHEN is_active THEN 1 END) AS avg_active_rules FROM rule_configurations GROUP BY DATE_TRUNC('month', created_at) ORDER BY month
标准SQL执行成功，行数: 12
预测SQL执行成功，行数: 12

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [avg_active_rules month new_rules]
[35m预测SQL列:[0m [avg_active_rules month new_rules]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [675 2023-01-01 00:00:00 +0000 +0000 846]
[35m预测[1]:[0m [675 2023-01-01 00:00:00 +0000 +0000 846]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [659.5 2023-02-01 00:00:00 +0000 +0000 819]
[35m预测[2]:[0m [644 2023-02-01 00:00:00 +0000 +0000 819]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [665.6666666666666 2023-03-01 00:00:00 +0000 +0000 860]
[35m预测[3]:[0m [678 2023-03-01 00:00:00 +0000 +0000 860]
执行查询: ID=3303778848, DB=risk_control
执行标准SQL: SELECT rr.author, rr.approval_status FROM risk_reports rr WHERE rr.approval_status = '已批准';
执行预测SQL: SELECT author AS report_author, approval_status AS approval_status FROM risk_reports WHERE approval_status = '已批准'
标准SQL执行成功，行数: 3284
预测SQL执行成功，行数: 3284
执行查询: ID=2919479377, DB=risk_control
执行标准SQL: SELECT c.customer_name, t.amount, t.status FROM customers c JOIN transactions t ON c.customer_id = t.customer_id;
执行预测SQL: SELECT customers.customer_name AS customer_name, transactions.amount AS transaction_amount, transactions.status AS transaction_status FROM customers INNER JOIN transactions ON customers.customer_id = transactions.customer_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3408098582, DB=risk_control
执行标准SQL: SELECT re.event_id, ra.assessment_id, ra.risk_level FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id;
执行预测SQL: SELECT risk_events.event_id AS event_id, risk_assessments.assessment_id AS assessment_id, risk_assessments.risk_level AS risk_level FROM risk_events INNER JOIN risk_assessments ON risk_events.event_id = risk_assessments.event_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3536942222, DB=risk_control
执行标准SQL: SELECT ri.indicator_id, ri.indicator_name, ri.threshold_value, AVG(rml.actual_value) as avg_actual_value FROM risk_indicators ri LEFT JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id GROUP BY ri.indicator_id, ri.indicator_name, ri.threshold_value
执行预测SQL: SELECT ri.indicator_id AS indicator_id, ri.indicator_name AS indicator_name, ri.threshold_value AS threshold_value, AVG(rml.actual_value) AS avg_actual_value 
FROM risk_indicators ri 
JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id 
GROUP BY ri.indicator_id, ri.indicator_name, ri.threshold_value
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 810/1042 个查询...
执行查询: ID=3025435441, DB=risk_control
执行标准SQL: SELECT rr.report_id, rr.report_type, rr.report_content, re.event_type, re.event_description FROM risk_reports rr JOIN risk_events re ON rr.event_id = re.event_id WHERE rr.approval_status = '已批准'
执行预测SQL: SELECT r.report_id AS report_id, r.report_type AS report_type, r.report_content AS report_content, re.event_type AS event_type, re.event_description AS event_description FROM risk_reports r INNER JOIN risk_events re ON r.event_id = re.event_id WHERE r.approval_status = '已批准'
标准SQL执行成功，行数: 3284
预测SQL执行成功，行数: 3284
执行查询: ID=3761432717, DB=risk_control
执行标准SQL: SELECT DISTINCT c.customer_id, c.customer_name, t.transaction_date FROM customers c JOIN transactions t ON c.customer_id = t.customer_id JOIN alerts a ON t.event_id = a.event_id WHERE t.risk_score > 80 AND a.alert_level = '高' AND DATE(t.transaction_date) = DATE(a.alert_time)
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=3404778014, DB=risk_control
执行标准SQL: SELECT t.transaction_id, c.customer_name FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.risk_score > 15;
执行预测SQL: SELECT t.transaction_id AS transaction_id, c.customer_name AS customer_name
FROM transactions t
JOIN customers c ON t.customer_id = c.customer_id
WHERE t.risk_score >= 80
标准SQL执行成功，行数: 8523
预测SQL执行成功，行数: 2150

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回8523行, 预测SQL返回2150行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [transaction_id customer_name]
[35m预测SQL列:[0m [customer_name transaction_id]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [TR0001 兴业科技有限公司]
[35m预测[1]:[0m [吴丽 TR0002]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [TR0002 吴丽]
[35m预测[2]:[0m [创联地产有限公司 TR0012]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [TR0006 长江教育有限公司]
[35m预测[3]:[0m [李秀英 TR0013]
执行查询: ID=3200534548, DB=risk_control
执行标准SQL: SELECT re.event_description, ra.assessment_date FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE ra.risk_level = '高'
执行预测SQL: SELECT re.event_description AS event_description, ra.assessment_date AS assessment_date FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id WHERE ra.risk_level = '高'
标准SQL执行成功，行数: 3363
预测SQL执行成功，行数: 3363
执行查询: ID=698660188, DB=risk_control
执行标准SQL: SELECT c.customer_name, t.status FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.risk_level = '高' AND t.status = '失败';
执行预测SQL: SELECT c.customer_name AS customer_name, t.status AS transaction_status 
FROM customers c 
JOIN (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY transaction_date DESC) AS rn 
    FROM transactions 
    WHERE status = '失败'
) t ON c.customer_id = t.customer_id 
WHERE c.risk_level = '高' AND t.rn = 1
标准SQL执行成功，行数: 1088
预测SQL执行成功，行数: 1088
执行查询: ID=756643276, DB=risk_control
执行标准SQL: SELECT re.event_id, COUNT(t.transaction_id) AS transaction_count FROM risk_events re LEFT JOIN transactions t ON re.event_id = t.event_id GROUP BY re.event_id;
执行预测SQL: SELECT event_id, COUNT(*) AS transaction_count FROM transactions GROUP BY event_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1961596891, DB=risk_control
执行标准SQL: SELECT t.transaction_id, t.amount, t.transaction_date, c.customer_name, c.risk_level FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE c.risk_level = '高' AND t.amount > 500000 AND t.transaction_date BETWEEN '2023-01-01' AND '2023-03-31' ORDER BY t.amount DESC
执行预测SQL: SELECT 
    transactions.transaction_id AS transaction_id,
    transactions.amount AS amount,
    transactions.transaction_date AS transaction_date,
    customers.customer_name AS customer_name,
    customers.risk_level AS risk_level
FROM 
    transactions
JOIN 
    customers ON transactions.customer_id = customers.customer_id
WHERE 
    customers.risk_level = '高' 
    AND transactions.amount > 500000 
    AND transactions.transaction_date BETWEEN '2023-01-01' AND '2023-03-31'
标准SQL执行成功，行数: 432
预测SQL执行成功，行数: 432
执行查询: ID=1488802626, DB=risk_control
执行标准SQL: SELECT re.event_id, re.event_description, re.severity, ra.risk_level, ra.mitigation_plan FROM risk_events re LEFT JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE EXTRACT(YEAR FROM re.occurrence_time) = 2023 AND re.severity IN (4, 5) ORDER BY re.severity DESC, re.occurrence_time
执行预测SQL: SELECT re.event_id AS event_id, re.event_description AS event_description, re.severity AS severity, ra.risk_level AS risk_level, ra.mitigation_plan AS mitigation_plan FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE EXTRACT(YEAR FROM re.occurrence_time) = 2023 AND re.severity IN (4,5)
标准SQL执行成功，行数: 4069
预测SQL执行成功，行数: 4069
执行查询: ID=3027811751, DB=risk_control
执行标准SQL: SELECT ml.log_id, ml.notes FROM risk_monitoring_logs ml WHERE ml.is_exceeding_threshold = FALSE;
执行预测SQL: SELECT log_id AS 监控日志ID, notes AS 备注 FROM risk_monitoring_logs WHERE is_exceeding_threshold = false
标准SQL执行成功，行数: 7047
预测SQL执行成功，行数: 7047
执行查询: ID=1296190191, DB=risk_control
执行标准SQL: SELECT r.report_id, r.report_type, r.author, e.event_type, e.severity, al.audit_result, al.audit_comments FROM risk_reports r JOIN risk_events e ON r.event_id = e.event_id LEFT JOIN (SELECT event_id, audit_result, audit_comments, ROW_NUMBER() OVER (PARTITION BY event_id ORDER BY audit_time DESC) as rn FROM audit_logs) al ON e.event_id = al.event_id AND al.rn = 1 WHERE r.approval_status = '待审批' ORDER BY e.severity DESC, r.report_date DESC;
执行预测SQL: SELECT r.report_id AS report_id, r.report_type AS report_type, r.author AS author, re.event_type AS event_type, re.severity AS severity, a.audit_result AS audit_result, a.audit_comments AS audit_comments 
FROM risk_reports r 
JOIN risk_events re ON r.event_id = re.event_id 
LEFT JOIN audit_logs a ON r.report_id = a.related_id 
WHERE r.approval_status = '待审批' 
ORDER BY r.report_id
标准SQL执行成功，行数: 3284
预测SQL执行成功，行数: 3284

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [report_id report_type author event_type severity audit_result audit_comments]
[35m预测SQL列:[0m [report_id report_type author event_type severity audit_result audit_comments]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [RR6678 专项风险报告 陈强 操作风险 5 通过 审核完成，需要补充材料]
[35m预测[1]:[0m [RR#### 月度风险报告 刘芳 信用风险 5 <nil> <nil>]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [RR7565 专项风险报告 刘芳 操作风险 5 拒绝 <nil>]
[35m预测[2]:[0m [RR0005 年度风险总结 郑华 流动性风险 2 <nil> <nil>]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [RR6334 季度风险评估 张立 流动性风险 5 需进一步调查 审核完成，存在风险]
[35m预测[3]:[0m [RR0006 专项风险报告 孙宇 操作风险 3 <nil> <nil>]
已处理 820/1042 个查询...
执行查询: ID=2631012035, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, c.credit_score, c.risk_level FROM customers c WHERE c.registration_date >= '2021-01-01' AND c.registration_date < '2022-01-01' AND c.risk_level = '高' AND c.credit_score < 550;
执行预测SQL: SELECT customer_id AS customer_id, customer_name AS customer_name, credit_score AS credit_score, risk_level AS risk_level FROM customers WHERE EXTRACT(YEAR FROM registration_date) = 2021 AND risk_level = '高' AND credit_score < 550
标准SQL执行成功，行数: 215
预测SQL执行成功，行数: 215
执行查询: ID=2342271424, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, t.transaction_id, t.amount, t.transaction_date, CASE WHEN al.alert_id IS NOT NULL THEN 'Yes' ELSE 'No' END as triggered_alert FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id LEFT JOIN alerts al ON t.transaction_id = al.event_id WHERE t.transaction_date = (SELECT MAX(transaction_date) FROM transactions WHERE customer_id = c.customer_id)
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=2292865545, DB=risk_control
执行标准SQL: SELECT re.event_type, COUNT(re.event_id) AS event_count FROM risk_events re GROUP BY re.event_type;
执行预测SQL: SELECT event_type, COUNT(*) AS event_count FROM risk_events GROUP BY event_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=3057920994, DB=risk_control
执行标准SQL: SELECT c.customer_name, rc.rule_name, COUNT(*) AS trigger_count FROM customers c JOIN transactions t ON c.customer_id = t.customer_id JOIN alerts a ON t.event_id = a.event_id JOIN rule_configurations rc ON a.rule_id = rc.rule_id WHERE c.risk_level = '高' GROUP BY c.customer_id, c.customer_name, rc.rule_id, rc.rule_name ORDER BY trigger_count DESC, c.customer_name
执行预测SQL: SELECT 
    c.customer_name,
    rc.rule_name,
    COUNT(*) AS trigger_count
FROM 
    customers c
JOIN 
    transactions t ON c.customer_id = t.customer_id
JOIN 
    risk_events re ON t.event_id = re.event_id
JOIN 
    alerts a ON re.event_id = a.event_id
JOIN 
    rule_configurations rc ON a.rule_id = rc.rule_id
WHERE 
    c.risk_level = '高'
GROUP BY 
    c.customer_name, rc.rule_name
标准SQL执行成功，行数: 3366
预测SQL执行成功，行数: 994

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回3366行, 预测SQL返回994行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [customer_name rule_name trigger_count]
[35m预测SQL列:[0m [customer_name rule_name trigger_count]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [中天制造有限公司 可疑交易监控规则## 1]
[35m预测[1]:[0m [吴秀英 可疑交易监控规则## 3]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [中天制造有限公司 跨境交易监控规则## 1]
[35m预测[2]:[0m [刘丽 可疑交易监控规则## 6]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [中天制造有限公司 频繁交易监控规则## 1]
[35m预测[3]:[0m [吴丽 大额交易监控规则## 5]
执行查询: ID=1563461822, DB=risk_control
执行标准SQL: SELECT DATE_TRUNC('month', re.occurrence_time) as month, re.event_type, COUNT(*) as event_count, AVG(re.severity) as avg_severity, SUM(CASE WHEN re.status = '已解决' THEN 1 ELSE 0 END) / COUNT(*) as resolution_rate FROM risk_events re GROUP BY DATE_TRUNC('month', re.occurrence_time), re.event_type ORDER BY month, re.event_type
执行预测SQL: SELECT 
  EXTRACT(YEAR FROM occurrence_time) * 100 + EXTRACT(MONTH FROM occurrence_time) AS month,
  event_type,
  COUNT(*) AS event_count,
  AVG(severity) AS avg_severity,
  SUM(CASE WHEN status = 'closed' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS resolution_rate
FROM risk_events
GROUP BY 
  EXTRACT(YEAR FROM occurrence_time) * 100 + EXTRACT(MONTH FROM occurrence_time),
  event_type
标准SQL执行成功，行数: 60
预测SQL执行成功，行数: 60

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [month event_type event_count avg_severity resolution_rate]
[35m预测SQL列:[0m [month event_type event_count avg_severity resolution_rate]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [2023-01-01 00:00:00 +0000 +0000 信用风险 162 3.0987654320987654 0]
[35m预测[1]:[0m [202306 市场风险 169 3.0236686390532546 0]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [2023-01-01 00:00:00 +0000 +0000 合规风险 144 2.9791666666666665 0]
[35m预测[2]:[0m [202307 流动性风险 157 3.184713375796178 0]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [2023-01-01 00:00:00 +0000 +0000 市场风险 180 3.011111111111111 0]
[35m预测[3]:[0m [202306 流动性风险 141 3.1702127659574466 0]
执行查询: ID=2699040253, DB=risk_control
执行标准SQL: SELECT ml.monitoring_date, ml.actual_value, ri.threshold_value FROM risk_monitoring_logs ml JOIN risk_indicators ri ON ml.indicator_id = ri.indicator_id;
执行预测SQL: SELECT rm.monitoring_date AS monitoring_date, rm.actual_value AS actual_value, ri.threshold_value AS threshold_value FROM risk_monitoring_logs rm JOIN risk_indicators ri ON rm.indicator_id = ri.indicator_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2609391365, DB=risk_control
执行标准SQL: SELECT c.risk_level, t.transaction_type, AVG(t.amount) AS avg_transaction_amount FROM customers c JOIN transactions t ON c.customer_id = t.customer_id GROUP BY c.risk_level, t.transaction_type ORDER BY c.risk_level, avg_transaction_amount DESC
执行预测SQL: SELECT customers.risk_level, transactions.transaction_type, AVG(transactions.amount) AS avg_transaction_amount FROM customers JOIN transactions ON customers.customer_id = transactions.customer_id GROUP BY customers.risk_level, transactions.transaction_type
标准SQL执行成功，行数: 15
预测SQL执行成功，行数: 15
执行查询: ID=1646275357, DB=risk_control
执行标准SQL: SELECT COUNT(*) FROM rule_configurations WHERE is_active = true
执行预测SQL: SELECT COUNT(*) AS count FROM rule_configurations WHERE is_active = true
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=3640375109, DB=risk_control
执行标准SQL: SELECT customer_id, customer_name, risk_level, credit_score FROM customers;
执行预测SQL: SELECT customer_id AS customer_id, customer_name AS customer_name, risk_level AS risk_level, credit_score AS credit_score FROM customers
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1137138067, DB=risk_control
执行标准SQL: SELECT COUNT(*), AVG(update_frequencyerval) FROM risk_indicators WHERE threshold_value > 100;
标准SQL执行错误: SQL执行失败: pq: column "update_frequencyerval" does not exist
执行预测SQL: SELECT COUNT(*) AS threshold_count, AVG(CAST(update_frequency AS numeric)) AS avg_update_frequency FROM risk_indicators WHERE threshold_value > 100
标准SQL执行错误: SQL执行失败: pq: column "update_frequencyerval" does not exist
已处理 830/1042 个查询...
执行查询: ID=674388735, DB=risk_control
执行标准SQL: SELECT customer_name, registration_date FROM customers;
执行预测SQL: SELECT customer_name AS customer_name, registration_date AS registration_date FROM customers
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2598937105, DB=risk_control
执行标准SQL: SELECT ri.indicator_id, ri.indicator_name, ml.log_id, ml.actual_value, ml.is_exceeding_threshold FROM risk_indicators ri JOIN risk_monitoring_logs ml ON ri.indicator_id = ml.indicator_id;
执行预测SQL: SELECT rm.log_id AS log_id, ri.indicator_id AS indicator_id, rm.actual_value AS actual_value, rm.is_exceeding_threshold AS is_exceeding_threshold, ri.indicator_name AS indicator_name FROM risk_monitoring_logs rm JOIN risk_indicators ri ON rm.indicator_id = ri.indicator_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=62865185, DB=risk_control
执行标准SQL: SELECT ri.indicator_id, ri.indicator_name, ri.data_source, AVG(rml.actual_value) AS avg_value, STDDEV(rml.actual_value) AS stddev_value FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id GROUP BY ri.indicator_id, ri.indicator_name, ri.data_source
执行预测SQL: SELECT ri.indicator_id, ri.indicator_name, ri.data_source, AVG(rml.actual_value) AS avg_value, STDDEV(rml.actual_value) AS stddev_value FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id GROUP BY ri.indicator_id, ri.indicator_name, ri.data_source
执行查询: ID=185839438, DB=risk_control
执行标准SQL: SELECT al.audit_id, al.audit_result, al.auditor FROM audit_logs al WHERE al.audit_result = '拒绝';
执行预测SQL: SELECT audit_id AS audit_id, audit_result AS audit_result, auditor AS auditor FROM audit_logs WHERE audit_result = '拒绝'
标准SQL执行成功，行数: 3331
预测SQL执行成功，行数: 3331
执行查询: ID=3165460471, DB=risk_control
执行标准SQL: SELECT alert_type, alert_content FROM alerts;
执行预测SQL: SELECT alert_type AS alert_type, alert_content AS alert_content FROM alerts
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3849483796, DB=risk_control
执行标准SQL: SELECT a.alert_id, a.alert_type, a.alert_content, e.event_description, al.audit_result, al.audit_comments FROM alerts a JOIN risk_events e ON a.event_id = e.event_id LEFT JOIN (SELECT alert_id, audit_result, audit_comments, ROW_NUMBER() OVER (PARTITION BY alert_id ORDER BY audit_time DESC) as rn FROM audit_logs) al ON a.alert_id = al.alert_id AND al.rn = 1 WHERE a.status = '未处理' ORDER BY a.alert_time DESC;
执行预测SQL: SELECT a.alert_id AS alert_id, a.alert_type AS alert_type, a.alert_content AS alert_content, re.event_description AS event_description, al.audit_result AS audit_result, al.audit_comments AS audit_comments 
FROM alerts a 
JOIN risk_events re ON a.event_id = re.event_id 
JOIN (
    SELECT alert_id, audit_result, audit_comments
    FROM (
        SELECT alert_id, audit_result, audit_comments, 
        ROW_NUMBER() OVER (PARTITION BY alert_id ORDER BY audit_time DESC) AS rn
        FROM audit_logs
        WHERE alert_id IS NOT NULL
    ) sub
    WHERE rn = 1
) al ON a.alert_id = al.alert_id 
WHERE a.status = 'open'
标准SQL执行成功，行数: 3306
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回3306行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1990473038, DB=risk_control
执行标准SQL: SELECT AVG(EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - alert_time))) AS average_alert_time FROM alerts WHERE status = '未处理';
执行预测SQL: SELECT AVG(EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - alert_time))) AS average_alert_time
FROM alerts
WHERE status = '未处理'
执行查询: ID=3119334868, DB=risk_control
执行标准SQL: WITH risk_stats AS (SELECT c.customer_id, COUNT(ra.assessment_id) AS assessment_count, AVG(CASE WHEN ra.risk_level = '高' THEN 3 WHEN ra.risk_level = '中' THEN 2 ELSE 1 END) AS avg_risk_score, COUNT(a.alert_id) AS alert_count FROM customers c LEFT JOIN risk_assessments ra ON c.customer_id = ra.event_id LEFT JOIN alerts a ON c.customer_id = a.event_id GROUP BY c.customer_id) SELECT rs.customer_id, c.customer_name, c.risk_level, (rs.assessment_count * rs.avg_risk_score + rs.alert_count * 2) AS risk_index FROM risk_stats rs JOIN customers c ON rs.customer_id = c.customer_id ORDER BY risk_index DESC
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2458967882, DB=risk_control
执行标准SQL: SELECT event_type, COUNT(*) as event_count FROM risk_events WHERE status = '未处理' GROUP BY event_type;
执行预测SQL: SELECT event_type, COUNT(*) AS event_count FROM risk_events WHERE status = '未处理' GROUP BY event_type
执行查询: ID=4081376750, DB=risk_control
执行标准SQL: SELECT t.* FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.risk_level = '低' AND c.credit_score > 700;
执行预测SQL: SELECT t.transaction_id AS transaction_id, t.customer_id AS customer_id, t.transaction_type AS transaction_type, t.amount AS amount, t.transaction_date AS transaction_date, t.status AS status, t.risk_score AS risk_score, t.event_id AS event_id FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE c.risk_level = '低' AND c.credit_score > 700
标准SQL执行成功，行数: 1146
预测SQL执行成功，行数: 1146
已处理 840/1042 个查询...
执行查询: ID=2952805928, DB=risk_control
执行标准SQL: SELECT a.alert_id, a.alert_type, a.alert_content, a.alert_level, re.event_id, re.event_type, re.severity FROM alerts a LEFT JOIN risk_events re ON a.event_id = re.event_id WHERE a.status = '未处理' AND a.alert_level = '高'
执行预测SQL: SELECT 
    alerts.alert_id AS alert_id,
    alerts.alert_type AS alert_type,
    alerts.alert_content AS alert_content,
    alerts.alert_level AS alert_level,
    alerts.event_id AS event_id,
    risk_events.event_type AS event_type,
    risk_events.severity AS severity
FROM alerts
INNER JOIN risk_events ON alerts.event_id = risk_events.event_id
WHERE alerts.status = '未处理' AND alerts.alert_level = '高'
标准SQL执行成功，行数: 1104
预测SQL执行成功，行数: 1104
执行查询: ID=790231894, DB=risk_control
执行标准SQL: SELECT alert_content, status FROM alerts WHERE rule_id IN (SELECT rule_id FROM rule_configurations WHERE rule_type = '合规检查');
执行预测SQL: SELECT a.alert_content AS alert_content, a.status AS status FROM alerts a JOIN rule_configurations rc ON a.rule_id = rc.rule_id WHERE rc.rule_type = '合规检查'
标准SQL执行成功，行数: 1984
预测SQL执行成功，行数: 1984
执行查询: ID=76184048, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.risk_level, SUM(t.amount) AS total_transaction_amount FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.risk_level = '高' GROUP BY c.customer_id, c.risk_level;
执行预测SQL: SELECT c.customer_id, c.risk_level, SUM(t.amount) AS total_transaction_amount 
FROM customers c 
JOIN transactions t ON c.customer_id = t.customer_id 
WHERE t.risk_score >= 80 
GROUP BY c.customer_id, c.risk_level
标准SQL执行成功，行数: 3366
预测SQL执行成功，行数: 2150

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回3366行, 预测SQL返回2150行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [customer_id risk_level total_transaction_amount]
[35m预测SQL列:[0m [total_transaction_amount customer_id risk_level]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [CU3531 高 170317.59]
[35m预测[1]:[0m [874076.73 CU8450 高]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [CU3939 高 200999.15]
[35m预测[2]:[0m [50816.14 CU6605 中]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [CU0690 高 220345.82]
[35m预测[3]:[0m [332555.45 CU3660 高]
执行查询: ID=291950371, DB=risk_control
执行标准SQL: SELECT report_content FROM risk_reports WHERE report_type = '月度风险报告' AND approval_status = '已拒绝';
执行预测SQL: SELECT report_content AS report_content FROM risk_reports WHERE report_type = '月度风险报告' AND approval_status = '已拒绝'
标准SQL执行成功，行数: 654
预测SQL执行成功，行数: 654
执行查询: ID=2809252635, DB=risk_control
执行标准SQL: SELECT re.event_type, COUNT(re.event_id) AS event_count FROM risk_events re GROUP BY re.event_type;
执行预测SQL: SELECT event_type, COUNT(*) AS event_count FROM risk_events GROUP BY event_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=184311181, DB=risk_control
执行标准SQL: SELECT c.customer_name, t.amount, t.transaction_date FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.transaction_type = '转账' AND t.amount > 200000 AND t.transaction_date >= '2023-05-04 00:00:00' AND t.transaction_date < '2023-05-05 00:00:00';
执行预测SQL: SELECT customers.customer_name AS customer_name, transactions.amount AS amount, transactions.transaction_date AS transaction_date 
FROM transactions 
JOIN customers ON transactions.customer_id = customers.customer_id 
WHERE transactions.transaction_date::date = '2023-05-04' 
AND transactions.amount > 200000 
AND transactions.transaction_type = '转账'
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=1539184065, DB=risk_control
执行标准SQL: SELECT a.alert_id, a.alert_content, a.alert_level, a.assigned_to, e.event_description FROM alerts a JOIN risk_events e ON a.event_id = e.event_id WHERE a.status = '未处理' AND a.alert_level = '高'
执行预测SQL: SELECT a.alert_id AS alert_id, a.alert_content AS alert_content, a.alert_level AS alert_level, a.assigned_to AS assigned_to, re.event_description AS event_description FROM alerts a JOIN risk_events re ON a.event_id = re.event_id WHERE a.status = 'open' AND a.alert_level = 'high'
标准SQL执行成功，行数: 1104
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1104行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3408938184, DB=risk_control
执行标准SQL: SELECT rr.report_id, rr.report_content FROM risk_reports rr WHERE rr.approval_status = '已批准' AND rr.approved_by = '高志远' AND rr.report_date = '2023-04-01';
执行预测SQL: SELECT report_id AS report_id, report_content AS report_content FROM risk_reports WHERE report_date BETWEEN '2023-04-01' AND '2023-04-30' AND approved_by = '高志远'
标准SQL执行成功，行数: 3
预测SQL执行成功，行数: 158

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回3行, 预测SQL返回158行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [report_id report_content]
[35m预测SQL列:[0m [report_id report_content]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [RR1917 报告概述了合规风险的现状，分析了潜在影响，并提出了风险控制的建议。]
[35m预测[1]:[0m [RR0017 报告概述了合规风险的现状，分析了潜在影响，并提出了风险转移的建议。]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [RR8050 报告概述了合规风险的现状，分析了潜在影响，并提出了风险接受的建议。]
[35m预测[2]:[0m [RR0041 报告概述了信用风险的现状，分析了潜在影响，并提出了风险规避的建议。]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [RR8443 报告概述了合规风险的现状，分析了潜在影响，并提出了风险接受的建议。]
[35m预测[3]:[0m [RR0162 报告概述了操作风险的现状，分析了潜在影响，并提出了风险转移的建议。]
执行查询: ID=547284006, DB=risk_control
执行标准SQL: SELECT transaction_type, 
       COUNT(CASE WHEN status = '成功' THEN 1 END) AS success_count, 
       COUNT(CASE WHEN status = '失败' THEN 1 END) AS failure_count 
FROM transactions 
GROUP BY transaction_type;
执行预测SQL: SELECT 
    transaction_type,
    SUM(CASE WHEN status = '成功' THEN 1 ELSE 0 END) AS success_count,
    SUM(CASE WHEN status = '失败' THEN 1 ELSE 0 END) AS failure_count
FROM transactions
GROUP BY transaction_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=2791172353, DB=risk_control
执行标准SQL: SELECT re.event_id, ra.risk_level FROM risk_events re LEFT JOIN risk_assessments ra ON re.event_id = ra.event_id ORDER BY ra.assessment_date DESC;
执行预测SQL: SELECT re.event_id AS event_id, ra.risk_level AS latest_risk_level FROM risk_events re JOIN (SELECT event_id, risk_level, assessment_date, ROW_NUMBER() OVER (PARTITION BY event_id ORDER BY assessment_date DESC) AS rn FROM risk_assessments) ra ON re.event_id = ra.event_id WHERE ra.rn = 1
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 850/1042 个查询...
执行查询: ID=616009086, DB=risk_control
执行标准SQL: SELECT c.customer_name, COUNT(DISTINCT ra.assessment_id) as high_risk_assessment_count, COUNT(DISTINCT t.transaction_id) as large_transaction_count FROM customers c JOIN transactions t ON c.customer_id = t.customer_id JOIN risk_assessments ra ON t.event_id = ra.event_id WHERE ra.risk_level = '高' AND t.amount > 500000 AND t.transaction_date >= date('now') - INTERVAL '1 year' GROUP BY c.customer_id, c.customer_name HAVING COUNT(DISTINCT ra.assessment_id) > 0 AND COUNT(DISTINCT t.transaction_id) > 0 ORDER BY high_risk_assessment_count DESC, large_transaction_count DESC;
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=2755424699, DB=risk_control
执行标准SQL: SELECT * FROM transactions WHERE customer_id = 'CU2534';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=3357225905, DB=risk_control
执行标准SQL: SELECT event_id, MAX(severity) AS max_severity FROM risk_events GROUP BY event_id;
执行预测SQL: SELECT event_id, MAX(severity) AS max_severity FROM risk_events GROUP BY event_id
执行查询: ID=2507883319, DB=risk_control
执行标准SQL: SELECT c.risk_level, COUNT(DISTINCT c.customer_id) as customer_count, AVG(t.amount) as avg_transaction_amount FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id GROUP BY c.risk_level
执行预测SQL: SELECT c.risk_level, COUNT(DISTINCT c.customer_id) AS customer_count, AVG(sub.total_amount) AS avg_transaction_amount 
FROM customers c 
JOIN transactions t ON c.customer_id = t.customer_id 
JOIN (SELECT customer_id, SUM(amount) AS total_amount FROM transactions GROUP BY customer_id) sub 
ON c.customer_id = sub.customer_id 
GROUP BY c.risk_level
标准SQL执行成功，行数: 3
预测SQL执行成功，行数: 3
执行查询: ID=2171757699, DB=risk_control
执行标准SQL: SELECT audit_time, audit_result FROM audit_logs WHERE auditor = '张强';
执行预测SQL: SELECT audit_time AS 审核时间, audit_result AS 审核结果 FROM audit_logs WHERE auditor = '张强'
标准SQL执行成功，行数: 1030
预测SQL执行成功，行数: 1030
执行查询: ID=1791933892, DB=risk_control
执行标准SQL: SELECT ml.log_id, ml.actual_value, ml.is_exceeding_threshold, ri.indicator_name FROM risk_monitoring_logs ml JOIN risk_indicators ri ON ml.indicator_id = ri.indicator_id;
执行预测SQL: SELECT rm.log_id AS log_id, rm.actual_value AS actual_value, rm.is_exceeding_threshold AS is_exceeding_threshold, ri.indicator_name AS indicator_name FROM risk_monitoring_logs rm JOIN risk_indicators ri ON rm.indicator_id = ri.indicator_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=4281611752, DB=risk_control
执行标准SQL: SELECT ri.indicator_name, COUNT(*) as exceed_count, AVG((rml.actual_value - ri.threshold_value) / ri.threshold_value * 100) as avg_exceed_percentage FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id WHERE rml.is_exceeding_threshold = true AND EXTRACT(YEAR FROM rml.monitoring_date) = 2023 GROUP BY ri.indicator_id, ri.indicator_name ORDER BY exceed_count DESC;
执行预测SQL: SELECT ri.indicator_name, COUNT(*) AS exceed_count, AVG((rm.actual_value - ri.threshold_value) / ri.threshold_value * 100) AS avg_exceed_percentage FROM risk_indicators ri JOIN risk_monitoring_logs rm ON ri.indicator_id = rm.indicator_id WHERE rm.monitoring_date >= '2023-01-01' AND rm.monitoring_date < '2024-01-01' AND rm.is_exceeding_threshold = true GROUP BY ri.indicator_name
标准SQL执行成功，行数: 2953
预测SQL执行成功，行数: 30

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2953行, 预测SQL返回30行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [indicator_name exceed_count avg_exceed_percentage]
[35m预测SQL列:[0m [indicator_name exceed_count avg_exceed_percentage]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [流动性覆盖率01 1 118.11562224183584]
[35m预测[1]:[0m [杠杆率## 616 210.59002658429395]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [不良贷款率02 1 -67.83224645828649]
[35m预测[2]:[0m [杠杆率30 1 48.7379098844067]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [不良贷款率06 1 27.096924510717614]
[35m预测[3]:[0m [净稳定资金比例## 583 673.9389269660326]
执行查询: ID=2403947927, DB=risk_control
执行标准SQL: SELECT a.alert_id, a.alert_content, a.status FROM alerts a WHERE a.alert_time >= '2023-01-01' AND a.alert_time < '2024-01-01';
执行预测SQL: SELECT alert_id AS 预警ID, alert_content AS 预警内容, status AS 处理状态 FROM alerts WHERE alert_time >= '2023-01-01' AND alert_time < '2024-01-01'
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3007794799, DB=risk_control
执行标准SQL: SELECT ri.indicator_id, ri.indicator_name, ml.monitoring_date, ml.actual_value FROM risk_indicators ri JOIN risk_monitoring_logs ml ON ri.indicator_id = ml.indicator_id ORDER BY ml.monitoring_date DESC;
执行预测SQL: SELECT rml.indicator_id AS indicator_id, ri.indicator_name AS indicator_name, rml.monitoring_date AS monitoring_date, rml.actual_value AS actual_value FROM risk_monitoring_logs rml JOIN risk_indicators ri ON rml.indicator_id = ri.indicator_id WHERE (rml.indicator_id, rml.monitoring_date) IN (SELECT indicator_id, MAX(monitoring_date) FROM risk_monitoring_logs GROUP BY indicator_id)
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3478580962, DB=risk_control
执行标准SQL: WITH indicator_stats AS (SELECT ri.indicator_id, ri.indicator_name, ri.threshold_value, COUNT(*) as total_checks, SUM(CASE WHEN rml.is_exceeding_threshold THEN 1 ELSE 0 END) as times_exceeded FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id WHERE rml.monitoring_date >= date('now') - INTERVAL '1 year' GROUP BY ri.indicator_id, ri.indicator_name, ri.threshold_value) SELECT indicator_name, threshold_value, times_exceeded, total_checks, ROUND(times_exceeded / total_checks * 100, 2) as exceed_percentage FROM indicator_stats ORDER BY times_exceeded DESC LIMIT 10;
执行预测SQL: SELECT 
    ri.indicator_name,
    ri.threshold_value,
    COUNT(CASE WHEN rm.is_exceeding_threshold THEN 1 END) AS times_exceeded,
    COUNT(*) AS total_checks,
    (COUNT(CASE WHEN rm.is_exceeding_threshold THEN 1 END) * 100.0 / COUNT(*)) AS exceed_percentage
FROM 
    risk_indicators ri
JOIN 
    risk_monitoring_logs rm ON ri.indicator_id = rm.indicator_id
WHERE 
    rm.monitoring_date >= CURRENT_DATE - INTERVAL '1 year'
GROUP BY 
    ri.indicator_id, ri.indicator_name, ri.threshold_value
ORDER BY 
    times_exceeded DESC
LIMIT 10
标准SQL执行成功，行数: -1
预测SQL执行成功，行数: -1
已处理 860/1042 个查询...
执行查询: ID=2835641813, DB=risk_control
执行标准SQL: SELECT risk_level, COUNT(customer_id) AS customer_count FROM customers GROUP BY risk_level;
执行预测SQL: SELECT risk_level AS risk_level, COUNT(*) AS customer_count FROM customers GROUP BY risk_level
标准SQL执行成功，行数: 3
预测SQL执行成功，行数: 3
执行查询: ID=3556405805, DB=risk_control
执行标准SQL: SELECT customer_id, risk_score, status FROM transactions;
执行预测SQL: SELECT customer_id AS customer_id, risk_score AS risk_score, status AS status FROM transactions
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1912282533, DB=risk_control
执行标准SQL: SELECT ra.assessment_id, ra.risk_level, t.transaction_id, t.risk_score FROM risk_assessments ra JOIN transactions t ON ra.event_id = t.event_id WHERE ra.risk_level = '高' AND t.risk_score < 50
执行预测SQL: SELECT ra.assessment_id AS assessment_id, ra.risk_level AS risk_level, t.transaction_id AS transaction_id, t.risk_score AS risk_score FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id JOIN transactions t ON re.event_id = t.event_id WHERE ra.risk_level = '高' AND t.risk_score < 50
标准SQL执行成功，行数: 1623
预测SQL执行成功，行数: 1623
执行查询: ID=966675168, DB=risk_control
执行标准SQL: SELECT transaction_type, COUNT(*) as success_count FROM transactions WHERE status = '成功' GROUP BY transaction_type ORDER BY success_count DESC LIMIT 1;
执行预测SQL: SELECT transaction_type, COUNT(*) AS success_count
FROM transactions
WHERE status = '成功'
GROUP BY transaction_type
ORDER BY success_count DESC
LIMIT 1
执行查询: ID=1657330121, DB=risk_control
执行标准SQL: SELECT t.transaction_id, t.amount, re.status FROM transactions t JOIN risk_events re ON t.event_id = re.event_id WHERE t.status = '失败' AND re.status = '已解决';
执行预测SQL: SELECT 
    t.transaction_id AS transaction_id,
    t.amount AS amount,
    t.status AS transaction_status
FROM 
    transactions t
JOIN 
    risk_events re ON t.event_id = re.event_id
WHERE 
    t.status = '失败' 
    AND re.status = '已解决'
标准SQL执行成功，行数: 1108
预测SQL执行成功，行数: 1108

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 列名不匹配且按位置比较数据不一致
[1m分类结果:[0m [35m投影错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [transaction_id amount status]
[35m预测SQL列:[0m [transaction_id amount transaction_status]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [TR0002 771401.19 已解决]
[35m预测[1]:[0m [TR0002 771401.19 失败]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [TR0004 921251.28 已解决]
[35m预测[2]:[0m [TR0004 921251.28 失败]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [TR0016 660256.83 已解决]
[35m预测[3]:[0m [TR0016 660256.83 失败]
执行查询: ID=2427884877, DB=risk_control
执行标准SQL: SELECT t.transaction_id, c.customer_name FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.status = '处理中';
执行预测SQL: SELECT transactions.transaction_id AS transaction_id, customers.customer_name AS customer_name FROM transactions JOIN customers ON transactions.customer_id = customers.customer_id WHERE transactions.status = '处理中'
标准SQL执行成功，行数: 3427
预测SQL执行成功，行数: 3427
执行查询: ID=2050953540, DB=risk_control
执行标准SQL: SELECT t.transaction_id, t.amount, re.event_description FROM transactions t JOIN risk_events re ON t.event_id = re.event_id WHERE t.amount > 1000;
执行预测SQL: SELECT t.transaction_id AS transaction_id, t.amount AS amount, re.event_description AS event_description FROM transactions t JOIN risk_events re ON t.event_id = re.event_id WHERE t.amount > 1000
标准SQL执行成功，行数: 9983
预测SQL执行成功，行数: 9983
执行查询: ID=2088100618, DB=risk_control
执行标准SQL: SELECT t.transaction_id, t.amount, t.transaction_date, c.customer_name, re.event_type, re.event_description FROM transactions t JOIN customers c ON t.customer_id = c.customer_id JOIN risk_events re ON t.event_id = re.event_id WHERE t.amount > 100000 AND c.risk_level = '高' AND t.transaction_date >= datetime('now') - INTERVAL '1 year'
标准SQL执行错误: SQL执行失败: pq: function datetime(unknown) does not exist
执行预测SQL: SELECT 
  t.transaction_id AS transaction_id,
  t.amount AS amount,
  t.transaction_date AS transaction_date,
  c.customer_name AS customer_name,
  re.event_type AS event_type,
  re.event_description AS event_description
FROM 
  transactions t
JOIN 
  customers c ON t.customer_id = c.customer_id
JOIN 
  risk_events re ON t.event_id = re.event_id
WHERE 
  t.amount > 100000
  AND t.transaction_date >= CURRENT_DATE - INTERVAL '1 year'
  AND c.risk_level = '高'
标准SQL执行错误: SQL执行失败: pq: function datetime(unknown) does not exist
执行查询: ID=4242999593, DB=risk_control
执行标准SQL: SELECT assessment_id, mitigation_plan FROM risk_assessments WHERE mitigation_plan IS NOT NULL;
执行预测SQL: SELECT assessment_id AS assessment_id, mitigation_plan AS mitigation_plan FROM risk_assessments WHERE mitigation_plan IS NOT NULL
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=4243946175, DB=risk_control
执行标准SQL: SELECT t.transaction_id, t.risk_score FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE c.risk_level = '高';
执行预测SQL: SELECT transactions.transaction_id AS transaction_id, transactions.risk_score AS risk_score FROM transactions JOIN customers ON transactions.customer_id = customers.customer_id WHERE customers.risk_level = '高'
标准SQL执行成功，行数: 3366
预测SQL执行成功，行数: 3366
已处理 870/1042 个查询...
执行查询: ID=1679294343, DB=risk_control
执行标准SQL: SELECT rml.actual_value, ri.indicator_name FROM risk_monitoring_logs rml JOIN risk_indicators ri ON rml.indicator_id = ri.indicator_id WHERE rml.actual_value < ri.threshold_value;
执行预测SQL: SELECT rm.actual_value AS actual_value, ri.indicator_name AS indicator_name FROM risk_monitoring_logs rm JOIN risk_indicators ri ON rm.indicator_id = ri.indicator_id WHERE rm.actual_value < ri.threshold_value
标准SQL执行成功，行数: 4968
预测SQL执行成功，行数: 4968
执行查询: ID=1824329950, DB=risk_control
执行标准SQL: SELECT rr.report_content, re.event_type, re.status FROM risk_reports rr JOIN risk_events re ON rr.event_id = re.event_id WHERE rr.approval_status = '已拒绝';
执行预测SQL: SELECT 
    rr.report_content AS report_content,
    re.event_type AS event_type,
    re.status AS status
FROM 
    risk_reports rr
JOIN 
    risk_events re ON rr.event_id = re.event_id
WHERE 
    rr.approval_status = '已拒绝'
标准SQL执行成功，行数: 3432
预测SQL执行成功，行数: 3432
执行查询: ID=888703769, DB=risk_control
执行标准SQL: SELECT DISTINCT c.customer_name, c.credit_score, c.registration_date, t.transaction_date FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.customer_type = '企业' AND c.registration_date >= '2021-01-01' AND c.registration_date < '2022-01-01' AND c.credit_score > 700 AND t.transaction_date >= datetime('now') - INTERVAL '1 year';
标准SQL执行错误: SQL执行失败: pq: function datetime(unknown) does not exist
执行预测SQL: SELECT DISTINCT c.customer_name AS customer_name, c.credit_score AS credit_score, c.registration_date AS registration_date, t.transaction_date AS transaction_date
FROM customers c
JOIN transactions t ON c.customer_id = t.customer_id
WHERE c.registration_date BETWEEN '2021-01-01' AND '2021-12-31'
  AND c.credit_score > 700
  AND t.transaction_date >= CURRENT_DATE - INTERVAL '1 year'
标准SQL执行错误: SQL执行失败: pq: function datetime(unknown) does not exist
执行查询: ID=411280576, DB=risk_control
执行标准SQL: SELECT a.alert_id, a.alert_type, a.alert_content, re.event_id, re.event_type, t.transaction_id, t.amount FROM alerts a LEFT JOIN risk_events re ON a.event_id = re.event_id LEFT JOIN transactions t ON re.event_id = t.event_id WHERE a.assigned_to = '陈强'
执行预测SQL: SELECT a.alert_id AS alert_id, a.alert_type AS alert_type, a.alert_content AS alert_content, a.event_id AS event_id, re.event_type AS event_type, t.transaction_id AS transaction_id, t.amount AS amount FROM alerts a JOIN risk_events re ON a.event_id = re.event_id JOIN transactions t ON re.event_id = t.event_id WHERE a.assigned_to = '陈强'
标准SQL执行成功，行数: 985
预测SQL执行成功，行数: 985
执行查询: ID=452369014, DB=risk_control
执行标准SQL: SELECT * FROM risk_reports WHERE report_content LIKE '%合规%';
执行预测SQL: SELECT report_id AS report_id, report_type AS report_type, report_date AS report_date, report_content AS report_content, author AS author, approval_status AS approval_status, approved_by AS approved_by, event_id AS event_id FROM risk_reports WHERE report_content LIKE '%合规%'
标准SQL执行成功，行数: 2042
预测SQL执行成功，行数: 2042
执行查询: ID=865900816, DB=risk_control
执行标准SQL: SELECT DATE_TRUNC('month', re.occurrence_time) as month, COUNT(DISTINCT re.event_id) as event_count, AVG(re.severity) as avg_severity, COUNT(a.alert_id) as alert_count FROM risk_events re LEFT JOIN alerts a ON re.event_id = a.event_id GROUP BY DATE_TRUNC('month', re.occurrence_time) ORDER BY month
执行预测SQL: SELECT TO_CHAR(risk_events.occurrence_time, 'YYYY-MM') AS month, COUNT(*) AS event_count, AVG(risk_events.severity) AS avg_severity, COUNT(alerts.alert_id) AS alert_count 
FROM risk_events 
LEFT JOIN alerts ON risk_events.event_id = alerts.event_id 
GROUP BY TO_CHAR(risk_events.occurrence_time, 'YYYY-MM') 
ORDER BY month
标准SQL执行成功，行数: 12
预测SQL执行成功，行数: 12

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [month event_count avg_severity alert_count]
[35m预测SQL列:[0m [month event_count avg_severity alert_count]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [2023-01-01 00:00:00 +0000 +0000 843 3.01423487544484 843]
[35m预测[1]:[0m [2023-01 843 3.01423487544484 843]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [2023-02-01 00:00:00 +0000 +0000 775 2.96 775]
[35m预测[2]:[0m [2023-02 775 2.96 775]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [2023-03-01 00:00:00 +0000 +0000 828 2.986714975845411 828]
[35m预测[3]:[0m [2023-03 828 2.986714975845411 828]
执行查询: ID=92424187, DB=risk_control
执行标准SQL: SELECT indicator_name, threshold_value FROM risk_indicators;
执行预测SQL: SELECT indicator_name AS indicator_name, threshold_value AS threshold_value FROM risk_indicators
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2998508313, DB=risk_control
执行标准SQL: SELECT ri.indicator_name, rml.* FROM risk_indicators ri LEFT JOIN LATERAL (SELECT * FROM risk_monitoring_logs WHERE indicator_id = ri.indicator_id ORDER BY monitoring_date DESC LIMIT 1) rml ON true
执行预测SQL: SELECT ri.indicator_name AS indicator_name, r.log_id AS log_id, r.indicator_id AS indicator_id, r.monitoring_date AS monitoring_date, r.actual_value AS actual_value, r.is_exceeding_threshold AS is_exceeding_threshold, r.notes AS notes FROM risk_monitoring_logs r JOIN risk_indicators ri ON r.indicator_id = ri.indicator_id WHERE (r.indicator_id, r.monitoring_date) IN (SELECT indicator_id, MAX(monitoring_date) FROM risk_monitoring_logs GROUP BY indicator_id) ORDER BY r.monitoring_date DESC
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1024168357, DB=risk_control
执行标准SQL: SELECT t.transaction_id, t.amount, c.customer_name, c.customer_type FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.amount > 100000;
执行预测SQL: SELECT 
    t.transaction_id AS transaction_id,
    t.amount AS amount,
    c.customer_name AS customer_name,
    c.customer_type AS customer_type
FROM 
    transactions t
JOIN 
    customers c ON t.customer_id = c.customer_id
WHERE 
    t.amount > 100000
标准SQL执行成功，行数: 9028
预测SQL执行成功，行数: 9028
执行查询: ID=2422412797, DB=risk_control
执行标准SQL: SELECT * FROM risk_reports WHERE approval_status = '已批准';
执行预测SQL: SELECT report_id AS report_id, report_type AS report_type, report_date AS report_date, report_content AS report_content, author AS author, approval_status AS approval_status, approved_by AS approved_by, event_id AS event_id FROM risk_reports WHERE approval_status = '已批准'
标准SQL执行成功，行数: 3284
预测SQL执行成功，行数: 3284
已处理 880/1042 个查询...
执行查询: ID=3918852865, DB=risk_control
执行标准SQL: SELECT transaction_type, AVG(risk_score) as avg_risk_score FROM transactions GROUP BY transaction_type ORDER BY avg_risk_score DESC
执行预测SQL: SELECT transaction_type, AVG(risk_score) AS avg_risk_score FROM transactions GROUP BY transaction_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=2671276850, DB=risk_control
执行标准SQL: WITH event_timelines AS (SELECT event_id, event_type, created_at, MAX(CASE WHEN status = '处理中' THEN occurrence_time END) as processing_start, MAX(CASE WHEN status = '已解决' THEN occurrence_time END) as resolved_time FROM risk_events GROUP BY event_id, event_type, created_at) SELECT event_type, AVG(EXTRACT(EPOCH FROM (resolved_time - created_at))/3600) as avg_total_time_hours, AVG(EXTRACT(EPOCH FROM (processing_start - created_at))/3600) as avg_unprocessed_time_hours, AVG(EXTRACT(EPOCH FROM (resolved_time - processing_start))/3600) as avg_processing_time_hours FROM event_timelines WHERE resolved_time IS NOT NULL GROUP BY event_type
执行预测SQL: SELECT 
    re.event_type,
    EXTRACT(EPOCH FROM (MAX(CASE WHEN a.status = '已解决' THEN a.audit_time END) - re.created_at)) / 3600 AS avg_total_time_hours,
    EXTRACT(EPOCH FROM (MAX(CASE WHEN a.status = '处理中' THEN a.audit_time END) - re.created_at)) / 3600 AS avg_unprocessed_time_hours,
    EXTRACT(EPOCH FROM (MAX(CASE WHEN a.status = '已解决' THEN a.audit_time END) - MAX(CASE WHEN a.status = '处理中' THEN a.audit_time END))) / 3600 AS avg_processing_time_hours
FROM risk_events re
LEFT JOIN audit_logs a ON re.event_id = a.event_id
WHERE a.audit_type = '风险事件审核'
GROUP BY re.event_type
预测SQL执行错误: SQL执行失败: pq: column a.status does not exist
预测SQL执行错误: SQL执行失败: pq: column a.status does not exist
执行查询: ID=3873676880, DB=risk_control
执行标准SQL: SELECT alert_type, COUNT(*) AS alert_count, AVG(EXTRACT(EPOCH FROM (resolved_time - alert_time))) AS avg_processing_time FROM (SELECT a.alert_type, a.alert_time, l.audit_time AS resolved_time FROM alerts a LEFT JOIN audit_logs l ON a.alert_id = l.alert_id WHERE a.status = '已解决') AS resolved_alerts GROUP BY alert_type;
执行预测SQL: SELECT alert_type, COUNT(*) AS alert_count, AVG(EXTRACT(EPOCH FROM (audit_time - alert_time)) / 60) AS avg_processing_time 
FROM alerts 
JOIN audit_logs ON alerts.alert_id = audit_logs.alert_id 
GROUP BY alert_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [alert_count avg_processing_time alert_type]
[35m预测SQL列:[0m [alert_type alert_count avg_processing_time]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [635 485731.4087468 客户风险上升]
[35m预测[1]:[0m [客户风险上升 1990 5699.670967902596]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [666 -965319.8089756111 信用恶化]
[35m预测[2]:[0m [信用恶化 1966 -8531.322534754823]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [690 -361353.65363625216 合规违规]
[35m预测[3]:[0m [合规违规 2031 5999.64727164634]
执行查询: ID=3957865555, DB=risk_control
执行标准SQL: SELECT event_type, AVG(EXTRACT(EPOCH FROM (CASE WHEN status = '已解决' THEN CURRENT_TIMESTAMP ELSE NULL END - created_at))/86400) as avg_resolution_days FROM risk_events WHERE status = '已解决' GROUP BY event_type
执行预测SQL: SELECT 
    re.event_type, 
    AVG(EXTRACT(DAY FROM (al.audit_time - re.created_at))) AS avg_resolution_days
FROM 
    risk_events re
JOIN (
    SELECT 
        event_id, 
        MAX(audit_time) AS last_audit_time
    FROM 
        audit_logs
    WHERE 
        audit_result = '通过'
    GROUP BY 
        event_id
) al ON re.event_id = al.event_id
WHERE 
    al.last_audit_time > re.created_at
GROUP BY 
    re.event_type
预测SQL执行错误: SQL执行失败: pq: column al.audit_time does not exist
预测SQL执行错误: SQL执行失败: pq: column al.audit_time does not exist
执行查询: ID=4127521896, DB=risk_control
执行标准SQL: SELECT a.alert_content, re.status FROM alerts a JOIN risk_events re ON a.event_id = re.event_id WHERE a.rule_id IS NOT NULL;
执行预测SQL: SELECT a.alert_content AS alert_content, re.status AS event_status FROM alerts a JOIN risk_events re ON a.event_id = re.event_id WHERE a.rule_id IS NOT NULL
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=4089186720, DB=risk_control
执行标准SQL: SELECT c.customer_name, COUNT(DISTINCT t.transaction_id) as high_risk_transactions, COUNT(DISTINCT a.alert_id) as high_level_alerts FROM customers c JOIN transactions t ON c.customer_id = t.customer_id LEFT JOIN alerts a ON t.event_id = a.event_id WHERE t.risk_score > 80 AND a.alert_level = '高' AND EXTRACT(YEAR FROM t.transaction_date) = 2023 GROUP BY c.customer_id, c.customer_name HAVING COUNT(DISTINCT t.transaction_id) > 0 AND COUNT(DISTINCT a.alert_id) > 0 ORDER BY high_risk_transactions DESC, high_level_alerts DESC;
执行预测SQL: SELECT c.customer_name, COUNT(DISTINCT t.transaction_id) AS high_risk_transactions, COUNT(DISTINCT a.alert_id) AS high_level_alerts 
FROM customers c 
JOIN transactions t ON c.customer_id = t.customer_id 
JOIN risk_events re ON t.event_id = re.event_id 
JOIN alerts a ON re.event_id = a.event_id 
WHERE t.risk_score > 80 
AND t.transaction_date >= '2023-01-01' 
AND t.transaction_date < '2024-01-01' 
AND a.alert_level = 'high' 
GROUP BY c.customer_id, c.customer_name
标准SQL执行成功，行数: 691
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回691行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=907497664, DB=risk_control
执行标准SQL: SELECT re.event_id, re.severity, ra.risk_level FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id;
执行预测SQL: SELECT risk_events.event_id AS event_id, risk_events.severity AS severity, risk_assessments.risk_level AS risk_level FROM risk_events INNER JOIN risk_assessments ON risk_events.event_id = risk_assessments.event_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=4046233588, DB=risk_control
执行标准SQL: SELECT transaction_id, transaction_type FROM transactions WHERE event_id = 'RE9297';
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=950586637, DB=risk_control
执行标准SQL: SELECT c.customer_type, COUNT(c.customer_id) AS customer_count FROM customers c GROUP BY c.customer_type;
执行预测SQL: SELECT customer_type, COUNT(*) AS customer_count FROM customers GROUP BY customer_type
标准SQL执行成功，行数: 2
预测SQL执行成功，行数: 2
执行查询: ID=1374953478, DB=risk_control
执行标准SQL: SELECT ra.assessment_id, re.event_description FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id;
执行预测SQL: SELECT risk_assessments.assessment_id AS assessment_id, risk_events.event_description AS event_description FROM risk_assessments JOIN risk_events ON risk_assessments.event_id = risk_events.event_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 890/1042 个查询...
执行查询: ID=3381418272, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, c.risk_level FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id AND t.transaction_date >= date('now') - INTERVAL '30 days' WHERE c.risk_level = '高' AND t.transaction_id IS NULL
执行预测SQL: AMBIGUOUS_QUERY
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "AMBIGUOUS_QUERY"
执行查询: ID=2179442925, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, c.risk_level, t.transaction_date, t.amount, t.risk_score FROM customers c LEFT JOIN (SELECT customer_id, transaction_date, amount, risk_score, ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY transaction_date DESC) as rn FROM transactions) t ON c.customer_id = t.customer_id WHERE c.risk_level = '高' AND t.rn = 1 ORDER BY t.risk_score DESC, t.amount DESC
执行预测SQL: SELECT 
    c.customer_id AS customer_id,
    c.customer_name AS customer_name,
    c.risk_level AS risk_level,
    t.transaction_date AS transaction_date,
    t.amount AS amount,
    t.risk_score AS risk_score
FROM 
    customers c
JOIN 
    (SELECT 
         customer_id, 
         transaction_date, 
         amount, 
         risk_score,
         ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY transaction_date DESC) AS rn
     FROM 
         transactions) t
ON 
    c.customer_id = t.customer_id
WHERE 
    c.risk_level = '高' 
    AND t.rn = 1
标准SQL执行成功，行数: 3366
预测SQL执行成功，行数: 3366
执行查询: ID=1859945760, DB=risk_control
执行标准SQL: SELECT t.transaction_type, COUNT(t.transaction_id) AS transaction_count, COUNT(CASE WHEN t.status = '成功' THEN 1 END) AS success_count FROM transactions t GROUP BY t.transaction_type;
执行预测SQL: SELECT transaction_type, COUNT(*) AS transaction_count, SUM(CASE WHEN status = '成功' THEN 1 ELSE 0 END) AS success_count FROM transactions GROUP BY transaction_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=2798341435, DB=risk_control
执行标准SQL: SELECT e.event_id, e.event_type, a.risk_level, a.mitigation_plan, a.assessor FROM risk_events e JOIN risk_assessments a ON e.event_id = a.event_id WHERE a.risk_level = '高'
执行预测SQL: SELECT ra.event_id AS event_id, re.event_type AS event_type, ra.risk_level AS risk_level, ra.mitigation_plan AS mitigation_plan, ra.assessor AS assessor FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id WHERE ra.risk_level = '高'
标准SQL执行成功，行数: 3363
预测SQL执行成功，行数: 3363
执行查询: ID=2480313897, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.customer_name, c.credit_score FROM customers c WHERE c.risk_level = '高' AND c.credit_score < 700;
执行预测SQL: SELECT customer_id AS cust_id, customer_name AS cust_name, credit_score AS credit_score FROM customers WHERE risk_level = '高' AND credit_score < 700
标准SQL执行成功，行数: 2249
预测SQL执行成功，行数: 2249
执行查询: ID=4249746696, DB=risk_control
执行标准SQL: SELECT * FROM customers WHERE risk_level = '高' AND credit_score < 600
执行预测SQL: SELECT customer_id AS customer_id, customer_name AS customer_name, customer_type AS customer_type, credit_score AS credit_score, risk_level AS risk_level, registration_date AS registration_date, last_update_date AS last_update_date FROM customers WHERE risk_level = '高' AND credit_score < 600
标准SQL执行成功，行数: 1148
预测SQL执行成功，行数: 1148
执行查询: ID=3634061359, DB=risk_control
执行标准SQL: SELECT c.customer_id, c.risk_level, SUM(t.amount) AS total_amount FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.status = '成功' GROUP BY c.customer_id, c.risk_level;
执行预测SQL: SELECT c.customer_id, c.risk_level, SUM(t.amount) AS total_amount FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.status = '成功' GROUP BY c.customer_id, c.risk_level
执行查询: ID=1094205818, DB=risk_control
执行标准SQL: SELECT rr.report_id, rr.report_type, rr.approval_status, re.event_type, re.event_description FROM risk_reports rr JOIN risk_events re ON rr.event_id = re.event_id WHERE rr.approval_status = '已批准'
执行预测SQL: SELECT rr.report_id AS report_id, rr.report_type AS report_type, rr.approval_status AS approval_status, re.event_type AS event_type, re.event_description AS event_description FROM risk_reports rr JOIN risk_events re ON rr.event_id = re.event_id WHERE rr.approval_status = '已批准'
标准SQL执行成功，行数: 3284
预测SQL执行成功，行数: 3284
执行查询: ID=4008892599, DB=risk_control
执行标准SQL: SELECT author, COUNT(*) as report_count FROM risk_reports GROUP BY author ORDER BY report_count DESC LIMIT 1
执行预测SQL: SELECT author, COUNT(*) AS report_count FROM risk_reports GROUP BY author ORDER BY report_count DESC LIMIT 1
执行查询: ID=1522060162, DB=risk_control
执行标准SQL: SELECT event_id, event_type, reporter FROM risk_events WHERE status = '未处理';
执行预测SQL: SELECT event_id AS 事件ID, event_type AS 事件类型, reporter AS 报告人 FROM risk_events WHERE status = '未处理'
标准SQL执行成功，行数: 3281
预测SQL执行成功，行数: 3281
已处理 900/1042 个查询...
执行查询: ID=2054103027, DB=risk_control
执行标准SQL: SELECT c.customer_name, c.last_update_date FROM customers c WHERE c.registration_date > '2021-01-01';
执行预测SQL: SELECT customer_name AS customer_name, last_update_date AS last_update_date FROM customers WHERE registration_date > '2021-01-01'
标准SQL执行成功，行数: 6731
预测SQL执行成功，行数: 6731
执行查询: ID=3283769605, DB=risk_control
执行标准SQL: SELECT rr.*, re.event_type, re.event_description FROM risk_reports rr LEFT JOIN risk_events re ON rr.event_id = re.event_id WHERE rr.approved_by = '高志远'
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=747719750, DB=risk_control
执行标准SQL: SELECT ri.indicator_id, ri.indicator_name, ri.threshold_value, rml.actual_value, rml.monitoring_date as last_update_time FROM risk_indicators ri LEFT JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id WHERE rml.monitoring_date = (SELECT MAX(monitoring_date) FROM risk_monitoring_logs WHERE indicator_id = ri.indicator_id)
执行预测SQL: SELECT ri.indicator_id AS indicator_id, ri.indicator_name AS indicator_name, ri.threshold_value AS threshold_value, rml.actual_value AS actual_value, rml.monitoring_date AS last_update_time FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id WHERE rml.monitoring_date = (SELECT MAX(monitoring_date) FROM risk_monitoring_logs WHERE indicator_id = ri.indicator_id)
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=334580003, DB=risk_control
执行标准SQL: SELECT ml.log_id, ml.actual_value, ri.indicator_name FROM risk_monitoring_logs ml JOIN risk_indicators ri ON ml.indicator_id = ri.indicator_id;
执行预测SQL: SELECT risk_monitoring_logs.log_id AS log_id, risk_monitoring_logs.actual_value AS actual_value, risk_indicators.indicator_name AS indicator_name FROM risk_monitoring_logs JOIN risk_indicators ON risk_monitoring_logs.indicator_id = risk_indicators.indicator_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=388467912, DB=risk_control
执行标准SQL: SELECT AVG(impact_score) AS avg_impact, AVG(probability_score) AS avg_probability FROM risk_assessments;
执行预测SQL: SELECT AVG(impact_score) AS avg_impact, AVG(probability_score) AS avg_probability FROM risk_assessments
执行查询: ID=3589660339, DB=risk_control
执行标准SQL: SELECT re.event_id, re.event_description, ra.assessor FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE ra.assessor IS NOT NULL;
执行预测SQL: SELECT risk_events.event_id AS event_id, risk_events.event_description AS event_description, risk_assessments.assessor AS assessor FROM risk_events INNER JOIN risk_assessments ON risk_events.event_id = risk_assessments.event_id WHERE risk_assessments.assessor IS NOT NULL
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1785182803, DB=risk_control
执行标准SQL: SELECT SUM(amount) FROM transactions WHERE transaction_type = '退款';
执行预测SQL: SELECT SUM(amount) AS total_refund_amount FROM transactions WHERE transaction_type = '退款'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=3949045999, DB=risk_control
执行标准SQL: SELECT ri.*, rml.actual_value, rml.monitoring_date FROM risk_indicators ri LEFT JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id WHERE rml.monitoring_date = (SELECT MAX(monitoring_date) FROM risk_monitoring_logs WHERE indicator_id = ri.indicator_id)
执行预测SQL: SELECT ri.indicator_id AS indicator_id, ri.indicator_name AS indicator_name, ri.indicator_description AS indicator_description, ri.measurement_unit AS measurement_unit, ri.threshold_value AS threshold_value, ri.data_source AS data_source, ri.update_frequency AS update_frequency, rml.actual_value AS actual_value, rml.monitoring_date AS monitoring_date FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id WHERE (ri.indicator_id, rml.monitoring_date) IN (SELECT indicator_id, MAX(monitoring_date) FROM risk_monitoring_logs GROUP BY indicator_id)
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1365503712, DB=risk_control
执行标准SQL: SELECT re.event_type, AVG(ra.assessment_date - re.occurrence_time) as avg_mitigation_time FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id GROUP BY re.event_type
执行预测SQL: SELECT re.event_type, AVG(EXTRACT(EPOCH FROM (ra.assessment_date - re.occurrence_time)) / 60) AS avg_mitigation_time FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE ra.assessment_date > re.occurrence_time GROUP BY re.event_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [event_type avg_mitigation_time]
[35m预测SQL列:[0m [event_type avg_mitigation_time]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [市场风险 -13]
[35m预测[1]:[0m [市场风险 173671.41947941034]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [流动性风险 -5]
[35m预测[2]:[0m [流动性风险 167095.22022517773]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [合规风险 -2]
[35m预测[3]:[0m [合规风险 174349.4642434953]
执行查询: ID=454781039, DB=risk_control
执行标准SQL: SELECT event_type, COUNT(*) as event_count FROM risk_events GROUP BY event_type;
执行预测SQL: SELECT event_type, COUNT(*) AS event_count FROM risk_events GROUP BY event_type
已处理 910/1042 个查询...
执行查询: ID=312146930, DB=risk_control
执行标准SQL: SELECT ra.assessment_id, re.event_description, ra.assessor FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id;
执行预测SQL: SELECT ra.assessment_id AS assessment_id, re.event_description AS event_description, ra.assessor AS assessor FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3050678212, DB=risk_control
执行标准SQL: SELECT * FROM risk_monitoring_logs WHERE is_exceeding_threshold = TRUE; SELECT COUNT(*) FROM risk_monitoring_logs WHERE is_exceeding_threshold = TRUE;
执行预测SQL: SELECT COUNT(*) AS total_exceeding_records FROM risk_monitoring_logs WHERE is_exceeding_threshold = true
标准SQL执行成功，行数: 2953
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2953行, 预测SQL返回1行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [notes log_id indicator_id monitoring_date actual_value is_exceeding_threshold]
[35m预测SQL列:[0m [total_exceeding_records]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [指标趋势异常阈值，建议进行干预 ML0001 RI0001 2023-08-07 04:33:56.189877 +0000 +0000 98.85 true]
[35m预测[1]:[0m [2953]
执行查询: ID=2500244814, DB=risk_control
执行标准SQL: SELECT re.event_id, ra.assessment_id, ra.mitigation_plan FROM risk_events re LEFT JOIN risk_assessments ra ON re.event_id = ra.event_id;
执行预测SQL: SELECT risk_events.event_id AS event_id, risk_assessments.assessment_id AS assessment_id, risk_assessments.mitigation_plan AS mitigation_plan FROM risk_events INNER JOIN risk_assessments ON risk_events.event_id = risk_assessments.event_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2753692877, DB=risk_control
执行标准SQL: SELECT report_id, report_type, report_date, author FROM risk_reports WHERE approval_status = '已批准';
执行预测SQL: SELECT report_id AS report_id, report_type AS report_type, report_date AS report_date, author AS author FROM risk_reports WHERE approval_status = '已批准'
标准SQL执行成功，行数: 3284
预测SQL执行成功，行数: 3284
执行查询: ID=2701292510, DB=risk_control
执行标准SQL: SELECT c.* FROM customers c WHERE c.risk_level = '高' AND c.credit_score > (SELECT AVG(credit_score) FROM customers)
执行预测SQL: SELECT customer_id AS customer_id, customer_name AS customer_name, customer_type AS customer_type, credit_score AS credit_score, risk_level AS risk_level, registration_date AS registration_date, last_update_date AS last_update_date FROM customers WHERE risk_level = '高' AND credit_score > (SELECT AVG(credit_score) FROM customers)
标准SQL执行成功，行数: 1663
预测SQL执行成功，行数: 1663
执行查询: ID=3788454929, DB=risk_control
执行标准SQL: SELECT alert_id, alert_content, assigned_to FROM alerts;
执行预测SQL: SELECT alert_id AS 预警ID, alert_content AS 预警内容, assigned_to AS 处理人员 FROM alerts
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1494274200, DB=risk_control
执行标准SQL: SELECT re.event_id, re.event_description, re.severity, re.created_at, MAX(ra.assessment_date) AS resolved_date, MAX(ra.assessment_date) - re.created_at AS resolution_time FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE re.status = '已解决' GROUP BY re.event_id, re.event_description, re.severity, re.created_at ORDER BY resolution_time DESC LIMIT 10
执行预测SQL: SELECT re.event_id AS event_id, re.event_description AS event_description, re.severity AS severity, re.created_at AS created_at, al.audit_time AS resolved_date, (al.audit_time - re.created_at) AS resolution_time 
FROM risk_events re 
JOIN audit_logs al ON re.event_id = al.related_id 
WHERE re.status = '已解决' 
AND al.audit_result = '已解决' 
ORDER BY resolution_time DESC 
LIMIT 10
标准SQL执行成功，行数: 10
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=2741655674, DB=risk_control
执行标准SQL: SELECT rc.*, ri.indicator_name FROM rule_configurations rc LEFT JOIN risk_indicators ri ON rc.indicator_id = ri.indicator_id WHERE rc.is_active = TRUE
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4006191467, DB=risk_control
执行标准SQL: SELECT risk_level, COUNT(*) AS customer_count FROM customers GROUP BY risk_level;
执行预测SQL: SELECT risk_level, COUNT(*) AS customer_count FROM customers GROUP BY risk_level
执行查询: ID=1366443289, DB=risk_control
执行标准SQL: SELECT event_id, event_description, reporter FROM risk_events WHERE status = '未处理';
执行预测SQL: SELECT event_id AS event_id, event_description AS event_description, reporter AS reporter FROM risk_events WHERE status = '未处理'
标准SQL执行成功，行数: 3281
预测SQL执行成功，行数: 3281
已处理 920/1042 个查询...
执行查询: ID=2713864982, DB=risk_control
执行标准SQL: SELECT created_at FROM risk_events WHERE severity >= 3;
执行预测SQL: SELECT created_at AS creation_time FROM risk_events WHERE severity >= 3
标准SQL执行成功，行数: 5997
预测SQL执行成功，行数: 5997
执行查询: ID=4176420377, DB=risk_control
执行标准SQL: SELECT ra.assessment_id, ra.mitigation_plan, ra.assessor FROM risk_assessments ra;
执行预测SQL: SELECT assessment_id AS assessment_id, mitigation_plan AS mitigation_plan, assessor AS assessor FROM risk_assessments
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2609744326, DB=risk_control
执行标准SQL: SELECT a.alert_id, a.alert_content, a.alert_level, re.event_description, al.audit_comments, al.audit_time FROM alerts a JOIN risk_events re ON a.event_id = re.event_id LEFT JOIN audit_logs al ON a.alert_id = al.alert_id WHERE a.status != '已解决' AND a.alert_level = '高' AND al.audit_time = (SELECT MAX(audit_time) FROM audit_logs WHERE alert_id = a.alert_id)
执行预测SQL: SELECT 
    a.alert_id AS alert_id,
    a.alert_content AS alert_content,
    a.alert_level AS alert_level,
    re.event_description AS event_description,
    al.audit_comments AS audit_comments,
    al.audit_time AS audit_time
FROM alerts a
JOIN risk_events re ON a.event_id = re.event_id
JOIN (
    SELECT 
        alert_id, 
        audit_comments, 
        audit_time,
        ROW_NUMBER() OVER (PARTITION BY alert_id ORDER BY audit_time DESC) AS rn
    FROM audit_logs
) al ON a.alert_id = al.alert_id
WHERE a.status = '未处理' 
  AND a.alert_level = '高'
  AND al.rn = 1
标准SQL执行成功，行数: 2198
预测SQL执行成功，行数: 1104

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2198行, 预测SQL返回1104行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [alert_id alert_content alert_level event_description audit_comments audit_time]
[35m预测SQL列:[0m [alert_id alert_content alert_level event_description audit_comments audit_time]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [AL0013 检测到多次尝试失败的交易，请及时核查。 高 在北京分行发生的系统故障事件 <nil> 2023-12-11 00:17:48.332148 +0000 +0000]
[35m预测[1]:[0m [AL0014 检测到客户风险等级突升，请及时核查。 高 在成都分行发生的股市波动事件 <nil> 2023-09-25 03:09:11.839806 +0000 +0000]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [AL0014 检测到客户风险等级突升，请及时核查。 高 在成都分行发生的股市波动事件 <nil> 2023-09-25 03:09:11.839806 +0000 +0000]
[35m预测[2]:[0m [AL0020 检测到多次尝试失败的交易，请及时核查。 高 在武汉分行发生的股市波动事件 审核完成，已采取相应措施 2023-11-26 01:09:12.240694 +0000 +0000]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [AL0020 检测到多次尝试失败的交易，请及时核查。 高 在武汉分行发生的股市波动事件 审核完成，已采取相应措施 2023-11-26 01:09:12.240694 +0000 +0000]
[35m预测[3]:[0m [AL0045 检测到可疑大额交易，请及时核查。 高 在上海分行发生的客户违约事件 审核完成，已采取相应措施 2023-10-06 21:50:28.488801 +0000 +0000]
执行查询: ID=1472140605, DB=risk_control
执行标准SQL: SELECT ra.assessment_id, ra.risk_level, ra.mitigation_plan, re.event_id, re.event_type, re.event_description FROM risk_assessments ra INNER JOIN risk_events re ON ra.event_id = re.event_id WHERE ra.risk_level = '高'
执行预测SQL: SELECT ra.assessment_id AS assessment_id, ra.risk_level AS risk_level, ra.mitigation_plan AS mitigation_plan, ra.event_id AS event_id, re.event_type AS event_type, re.event_description AS event_description FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id WHERE ra.risk_level = '高'
标准SQL执行成功，行数: 3363
预测SQL执行成功，行数: 3363
执行查询: ID=4016844576, DB=risk_control
执行标准SQL: SELECT DISTINCT c.customer_id, c.customer_name, t.amount FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.risk_level = '高' AND t.amount > 100000 AND t.transaction_date >= date('now') - INTERVAL '1 year'
执行预测SQL: SELECT c.customer_id AS customer_id, c.customer_name AS customer_name, t.amount AS amount FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.risk_level = '高' AND t.amount > 100000 AND t.transaction_date >= CURRENT_DATE - INTERVAL '1 year'
标准SQL执行成功，行数: -1
预测SQL执行成功，行数: -1
执行查询: ID=1206095116, DB=risk_control
执行标准SQL: SELECT assessment_id, event_id FROM risk_assessments WHERE impact_score > 8 AND risk_level = '高';
执行预测SQL: SELECT assessment_id AS assessment_id, event_id AS event_id FROM risk_assessments WHERE impact_score > 8 AND risk_level = '高'
标准SQL执行成功，行数: 661
预测SQL执行成功，行数: 661
执行查询: ID=747204718, DB=risk_control
执行标准SQL: SELECT re.event_id, rr.report_type, rr.report_content FROM risk_events re JOIN risk_reports rr ON re.event_id = rr.event_id;
执行预测SQL: SELECT risk_events.event_id AS event_id, risk_reports.report_type AS report_type, risk_reports.report_content AS report_content FROM risk_events INNER JOIN risk_reports ON risk_events.event_id = risk_reports.event_id
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=380031248, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id JOIN non_performing_loans npl ON fii.institution_id = npl.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND rr.report_date BETWEEN '2023-07-01' AND '2023-09-30' AND npl.npl_ratio > 2.0;
执行预测SQL: SELECT DISTINCT fi.institution_name AS institution_name 
FROM financial_institution_info fi 
JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id 
JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id 
WHERE rr.report_type = '季度报告' 
AND rr.approval_status = '需修改' 
AND rr.report_date BETWEEN '2023-07-01' AND '2023-09-30' 
AND npl.npl_ratio > 2
标准SQL执行成功，行数: 811
预测SQL执行成功，行数: 7

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回811行, 预测SQL返回7行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_name]
[35m预测SQL列:[0m [institution_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [国家开发银行]
[35m预测[1]:[0m [中国农业发展银行]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [中国工商银行北京分行]
[35m预测[2]:[0m [中国工商银行北京分行]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [深圳福田村镇银行]
[35m预测[3]:[0m [中国进出口银行]
执行查询: ID=796615861, DB=supervise
执行标准SQL: SELECT * FROM regulatory_reports WHERE submission_date = '2023-11-01';
执行预测SQL: SELECT report_id AS report_id, institution_id AS institution_id, report_date AS report_date, report_type AS report_type, submission_date AS submission_date, approval_status AS approval_status, comments AS comments FROM regulatory_reports WHERE submission_date = '2023-11-01'
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: 2500
执行查询: ID=226307394, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM financial_institution_info fii JOIN capital_adequacy_ratio car ON fii.institution_id = car.institution_id JOIN non_performing_loans npl ON fii.institution_id = npl.institution_id WHERE car.report_date = '2023-06-01' AND npl.report_date = '2023-06-01' AND car.total_car < 12 AND npl.npl_ratio > 2;
执行预测SQL: SELECT fi.institution_name AS institution_name FROM financial_institution_info fi JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE car.report_date BETWEEN '2023-06-01' AND '2023-06-30' AND npl.report_date BETWEEN '2023-06-01' AND '2023-06-30' AND car.total_car < 12 AND npl.npl_ratio > 2
标准SQL执行成功，行数: 79
预测SQL执行成功，行数: 79
已处理 930/1042 个查询...
执行查询: ID=2186232166, DB=supervise
执行标准SQL: SELECT fi.institution_name FROM risk_exposure re JOIN financial_institution_info fi ON re.institution_id = fi.institution_id ORDER BY (re.market_risk_exposure / re.total_risk_exposure) DESC LIMIT 1;
执行预测SQL: SELECT f.institution_name 
FROM risk_exposure r 
JOIN financial_institution_info f ON r.institution_id = f.institution_id 
WHERE r.total_risk_exposure > 0 
ORDER BY (r.market_risk_exposure / r.total_risk_exposure) DESC 
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=3832687129, DB=supervise
执行标准SQL: SELECT fii.institution_name, rr.report_id, rr.report_type, rr.approval_status, fii.registered_capital FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND rr.submission_date >= '2023-07-01' AND rr.submission_date < '2023-10-01' AND fii.registered_capital > 50000000;
执行预测SQL: SELECT fi.institution_name AS institution_name, r.report_id AS report_id, r.report_type AS report_type, r.approval_status AS approval_status, fi.registered_capital AS registered_capital FROM regulatory_reports r JOIN financial_institution_info fi ON r.institution_id = fi.institution_id WHERE r.report_type = '季度报告' AND r.approval_status = '需修改' AND r.report_date BETWEEN '2023-07-01' AND '2023-09-30' AND fi.registered_capital > 50000000
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: 2500
执行查询: ID=3593789396, DB=supervise
执行标准SQL: SELECT fi.institution_name, (car.risk_weighted_assets / bs.total_assets * 100) AS rwa_density FROM financial_institution_info fi JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id JOIN balance_sheet bs ON fi.institution_id = bs.institution_id ORDER BY rwa_density DESC LIMIT 1
执行预测SQL: SELECT fi.institution_name, (ca.risk_weighted_assets / bs.total_assets) AS rwa_density 
FROM capital_adequacy_ratio ca 
JOIN balance_sheet bs ON ca.institution_id = bs.institution_id AND ca.report_date = bs.report_date 
JOIN financial_institution_info fi ON ca.institution_id = fi.institution_id 
ORDER BY rwa_density DESC 
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3734281326, DB=supervise
执行标准SQL: SELECT liquidity_coverage_ratio, net_stable_funding_ratio FROM liquidity_ratio;
执行预测SQL: SELECT liquidity_coverage_ratio AS liquidity_coverage_ratio, net_stable_funding_ratio AS net_stable_funding_ratio FROM liquidity_ratio
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2976622725, DB=supervise
执行标准SQL: SELECT institution_id FROM compliance_records WHERE record_date >= '2023-12-01' AND record_date < '2024-01-01' AND status = '未解决';
执行预测SQL: SELECT DISTINCT institution_id AS institution_id FROM compliance_records WHERE TO_CHAR(record_date, 'YYYYMM') = '202312' AND status = '未解决'
标准SQL执行成功，行数: 291
预测SQL执行成功，行数: 291
执行查询: ID=3196242817, DB=supervise
执行标准SQL: SELECT institution_id, SUM(loans_and_advances) AS total_loans, SUM(deposits) AS total_deposits FROM balance_sheet WHERE EXTRACT(YEAR FROM report_date) = 2024 GROUP BY institution_id;
执行预测SQL: SELECT institution_id, SUM(loans_and_advances) AS total_loans, SUM(deposits) AS total_deposits FROM balance_sheet WHERE EXTRACT(YEAR FROM report_date) = 2024 GROUP BY institution_id
执行查询: ID=1889616376, DB=supervise
执行标准SQL: SELECT * FROM balance_sheet WHERE report_date = '2039-06-08';
执行预测SQL: SELECT balance_sheet_id AS balance_sheet_id, institution_id AS institution_id, report_date AS report_date, total_assets AS total_assets, total_liabilities AS total_liabilities, total_equity AS total_equity, cash_and_equivalents AS cash_and_equivalents, loans_and_advances AS loans_and_advances, deposits AS deposits FROM balance_sheet WHERE report_date = '2039-06-08'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=453935379, DB=supervise
执行标准SQL: SELECT COUNT(DISTINCT institution_id) FROM non_performing_loans WHERE npl_ratio > 3;
执行预测SQL: SELECT COUNT(DISTINCT institution_id) AS count FROM non_performing_loans WHERE npl_ratio > 3
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=44191459, DB=supervise
执行标准SQL: SELECT net_interest_income, non_interest_income FROM income_statement WHERE report_date = '2023-03-01';
执行预测SQL: SELECT net_interest_income AS net_interest_income, non_interest_income AS non_interest_income FROM income_statement WHERE report_date = '2023-03-01'
标准SQL执行成功，行数: 833
预测SQL执行成功，行数: 833
执行查询: ID=584013962, DB=supervise
执行标准SQL: SELECT npl_amount / total_loans AS npl_ratio FROM non_performing_loans;
执行预测SQL: SELECT npl_ratio AS npl_ratio FROM non_performing_loans
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据行数不匹配 (策略: exact_column_names)
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [npl_ratio]
[35m预测SQL列:[0m [npl_ratio]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [0.023994627099720292]
[35m预测[1]:[0m [1.93]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [0.011269596678974961]
[35m预测[2]:[0m [1.3]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [0.01768168380640552]
[35m预测[3]:[0m [1.69]
已处理 940/1042 个查询...
执行查询: ID=2733428482, DB=supervise
执行标准SQL: SELECT fi.institution_name FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE rr.submission_date >= '2023-01-01' AND rr.submission_date < '2024-01-01' AND rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND npl.report_date >= '2023-01-01' AND npl.report_date < '2024-01-01' AND npl.npl_ratio > 1.00;
执行预测SQL: SELECT DISTINCT fi.institution_name AS institution_name
FROM financial_institution_info fi
JOIN (
    SELECT DISTINCT institution_id
    FROM regulatory_reports
    WHERE report_type = '季度报告' 
      AND approval_status = '需修改' 
      AND submission_date BETWEEN '2023-01-01' AND '2023-12-31'
) rr ON fi.institution_id = rr.institution_id
JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id
WHERE npl.report_date BETWEEN '2023-01-01' AND '2023-12-31'
  AND npl.npl_ratio > 1
标准SQL执行成功，行数: 2497
预测SQL执行成功，行数: 7

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2497行, 预测SQL返回7行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_name]
[35m预测SQL列:[0m [institution_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [广州农村商业银行]
[35m预测[1]:[0m [国家开发银行]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [国家开发银行]
[35m预测[2]:[0m [中国进出口银行]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [中国工商银行北京分行]
[35m预测[3]:[0m [中国工商银行北京分行]
执行查询: ID=951459633, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id WHERE rr.report_date = '2023-10-01' AND rr.report_type = '半年度报告' AND rr.approval_status = '待审核';
执行预测SQL: SELECT fi.institution_name 
FROM financial_institution_info fi 
JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id 
WHERE rr.submission_date = '2023-10-01' 
AND rr.approval_status = '待审核' 
AND rr.report_type = '半年度报告'
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2500行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1829456676, DB=supervise
执行标准SQL: SELECT institution_name, registered_capital FROM financial_institution_info WHERE institution_type != '商业银行' ORDER BY registered_capital DESC LIMIT 5;
执行预测SQL: SELECT institution_name AS institution_name, registered_capital AS registered_capital
FROM financial_institution_info
WHERE institution_type = '非银行金融机构'
ORDER BY registered_capital DESC
LIMIT 5
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_name registered_capital]
[35m预测SQL列:[0m [institution_name registered_capital]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [中金公司 9.99949973694e+09]
[35m预测[1]:[0m [中金公司 9.99949973694e+09]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [中国农业发展银行 9.9979243901e+09]
[35m预测[2]:[0m [中金公司 9.99725660411e+09]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [广州农村商业银行 9.99735599194e+09]
[35m预测[3]:[0m [中金公司 9.99653029297e+09]
执行查询: ID=1953695337, DB=supervise
执行标准SQL: SELECT COUNT(*) FROM (SELECT institution_id FROM balance_sheet ORDER BY total_assets DESC LIMIT 500) AS top500 INNER JOIN non_performing_loans ON top500.institution_id = non_performing_loans.institution_id WHERE npl_ratio < 1 AND provision_coverage_ratio > 200;
执行预测SQL: SELECT COUNT(DISTINCT n.institution_id) AS count FROM non_performing_loans n WHERE n.institution_id IN (SELECT institution_id FROM balance_sheet ORDER BY total_assets DESC LIMIT 500) AND n.npl_ratio < 1 AND n.provision_coverage_ratio > 200
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=1414930652, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM financial_institution_info fii JOIN capital_adequacy_ratio car ON fii.institution_id = car.institution_id JOIN regulatory_reports rr ON fii.institution_id = rr.institution_id WHERE car.report_date = '2023-12-01' AND car.core_tier_1_ratio < 10 AND rr.approval_status = '待审核';
执行预测SQL: SELECT fi.institution_name 
FROM financial_institution_info fi
JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id
JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id
WHERE car.report_date = '2023-12-01'
AND rr.report_date = '2023-12-01'
AND car.core_tier_1_ratio < 10
AND rr.approval_status = '待审核'
标准SQL执行成功，行数: 832
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回832行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=364214965, DB=supervise
执行标准SQL: WITH income_growth AS (SELECT institution_id, (MAX(net_interest_income + non_interest_income) - MIN(net_interest_income + non_interest_income)) / MIN(net_interest_income + non_interest_income) * 100 AS income_growth_rate FROM income_statement WHERE report_date >= date('now') - INTERVAL '2 years' GROUP BY institution_id), profit_growth AS (SELECT institution_id, (MAX(net_profit) - MIN(net_profit)) / MIN(net_profit) * 100 AS profit_growth_rate FROM income_statement WHERE report_date >= date('now') - INTERVAL '2 years' GROUP BY institution_id) SELECT fii.institution_name FROM financial_institution_info fii JOIN income_growth ig ON fii.institution_id = ig.institution_id JOIN profit_growth pg ON fii.institution_id = pg.institution_id ORDER BY ig.income_growth_rate DESC, pg.profit_growth_rate ASC LIMIT 1;
执行预测SQL: SELECT 
    fi.institution_name AS institution_name
FROM (
    WITH income_data AS (
        SELECT 
            institution_id,
            report_date,
            (net_interest_income + non_interest_income) AS total_revenue,
            net_profit
        FROM income_statement
    ),
    ranked_income AS (
        SELECT 
            institution_id,
            report_date,
            total_revenue,
            net_profit,
            ROW_NUMBER() OVER (PARTITION BY institution_id ORDER BY report_date DESC) AS rn
        FROM income_data
    ),
    latest_two AS (
        SELECT 
            institution_id,
            total_revenue AS revenue1,
            net_profit AS profit1,
            LAG(total_revenue, 1) OVER (PARTITION BY institution_id ORDER BY report_date DESC) AS revenue2,
            LAG(net_profit, 1) OVER (PARTITION BY institution_id ORDER BY report_date DESC) AS profit2
        FROM ranked_income
        WHERE rn = 1
    ),
    growth_calculations AS (
        SELECT 
            institution_id,
            (revenue1 - revenue2) / NULLIF(revenue2, 0) AS revenue_growth,
            (profit1 - profit2) / NULLIF(profit2, 0) AS profit_growth
        FROM latest_two
        WHERE revenue2 IS NOT NULL AND profit2 IS NOT NULL
    )
    SELECT 
        institution_id,
        revenue_growth,
        profit_growth
    FROM growth_calculations
) sub
JOIN financial_institution_info fi ON sub.institution_id = fi.institution_id
ORDER BY sub.revenue_growth DESC, sub.profit_growth ASC
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=419882166, DB=supervise
执行标准SQL: SELECT report_id, approval_status FROM regulatory_reports WHERE report_date = '2023-07-01';
执行预测SQL: SELECT report_id AS report_id, approval_status AS approval_status FROM regulatory_reports WHERE report_date = '2023-07-01'
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: 2500
执行查询: ID=3742684421, DB=supervise
执行标准SQL: SELECT DISTINCT fi.institution_id, fi.institution_name FROM financial_institution_info fi JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id WHERE car.core_tier_1_ratio > (SELECT AVG(core_tier_1_ratio) FROM capital_adequacy_ratio) AND car.tier_1_ratio > (SELECT AVG(tier_1_ratio) FROM capital_adequacy_ratio) AND car.total_car > (SELECT AVG(total_car) FROM capital_adequacy_ratio);
执行预测SQL: SELECT ca.institution_id AS institution_id, fi.institution_name AS institution_name
FROM capital_adequacy_ratio ca
JOIN financial_institution_info fi ON ca.institution_id = fi.institution_id
WHERE ca.core_tier_1_ratio > (SELECT AVG(core_tier_1_ratio) FROM capital_adequacy_ratio)
  AND ca.tier_1_ratio > (SELECT AVG(tier_1_ratio) FROM capital_adequacy_ratio)
  AND ca.total_car > (SELECT AVG(total_car) FROM capital_adequacy_ratio)
标准SQL执行成功，行数: 1175
预测SQL执行成功，行数: 1175
执行查询: ID=2448874069, DB=supervise
执行标准SQL: SELECT * FROM compliance_records WHERE record_date >= '2023-01-01' AND record_date < '2024-01-01' AND status = '已解决';
执行预测SQL: SELECT record_id AS record_id, institution_id AS institution_id, record_date AS record_date, compliance_type AS compliance_type, description AS description, severity AS severity, status AS status, resolution_date AS resolution_date FROM compliance_records WHERE status = '已解决' AND record_date >= '2023-01-01' AND record_date < '2024-01-01'
标准SQL执行成功，行数: 3330
预测SQL执行成功，行数: 3330
执行查询: ID=3679648301, DB=supervise
执行标准SQL: SELECT report_type, COUNT(*) AS submission_count FROM regulatory_reports WHERE submission_date BETWEEN '2023-07-01' AND '2023-09-30' GROUP BY report_type ORDER BY submission_count DESC LIMIT 1
执行预测SQL: SELECT report_type, COUNT(*) AS submission_count FROM regulatory_reports WHERE submission_date BETWEEN '2023-07-01' AND '2023-09-30' GROUP BY report_type ORDER BY submission_count DESC LIMIT 1
已处理 950/1042 个查询...
执行查询: ID=293590145, DB=supervise
执行标准SQL: SELECT tier_1_ratio FROM capital_adequacy_ratio;
执行预测SQL: SELECT tier_1_ratio AS tier_1_ratio FROM capital_adequacy_ratio
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=685587392, DB=supervise
执行标准SQL: SELECT fii.institution_name, lr.report_date FROM liquidity_ratio lr JOIN financial_institution_info fii ON lr.institution_id = fii.institution_id WHERE lr.liquidity_coverage_ratio > 100;
执行预测SQL: SELECT financial_institution_info.institution_name AS institution_name, liquidity_ratio.report_date AS report_date 
FROM liquidity_ratio 
JOIN financial_institution_info ON liquidity_ratio.institution_id = financial_institution_info.institution_id 
WHERE liquidity_ratio.liquidity_coverage_ratio > 100
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=727742801, DB=supervise
执行标准SQL: WITH asset_liability_ratio AS (SELECT institution_id, report_date, total_liabilities / total_assets AS al_ratio FROM balance_sheet WHERE report_date >= date('now') - INTERVAL '2 years'), al_volatility AS (SELECT institution_id, MAX(al_ratio) - MIN(al_ratio) AS al_volatility FROM asset_liability_ratio GROUP BY institution_id), liquidity_trend AS (SELECT institution_id, report_date, liquidity_coverage_ratio, ROW_NUMBER() OVER (PARTITION BY institution_id ORDER BY report_date) AS row_num FROM liquidity_ratio WHERE report_date >= date('now') - INTERVAL '2 years') SELECT fi.institution_name, av.al_volatility, COALESCE(ROUND((last.liquidity_coverage_ratio - first.liquidity_coverage_ratio) / first.liquidity_coverage_ratio * 100, 2), 0) AS lcr_change_percentage FROM financial_institution_info fi JOIN al_volatility av ON fi.institution_id = av.institution_id LEFT JOIN liquidity_trend first ON fi.institution_id = first.institution_id AND first.row_num = 1 LEFT JOIN liquidity_trend last ON fi.institution_id = last.institution_id AND last.row_num = (SELECT MAX(row_num) FROM liquidity_trend WHERE institution_id = fi.institution_id) ORDER BY av.al_volatility DESC LIMIT 5
执行预测SQL: SELECT 
    fi.institution_name,
    av.al_volatility,
    lc.lcr_change_percentage
FROM financial_institution_info fi
JOIN (
    SELECT 
        institution_id,
        MAX(total_liabilities / total_assets) - MIN(total_liabilities / total_assets) AS al_volatility
    FROM balance_sheet
    WHERE report_date BETWEEN (CURRENT_DATE - INTERVAL '2 years') AND CURRENT_DATE
    GROUP BY institution_id
    HAVING COUNT(DISTINCT report_date) >= 2
) av ON fi.institution_id = av.institution_id
JOIN (
    SELECT 
        institution_id,
        (MAX(liquidity_coverage_ratio) - MIN(liquidity_coverage_ratio)) / NULLIF(MIN(liquidity_coverage_ratio), 0) * 100 AS lcr_change_percentage
    FROM liquidity_ratio
    WHERE report_date BETWEEN (CURRENT_DATE - INTERVAL '2 years') AND CURRENT_DATE
    GROUP BY institution_id
    HAVING COUNT(DISTINCT report_date) >= 2
) lc ON fi.institution_id = lc.institution_id
ORDER BY av.al_volatility DESC
LIMIT 5
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回5行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3429671168, DB=supervise
执行标准SQL: SELECT record_id, institution_id, record_date, resolution_date, description, severity, status, compliance_type FROM compliance_records WHERE record_date >= '2023-03-01' AND record_date < '2023-04-01';
执行预测SQL: SELECT record_id AS record_id, institution_id AS institution_id, record_date AS record_date, resolution_date AS resolution_date, description AS description, severity AS severity, status AS status, compliance_type AS compliance_type FROM compliance_records WHERE record_date BETWEEN '2023-03-01' AND '2023-03-31'
标准SQL执行成功，行数: 827
预测SQL执行成功，行数: 827
执行查询: ID=3200376501, DB=supervise
执行标准SQL: SELECT institution_id, record_date, description, severity FROM compliance_records WHERE record_date >= '2024-01-01' AND record_date < '2025-01-01';
执行预测SQL: SELECT institution_id AS institution_id, record_date AS record_date, description AS description, severity AS severity FROM compliance_records WHERE EXTRACT(YEAR FROM record_date) = 2024
标准SQL执行成功，行数: 8
预测SQL执行成功，行数: 8
执行查询: ID=1891907399, DB=supervise
执行标准SQL: SELECT report_type FROM regulatory_reports WHERE report_date = '2023-10-01';
执行预测SQL: SELECT report_type AS report_type FROM regulatory_reports WHERE report_date = '2023-10-01'
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: 2500
执行查询: ID=11596427, DB=supervise
执行标准SQL: SELECT * FROM compliance_records WHERE record_date >= '2023-01-01' AND record_date < '2024-01-01' AND severity = '中';
执行预测SQL: SELECT record_id AS 记录ID, institution_id AS 机构ID, record_date AS 记录日期, compliance_type AS 合规类型, description AS 描述, severity AS 严重程度, status AS 状态, resolution_date AS 解决日期 FROM compliance_records WHERE record_date BETWEEN '2023-01-01' AND '2023-12-31' AND severity = '中'
标准SQL执行成功，行数: 2499
预测SQL执行成功，行数: 2499
执行查询: ID=3129849565, DB=supervise
执行标准SQL: SELECT * FROM compliance_records WHERE record_date = '2023-10-01';
执行预测SQL: SELECT record_id AS record_id, institution_id AS institution_id, record_date AS record_date, compliance_type AS compliance_type, description AS description, severity AS severity, status AS status, resolution_date AS resolution_date FROM compliance_records WHERE record_date = '2023-10-01'
标准SQL执行成功，行数: 24
预测SQL执行成功，行数: 24
执行查询: ID=3154891263, DB=supervise
执行标准SQL: SELECT DISTINCT lr.institution_id FROM liquidity_ratio lr WHERE lr.liquidity_coverage_ratio > (SELECT AVG(liquidity_coverage_ratio) FROM liquidity_ratio) AND lr.net_stable_funding_ratio > (SELECT AVG(net_stable_funding_ratio) FROM liquidity_ratio) AND lr.loan_to_deposit_ratio > (SELECT AVG(loan_to_deposit_ratio) FROM liquidity_ratio);
执行预测SQL: SELECT institution_id
FROM liquidity_ratio
WHERE liquidity_coverage_ratio > 100
  AND net_stable_funding_ratio > 100
  AND loan_to_deposit_ratio < 80
标准SQL执行成功，行数: 1200
预测SQL执行成功，行数: 9995

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1200行, 预测SQL返回9995行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_id]
[35m预测SQL列:[0m [institution_id]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [1269]
[35m预测[1]:[0m [1]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [3309]
[35m预测[2]:[0m [2]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [6977]
[35m预测[3]:[0m [3]
执行查询: ID=1874414819, DB=supervise
执行标准SQL: SELECT fii.institution_name, rr.report_type, rr.submission_date FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id WHERE rr.approval_status = '需修改' AND rr.submission_date >= '2023-07-01' AND rr.submission_date < '2023-10-01' ORDER BY rr.submission_date DESC;
执行预测SQL: SELECT fi.institution_name AS institution_name, rr.report_type AS report_type, rr.submission_date AS submission_date FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE rr.submission_date BETWEEN '2023-07-01' AND '2023-09-30' AND rr.approval_status = '需修改' ORDER BY rr.submission_date DESC
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: 2500
已处理 960/1042 个查询...
执行查询: ID=495816064, DB=supervise
执行标准SQL: SELECT fii.institution_name
FROM capital_adequacy_ratio car
JOIN non_performing_loans npl ON car.institution_id = npl.institution_id AND car.report_date = npl.report_date
JOIN financial_institution_info fii ON car.institution_id = fii.institution_id
WHERE car.total_car <= (SELECT PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY total_car) FROM capital_adequacy_ratio)
AND npl.npl_ratio < (SELECT AVG(npl_ratio) FROM non_performing_loans);
执行预测SQL: ERROR: 无法提取最终 SQL
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4161304037, DB=supervise
执行标准SQL: SELECT registered_capital, institution_type FROM financial_institution_info;
执行预测SQL: SELECT registered_capital AS registered_capital, institution_type AS institution_type FROM financial_institution_info
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=1631317162, DB=supervise
执行标准SQL: SELECT establishment_date, legal_representative FROM financial_institution_info;
执行预测SQL: SELECT establishment_date AS establishment_date, legal_representative AS legal_representative FROM financial_institution_info
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=2784626903, DB=supervise
执行标准SQL: SELECT * FROM compliance_records WHERE status = '已解决';
执行预测SQL: SELECT record_id AS record_id, institution_id AS institution_id, record_date AS record_date, compliance_type AS compliance_type, description AS description, severity AS severity, status AS status, resolution_date AS resolution_date FROM compliance_records WHERE status = '已解决'
标准SQL执行成功，行数: 3333
预测SQL执行成功，行数: 3333
执行查询: ID=1450759690, DB=supervise
执行标准SQL: SELECT fii.institution_name, rr.approval_status, npl.npl_ratio FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id AND rr.report_date = npl.report_date WHERE rr.report_date = '2023-07-01' AND rr.approval_status = '需修改' AND npl.npl_ratio > 1.00;
执行预测SQL: SELECT fi.institution_name AS institution_name, rr.approval_status AS approval_status, npl.npl_ratio AS npl_ratio 
FROM regulatory_reports rr 
JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id 
JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id 
WHERE rr.report_date BETWEEN '2023-07-01' AND '2023-07-31' 
AND npl.report_date BETWEEN '2023-07-01' AND '2023-07-31' 
AND rr.approval_status = '需修改' 
AND npl.npl_ratio > 1
标准SQL执行成功，行数: 833
预测SQL执行成功，行数: 833
执行查询: ID=862814083, DB=supervise
执行标准SQL: SELECT institution_id FROM liquidity_ratio ORDER BY ABS(loan_to_deposit_ratio - 1) LIMIT 1;
执行预测SQL: SELECT institution_id, ABS(loans_and_advances / deposits - 1) AS ratio_diff FROM balance_sheet ORDER BY ratio_diff LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 列数不匹配: 标准SQL返回1列, 预测SQL返回2列
[1m分类结果:[0m [35m投影错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_id]
[35m预测SQL列:[0m [institution_id ratio_diff]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [461]
[35m预测[1]:[0m [4303 4.834074109214898e-05]
执行查询: ID=2681992996, DB=supervise
执行标准SQL: SELECT institution_id FROM non_performing_loans WHERE total_loans > 100000000000;
执行预测SQL: SELECT financial_institution_info.institution_id AS institution_id FROM non_performing_loans JOIN financial_institution_info ON non_performing_loans.institution_id = financial_institution_info.institution_id WHERE non_performing_loans.total_loans > 100000000000
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
执行查询: ID=3797835240, DB=supervise
执行标准SQL: SELECT cash_and_equivalents FROM balance_sheet WHERE report_date = '2026-04-27';
执行预测SQL: SELECT cash_and_equivalents AS cash_equivalent_amount FROM balance_sheet WHERE report_date = '2026-04-27'
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=788537141, DB=supervise
执行标准SQL: SELECT institution_id FROM capital_adequacy_ratio WHERE core_tier_1_ratio < 9;
执行预测SQL: SELECT DISTINCT institution_id AS institution_id
FROM capital_adequacy_ratio
WHERE core_tier_1_ratio < 9
标准SQL执行成功，行数: 6633
预测SQL执行成功，行数: 6633
执行查询: ID=2511418954, DB=supervise
执行标准SQL: SELECT fi.institution_name, rr.report_type, rr.approval_status, npl.npl_ratio FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id WHERE rr.submission_date >= '2023-01-01' AND rr.submission_date < '2024-01-01' AND rr.report_type = '季度报告' AND rr.approval_status = '已拒绝' AND npl.report_date >= '2023-01-01' AND npl.report_date < '2024-01-01' AND npl.npl_ratio > 2.00;
执行预测SQL: SELECT 
    fi.institution_name AS institution_name,
    rr.report_type AS report_type,
    rr.approval_status AS approval_status,
    npl.npl_ratio AS npl_ratio
FROM 
    regulatory_reports rr
JOIN 
    financial_institution_info fi ON rr.institution_id = fi.institution_id
JOIN 
    non_performing_loans npl ON rr.institution_id = npl.institution_id
WHERE 
    rr.report_type = '季度报告'
    AND rr.approval_status = '已拒绝'
    AND rr.submission_date BETWEEN '2023-01-01' AND '2023-12-31'
    AND npl.report_date BETWEEN '2023-01-01' AND '2023-12-31'
    AND npl.npl_ratio > 2
标准SQL执行成功，行数: 811
预测SQL执行成功，行数: 811
已处理 970/1042 个查询...
执行查询: ID=133973236, DB=supervise
执行标准SQL: SELECT COUNT(*) FROM (SELECT institution_id FROM capital_adequacy_ratio ORDER BY risk_weighted_assets / (SELECT total_assets FROM balance_sheet WHERE balance_sheet.institution_id = capital_adequacy_ratio.institution_id AND balance_sheet.report_date = capital_adequacy_ratio.report_date) DESC LIMIT 10) AS top_institutions WHERE institution_id IN (SELECT institution_id FROM risk_exposure WHERE market_risk_exposure > (SELECT AVG(market_risk_exposure) FROM risk_exposure));
执行预测SQL: SELECT COUNT(*) AS count FROM (
    SELECT DISTINCT r.institution_id
    FROM (
        SELECT b.institution_id
        FROM balance_sheet b
        JOIN capital_adequacy_ratio c ON b.institution_id = c.institution_id AND b.report_date = c.report_date
        WHERE b.total_assets > 0
        ORDER BY (c.risk_weighted_assets / b.total_assets) DESC
        LIMIT 10
    ) AS top_institutions
    JOIN risk_exposure r ON top_institutions.institution_id = r.institution_id
    WHERE r.market_risk_exposure > 0
) AS result
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [count]
[35m预测SQL列:[0m [count]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [5]
[35m预测[1]:[0m [0]
执行查询: ID=580723534, DB=supervise
执行标准SQL: SELECT AVG(branch_count) AS average_branch_count FROM (SELECT institution_id, COUNT(*) AS branch_count FROM financial_institution_info GROUP BY institution_id) AS branch_counts;
执行预测SQL: SELECT (SELECT COUNT(*) FROM balance_sheet) / (SELECT COUNT(*) FROM financial_institution_info) AS average_branch_count
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [average_branch_count]
[35m预测SQL列:[0m [average_branch_count]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [1]
[35m预测[1]:[0m [0]
执行查询: ID=627590872, DB=supervise
执行标准SQL: SELECT fi.institution_id, fi.institution_name FROM financial_institution_info fi JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id JOIN risk_exposure re ON fi.institution_id = re.institution_id WHERE car.core_tier_1_ratio < 8.5 AND (re.market_risk_exposure / re.total_risk_exposure) > 0.2;
执行预测SQL: SELECT f.institution_id AS institution_id, f.institution_name AS institution_name 
FROM financial_institution_info f 
WHERE EXISTS (SELECT 1 FROM risk_exposure re WHERE re.institution_id = f.institution_id AND re.market_risk_exposure > 20) 
AND EXISTS (SELECT 1 FROM capital_adequacy_ratio car WHERE car.institution_id = f.institution_id AND car.core_tier_1_ratio < 8.5)
标准SQL执行成功，行数: 2850
预测SQL执行成功，行数: 4986

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2850行, 预测SQL返回4986行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_id institution_name]
[35m预测SQL列:[0m [institution_name institution_id]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [1 中国进出口银行]
[35m预测[1]:[0m [中国进出口银行 1]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [6 国家开发银行]
[35m预测[2]:[0m [国家开发银行 6]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [7 广州农村商业银行]
[35m预测[3]:[0m [广州农村商业银行 7]
执行查询: ID=3208012990, DB=supervise
执行标准SQL: SELECT fii.institution_name, car.core_tier_1_ratio, car.tier_1_ratio, car.total_car FROM capital_adequacy_ratio car JOIN financial_institution_info fii ON car.institution_id = fii.institution_id WHERE car.report_date = '2023-12-01' AND car.core_tier_1_ratio < 10 AND car.total_car < 12;
执行预测SQL: SELECT fi.institution_name, car.core_tier_1_ratio, car.tier_1_ratio, car.total_car 
FROM capital_adequacy_ratio car 
JOIN financial_institution_info fi ON car.institution_id = fi.institution_id 
WHERE car.report_date = '2023-12-01' 
AND car.core_tier_1_ratio < 10 
AND car.total_car < 12
标准SQL执行成功，行数: 235
预测SQL执行成功，行数: 235
执行查询: ID=377707744, DB=supervise
执行标准SQL: SELECT COUNT(*) FROM compliance_records WHERE record_date >= '2023-01-01' AND record_date < '2024-01-01' AND severity = '高';
执行预测SQL: SELECT COUNT(*) AS count FROM compliance_records WHERE severity = '高' AND EXTRACT(YEAR FROM record_date) = 2023
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=2467976254, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM balance_sheet bs JOIN financial_institution_info fii ON bs.institution_id = fii.institution_id ORDER BY (bs.cash_and_equivalents / bs.total_assets) DESC LIMIT 1;
执行预测SQL: SELECT fi.institution_name, (bs.cash_and_equivalents / bs.total_assets) AS cash_ratio FROM balance_sheet bs JOIN financial_institution_info fi ON bs.institution_id = fi.institution_id ORDER BY cash_ratio DESC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 列数不匹配: 标准SQL返回1列, 预测SQL返回2列
[1m分类结果:[0m [35m投影错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_name]
[35m预测SQL列:[0m [institution_name cash_ratio]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [广州农村商业银行]
[35m预测[1]:[0m [广州农村商业银行 0.4563484221812004]
执行查询: ID=416448494, DB=supervise
执行标准SQL: SELECT fi.institution_name FROM financial_institution_info fi JOIN risk_exposure re ON fi.institution_id = re.institution_id WHERE (re.market_risk_exposure / re.total_risk_exposure) > 0.4;
执行预测SQL: SELECT fi.institution_name 
FROM financial_institution_info fi
JOIN risk_exposure re ON fi.institution_id = re.institution_id
WHERE re.market_risk_exposure > 0.4 * re.total_risk_exposure
标准SQL执行成功，行数: 1199
预测SQL执行成功，行数: 1199
执行查询: ID=1582694445, DB=supervise
执行标准SQL: SELECT fi.institution_name, rr.approval_status, rr.comments 
FROM regulatory_reports rr 
JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id 
WHERE rr.report_date >= '2023-01-01' AND rr.report_date < '2024-01-01' 
ORDER BY rr.approval_status DESC, rr.comments DESC;
执行预测SQL: SELECT fi.institution_name AS institution_name, rr.approval_status AS approval_status, rr.comments AS comments
FROM regulatory_reports rr
JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id
WHERE rr.report_date BETWEEN '2023-01-01' AND '2023-12-31'
ORDER BY 
    CASE 
        WHEN rr.approval_status = '已批准' THEN 1 
        WHEN rr.approval_status = '需修改' THEN 2 
        WHEN rr.approval_status = '待审核' THEN 3 
        WHEN rr.approval_status = '已拒绝' THEN 4 
        ELSE 5 
    END,
    fi.institution_name
标准SQL执行成功，行数: 7500
预测SQL执行成功，行数: 7500
执行查询: ID=3631241992, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM financial_institution_info fii JOIN capital_adequacy_ratio car ON fii.institution_id = car.institution_id JOIN regulatory_reports rr ON fii.institution_id = rr.institution_id WHERE car.report_date >= '2023-01-01' AND car.report_date < '2024-01-01' AND car.core_tier_1_ratio < 8 AND rr.approval_status = '已批准';
执行预测SQL: SELECT fi.institution_name AS institution_name
FROM financial_institution_info fi
JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id
JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id
WHERE car.report_date BETWEEN '2023-01-01' AND '2023-12-31'
AND car.core_tier_1_ratio < 8
AND rr.approval_status = '已批准'
AND rr.report_date BETWEEN '2023-01-01' AND '2023-12-31'
标准SQL执行成功，行数: 559
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回559行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3632342709, DB=supervise
执行标准SQL: SELECT institution_id, credit_risk_exposure, operational_risk_exposure FROM risk_exposure WHERE report_date >= '2024-01-01' AND report_date < '2024-02-01';
执行预测SQL: SELECT institution_id, credit_risk_exposure AS credit_risk_exposure, operational_risk_exposure AS operational_risk_exposure FROM risk_exposure WHERE report_date BETWEEN '2024-01-01' AND '2024-01-31'
标准SQL执行成功，行数: 833
预测SQL执行成功，行数: 833
已处理 980/1042 个查询...
执行查询: ID=2274602916, DB=supervise
执行标准SQL: SELECT record_id, institution_id, record_date, resolution_date, description, severity, status, compliance_type FROM compliance_records WHERE record_date = '2023-04-02';
执行预测SQL: SELECT record_id AS record_id, institution_id AS institution_id, record_date AS record_date, resolution_date AS resolution_date, description AS description, severity AS severity, status AS status, compliance_type AS compliance_type FROM compliance_records WHERE record_date::date = '2023-04-02'
标准SQL执行成功，行数: 30
预测SQL执行成功，行数: 30
执行查询: ID=3547022021, DB=supervise
执行标准SQL: SELECT npl.report_date, npl.npl_ratio, car.total_car FROM non_performing_loans npl JOIN capital_adequacy_ratio car ON npl.institution_id = car.institution_id AND npl.report_date = car.report_date ORDER BY npl.report_date;
执行预测SQL: ERROR: LLM 请求失败
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
预测SQL执行错误: SQL执行失败: pq: syntax error at or near "ERROR"
执行查询: ID=4106988075, DB=supervise
执行标准SQL: SELECT institution_id, provision_coverage_ratio FROM non_performing_loans WHERE provision_coverage_ratio > 150
执行预测SQL: SELECT institution_id AS institution_id, provision_coverage_ratio AS provision_coverage_ratio FROM non_performing_loans WHERE provision_coverage_ratio > 150
标准SQL执行成功，行数: 9999
预测SQL执行成功，行数: 9999
执行查询: ID=1714782457, DB=supervise
执行标准SQL: SELECT * FROM related_party_transactions WHERE transaction_date = '2023-12-22';
执行预测SQL: SELECT transaction_id AS transaction_id, institution_id AS institution_id, transaction_date AS transaction_date, related_party AS related_party, transaction_type AS transaction_type, transaction_amount AS transaction_amount, approval_status AS approval_status FROM related_party_transactions WHERE transaction_date = '2023-12-22'
标准SQL执行成功，行数: 34
预测SQL执行成功，行数: 34
执行查询: ID=663454855, DB=supervise
执行标准SQL: SELECT fi.institution_name FROM financial_institution_info fi JOIN liquidity_ratio lr ON fi.institution_id = lr.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE lr.liquidity_coverage_ratio > 110 AND npl.npl_ratio < 1.5;
执行预测SQL: SELECT fi.institution_name AS institution_name FROM financial_institution_info fi INNER JOIN liquidity_ratio lr ON fi.institution_id = lr.institution_id INNER JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE lr.liquidity_coverage_ratio > 110 AND npl.npl_ratio < 1.5
标准SQL执行成功，行数: 2698
预测SQL执行成功，行数: 2698
执行查询: ID=1930062711, DB=supervise
执行标准SQL: SELECT r.institution_id, f.institution_name, r.report_type, r.approval_status, n.npl_ratio FROM regulatory_reports r JOIN financial_institution_info f ON r.institution_id = f.institution_id JOIN non_performing_loans n ON r.institution_id = n.institution_id WHERE r.submission_date >= '2023-01-01' AND r.submission_date < '2024-01-01' AND r.report_type = '季度报告' AND r.approval_status = '需修改' AND n.npl_ratio > 2.00;
执行预测SQL: SELECT r.institution_id AS institution_id, fi.institution_name AS institution_name, r.report_type AS report_type, r.approval_status AS approval_status, npl.npl_ratio AS npl_ratio FROM regulatory_reports r JOIN financial_institution_info fi ON r.institution_id = fi.institution_id JOIN non_performing_loans npl ON r.institution_id = npl.institution_id WHERE r.report_date BETWEEN '2023-01-01' AND '2023-12-31' AND r.report_type = '季度报告' AND r.approval_status = '需修改' AND npl.npl_ratio > 2
标准SQL执行成功，行数: 811
预测SQL执行成功，行数: 811
执行查询: ID=166707732, DB=supervise
执行标准SQL: SELECT institution_id, AVG(net_profit / (net_interest_income + non_interest_income)) AS avg_net_profit_margin FROM income_statement WHERE report_date >= date('now') - INTERVAL '2 years' GROUP BY institution_id ORDER BY avg_net_profit_margin DESC LIMIT 5;
执行预测SQL: SELECT institution_id, AVG(net_profit / (net_interest_income + non_interest_income)) AS avg_net_profit_margin FROM income_statement WHERE report_date >= CURRENT_DATE - INTERVAL '2 years' GROUP BY institution_id ORDER BY avg_net_profit_margin DESC LIMIT 5
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=833967887, DB=supervise
执行标准SQL: SELECT fi.institution_type, AVG(npl.npl_ratio) as avg_npl_ratio
           FROM non_performing_loans npl
           JOIN financial_institution_info fi ON npl.institution_id = fi.institution_id
           WHERE EXTRACT(YEAR FROM npl.report_date) = 2023
           GROUP BY fi.institution_type
执行预测SQL: SELECT fi.institution_type, AVG(npl.npl_ratio) AS avg_npl_ratio FROM financial_institution_info fi JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE EXTRACT(YEAR FROM npl.report_date) = 2023 GROUP BY fi.institution_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=4204116228, DB=supervise
执行标准SQL: SELECT COUNT(DISTINCT re.institution_id) FROM risk_exposure re JOIN capital_adequacy_ratio car ON re.institution_id = car.institution_id AND re.report_date = car.report_date WHERE re.market_risk_exposure > (SELECT market_risk_exposure * 1.5 FROM risk_exposure WHERE institution_id = re.institution_id AND report_date < re.report_date ORDER BY report_date DESC LIMIT 1) AND car.total_car < (SELECT total_car + 1 FROM capital_adequacy_ratio WHERE institution_id = car.institution_id AND report_date < car.report_date ORDER BY report_date DESC LIMIT 1);
执行预测SQL: SELECT COUNT(DISTINCT r.institution_id)
FROM (
    SELECT institution_id
    FROM (
        SELECT 
            institution_id,
            market_risk_exposure,
            LAG(market_risk_exposure, 1) OVER (PARTITION BY institution_id ORDER BY report_date) AS prev_market_risk
        FROM liquidity_ratio
    ) r
    WHERE prev_market_risk IS NOT NULL
    AND (market_risk_exposure - prev_market_risk) / prev_market_risk > 0.5
) AS risk_institutions
JOIN (
    SELECT institution_id
    FROM (
        SELECT 
            institution_id,
            total_car,
            LAG(total_car, 1) OVER (PARTITION BY institution_id ORDER BY report_date) AS prev_total_car
        FROM capital_adequacy_ratio
    ) c
    WHERE prev_total_car IS NOT NULL
    AND ABS(total_car - prev_total_car) < 1
) AS car_institutions
ON risk_institutions.institution_id = car_institutions.institution_id
预测SQL执行错误: SQL执行失败: pq: column "market_risk_exposure" does not exist
预测SQL执行错误: SQL执行失败: pq: column "market_risk_exposure" does not exist
执行查询: ID=771560804, DB=supervise
执行标准SQL: SELECT institution_id, SUM(total_assets) AS total_assets, SUM(total_liabilities) AS total_liabilities FROM balance_sheet GROUP BY institution_id;
执行预测SQL: SELECT institution_id AS institution_id, total_assets AS total_assets, total_liabilities AS total_liabilities FROM balance_sheet
标准SQL执行成功，行数: 9997
预测SQL执行成功，行数: 9997
已处理 990/1042 个查询...
执行查询: ID=1414769749, DB=supervise
执行标准SQL: SELECT fii.institution_name, rr.approval_status, rpt.transaction_amount FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id JOIN related_party_transactions rpt ON rr.institution_id = rpt.institution_id WHERE rr.approval_status = '需修改' AND rr.report_date = '2023-07-01' AND rpt.transaction_amount > 5000000;
执行预测SQL: SELECT 
    fi.institution_name AS institution_name,
    rr.approval_status AS report_status,
    rptr.transaction_amount AS transaction_amount
FROM 
    financial_institution_info fi
JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id
JOIN related_party_transactions rptr ON fi.institution_id = rptr.institution_id
WHERE 
    rr.report_date BETWEEN '2023-07-01' AND '2023-07-31'
    AND rr.approval_status = '需修改'
    AND rptr.transaction_amount > 500
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: 2500
执行查询: ID=2946947084, DB=supervise
执行标准SQL: SELECT AVG(total_car) FROM capital_adequacy_ratio WHERE institution_id IN (SELECT institution_id FROM balance_sheet WHERE total_assets > 10000000000000);
执行预测SQL: SELECT AVG(c.total_car) AS avg_car FROM capital_adequacy_ratio c JOIN balance_sheet b ON c.institution_id = b.institution_id AND c.report_date = b.report_date WHERE b.total_assets > 1000000000000
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=68375114, DB=supervise
执行标准SQL: SELECT * FROM risk_exposure WHERE report_date = '2023-10-01';
执行预测SQL: SELECT risk_exposure_id AS risk_exposure_id, institution_id AS institution_id, report_date AS report_date, credit_risk_exposure AS credit_risk_exposure, market_risk_exposure AS market_risk_exposure, operational_risk_exposure AS operational_risk_exposure, total_risk_exposure AS total_risk_exposure FROM risk_exposure WHERE report_date = '2023-10-01'
标准SQL执行成功，行数: 834
预测SQL执行成功，行数: 834
执行查询: ID=1086344523, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM financial_institution_info fii JOIN related_party_transactions rpt ON fii.institution_id = rpt.institution_id JOIN regulatory_reports rr ON fii.institution_id = rr.institution_id WHERE rpt.transaction_amount > 5000000 AND rpt.transaction_date = '2023-06-01' AND rr.approval_status = '已批准';
执行预测SQL: SELECT fi.institution_name AS institution_name
FROM financial_institution_info fi
JOIN related_party_transactions rpt ON fi.institution_id = rpt.institution_id
JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id
WHERE rpt.transaction_date = '2023-06-01'
AND rpt.transaction_amount > 5000000
AND rr.approval_status = '已批准'
标准SQL执行成功，行数: 2
预测SQL执行成功，行数: 2
执行查询: ID=1266365033, DB=supervise
执行标准SQL: SELECT corr(b.total_assets, c.total_car) AS correlation_coefficient
FROM balance_sheet b
JOIN capital_adequacy_ratio c ON b.institution_id = c.institution_id AND b.report_date = c.report_date;
执行预测SQL: SELECT CORR(b.total_assets, c.total_car) AS correlation_coefficient FROM balance_sheet b JOIN capital_adequacy_ratio c ON b.institution_id = c.institution_id AND b.report_date = c.report_date
执行查询: ID=152560977, DB=supervise
执行标准SQL: WITH transaction_stats AS (
             SELECT institution_id,
                    COUNT(*) as total_transactions,
                    SUM(CASE WHEN approval_status != '已批准' THEN 1 ELSE 0 END) as unapproved_transactions
             FROM related_party_transactions
             WHERE EXTRACT(YEAR FROM transaction_date) = 2023
             GROUP BY institution_id
           )
           SELECT fi.institution_name,
                  (ts.unapproved_transactions / NULLIF(ts.total_transactions, 0)) * 100 as unapproved_ratio
           FROM transaction_stats ts
           JOIN financial_institution_info fi ON ts.institution_id = fi.institution_id
           WHERE (ts.unapproved_transactions / NULLIF(ts.total_transactions, 0)) > 0.2
           ORDER BY unapproved_ratio DESC
执行预测SQL: SELECT fi.institution_name, (rt.unapproved_amount * 100.0 / rt.total_amount) AS unapproved_ratio 
FROM financial_institution_info fi 
JOIN (
    SELECT institution_id, 
           SUM(CASE WHEN approval_status = '已拒绝' THEN transaction_amount ELSE 0 END) AS unapproved_amount, 
           SUM(transaction_amount) AS total_amount 
    FROM related_party_transactions 
    WHERE EXTRACT(YEAR FROM transaction_date) = 2023 
    GROUP BY institution_id 
    HAVING (SUM(CASE WHEN approval_status = '已拒绝' THEN transaction_amount ELSE 0 END) * 100.0 / SUM(transaction_amount)) > 20
) rt 
ON fi.institution_id = rt.institution_id
标准SQL执行成功，行数: 6662
预测SQL执行成功，行数: 3329

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回6662行, 预测SQL返回3329行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_name unapproved_ratio]
[35m预测SQL列:[0m [institution_name unapproved_ratio]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [中国进出口银行 100]
[35m预测[1]:[0m [广州农村商业银行 100]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [广州农村商业银行 100]
[35m预测[2]:[0m [中国工商银行重庆分行 100]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [中金公司 100]
[35m预测[3]:[0m [深圳福田村镇银行 100]
执行查询: ID=3829846580, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id JOIN non_performing_loans npl ON fii.institution_id = npl.institution_id WHERE rr.report_date = '2023-07-01' AND rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND npl.npl_ratio > 2.00;
执行预测SQL: SELECT DISTINCT fi.institution_name AS institution_name FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE rr.report_date = '2023-07-01' AND rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND npl.npl_ratio > 2
标准SQL执行成功，行数: 811
预测SQL执行成功，行数: 7

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回811行, 预测SQL返回7行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_name]
[35m预测SQL列:[0m [institution_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [国家开发银行]
[35m预测[1]:[0m [中国农业发展银行]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [中国工商银行北京分行]
[35m预测[2]:[0m [中国工商银行北京分行]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [深圳福田村镇银行]
[35m预测[3]:[0m [中国进出口银行]
执行查询: ID=3809349460, DB=supervise
执行标准SQL: SELECT r.institution_id, r.approval_status, c.compliance_type, c.severity, c.status 
FROM regulatory_reports r 
JOIN compliance_records c ON r.institution_id = c.institution_id 
WHERE EXTRACT(YEAR FROM r.report_date) = 2023;
执行预测SQL: SELECT r.institution_id AS institution_id, r.approval_status AS approval_status, c.compliance_type AS compliance_type, c.severity AS severity, c.status AS status FROM regulatory_reports r JOIN compliance_records c ON r.institution_id = c.institution_id WHERE r.report_date BETWEEN '2023-01-01' AND '2023-12-31' AND c.record_date BETWEEN '2023-01-01' AND '2023-12-31'
标准SQL执行成功，行数: 7500
预测SQL执行成功，行数: 7495

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回7500行, 预测SQL返回7495行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [compliance_type severity status institution_id approval_status]
[35m预测SQL列:[0m [approval_status compliance_type severity status institution_id]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [内控管理 中 处理中 1 待审核]
[35m预测[1]:[0m [待审核 内控管理 中 处理中 1]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [信息披露 高 未解决 2 需修改]
[35m预测[2]:[0m [需修改 信息披露 高 未解决 2]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [客户权益保护 严重 已解决 3 已拒绝]
[35m预测[3]:[0m [已拒绝 客户权益保护 严重 已解决 3]
执行查询: ID=3887529815, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id WHERE rr.report_date = '2023-10-01' AND rr.report_type = '半年度报告' AND npl.npl_ratio > 2.0;
执行预测SQL: SELECT f.institution_name AS institution_name
FROM financial_institution_info f
JOIN regulatory_reports rr ON f.institution_id = rr.institution_id
JOIN non_performing_loans npl ON f.institution_id = npl.institution_id
WHERE rr.report_date = '2023-10-01'
AND rr.report_type = '半年度报告'
AND npl.npl_ratio > 2
AND npl.report_date = '2023-10-01'
标准SQL执行成功，行数: 817
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回817行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1095324516, DB=supervise
执行标准SQL: SELECT institution_id, liquidity_coverage_ratio, net_stable_funding_ratio FROM liquidity_ratio WHERE report_date >= '2023-05-01' AND report_date < '2023-06-01';
执行预测SQL: SELECT institution_id AS institution_id, liquidity_coverage_ratio AS liquidity_coverage_ratio, net_stable_funding_ratio AS net_stable_funding_ratio FROM liquidity_ratio WHERE report_date BETWEEN '2023-05-01' AND '2023-05-31'
标准SQL执行成功，行数: 31
预测SQL执行成功，行数: 31
已处理 1000/1042 个查询...
执行查询: ID=2608079409, DB=supervise
执行标准SQL: SELECT institution_id, SUM(non_interest_income) AS total_non_interest_income FROM income_statement WHERE report_date = '2023-03-01' GROUP BY institution_id;
执行预测SQL: SELECT institution_id, SUM(non_interest_income) AS total_non_interest_income FROM income_statement WHERE report_date = '2023-03-01' GROUP BY institution_id
执行查询: ID=1384996686, DB=supervise
执行标准SQL: SELECT * FROM risk_exposure WHERE report_date = '2023-02-01';
执行预测SQL: SELECT risk_exposure_id AS risk_exposure_id, institution_id AS institution_id, report_date AS report_date, credit_risk_exposure AS credit_risk_exposure, market_risk_exposure AS market_risk_exposure, operational_risk_exposure AS operational_risk_exposure, total_risk_exposure AS total_risk_exposure FROM risk_exposure WHERE report_date = '2023-02-01'
标准SQL执行成功，行数: 833
预测SQL执行成功，行数: 833
执行查询: ID=2903384914, DB=supervise
执行标准SQL: SELECT COUNT(*) FROM related_party_transactions WHERE transaction_amount > 500000000 AND transaction_type = '资产转移' AND EXTRACT(YEAR FROM transaction_date) = 2023;
执行预测SQL: SELECT COUNT(*) AS count FROM related_party_transactions WHERE EXTRACT(YEAR FROM transaction_date) = 2023 AND transaction_type = '资产转移' AND transaction_amount > 500000000
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=1640671061, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id JOIN related_party_transactions rpt ON rr.institution_id = rpt.institution_id WHERE rr.approval_status = '需修改' AND rr.submission_date = '2023-08-01' AND rpt.transaction_amount > 5000000;
执行预测SQL: SELECT fi.institution_name AS institution_name
FROM financial_institution_info fi
WHERE fi.institution_id IN (
    SELECT institution_id
    FROM regulatory_reports
    WHERE report_date = '2023-08-01' AND approval_status = '需修改'
)
AND fi.institution_id IN (
    SELECT institution_id
    FROM related_party_transactions
    GROUP BY institution_id
    HAVING SUM(transaction_amount) > 5000000
)
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2500行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3904574419, DB=supervise
执行标准SQL: SELECT r.institution_id, f.institution_name FROM regulatory_reports r JOIN financial_institution_info f ON r.institution_id = f.institution_id JOIN income_statement i ON r.institution_id = i.institution_id WHERE r.submission_date >= '2023-01-01' AND r.submission_date < '2024-01-01' AND r.report_type = '季度报告' AND r.approval_status = '已拒绝' AND i.report_date >= '2023-01-01' AND i.report_date < '2023-04-01' AND i.net_profit > 10000000;
执行预测SQL: SELECT DISTINCT r.institution_id AS institution_id, fi.institution_name AS institution_name 
FROM regulatory_reports r 
JOIN financial_institution_info fi ON r.institution_id = fi.institution_id 
JOIN income_statement i ON r.institution_id = i.institution_id 
WHERE r.report_type = '季度报告' 
AND r.approval_status = '已拒绝' 
AND r.submission_date BETWEEN '2023-01-01' AND '2023-12-31' 
AND i.report_date BETWEEN '2023-01-01' AND '2023-03-31' 
AND i.net_profit > 10000000
标准SQL执行成功，行数: 833
预测SQL执行成功，行数: 833
执行查询: ID=493525183, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id WHERE rr.report_date = '2023-07-01' AND rr.report_type = '季度报告' AND rr.approval_status = '需修改';
执行预测SQL: SELECT fi.institution_name AS institution_name FROM financial_institution_info fi JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id WHERE rr.submission_date = '2023-07-01' AND rr.approval_status = '需要修改'
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2500行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3146074594, DB=supervise
执行标准SQL: SELECT * FROM compliance_records WHERE compliance_type = '内控管理';
执行预测SQL: SELECT record_id AS record_id, institution_id AS institution_id, record_date AS record_date, compliance_type AS compliance_type, description AS description, severity AS severity, status AS status, resolution_date AS resolution_date FROM compliance_records WHERE compliance_type = '内控管理'
标准SQL执行成功，行数: 2000
预测SQL执行成功，行数: 2000
执行查询: ID=2337714646, DB=supervise
执行标准SQL: SELECT fii.institution_name, rr.report_type, rr.approval_status, npl.npl_ratio FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id JOIN non_performing_loans npl ON fii.institution_id = npl.institution_id WHERE rr.report_type = '半年度报告' AND rr.approval_status = '待审核' AND rr.report_date >= '2023-10-01' AND rr.report_date < '2023-11-01' AND npl.npl_ratio > 1.00;
执行预测SQL: SELECT 
    fi.institution_name AS institution_name,
    rr.report_type AS report_type,
    rr.approval_status AS approval_status,
    npl.npl_ratio AS npl_ratio
FROM 
    regulatory_reports rr
JOIN 
    financial_institution_info fi ON rr.institution_id = fi.institution_id
JOIN 
    non_performing_loans npl ON rr.institution_id = npl.institution_id AND rr.report_date = npl.report_date
WHERE 
    rr.report_date BETWEEN '2023-10-01' AND '2023-10-31'
    AND rr.report_type = '半年度报告'
    AND rr.approval_status = '待审核'
    AND npl.npl_ratio > 1
标准SQL执行成功，行数: 2489
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2489行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=2791588181, DB=supervise
执行标准SQL: SELECT institution_type, PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY npl_ratio) AS median_npl_ratio FROM non_performing_loans JOIN financial_institution_info ON non_performing_loans.institution_id = financial_institution_info.institution_id GROUP BY institution_type;
执行预测SQL: SELECT institution_type, PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY npl_ratio) AS median_npl_ratio FROM financial_institution_info JOIN non_performing_loans ON financial_institution_info.institution_id = non_performing_loans.institution_id GROUP BY institution_type
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5
执行查询: ID=833263523, DB=supervise
执行标准SQL: SELECT * FROM capital_adequacy_ratio WHERE core_tier_1_ratio < 8;
执行预测SQL: SELECT car_id AS record_id, institution_id AS institution_id, report_date AS report_date, core_tier_1_ratio AS core_tier_1_ratio, tier_1_ratio AS tier_1_ratio, total_car AS total_car, risk_weighted_assets AS risk_weighted_assets FROM capital_adequacy_ratio WHERE core_tier_1_ratio < 8
标准SQL执行成功，行数: 3304
预测SQL执行成功，行数: 3304
已处理 1010/1042 个查询...
执行查询: ID=3179741002, DB=supervise
执行标准SQL: SELECT r.institution_id, f.institution_name, f.registered_capital, r.report_type, r.approval_status FROM regulatory_reports r JOIN financial_institution_info f ON r.institution_id = f.institution_id WHERE r.submission_date >= '2023-01-01' AND r.submission_date < '2024-01-01' AND r.report_type = '半年度报告' AND r.approval_status = '待审核' AND f.registered_capital > 50000000;
执行预测SQL: SELECT r.institution_id AS institution_id, fi.institution_name AS institution_name, fi.registered_capital AS registered_capital, r.report_type AS report_type, r.approval_status AS approval_status FROM regulatory_reports r JOIN financial_institution_info fi ON r.institution_id = fi.institution_id WHERE r.report_date >= '2023-01-01' AND r.report_date < '2024-01-01' AND r.report_type = '半年度报告' AND r.approval_status = '待审核' AND fi.registered_capital > 50000000
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: 2500
执行查询: ID=2065261887, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM financial_institution_info fii JOIN related_party_transactions rpt ON fii.institution_id = rpt.institution_id WHERE rpt.transaction_date = '2023-06-01' AND rpt.transaction_amount > 5000000 AND rpt.approval_status = '待审批';
执行预测SQL: SELECT fi.institution_name AS institution_name FROM related_party_transactions rpt JOIN financial_institution_info fi ON rpt.institution_id = fi.institution_id WHERE rpt.transaction_date = '2023-06-01' AND rpt.transaction_amount > 5000000 AND rpt.approval_status = '待审批'
标准SQL执行成功，行数: 9
预测SQL执行成功，行数: 9
执行查询: ID=2360476437, DB=supervise
执行标准SQL: SELECT lr.institution_id FROM liquidity_ratio lr WHERE lr.loan_to_deposit_ratio > (SELECT AVG(loan_to_deposit_ratio) FROM liquidity_ratio) AND lr.liquidity_coverage_ratio < (SELECT AVG(liquidity_coverage_ratio) FROM liquidity_ratio);
执行预测SQL: SELECT DISTINCT lr.institution_id AS institution_id
FROM liquidity_ratio lr
WHERE lr.loan_to_deposit_ratio > (SELECT AVG(loan_to_deposit_ratio) FROM liquidity_ratio)
  AND lr.liquidity_coverage_ratio < (SELECT AVG(liquidity_coverage_ratio) FROM liquidity_ratio)
标准SQL执行成功，行数: 2477
预测SQL执行成功，行数: 2477
执行查询: ID=1635102268, DB=supervise
执行标准SQL: SELECT f.institution_name FROM financial_institution_info f JOIN income_statement i ON f.institution_id = i.institution_id WHERE i.report_date = '2023-04-01' AND i.net_interest_income > 10000000000;
执行预测SQL: SELECT fi.institution_name AS institution_name FROM income_statement AS is_table JOIN financial_institution_info AS fi ON is_table.institution_id = fi.institution_id WHERE is_table.report_date = '2023-04-01' AND is_table.net_interest_income > 1000000000
标准SQL执行成功，行数: 747
预测SQL执行成功，行数: 833

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回747行, 预测SQL返回833行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_name]
[35m预测SQL列:[0m [institution_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [中金公司]
[35m预测[1]:[0m [中金公司]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [国家开发银行]
[35m预测[2]:[0m [国家开发银行]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [深圳福田村镇银行]
[35m预测[3]:[0m [深圳福田村镇银行]
执行查询: ID=890576370, DB=supervise
执行标准SQL: SELECT r.institution_id, r.report_id, r.report_type, r.approval_status, n.npl_ratio FROM regulatory_reports r JOIN non_performing_loans n ON r.institution_id = n.institution_id WHERE r.submission_date >= '2023-01-01' AND r.submission_date < '2024-01-01' AND r.report_type = '季度报告' AND r.approval_status = '需修改' AND n.report_date >= '2023-01-01' AND n.report_date < '2024-01-01' AND n.npl_ratio > 1.00;
执行预测SQL: SELECT 
    r.institution_id AS institution_id, 
    r.report_id AS report_id, 
    r.report_type AS report_type, 
    r.approval_status AS approval_status, 
    n.npl_ratio AS npl_ratio 
FROM 
    regulatory_reports r 
JOIN 
    non_performing_loans n 
ON 
    r.institution_id = n.institution_id 
WHERE 
    EXTRACT(YEAR FROM r.submission_date) = 2023 
    AND r.report_type = '季度报告' 
    AND r.approval_status = '需修改' 
    AND EXTRACT(YEAR FROM n.report_date) = 2023 
    AND n.npl_ratio > 0.01
标准SQL执行成功，行数: 2497
预测SQL执行成功，行数: 2500

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回2497行, 预测SQL返回2500行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [report_id report_type approval_status npl_ratio institution_id]
[35m预测SQL列:[0m [institution_id report_id report_type approval_status npl_ratio]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [2 季度报告 需修改 1.3 2]
[35m预测[1]:[0m [2 2 季度报告 需修改 1.3]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [6 季度报告 需修改 2.3 6]
[35m预测[2]:[0m [6 6 季度报告 需修改 2.3]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [10 季度报告 需修改 2.03 10]
[35m预测[3]:[0m [10 10 季度报告 需修改 2.03]
执行查询: ID=1878253672, DB=supervise
执行标准SQL: SELECT fii.institution_name, re.total_risk_exposure, car.core_tier_1_ratio FROM financial_institution_info fii JOIN risk_exposure re ON fii.institution_id = re.institution_id JOIN capital_adequacy_ratio car ON fii.institution_id = car.institution_id WHERE re.report_date = '2023-10-01' AND re.total_risk_exposure > 300000000000 AND car.core_tier_1_ratio < 8
执行预测SQL: SELECT fi.institution_name AS institution_name, re.total_risk_exposure AS total_risk_exposure, car.core_tier_1_ratio AS core_tier_1_ratio FROM financial_institution_info fi JOIN risk_exposure re ON fi.institution_id = re.institution_id JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id WHERE re.report_date = '2023-10-01' AND car.report_date = '2023-10-01' AND re.total_risk_exposure > 300000000000 AND car.core_tier_1_ratio < 8
标准SQL执行成功，行数: 268
预测SQL执行成功，行数: 268
执行查询: ID=860852233, DB=supervise
执行标准SQL: SELECT COUNT(DISTINCT re.institution_id) FROM risk_exposure re JOIN risk_exposure re_prev ON re.institution_id = re_prev.institution_id AND re.report_date = date('now') - INTERVAL '1 year' AND re_prev.report_date = date('now') - INTERVAL '2 years' WHERE (re.market_risk_exposure / re.credit_risk_exposure) / (re_prev.market_risk_exposure / re_prev.credit_risk_exposure) > 1.1 OR (re.market_risk_exposure / re.credit_risk_exposure) / (re_prev.market_risk_exposure / re_prev.credit_risk_exposure) < 0.9;
执行预测SQL: SELECT COUNT(DISTINCT institution_id) AS count FROM risk_exposure WHERE report_date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY institution_id HAVING COUNT(*) > 1 AND (MAX(market_risk_exposure) <> MIN(market_risk_exposure) OR MAX(credit_risk_exposure) <> MIN(credit_risk_exposure))
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=3387337626, DB=supervise
执行标准SQL: SELECT b.institution_id FROM balance_sheet b WHERE b.loans_and_advances > b.deposits;
执行预测SQL: SELECT DISTINCT institution_id AS institution_id FROM balance_sheet WHERE loans_and_advances > deposits
标准SQL执行成功，行数: 3245
预测SQL执行成功，行数: 3245
执行查询: ID=1310122613, DB=supervise
执行标准SQL: SELECT fii.institution_name, rr.report_date, rr.approval_status FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id WHERE rr.submission_date >= '2023-01-01' AND rr.submission_date <= '2023-12-31' AND rr.report_type = '季度报告' AND rr.approval_status = '已拒绝';
执行预测SQL: SELECT fi.institution_name AS institution_name, rr.report_date AS report_date, rr.approval_status AS approval_status 
FROM regulatory_reports rr 
JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id 
WHERE EXTRACT(YEAR FROM rr.report_date) = 2023 
AND rr.report_type = '季度报告' 
AND rr.approval_status = '已拒绝'
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: 2500
执行查询: ID=663309404, DB=supervise
执行标准SQL: SELECT f.institution_name FROM financial_institution_info f JOIN income_statement i ON f.institution_id = i.institution_id WHERE i.report_date = '2023-04-01' AND i.non_interest_income > 200000000;
执行预测SQL: SELECT fi.institution_name FROM income_statement AS is_table JOIN financial_institution_info fi ON is_table.institution_id = fi.institution_id WHERE is_table.report_date = '2023-04-01' AND is_table.non_interest_income > 200000000
标准SQL执行成功，行数: 833
预测SQL执行成功，行数: 833
已处理 1020/1042 个查询...
执行查询: ID=3052564664, DB=supervise
执行标准SQL: SELECT institution_id, COUNT(*) AS transaction_count FROM related_party_transactions WHERE transaction_date >= date('now') - INTERVAL '1 year' GROUP BY institution_id ORDER BY transaction_count DESC LIMIT 1;
执行预测SQL: SELECT institution_id, COUNT(*) AS transaction_count 
FROM related_party_transactions 
WHERE transaction_date >= CURRENT_DATE - INTERVAL '1 year' 
GROUP BY institution_id 
ORDER BY transaction_count DESC 
LIMIT 1
标准SQL执行成功，行数: -1
预测SQL执行成功，行数: -1
执行查询: ID=3564915606, DB=supervise
执行标准SQL: SELECT fi.institution_name, (re.credit_risk_exposure / re.total_risk_exposure * 100) AS credit_risk_percentage FROM financial_institution_info fi JOIN risk_exposure re ON fi.institution_id = re.institution_id ORDER BY credit_risk_percentage DESC LIMIT 1
执行预测SQL: SELECT fi.institution_name, (re.credit_risk_exposure / re.total_risk_exposure) * 100 AS credit_risk_percentage 
FROM financial_institution_info fi 
JOIN risk_exposure re ON fi.institution_id = re.institution_id 
ORDER BY credit_risk_percentage DESC 
LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=197691923, DB=supervise
执行标准SQL: SELECT DISTINCT institution_id FROM risk_exposure WHERE report_date >= '2023-01-01' AND report_date < '2024-01-01';
执行预测SQL: SELECT DISTINCT institution_id AS institution_id FROM risk_exposure WHERE report_date BETWEEN '2023-01-01' AND '2023-12-31'
标准SQL执行成功，行数: 9167
预测SQL执行成功，行数: 9167
执行查询: ID=4129983532, DB=supervise
执行标准SQL: SELECT institution_id FROM capital_adequacy_ratio WHERE report_date = '2023-11-01' AND risk_weighted_assets > 120000000000;
执行预测SQL: SELECT institution_id FROM capital_adequacy_ratio WHERE report_date >= '2023-11-01' AND report_date < '2023-12-01' AND risk_weighted_assets > 120000000000
标准SQL执行成功，行数: 834
预测SQL执行成功，行数: 834
执行查询: ID=2233736633, DB=supervise
执行标准SQL: SELECT severity, AVG(resolution_date - record_date) AS avg_resolution_time FROM compliance_records GROUP BY severity;
执行预测SQL: SELECT severity, AVG(resolution_date - record_date) AS avg_resolution_time FROM compliance_records WHERE resolution_date IS NOT NULL GROUP BY severity
标准SQL执行成功，行数: 4
预测SQL执行成功，行数: 4
执行查询: ID=2305237654, DB=supervise
执行标准SQL: SELECT COUNT(DISTINCT institution_id) FROM liquidity_ratio WHERE liquidity_coverage_ratio > 100 AND net_stable_funding_ratio > 100;
执行预测SQL: SELECT COUNT(DISTINCT institution_id) AS count FROM liquidity_ratio WHERE liquidity_coverage_ratio > 100 AND net_stable_funding_ratio > 100
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
执行查询: ID=2186326450, DB=supervise
执行标准SQL: SELECT AVG(npl_ratio) AS average_npl_ratio, AVG(provision_coverage_ratio) AS average_provision_coverage_ratio, AVG(total_car) AS average_total_car FROM (SELECT b.institution_id, n.npl_ratio, n.provision_coverage_ratio, c.total_car FROM balance_sheet b JOIN non_performing_loans n ON b.institution_id = n.institution_id AND b.report_date = n.report_date JOIN capital_adequacy_ratio c ON b.institution_id = c.institution_id AND b.report_date = c.report_date ORDER BY b.total_assets DESC LIMIT 1000) AS top_institutions;
执行预测SQL: SELECT 
    AVG(npl.npl_ratio) AS average_npl_ratio,
    AVG(npl.provision_coverage_ratio) AS average_provision_coverage_ratio,
    AVG(car.total_car) AS average_total_car
FROM 
    (SELECT institution_id FROM balance_sheet ORDER BY total_assets DESC LIMIT 1000) AS top_institutions
JOIN 
    non_performing_loans AS npl ON top_institutions.institution_id = npl.institution_id
JOIN 
    capital_adequacy_ratio AS car ON top_institutions.institution_id = car.institution_id
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [average_npl_ratio average_provision_coverage_ratio average_total_car]
[35m预测SQL列:[0m [average_npl_ratio average_provision_coverage_ratio average_total_car]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [<nil> <nil> <nil>]
[35m预测[1]:[0m [1.74396 199.52703 12.55814]
执行查询: ID=2638456489, DB=supervise
执行标准SQL: SELECT fii.institution_name, rr.report_type, npl.npl_ratio FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id WHERE rr.report_date = '2023-07-01' AND rr.report_type = '季度报告' AND npl.npl_ratio > 1.5;
执行预测SQL: SELECT fi.institution_name AS institution_name, rr.report_type AS report_type, npl.npl_ratio AS npl_ratio FROM financial_institution_info fi JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE rr.report_date = '2023-07-01' AND rr.report_type = '季度报告' AND npl.report_date = '2023-07-01' AND npl.npl_ratio > 1.5
标准SQL执行成功，行数: 1656
预测SQL执行成功，行数: 578

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1656行, 预测SQL返回578行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [report_type npl_ratio institution_name]
[35m预测SQL列:[0m [institution_name report_type npl_ratio]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [季度报告 2.3 国家开发银行]
[35m预测[1]:[0m [国家开发银行 季度报告 2.3]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [季度报告 2.03 中国工商银行北京分行]
[35m预测[2]:[0m [深圳福田村镇银行 季度报告 2.38]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [季度报告 2.38 深圳福田村镇银行]
[35m预测[3]:[0m [中国工商银行北京分行 季度报告 2.37]
执行查询: ID=3113756288, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id JOIN non_performing_loans npl ON fii.institution_id = npl.institution_id WHERE rr.report_date = '2024-01-01' AND rr.report_type = '年度报告' AND rr.approval_status = '已批准' AND npl.report_date = '2024-01-01' AND npl.npl_ratio > 1.0;
执行预测SQL: SELECT fi.institution_name 
FROM financial_institution_info fi 
JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id 
JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id 
WHERE rr.report_date = '2024-01-01' 
AND rr.report_type = '年度报告' 
AND rr.approval_status = '已批准' 
AND npl.report_date = '2024-01-01' 
AND npl.npl_ratio > 1
标准SQL执行成功，行数: 829
预测SQL执行成功，行数: 829
执行查询: ID=1220868379, DB=supervise
执行标准SQL: SELECT lr.liquidity_coverage_ratio, lr.net_stable_funding_ratio, lr.loan_to_deposit_ratio FROM liquidity_ratio lr;
执行预测SQL: SELECT liquidity_coverage_ratio AS liquidity_coverage_ratio, net_stable_funding_ratio AS net_stable_funding_ratio, loan_to_deposit_ratio AS loan_to_deposit_ratio FROM liquidity_ratio
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 10000
已处理 1030/1042 个查询...
执行查询: ID=576576905, DB=supervise
执行标准SQL: SELECT fi.institution_name FROM non_performing_loans npl JOIN financial_institution_info fi ON npl.institution_id = fi.institution_id WHERE npl.report_date >= '2023-12-01' AND npl.report_date < '2024-01-01' AND npl.npl_ratio > 1.5;
执行预测SQL: SELECT fi.institution_name AS institution_name FROM non_performing_loans npl JOIN financial_institution_info fi ON npl.institution_id = fi.institution_id WHERE npl.report_date >= '2023-12-01' AND npl.report_date < '2024-01-01' AND npl.npl_ratio > 1.5
标准SQL执行成功，行数: 543
预测SQL执行成功，行数: 543
执行查询: ID=4037291156, DB=supervise
执行标准SQL: SELECT fi.institution_name FROM financial_institution_info fi JOIN liquidity_ratio lr ON fi.institution_id = lr.institution_id WHERE lr.loan_to_deposit_ratio > 75 AND lr.liquidity_coverage_ratio < 120;
执行预测SQL: SELECT fi.institution_name AS institution_name FROM liquidity_ratio lr JOIN financial_institution_info fi ON lr.institution_id = fi.institution_id WHERE lr.loan_to_deposit_ratio > 75 AND lr.liquidity_coverage_ratio < 120
标准SQL执行成功，行数: 998
预测SQL执行成功，行数: 998
执行查询: ID=163054391, DB=supervise
执行标准SQL: SELECT * FROM regulatory_reports WHERE report_type = '半年度报告';
执行预测SQL: SELECT 
    report_id AS report_id,
    institution_id AS institution_id,
    report_date AS report_date,
    report_type AS report_type,
    submission_date AS submission_date,
    approval_status AS approval_status,
    comments AS comments
FROM 
    regulatory_reports
WHERE 
    report_type = '半年度报告'
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: 2500
执行查询: ID=3390154129, DB=supervise
执行标准SQL: SELECT * FROM compliance_records ORDER BY resolution_date - record_date DESC LIMIT 5;
执行预测SQL: SELECT record_id AS record_id, institution_id AS institution_id, record_date AS record_date, compliance_type AS compliance_type, description AS description, severity AS severity, status AS status, resolution_date AS resolution_date FROM compliance_records WHERE resolution_date IS NOT NULL ORDER BY (resolution_date - record_date) DESC LIMIT 5
标准SQL执行成功，行数: 5
预测SQL执行成功，行数: 5

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 数据不一致
[1m分类结果:[0m [36m数据不一致错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [resolution_date record_id institution_id record_date compliance_type description severity status]
[35m预测SQL列:[0m [institution_id record_date compliance_type description severity status resolution_date record_id]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [<nil> 2 2 2023-07-27 00:00:00 +0000 +0000 信息披露 重大事项未及时披露 高 未解决]
[35m预测[1]:[0m [3171 2023-01-04 00:00:00 +0000 +0000 内控管理 内部审计制度执行不到位 严重 已解决 2023-12-31 00:00:00 +0000 +0000 3171]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [<nil> 1 1 2023-01-11 00:00:00 +0000 +0000 内控管理 内部审计制度执行不到位 中 处理中]
[35m预测[2]:[0m [1233 2023-01-03 00:00:00 +0000 +0000 客户权益保护 客户投诉处理不当 中 已解决 2023-12-29 00:00:00 +0000 +0000 1233]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [<nil> 4 4 2023-06-26 00:00:00 +0000 +0000 其他 违规展业行为 低 处理中]
[35m预测[3]:[0m [348 2023-01-03 00:00:00 +0000 +0000 客户权益保护 客户投诉处理不当 低 已解决 2023-12-29 00:00:00 +0000 +0000 348]
执行查询: ID=1510688156, DB=supervise
执行标准SQL: SELECT r.institution_id, r.report_id, r.report_type, r.approval_status, n.npl_ratio FROM regulatory_reports r JOIN non_performing_loans n ON r.institution_id = n.institution_id WHERE r.submission_date >= '2023-01-01' AND r.submission_date < '2024-01-01' AND r.report_type = '季度报告' AND r.approval_status = '已拒绝' AND n.report_date >= '2023-01-01' AND n.report_date < '2024-01-01' AND n.npl_ratio > 2.00;
执行预测SQL: SELECT r.report_id, r.report_type, r.approval_status, n.npl_ratio, r.institution_id 
FROM regulatory_reports r 
JOIN non_performing_loans n ON r.institution_id = n.institution_id 
WHERE r.report_date >= '2023-01-01' 
AND r.report_date < '2024-01-01' 
AND r.report_type = '季度报告' 
AND r.approval_status = '已拒绝' 
AND n.npl_ratio > 2 
AND n.report_date >= '2023-01-01' 
AND n.report_date < '2024-01-01'
标准SQL执行成功，行数: 811
预测SQL执行成功，行数: 811
执行查询: ID=776982448, DB=supervise
执行标准SQL: SELECT fii.institution_name, rr.report_id, rr.report_date, rr.comments FROM regulatory_reports rr JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id WHERE rr.submission_date >= '2023-01-01' AND rr.submission_date < '2024-01-01' AND rr.report_type = '季度报告' AND rr.approval_status = '已拒绝';
执行预测SQL: SELECT fi.institution_name AS institution_name, rr.report_id AS report_id, rr.report_date AS report_date, rr.comments AS comments 
FROM regulatory_reports rr 
JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id 
WHERE rr.submission_date BETWEEN '2023-01-01' AND '2023-12-31' 
AND rr.report_type = '季度报告' 
AND rr.approval_status = '已拒绝'
标准SQL执行成功，行数: 2500
预测SQL执行成功，行数: 2500
执行查询: ID=3735593182, DB=supervise
执行标准SQL: SELECT f.institution_name FROM financial_institution_info f JOIN liquidity_ratio l ON f.institution_id = l.institution_id WHERE l.loan_to_deposit_ratio BETWEEN 60 AND 80;
执行预测SQL: SELECT DISTINCT fi.institution_name AS institution_name 
FROM liquidity_ratio lr 
JOIN financial_institution_info fi ON lr.institution_id = fi.institution_id 
WHERE lr.loan_to_deposit_ratio BETWEEN 60 AND 80
标准SQL执行成功，行数: 10000
预测SQL执行成功，行数: 8

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回10000行, 预测SQL返回8行
[1m分类结果:[0m [34m行数错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_name]
[35m预测SQL列:[0m [institution_name]

[1m数据对比（前3行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [中国进出口银行]
[35m预测[1]:[0m [国家开发银行]
---------- [1m行 2[0m ----------
[34m标准[2]:[0m [广州农村商业银行]
[35m预测[2]:[0m [中国进出口银行]
---------- [1m行 3[0m ----------
[34m标准[3]:[0m [深圳福田村镇银行]
[35m预测[3]:[0m [中国工商银行北京分行]
执行查询: ID=1403047777, DB=supervise
执行标准SQL: SELECT institution_id FROM capital_adequacy_ratio ORDER BY ABS(core_tier_1_ratio - total_car) LIMIT 1;
执行预测SQL: SELECT institution_id, (core_tier_1_ratio - total_car) AS difference FROM capital_adequacy_ratio ORDER BY (core_tier_1_ratio - total_car) ASC LIMIT 1
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 列数不匹配: 标准SQL返回1列, 预测SQL返回2列
[1m分类结果:[0m [35m投影错误[0m

[1m列信息对比:[0m
[34m标准SQL列:[0m [institution_id]
[35m预测SQL列:[0m [institution_id difference]

[1m数据对比（前1行）:[0m
---------- [1m行 1[0m ----------
[34m标准[1]:[0m [8157]
[35m预测[1]:[0m [2644 -6.92]
执行查询: ID=2008864858, DB=supervise
执行标准SQL: SELECT b.institution_id, b.total_liabilities, f.registered_capital FROM balance_sheet b JOIN financial_institution_info f ON b.institution_id = f.institution_id WHERE EXTRACT(YEAR FROM b.report_date) = 2024;
执行预测SQL: SELECT balance_sheet.institution_id AS institution_id, balance_sheet.total_liabilities AS total_liabilities, financial_institution_info.registered_capital AS registered_capital FROM balance_sheet INNER JOIN financial_institution_info ON balance_sheet.institution_id = financial_institution_info.institution_id WHERE balance_sheet.report_date BETWEEN '2024-01-01' AND '2024-12-31'
标准SQL执行成功，行数: 362
预测SQL执行成功，行数: 362
执行查询: ID=4061107202, DB=supervise
执行标准SQL: SELECT corr(npl_ratio, credit_risk_exposure) AS correlation_coefficient FROM non_performing_loans JOIN risk_exposure USING (institution_id, report_date);
执行预测SQL: SELECT CORR(risk_exposure.credit_risk_exposure, non_performing_loans.npl_ratio) AS correlation_coefficient FROM risk_exposure JOIN non_performing_loans ON risk_exposure.institution_id = non_performing_loans.institution_id AND risk_exposure.report_date = non_performing_loans.report_date
标准SQL执行成功，行数: 1
预测SQL执行成功，行数: 1
已处理 1040/1042 个查询...
执行查询: ID=1821132508, DB=supervise
执行标准SQL: SELECT fii.institution_name FROM financial_institution_info fii JOIN regulatory_reports rr ON fii.institution_id = rr.institution_id JOIN capital_adequacy_ratio car ON fii.institution_id = car.institution_id WHERE rr.report_type = '年度报告' AND rr.approval_status = '已批准' AND car.report_date >= '2023-01-01' AND car.report_date < '2024-01-01' AND car.total_car > 10;
执行预测SQL: SELECT DISTINCT fi.institution_name AS institution_name
FROM financial_institution_info fi
JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id
JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id
WHERE rr.report_date BETWEEN '2023-01-01' AND '2023-12-31'
AND rr.approval_status = 'approved'
AND car.report_date BETWEEN '2023-01-01' AND '2023-12-31'
AND car.total_car > 10
AND car.report_date = rr.report_date
标准SQL执行成功，行数: 1667
预测SQL执行成功，行数: -1

[1m===== 错误分析结果 =====[0m
[1m错误原因:[0m 行数不匹配: 标准SQL返回1667行, 预测SQL返回-1行
[1m分类结果:[0m [34m行数错误[0m
执行查询: ID=1128459706, DB=supervise
执行标准SQL: SELECT npl_ratio, institution_id FROM non_performing_loans WHERE report_date = '2023-06-01';
执行预测SQL: SELECT npl_ratio AS npl_ratio, institution_id AS institution_id FROM non_performing_loans WHERE report_date = '2023-06-01'
标准SQL执行成功，行数: 833
预测SQL执行成功，行数: 833

开始分类输出分析结果...
分类输出完成，结果保存在: results/qwen_test3

[1m[36m======================================[0m
[1m[36m             SQL分析结果摘要             [0m
[1m[36m======================================[0m

[1m总查询数:[0m 1042
[1m正确数量:[0m [32m542[0m (精确匹配: [32m38[0m, 语义等价: [32m504[0m)
[1m模糊查询:[0m [33m33[0m
[1m错误数量:[0m [31m467[0m
[1m总体正确率(排除模糊和参考答案错误):[0m [34m57.01%[0m

[1m[31m错误类型统计(按频率排序)[0m
[1m--------------------------------------[0m
[1m错误类型                         数量             百分比[0m
[1m----------------------------------------[0m
行数错误                 [34m       137[0m           13.15%
数据不一致错误              [36m        42[0m            4.03%
投影错误                 [35m         6[0m            0.58%

[1m[34m详细错误分类统计[0m
[1m--------------------------------------[0m
[1m错误类型                         数量             百分比[0m
[1m----------------------------------------[0m
语法错误                 [33m         0[0m            0.00%
参考答案语法错误             [33m        19[0m            1.82%
投影错误                 [35m         6[0m            0.58%
行数错误                 [34m       137[0m           13.15%
数据不一致                [36m        42[0m            4.03%
执行错误                 [31m       263[0m           25.24%
其他错误                 [31m         0[0m            0.00%

[1m报告已保存到:[0m [32manalysis_report/analysis_reports/summary_report.json[0m

分析完成，总耗时: 2m4.957759613s
